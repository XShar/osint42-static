<!DOCTYPE html>
<html id="XF" lang="ru-RU" dir="LTR"
	data-xf="2.3"
	data-app="public"
	data-variation="alternate"
	data-color-scheme="dark"
	data-template="xa_ams_article_page_view"
	data-container-key="amsCategory-2"
	data-content-key=""
	data-logged-in="false"
	data-cookie-prefix="xf_"
	data-csrf="1758965535,a67e2c2d807cebe310218c8b0b84df4c"
	class="has-no-js template-xa_ams_article_page_view"
	>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/kungfu-2-izuchayem-api-hooking.28/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:42:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<link rel="icon" href="../../../../favicon.ico" type="image/x-icon">
	
	
	

	<meta charset="utf-8" />
	<title>Цикл статей &quot;Изучение вредоносных программ&quot; | Кунгфу-2.Изучаем API Hooking | Osint42.Org - Безопасность и код</title>
	<link rel="manifest" crossorigin="use-credentials" href="../../../../webmanifest.php">

	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

	
		
			<meta name="theme-color" content="#0a1c29" />
		
	

	<meta name="apple-mobile-web-app-title" content="Osint42.Org - Безопасность и код">
	
		<link rel="apple-touch-icon" href="../../../../data/assets/logo/192192.png">
		

	
		
		<meta property="og:title" content="Кунгфу-2.Изучаем API Hooking | Цикл статей &quot;Изучение вредоносных программ&quot;" />
		<meta property="twitter:title" content="Кунгфу-2.Изучаем API Hooking | Цикл статей &quot;Изучение вредоносных..." />
	
	
		
		<meta name="description" content="Введение 

API Hooking — это техника, используемая для перехвата и изменения поведения функции API. Она часто используется для отладки, обратного..." />
		<meta property="og:description" content="Введение 

API Hooking — это техника, используемая для перехвата и изменения поведения функции API. Она часто используется для отладки, обратного проектирования и взлома игр.
API Hooking позволяет заменять оригинальную реализацию функции API..." />
		<meta property="twitter:description" content="Введение 

API Hooking — это техника, используемая для перехвата и изменения поведения функции API. Она часто используется для отладки, обратного проектирования и взлома игр.
API Hooking позволяет..." />
	
	
		<meta property="og:type" content="article" />
	
		<meta property="og:url" content="index.html" />
	
		<link rel="canonical" href="index.html" />
	
		
		<meta property="og:image" content="1746785165779.png" />
		<meta property="twitter:image" content="1746785165779.png" />
		<meta property="twitter:card" content="summary_large_image" />
	
	

	
		
	
	
	<meta property="og:site_name" content="Osint42.Org - Безопасность и код" />


	
	
	
	
	
	

	
	
	
		
	
	

	<link rel="stylesheet" href="../../../../cssf1bd.css?css=public%3Anormalize.css%2Cpublic%3Afa.css%2Cpublic%3Avariations.less%2Cpublic%3Acore.less%2Cpublic%3Aapp.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=650febe17d52673553ff8fcab924bc52ae7c26c5" />

	<link rel="stylesheet" href="../../../../cssa4a6.css?css=public%3Aalnb_navigation.less%2Cpublic%3Abb_code.less%2Cpublic%3Alightbox.less%2Cpublic%3Anotices.less%2Cpublic%3Ashare_controls.less%2Cpublic%3Axa_ams.less%2Cpublic%3Axa_ams_comment.less%2Cpublic%3Aextra.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=ecd081a308b705ae506a43d4915bd16740d009d9" />


	
		<script data-cfasync="false" src="../../../../js/xf/preamble.minf74f.js?_v=01eb82fa"></script>
	

	
	<script data-cfasync="false" src="../../../../js/vendor/vendor-compiledf74f.js?_v=01eb82fa" defer></script>
	<script data-cfasync="false" src="../../../../js/xf/core-compiledf74f.js?_v=01eb82fa" defer></script>

	<script data-cfasync="false">
		XF.ready(() =>
		{
			XF.extendObject(true, XF.config, {
				// 
				userId: 0,
				enablePush: true,
				pushAppServerKey: 'BA479YFsUh5Dh5bOkTEWM7LoORrEgUroE2adYpgA6_NLt6AmfJFBdCBxt_i9NhpAIXJviINVU4JDqWxez0NnB-w',
				url: {
					fullBase: 'https://osint42.org/',
					basePath: '/',
					css: '/css.php?css=__SENTINEL__&s=1&l=2&d=1758392320',
					js: '/js/__SENTINEL__?_v=01eb82fa',
					icon: '/data/local/icons/__VARIANT__.svg?v=1757401797#__NAME__',
					iconInline: '/styles/fa/__VARIANT__/__NAME__.svg?v=5.15.3',
					keepAlive: '/login/keep-alive'
				},
				cookie: {
					path: '/',
					domain: '',
					prefix: 'xf_',
					secure: true,
					consentMode: 'disabled',
					consented: ["optional","_third_party"]
				},
				cacheKey: '60356f7aa4f82ca98e605b4e87a0a057',
				csrf: '1758965535,a67e2c2d807cebe310218c8b0b84df4c',
				js: {"\/js\/xf\/lightbox-compiled.js?_v=01eb82fa":true,"\/js\/xf\/code_block-compiled.js?_v=01eb82fa":true,"\/js\/copycode\/copycode.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/4.4.1\/socket.io.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/socket-conv.min.js?_v=01eb82fa":true},
				fullJs: false,
				css: {"public:alnb_navigation.less":true,"public:bb_code.less":true,"public:lightbox.less":true,"public:notices.less":true,"public:share_controls.less":true,"public:xa_ams.less":true,"public:xa_ams_comment.less":true,"public:extra.less":true},
				time: {
					now: 1758965535,
					today: 1758920400,
					todayDow: 6,
					tomorrow: 1759006800,
					yesterday: 1758834000,
					week: 1758402000,
					month: 1756674000,
					year: 1735678800
				},
				style: {
					light: 'default',
					dark: 'alternate',
					defaultColorScheme: 'light'
				},
				borderSizeFeature: '3px',
				fontAwesomeWeight: 'r',
				enableRtnProtect: true,
				
				enableFormSubmitSticky: true,
				imageOptimization: '0',
				imageOptimizationQuality: 0.85,
				uploadMaxFilesize: 3145728,
				uploadMaxWidth: 0,
				uploadMaxHeight: 0,
				allowedVideoExtensions: ["m4v","mov","mp4","mp4v","mpeg","mpg","ogv","webm"],
				allowedAudioExtensions: ["mp3","opus","ogg","wav"],
				shortcodeToEmoji: true,
				visitorCounts: {
					conversations_unread: '0',
					alerts_unviewed: '0',
					total_unread: '0',
					title_count: true,
					icon_indicator: true
				},
				jsMt: {"xf\/action.js":"dc2375bf","xf\/embed.js":"d3d00259","xf\/form.js":"d3d00259","xf\/structure.js":"dc2375bf","xf\/tooltip.js":"d3d00259"},
				jsState: {},
				publicMetadataLogoUrl: 'https://osint42.org/data/assets/logo/192192.png',
				publicPushBadgeUrl: 'https://osint42.org/styles/default/xenforo/bell.png'
			})

			XF.extendObject(XF.phrases, {
				// 
"svStandardLib_time.day": "{count} day",
"svStandardLib_time.days": "{count} дней",
"svStandardLib_time.hour": "{count} hour",
"svStandardLib_time.hours": "{count} часов",
"svStandardLib_time.minute": "{count} минут",
"svStandardLib_time.minutes": "{count} минут",
"svStandardLib_time.month": "{count} month",
"svStandardLib_time.months": "{count} месяцев",
"svStandardLib_time.second": "{count} second",
"svStandardLib_time.seconds": "{count} секунд",
"svStandardLib_time.week": "time.week",
"svStandardLib_time.weeks": "{count} недель",
"svStandardLib_time.year": "{count} year",
"svStandardLib_time.years": "{count} лет",
copy_to_clipboard: "Скопировать в буфер обмена",
text_copied_to_clipboard: "Текст скопирован в буфер обмена.",
				date_x_at_time_y:     "{date} в {time}",
				day_x_at_time_y:      "{day} в {time}",
				yesterday_at_x:       "Вчера в {time}",
				x_minutes_ago:        "{minutes} мин. назад",
				one_minute_ago:       "Минуту назад",
				a_moment_ago:         "Только что",
				today_at_x:           "Сегодня в {time}",
				in_a_moment:          "Через секунду",
				in_a_minute:          "Через минуту",
				in_x_minutes:         "Через {minutes} мин.",
				later_today_at_x:     "Сегодня в {time}",
				tomorrow_at_x:        "Завтра в {time}",
				short_date_x_minutes: "{minutes} м.",
				short_date_x_hours:   "{hours} ч.",
				short_date_x_days:    "{days} д.",

				day0: "Воскресенье",
				day1: "Понедельник",
				day2: "Вторник",
				day3: "Среда",
				day4: "Четверг",
				day5: "Пятница",
				day6: "Суббота",

				dayShort0: "Вс",
				dayShort1: "Пн",
				dayShort2: "Вт",
				dayShort3: "Ср",
				dayShort4: "Чт",
				dayShort5: "Пт",
				dayShort6: "Сб",

				month0: "Январь",
				month1: "Февраль",
				month2: "Март",
				month3: "Апрель",
				month4: "Май",
				month5: "Июнь",
				month6: "Июль",
				month7: "Август",
				month8: "Сентябрь",
				month9: "Октябрь",
				month10: "Ноябрь",
				month11: "Декабрь",

				active_user_changed_reload_page: "Ваша сессия истекла. Перезагрузите страницу.",
				server_did_not_respond_in_time_try_again: "Сервер не ответил вовремя. Пожалуйста, попробуйте снова.",
				oops_we_ran_into_some_problems: "Упс! Мы столкнулись с некоторыми проблемами.",
				oops_we_ran_into_some_problems_more_details_console: "Упс! Мы столкнулись с некоторыми проблемами. Пожалуйста, попробуйте позже. Более детальную информацию об ошибке Вы можете посмотреть в консоли браузера",
				file_too_large_to_upload: "Файл слишком большой для загрузки.",
				uploaded_file_is_too_large_for_server_to_process: "Загружаемый файл слишком большой для обработки сервером.",
				files_being_uploaded_are_you_sure: "Файлы ещё загружаются. Вы уверены, что хотите отправить эту форму?",
				attach: "Прикрепить файлы",
				rich_text_box: "Текстовое поле с поддержкой форматирования",
				close: "Закрыть",
				link_copied_to_clipboard: "Ссылка скопирована в буфер обмена.",
				text_copied_to_clipboard: "Текст скопирован в буфер обмена.",
				loading: "Загрузка...",
				you_have_exceeded_maximum_number_of_selectable_items: "Вы превысили максимальное количество выбираемых элементов.",

				processing: "Обработка",
				'processing...': "Обработка...",

				showing_x_of_y_items: "Показано {count} из {total} элементов",
				showing_all_items: "Показаны все элементы",
				no_items_to_display: "Нет элементов для отображения",

				number_button_up: "Увеличить",
				number_button_down: "Уменьшить",

				push_enable_notification_title: "Push-уведомления для сайта Osint42.Org - Безопасность и код успешно включены",
				push_enable_notification_body: "Спасибо за включение push-уведомлений!",

				pull_down_to_refresh: "Потяните вниз для обновления",
				release_to_refresh: "Отпустите для обновления",
				refreshing: "Обновление..."
			})
		})
	

window.addEventListener('DOMContentLoaded',()=>{XF.Push.updateUserSubscriptionParent=XF.Push.updateUserSubscription;XF.Push.updateUserSubscription=function(b,a){"unsubscribe"===a&&XF.browser.safari&&XF.Push.setPushHistoryUserIds({});XF.Push.updateUserSubscriptionParent(b,a)}});
</script>

	<script data-cfasync="false" src="../../../../js/xf/lightbox-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/xf/code_block-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/copycode/copycode.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/DCom/LiveContent/4.4.1/socket.io.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/DCom/LiveContent/socket-conv.minf74f.js?_v=01eb82fa" defer></script>



	
		<link rel="icon" type="image/png" href="../../../../data/assets/logo/favicon.png" sizes="32x32" />
	

	
	
</head>
<body data-template="xa_ams_article_page_view">

<div class="p-pageWrapper" id="top">

	

	<header class="p-header" id="header">
		<div class="p-header-inner">
			<div class="p-header-content">
				<div class="p-header-logo p-header-logo--image">
					<a href="../../../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;}}">
		
		
		

		

		<img src="../../../../data/assets/logo_alternate/osint4242.png" srcset="/data/assets/logo_alternate/osint4242.png 2x" width="100" height="36" alt="Osint42.Org - Безопасность и код"  />
	</picture>


					</a>
				</div>

				
			</div>
		</div>
	</header>

	
	

	
		<div class="p-navSticky p-navSticky--primary" data-xf-init="sticky-header">
			
		<nav class="p-nav">
			<div class="p-nav-inner">
				<button type="button" class="button button--plain p-nav-menuTrigger" data-xf-click="off-canvas" data-menu=".js-headerOffCanvasMenu" tabindex="0" aria-label="Меню"><span class="button-text">
					<i aria-hidden="true"></i>
				</span></button>

				<div class="p-nav-smallLogo">
					<a href="../../../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:null},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:null}}">
		
		
		

		

		<img src="../../../../data/assets/logo_alternate/osint4242.png"  width="100" height="36" alt="Osint42.Org - Безопасность и код"  />
	</picture>


					</a>
				</div>

				<div class="p-nav-scroller hScroller" data-xf-init="h-scroller" data-auto-scroll=".p-navEl.is-selected">
					<div class="hScroller-scroll">
						<ul class="p-nav-list js-offCanvasNavSource">
							
								<li>
									
	<div class="p-navEl is-selected" data-has-children="true">
	

		
	
	<a href="../../../../index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xa_ams">Статьи</a>


		<a data-xf-key="1"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewArticles">Новые статьи</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewComments">Новые комментарии</a>

	

				
					
	
	
	<a href="../../../authors/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xa_amsAuthorList">Список авторов</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../forums/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="forums">Форум</a>


		<a data-xf-key="2"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="newPosts">Новые сообщения</a>

	

				
					
	
	
	<a href="../../../../search/index4009.html?type=post"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="searchForums">Поиск по форуму</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../whats-new/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="whatsNew">Что нового</a>


		<a data-xf-key="3"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="whatsNewPosts">Новые сообщения</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewNewArticles">Новые статьи</a>

	

				
					
	
	
	<a href="../../../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgWhatsNewNewMedia">Новые медиа</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewArticleComments">Новые комментарии к статье</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../media/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xfmg">Медиа</a>


		<a data-xf-key="4"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewMedia">Новые медиа</a>

	

				
					
	
	
	<a href="../../../../whats-new/media-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewComments">Новые комментарии</a>

	

				
					
	
	
	<a href="../../../../search/index4784.html?type=xfmg_media"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xfmgSearchMedia">Поиск медиа</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="https://osint42.org/members/"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="members">Пользователи</a>


		<a data-xf-key="5"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="https://osint42.org/online/"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="currentVisitors">Сейчас на форуме</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>

				<div class="p-nav-opposite">
					<div class="p-navgroup p-account p-navgroup--guest">
						
							<a href="../../../../login/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--logIn"
								data-xf-click="overlay" data-follow-redirects="on">
								<span class="p-navgroup-linkText">Вход</span>
							</a>
							
								<a href="../../../../register/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--register"
									data-xf-click="overlay" data-follow-redirects="on">
									<span class="p-navgroup-linkText">Регистрация</span>
								</a>
							
						
					</div>
					
					
    <a href="https://osint42.org/misc/style-variation"
       class="p-navgroup-link p-navgroup-link--iconic js-styleVariationsLink"
       data-xf-click="menu"
       data-menu-pos-ref="< .p-navgroup"
       aria-label=" Выбор стиля"
       aria-expanded="false"
       aria-haspopup="true"
       title=" Выбор стиля">
        <i aria-hidden="true">
            <i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
        </i>
        <span class="p-navgroup-linkText"> Выбор стиля</span>
    </a>

    <div class="menu menu--structural" data-menu="menu" aria-hidden="true">
        <div class="menu-content js-styleVariationsMenu">
            

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			Системный
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			Светлый
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			Тёмный
		
	</a>

	

	
		
	

        </div>
    </div>



					<div class="p-navgroup p-discovery">
						<a href="../../../../whats-new/index.html"
							

	class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--whatsnew"

							aria-label="Что нового"
							title="Что нового">
							<i aria-hidden="true"></i>
							<span class="p-navgroup-linkText">Что нового</span>
						</a>

						
							<a href="../../../../search/index.html"
								class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--search"
								data-xf-click="menu"
								data-xf-key="/"
								aria-label="Поиск"
								aria-expanded="false"
								aria-haspopup="true"
								title="Поиск">
								<i aria-hidden="true"></i>
								<span class="p-navgroup-linkText">Поиск</span>
							</a>
							<div class="menu menu--structural menu--wide" data-menu="menu" aria-hidden="true">
								<form action="https://osint42.org/search/search" method="post"
									class="menu-content"
									data-xf-init="quick-search">

									<h3 class="menu-header">Поиск</h3>
									
									<div class="menu-row">
										
											<div class="inputGroup inputGroup--joined">
												<input type="text" class="input" name="keywords" data-acurl="/search/auto-complete" placeholder="Поиск..." aria-label="Поиск" data-menu-autofocus="true" />
												
			<select name="constraints" class="js-quickSearch-constraint input" aria-label="Поиск в">
				<option value="">Везде</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;}">Статьи</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;,&quot;c&quot;:{&quot;categories&quot;:[2],&quot;child_categories&quot;:1}}">Эта категория</option>

			</select>
		
											</div>
										
									</div>

									
									<div class="menu-row">
										<label class="iconic"><input type="checkbox"  name="c[title_only]" value="1" /><i aria-hidden="true"></i><span class="iconic-label">Искать только в заголовках

													
													<span tabindex="0" role="button"
														data-xf-init="tooltip" data-trigger="hover focus click" title="Теги также будут учитываться">

														<i class="fa--xf far fa-question-circle  u-muted u-smaller"><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Примечание</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#question-circle"></use></svg></i>
													</span></span></label>

									</div>
									
									<div class="menu-row">
										<div class="inputGroup">
											<span class="inputGroup-text" id="ctrl_search_menu_by_member">Автор:</span>
											<input type="text" class="input" name="c[users]" data-xf-init="auto-complete" placeholder="Пользователь" aria-labelledby="ctrl_search_menu_by_member" />
										</div>
									</div>
									<div class="menu-footer">
									<span class="menu-footer-controls">
										<button type="submit" class="button button--icon button--icon--search button--primary"><i class="fa--xf far fa-search "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#search"></use></svg></i><span class="button-text">Найти</span></button>
										<button type="submit" class="button " name="from_search_menu"><span class="button-text">Расширенный поиск...</span></button>
									</span>
									</div>

									<input type="hidden" name="_xfToken" value="1758965535,a67e2c2d807cebe310218c8b0b84df4c" />
								</form>
							</div>
						
					</div>
				</div>
			</div>
		</nav>
	
		</div>
		
		
			<div class="p-sectionLinks">
				<div class="p-sectionLinks-inner hScroller" data-xf-init="h-scroller">
					<div class="hScroller-scroll">
						<ul class="p-sectionLinks-list">
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+1"
	data-nav-id="xa_amsNewArticles">Новые статьи</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+2"
	data-nav-id="xa_amsNewComments">Новые комментарии</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../authors/index.html"
	class="p-navEl-link "
	
	data-xf-key="alt+3"
	data-nav-id="xa_amsAuthorList">Список авторов</a>


		

		
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>
			</div>
			
	
		

	<div class="offCanvasMenu offCanvasMenu--nav js-headerOffCanvasMenu" data-menu="menu" aria-hidden="true" data-ocm-builder="navigation">
		<div class="offCanvasMenu-backdrop" data-menu-close="true"></div>
		<div class="offCanvasMenu-content">
			<div class="offCanvasMenu-header">
				Меню
				<a class="offCanvasMenu-closer" data-menu-close="true" role="button" tabindex="0" aria-label="Закрыть"></a>
			</div>
			
				<div class="p-offCanvasRegisterLink">
					<div class="offCanvasMenu-linkHolder">
						<a href="../../../../login/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
							Вход
						</a>
					</div>
					<hr class="offCanvasMenu-separator" />
					
						<div class="offCanvasMenu-linkHolder">
							<a href="../../../../register/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
								Регистрация
							</a>
						</div>
						<hr class="offCanvasMenu-separator" />
					
				</div>
			
			<div class="js-offCanvasNavTarget"></div>
			<div class="offCanvasMenu-installBanner js-installPromptContainer" style="display: none;" data-xf-init="install-prompt">
				<div class="offCanvasMenu-installBanner-header">Установить приложение</div>
				<button type="button" class="button js-installPromptButton"><span class="button-text">Установить</span></button>
				<template class="js-installTemplateIOS">
					<div class="js-installTemplateContent">
						<div class="overlay-title">Как установить приложение на iOS</div>
						<div class="block-body">
							<div class="block-row">
								<p>
									Следуйте инструкциям в видео ниже, чтобы узнать, как установить наш сайт как веб-приложение на главный экран вашего устройства.
								</p>
								<p style="text-align: center">
									<video src="../../../../styles/default/xenforo/add_to_home_new.mp4"
										width="280" height="480" autoplay loop muted playsinline></video>
								</p>
								<p>
									<small><strong>Примечание:</strong> Эта функция может быть недоступна в некоторых браузерах.</small>
								</p>
							</div>
						</div>
					</div>
				</template>
			</div>
		</div>
	</div>

	<div class="p-body">
		<div class="p-body-inner">
			<!--XF:EXTRA_OUTPUT-->


			
				
	
		
		

		<ul class="notices notices--block  js-notices"
			data-xf-init="notices"
			data-type="block"
			data-scroll-interval="6">

			
				
	<li class="notice js-notice notice--primary notice--hasImage"
		data-notice-id="1"
		data-delay-duration="0"
		data-display-duration="0"
		data-auto-dismiss=""
		data-visibility="">

		
			<div class="notice-image"><img src="../../../../data/assets/notice_images/c7eb1746-6291-4d37-b72b-8e3b5cfd1303.png" alt="" /></div>
		
		<div class="notice-content">
			
			<div class="block"
     style="border:1px solid #ccc;
            border-radius:8px;
            padding:min(4vw,15px);
            background:var(--xf-contentBg);
            box-shadow:0 0 8px rgba(0,0,0,.1);
            width:100%;
            max-width:clamp(480px,90vw,1200px);
            margin:0 auto;
            box-sizing:border-box;
            overflow:hidden;">

  <div class="block-container">
    <h3 class="block-header"
        style="font-size:clamp(1rem,4vw,1.125rem);
               margin:0 0 10px 0;">
      📡 Наши контакты
    </h3>

    <div class="block-body" style="line-height:1.4;">

      <!-- Email -->
      <p style="margin:8px 0;">
        ✉️ Email:
        <a href="../../../../cdn-cgi/l/email-protection.html#dab3b4bcb59ab5a9b3b4aeeee8f4b9b5b7" style="color:#2ecc71;
                  font-weight:bold;
                  overflow-wrap:anywhere;
                  text-decoration:none;">
          <span class="__cf_email__" data-cfemail="7910171f1639160a10170d4d4b571a1614">[email&#160;protected]</span>
        </a>
      </p>

      <div class="ya-site-form ya-site-form_inited_no" data-bem="{&quot;action&quot;:&quot;https://yandex.ru/search/site/&quot;,&quot;arrow&quot;:false,&quot;bg&quot;:&quot;transparent&quot;,&quot;fontsize&quot;:12,&quot;fg&quot;:&quot;#000000&quot;,&quot;language&quot;:&quot;ru&quot;,&quot;logo&quot;:&quot;rb&quot;,&quot;publicname&quot;:&quot;Поиск по osint42.com&quot;,&quot;suggest&quot;:true,&quot;target&quot;:&quot;_blank&quot;,&quot;tld&quot;:&quot;ru&quot;,&quot;type&quot;:2,&quot;usebigdictionary&quot;:true,&quot;searchid&quot;:13900241,&quot;input_fg&quot;:&quot;#000000&quot;,&quot;input_bg&quot;:&quot;#ffffff&quot;,&quot;input_fontStyle&quot;:&quot;normal&quot;,&quot;input_fontWeight&quot;:&quot;normal&quot;,&quot;input_placeholder&quot;:&quot;Поиск по сайту&quot;,&quot;input_placeholderColor&quot;:&quot;#000000&quot;,&quot;input_borderColor&quot;:&quot;#7f9db9&quot;}"><form action="https://yandex.ru/search/site/" method="get" target="_blank" accept-charset="utf-8"><input type="hidden" name="searchid" value="13900241"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
      <!-- Notice -->
      <p style="margin:15px 0 0;
                padding:10px;
                border-radius:6px;
                background:#ffeaea;
                color:#c0392b;
                font-weight:bold;
                text-align:center;">
        ⚠️ Это архив форума, в ближайшее время поддержка ресурса не планируется!
      </p>

    </div>
  </div>
</div>
		</div>
	</li>

			
		</ul>
	

			

			

			
			
	
		<ul class="p-breadcrumbs "
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">Уроки разработки вредоносного софта</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			

			
	<noscript class="js-jsWarning"><div class="blockMessage blockMessage--important blockMessage--iconic u-noJsOnly">JavaScript отключён. Для полноценно использования нашего сайта, пожалуйста, включите JavaScript в своём браузере.</div></noscript>

			
	<div class="blockMessage blockMessage--important blockMessage--iconic js-browserWarning" style="display: none">Вы используете устаревший браузер. Этот и другие сайты могут отображаться в нем неправильно.<br />Необходимо обновить браузер или попробовать использовать <a href="https://www.google.com/chrome/" target="_blank" rel="noopener">другой</a>.</div>


			
				<div class="p-body-header">
					
		<div class="contentRow contentRow--hideFigureNarrow">
			<div class="contentRow-main">
				<div class="p-title">
					<h1 class="p-title-value">
						
							
							Цикл статей &quot;Изучение вредоносных программ&quot;
						
					</h1>
				</div>
				
					<div class="p-description">
						
							<ul class="listInline listInline--bullet">
								<li>
									<i class="fa--xf far fa-user "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Автор</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#user"></use></svg></i>
									<span class="u-srOnly">Автор</span>
									
										<a href="https://osint42.org/members/0x42.1/" class="username  u-concealed" dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a>
									
								</li>
								
								<li>
									<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Дата публикации</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
									<span class="u-srOnly">Дата публикации</span>

									<a href="../../index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-05-08T13:54:22+0300" data-timestamp="1746701662" data-date="08.05.2025" data-time="13:54" data-short="8 Май" title="08.05.2025 в 13:54">08.05.2025</time></a>
								</li>
																
									<li>
										<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Последнее обновление</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
										<span class="u-concealed">Обновлено</span>

										<time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 Май" title="09.05.2025 в 16:44">09.05.2025</time>
									</li>
								
																
									<li>
										<i class="fa--xf far fa-hourglass "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Article read time</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#hourglass"></use></svg></i>
										<span class="u-srOnly">Article read time</span>

										398 min read
									</li>
								
								
								
									<li><span class="label label--accent">Рекомендуемые</span></li>
								
							</ul>
						
					</div>
				

				

	
		
	

			</div>
		</div>
	
				</div>
				

			<div class="p-body-main p-body-main--withSidebar ">
				
				<div class="p-body-contentCol"></div>
				
					<div class="p-body-sidebarCol"></div>
				

				

				<div class="p-body-content">
					
					<div class="p-body-pageContent">









	

	



	
	

	




	




	







	



	




	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	







	
		
		

		
			<script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script class="js-extraPhrases" type="application/json">
			{
				"lightbox_close": "Закрыть",
				"lightbox_next": "Следующая",
				"lightbox_previous": "Предыдущая",
				"lightbox_error": "Запрошенный контент не может быть загружен. Пожалуйста, попробуйте позже.",
				"lightbox_start_slideshow": "Запустить слайд-шоу",
				"lightbox_stop_slideshow": "Остановить слайд-шоу",
				"lightbox_full_screen": "Полный экран",
				"lightbox_thumbnails": "Миниатюры",
				"lightbox_download": "Скачать",
				"lightbox_share": "Поделиться",
				"lightbox_zoom": "Увеличить",
				"lightbox_new_window": "Новое окно",
				"lightbox_toggle_sidebar": "Переключить боковую панель"
			}
			</script>
		
		
	


<div class="block">
	
		<div class="block-outer">
			<div class="block-outer-opposite">
			
				

	

	

	

	

	

	

	

	
		<div class="buttonGroup">
		
			

			
			
			
			

	

			
			
				<div class="buttonGroup-buttonWrapper">
					<button type="button" class="button button--link menuTrigger" data-xf-click="menu" aria-expanded="false" aria-haspopup="true" title="Навигация по страницам"><span class="button-text">
						ОГЛАВЛЕНИЕ
					</span></button>
					<div class="menu" data-menu="menu" aria-hidden="true">
						<div class="menu-content">
							<h4 class="menu-header">Выберите страницу</h4>

							<a href="../../index.html" class="menu-linkRow ">
								
									Зачем изучать разработку вредоносных программ ?
								
							</a>

							
								
									<a href="../instrumenty.1/index.html" class="menu-linkRow ">
									 Инструменты</a>
								
									<a href="../tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="menu-linkRow ">
									 Так какой-же язык выбрать !?</a>
								
									<a href="../shpargalka-po-arkhitekture-vindy.3/index.html" class="menu-linkRow ">
									 Шпаргалка по архитектуре винды</a>
								
									<a href="../chto-takoye-payload-i-shell-code.5/index.html" class="menu-linkRow ">
									 Что такое payload и shell code</a>
								
									<a href="../izuchayem-dinamicheskiye-biblioteki.6/index.html" class="menu-linkRow ">
									 Изучаем динамические библиотеки</a>
								
									<a href="../protsessy-windows.7/index.html" class="menu-linkRow ">
									 Процессы Windows</a>
								
									<a href="../vidy-detektov.8/index.html" class="menu-linkRow ">
									 Виды детектов</a>
								
									<a href="../kuda-klast-nagruzku.9/index.html" class="menu-linkRow ">
									 Куда класть нагрузку ?</a>
								
									<a href="../shifruyem-payload.10/index.html" class="menu-linkRow ">
									 Шифруем Payload</a>
								
									<a href="../obfuskatsiya-payload.11/index.html" class="menu-linkRow ">
									 Обфускация Payload</a>
								
									<a href="../lokal-nyi-zapusk-payload.12/index.html" class="menu-linkRow ">
									 Локальный запуск Payload</a>
								
									<a href="../in-yektsiya-v-protsess.13/index.html" class="menu-linkRow ">
									 Иньекция в процесс</a>
								
									<a href="../in-yektsiya-shell-koda-v-protsess.14/index.html" class="menu-linkRow ">
									 Инъекция шелл-кода в процесс</a>
								
									<a href="../razmeshchayem-payload-udalenno-na-servere.15/index.html" class="menu-linkRow ">
									 Размещаем Payload удаленно на сервере</a>
								
									<a href="../pryachem-payload-v-reyestre.16/index.html" class="menu-linkRow ">
									 Прячем Payload в реестре</a>
								
									<a href="../razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="menu-linkRow ">
									 Разборка с цифровой подписью зверька</a>
								
									<a href="../izuchayem-tekhniku-thread-hijacking.18/index.html" class="menu-linkRow ">
									 Изучаем технику Thread Hijacking</a>
								
									<a href="../opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="menu-linkRow ">
									 Определение PID нужного процесса, или перечисления процессов</a>
								
									<a href="../izuchayem-tekhniku-apc-injection.20/index.html" class="menu-linkRow ">
									 Изучаем технику APC Injection</a>
								
									<a href="../vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="menu-linkRow ">
									 Вызов кода через функции обратного вызова</a>
								
									<a href="../in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="menu-linkRow ">
									 Инъекция отображаемой памяти</a>
								
									<a href="../izuchayem-tekhniku-stomping-injection.23/index.html" class="menu-linkRow ">
									 Изучаем технику Stomping Injection</a>
								
									<a href="../kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="menu-linkRow ">
									 Контроль выполнения полезной нагрузки</a>
								
									<a href="../izuchayem-tekhniku-spoofing.25/index.html" class="menu-linkRow ">
									 Изучаем технику Spoofing</a>
								
									<a href="../skrytiye-strok.26/index.html" class="menu-linkRow ">
									 Скрытие строк</a>
								
									<a href="../izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="menu-linkRow ">
									 Изучаем кунгфу-1. Скрытие таблицы импорта</a>
								
									<a href="index.html" class="menu-linkRow is-selected">
									 Кунгфу-2.Изучаем API Hooking</a>
								
									<a href="../predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="menu-linkRow ">
									 Предельная техника. Разборка с сисколами</a>
								
									<a href="../predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="menu-linkRow ">
									 Предельная техника-2. Практика. Реализуем техники инъекции через сисколы</a>
								
									<a href="../cherpayem-sily-v-antiotladke.31/index.html" class="menu-linkRow ">
									 Черпаем силы в антиотладке</a>
								
									<a href="../obkhod-virtual-nykh-mashin.32/index.html" class="menu-linkRow ">
									 Обход виртуальных машин</a>
								
									<a href="../otkryvayem-vrata-ada.33/index.html" class="menu-linkRow ">
									 Открываем врата ада</a>
								
									<a href="../umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="menu-linkRow ">
									 Уменьшение вероятности детекта зверька</a>
								
									<a href="../obkhod-windows-defender.35/index.html" class="menu-linkRow ">
									 Обход Windows defender</a>
								
									<a href="../pro-endpoint-detection-and-response-edr.36/index.html" class="menu-linkRow ">
									 Про Endpoint Detection and Response (EDR)</a>
								
									<a href="../pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="menu-linkRow ">
									 Про детект в памяти. Ничего не поделаешь и это неизбежно)</a>
								
									<a href="../ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="menu-linkRow ">
									 Огромная база исходников современных вирусов для разных платформ</a>
								
									<a href="../kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="menu-linkRow ">
									 Как RootKit загрузить или же как загрузить драйвер без подписи</a>
								
									<a href="../obkhod-amsi.40/index.html" class="menu-linkRow ">
									 Обход AMSI</a>
								
									<a href="../obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="menu-linkRow ">
									 Обход AMSI при помощи хардварных точек останова</a>
								
									<a href="../uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="menu-linkRow ">
									 Уклоняемся от поведенческого детекта антивируса и EDR</a>
								
									<a href="../obkhodim-antivirusy-i-edr.43/index.html" class="menu-linkRow ">
									 Обходим антивирусы и EDR</a>
								
									<a href="../mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="menu-linkRow ">
									 MutationGate - Новый подход работы с сисколами</a>
								
									<a href="../razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="menu-linkRow ">
									 Разработка настоящего вируса в 2024 году</a>
								
							
							
								<a href="../../index9401.html?full=1" class="menu-linkRow ">Просмотреть всю статью</a>
							
						</div>
					</div>
				</div>
			

			

			
		
		</div>
	

			
			</div>
		</div>
	

	
	
	
	
		

	<div class="block-container">
		<div class="block-body lbContainer js-articleBody"
			data-xf-init="lightbox"
			data-lb-id="article-6"
			data-lb-caption-desc="0x42 &middot; 08.05.2025 в 13:54"
			id="js-articleBody-6">

			<div class="articleBody">
				<article class="articleBody-main js-lbContainer">
					
					

					<h2>Кунгфу-2.Изучаем API Hooking</h2>

					

						

					<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746785165779.png"
		data-src="https://osint42.org/attachments/1746785165779-png.191/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785165779-png.191/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785165779.png"
			title="1746785165779.png"
			width="1000" height="667" loading="lazy" />
	</div><br />
<br />
<b>Введение </b><br />
<br />
API Hooking — это техника, используемая для перехвата и изменения поведения функции API. Она часто используется для отладки, обратного проектирования и взлома игр.<br />
API Hooking позволяет заменять оригинальную реализацию функции API собственной версией, которая выполняет некоторые дополнительные действия до или после вызова оригинальной функции. Это позволяет изменять поведение программы без изменения её исходного кода.<br />
<br />
<b>Трамплины</b><br />
<br />
Классический способ реализации API-хуков осуществляется с помощью трамплинов.<br />
Трамплин — это шеллкод, который используется для изменения пути выполнения кода путем перехода на другой конкретный адрес в адресном пространстве процесса. Шеллкод трамплина вставляется в начало функции, в результате чего функция становится &quot;подцепленной&quot;. Когда вызывается подцепленная функция, вместо нее активируется шеллкод трамплина, и поток выполнения передается и изменяется на другой адрес, что приводит к выполнению другой функции.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785174606.png"
		data-src="https://osint42.org/attachments/1746785174606-png.192/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785174606-png.192/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785174606.png"
			title="1746785174606.png"
			width="1058" height="385" loading="lazy" />
	</div><br />
<br />
<b>Встраиваемый Хук</b><br />
<br />
Встраиваемый хук — это альтернативный метод выполнения API-хуков, который работает аналогично хуку на основе трамплина. Разница заключается в том, что встраиваемые хуки возвращают выполнение законной функции, позволяя нормальному выполнению продолжаться. Несмотря на то что они сложнее в реализации и потенциально труднее в обслуживании, встраиваемые хуки более эффективны.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785181159.png"
		data-src="https://osint42.org/attachments/1746785181159-png.193/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785181159-png.193/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785181159.png"
			title="1746785181159.png"
			width="1020" height="396" loading="lazy" />
	</div><br />
<br />
API-хук выполняется некоторыми средствами безопасности, чтобы позволить им более тщательно изучать часто злоупотребляемые функции. Об этом будет подробнее рассказано далее.<br />
<br />
<b>Зачем API-Хук</b><br />
<br />
Хотя API-хук в основном используется для анализа вредоносного ПО и целей отладки, его можно использовать при разработке вредоносного ПО по следующим причинам:<br />
<br />
Сбор конфиденциальной информации или данных (например, учетные данные).<br />
<br />
Изменение или перехват вызовов функций в злонамеренных целях.<br />
<br />
Обход мер безопасности путем изменения поведения операционной системы или программы (например, AMSI, ETW).<br />
<br />
<b>Реализация Хука</b><br />
<br />
Существует много способов реализации API-хука, один из способов — через открытые библиотеки, такие как библиотека <a href="https://github.com/microsoft/Detours" target="_blank" class="link link--external" rel="noopener">Detours от Microsoft</a> и <a href="https://github.com/TsudaKageyu/minhook" target="_blank" class="link link--external" rel="noopener">Minhook</a>. Еще один, более ограниченный способ, — использование API Windows, предназначенных для выполнения API-хука (хотя с ограниченными возможностями).<br />
<br />
Далее в статье будут продемонстрированы как Detours, так и Minhook.<br />
<br />
Кроме того, будут использованы API Windows, чтобы увидеть, что они могут предложить.<br />
<br />
<b>Наконец, будет создан пользовательский код хука,</b> чтобы уменьшить подписи и индикаторы компрометации, которые обычно используются для обнаружения использования открытых библиотек.<br />
<br />
Итак начнём.)<br />
<br />
API Hooking - <a href="https://github.com/microsoft/Detours" target="_blank" class="link link--external" rel="noopener">Библиотека Detours</a><br />
<br />
Библиотека Detours для хука, разработанная Microsoft Research, позволяет перехватывать и перенаправлять вызовы функций в Windows.<br />
Библиотека перенаправляет вызовы определенных функций к пользовательской заменяющей функции, которая может затем выполнять дополнительные задачи или изменять поведение исходной функции.<br />
Detours обычно используется с программами на C/C++ и может быть использована как с 32-битными, так и с 64-битными приложениями.<br />
<br />
Страница wiki библиотеки доступна <a href="https://github.com/microsoft/Detours/wiki/" target="_blank" class="link link--external" rel="noopener">здесь.</a><br />
<br />
<b>Транзакции</b><br />
<br />
Библиотека Detours заменяет первые несколько инструкций целевой функции, то есть функции, к которой применяется хук, безусловным переходом к пользовательской функции обходного пути, которая будет выполнена вместо неё.<br />
Термин &quot;безусловный переход&quot; также называется &quot;трамплином&quot;.<br />
<br />
Библиотека использует транзакции для установки и удаления хуков из целевой функции. Транзакции позволяют группировать несколько функций хуков вместе и применять их как единую единицу, что может быть полезно при внесении нескольких изменений в поведение программы. Это также предоставляет преимущество в том, что пользователь может легко отменить все изменения при необходимости. При использовании транзакций можно начать новую транзакцию, добавить функции хуков и затем подтвердить её. При подтверждении транзакции все функции хуков, добавленные к транзакции, будут применены к программе, как это было бы в случае с удалением хука.<br />
<br />
<b>Использование библиотеки Detours</b><br />
<br />
Для использования функций библиотеки Detours необходимо загрузить и скомпилировать репозиторий Detours, чтобы получить необходимые статические файлы библиотеки (.lib). Кроме того, следует включить заголовочный файл detours.h, что объясняется в разделе &quot;Использование Detours&quot; на вики Detours.<br />
<br />
Для дополнительной помощи в добавлении .lib файлов в проект ознакомьтесь <a href="https://learn.microsoft.com/en-us/cpp/build/reference/dot-lib-files-as-linker-input?view=msvc-170" target="_blank" class="link link--external" rel="noopener">с документацией Microsoft.</a><br />
<br />
<b>32-битная vs 64-битная библиотека Detours</b><br />
<br />
Предоставленный в этой статье код содержит препроцессорный код, который определяет, какую версию файла .lib Detours следует включить, в зависимости от архитектуры используемой машины. Для этого используются макросы _M_X64 и _M_IX86. Эти макросы определены компилятором для указания, работает ли машина на 64-битной или 32-битной версии Windows. Препроцессорный код выглядит следующим образом:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Если компилируется как 64-бит
#ifdef _M_X64
#pragma comment (lib, &quot;detoursx64.lib&quot;)
#endif // _M_X64
// Если компилируется как 32-бит
#ifdef _M_IX86
#pragma comment (lib, &quot;detoursx86.lib&quot;)
#endif // _M_IX86</code></pre>
	</div>
</div><br />
#ifdef _M_X64 проверяет, определен ли макрос _M_X64, и если он определен, следующий за ним код будет включен в компиляцию. Если он не определен, код будет проигнорирован. Аналогично, #ifdef _M_IX86 проверяет, определен ли макрос _M_IX86, и если он определен, следующий за ним код будет включен в компиляцию. #pragma comment (lib, &quot;detoursx64.lib&quot;) используется для связывания библиотеки detoursx64.lib во время компиляции для 64-битных систем, и #pragma comment (lib, &quot;detoursx86.lib&quot;) используется для связывания библиотеки detoursx86.lib во время компиляции для 32-битных систем.<br />
<br />
Файлы detoursx64.lib и detoursx86.lib создаются при компиляции библиотеки Detours, detoursx64.lib создается при компиляции библиотеки Detours как 64-битный проект, таким же образом файл detoursx86.lib создается при компиляции библиотеки Detours как 32-битный проект.<br />
<br />
<b>Функции API Detours</b><br />
<br />
При использовании любого метода хуков первым шагом всегда является получение адреса функции WinAPI для хука. Адрес функции требуется для определения, где будут размещены инструкции перехода. В этом модуле функция MessageBoxA будет использоваться как функция для хука.<br />
<br />
Ниже перечислены функции API, которые предлагает библиотека Detours:<br />
<ul>
<li data-xf-list-type="ul">DetourTransactionBegin - начать новую транзакцию для установки или удаления обходных путей. Эту функцию следует вызывать первой при установке и удалении хука.</li>
<li data-xf-list-type="ul">DetourUpdateThread - обновить текущую транзакцию. Это используется библиотекой Detours для включения потока в текущую транзакцию.</li>
<li data-xf-list-type="ul">DetourAttach - установить хук на целевую функцию в текущей транзакции. Это не будет зафиксировано, пока не будет вызвана функция DetourTransactionCommit.</li>
<li data-xf-list-type="ul">DetourDetach - удалить хук с целевой функции в текущей транзакции. Это не будет зафиксировано, пока не будет вызвана функция DetourTransactionCommit.</li>
<li data-xf-list-type="ul">DetourTransactionCommit - подтвердить текущую транзакцию для установки или удаления обходных путей. Возвращаемое значение функций выше - это значение LONG, которое используется для понимания результата выполнения функции. API Detours вернет NO_ERROR, которое равно 0, если она завершится успешно, и ненулевое значение в случае ошибки. Ненулевое значение может быть использовано как код ошибки для целей отладки.</li>
</ul><b>Замена подцепленного API </b><br />
<br />
Следующим шагом является создание функции для замены подцепленного API. Функция замены должна иметь тот же тип данных и, по желанию, принимать те же параметры. Это позволяет проверять или изменять значения параметров. Например, следующая функция может быть использована в качестве функции обходного пути для MessageBoxA, что позволяет проверять исходные значения параметров.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		Код:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // мы можем проверять hWnd - lpText - lpCaption - параметры uType
}</code></pre>
	</div>
</div><br />
Стоит отметить, что функция замены может принимать меньше параметров, но не может принимать больше, чем исходная функция, потому что тогда она будет обращаться к недействительному адресу, что вызовет исключения нарушения доступа.<br />
<br />
<b>Проблема бесконечного цикла</b><br />
<br />
Когда вызывается подцепленная функция и активируется хук, выполняется пользовательская функция, однако для продолжения потока выполнения пользовательская функция должна вернуть действительное значение, которое исходная подцепленная функция должна была вернуть. Наивный подход заключается в том, чтобы вернуть то же значение, вызывая исходную функцию внутри хука. Это может привести к проблемам, так как вместо заменяющей функции будет вызываться исходная функция, <b>что приведет к бесконечному циклу. </b>Это общая проблема хуков и не ошибка в библиотеке Detours.<br />
<br />
Для лучшего понимания рассмотрите приведенный ниже фрагмент кода, показывающий функцию замены MyMessageBoxA, вызывающую MessageBoxA. Это приводит к бесконечному циклу. Программа застрянет на выполнении MyMessageBoxA, потому что MyMessageBoxA вызывает MessageBoxA, и MessageBoxA ведет к функции MyMessageBoxA снова.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // Вывод оригинальных значений параметров
  printf(&quot;Оригинальный параметр lpText    : %s\n&quot;, lpText);
  printf(&quot;Оригинальный параметр lpCaption : %s\n&quot;, lpCaption);

  // НЕ ДЕЛАЙТЕ ТАК
  // Изменение значений параметров
  return MessageBoxA(hWnd, &quot;другой lpText&quot;, &quot;другой lpCaption&quot;, uType); // Вызов MessageBoxA (этот хук активен)
}</code></pre>
	</div>
</div><br />
<b>Решение 1 - Глобальный указатель</b> <b>на оригинальную функцию</b><br />
<br />
Библиотека Detours может решить эту проблему, сохранив указатель на исходную функцию перед ее подцеплением. Этот указатель можно сохранить в глобальной переменной и вызвать вместо подцепленной функции в функции обходного пути.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Используется как не подцепленная MessageBoxA в `MyMessageBoxA`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // Вывод оригинальных значений параметров
  printf(&quot;Оригинальный параметр lpText    : %s\n&quot;, lpText);
  printf(&quot;Оригинальный параметр lpCaption : %s\n&quot;, lpCaption);

  // Изменение значений параметров
  // Вызов не подцепленной MessageBoxA
  return g_pMessageBoxA(hWnd, &quot;другой lpText&quot;, &quot;другой lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
<b>Решение 2 - Использование другого API </b><br />
<br />
Еще одно более общее решение, которое стоит упомянуть, заключается в вызове другой не подцепленной функции, которая имеет такую же функциональность, как и подцепленная функция. Например, MessageBoxA и MessageBoxW, VirtualAlloc и VirtualAllocEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // Вывод оригинальных значений параметров
  printf(&quot;Оригинальный параметр lpText    : %s\n&quot;, lpText);
  printf(&quot;Оригинальный параметр lpCaption : %s\n&quot;, lpCaption);

  // Изменение значений параметров
  return MessageBoxW(hWnd, L&quot;другой lpText&quot;, L&quot;другой lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
<b>Процедура хука Detours</b><br />
<br />
Как было объяснено ранее, библиотека Detours работает с использованием транзакций, поэтому для установки хука на функцию API необходимо создать транзакцию, представить действие (установка/удаление хука) для транзакции, а затем подтвердить транзакцию. Приведенный ниже фрагмент кода выполняет эти шаги.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Используется как не подцепленная MessageBoxA в `MyMessageBoxA`
// И используется в `DetourAttach` &amp; `DetourDetach`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

// Функция, которая будет запускаться вместо MessageBoxA при активации хука
INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {

    printf(&quot;[+] Оригинальные параметры : \n&quot;);
    printf(&quot;\t - lpText    : %s\n&quot;, lpText);
    printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

    return g_pMessageBoxA(hWnd, &quot;другой lpText&quot;, &quot;другой lpCaption&quot;, uType);
}

BOOL InstallHook() {

    DWORD    dwDetoursErr = NULL;

      // Создание транзакции и её обновление
    if ((dwDetoursErr = DetourTransactionBegin()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionBegin завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    if ((dwDetoursErr = DetourUpdateThread(GetCurrentThread())) != NO_ERROR) {
        printf(&quot;[!] DetourUpdateThread завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // Запуск MyMessageBoxA вместо g_pMessageBoxA, который является MessageBoxA
    if ((dwDetoursErr = DetourAttach((PVOID)&amp;g_pMessageBoxA, MyMessageBoxA)) != NO_ERROR) {
        printf(&quot;[!] DetourAttach завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // Фактическая установка хука происходит после `DetourTransactionCommit` - подтверждение транзакции
    if ((dwDetoursErr = DetourTransactionCommit()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionCommit завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Процедура удаления хука Detours</b><br />
<br />
Приведенный ниже фрагмент кода показывает ту же процедуру, что и в предыдущем разделе, но это для удаления хука.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Используется как не подцепленная MessageBoxA в `MyMessageBoxA`
// И используется в `DetourAttach` &amp; `DetourDetach`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

// Функция, которая будет запускаться вместо MessageBoxA при активации хука
INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {

    printf(&quot;[+] Оригинальные параметры : \n&quot;);
    printf(&quot;\t - lpText    : %s\n&quot;, lpText);
    printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

    return g_pMessageBoxA(hWnd, &quot;другой lpText&quot;, &quot;другой lpCaption&quot;, uType);
}

BOOL Unhook() {

    DWORD    dwDetoursErr = NULL;

      // Создание транзакции и её обновление
    if ((dwDetoursErr = DetourTransactionBegin()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionBegin завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    if ((dwDetoursErr = DetourUpdateThread(GetCurrentThread())) != NO_ERROR) {
        printf(&quot;[!] DetourUpdateThread завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // Удаление хука из MessageBoxA
    if ((dwDetoursErr = DetourDetach((PVOID)&amp;g_pMessageBoxA, MyMessageBoxA)) != NO_ERROR) {
        printf(&quot;[!] DetourDetach завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // Фактическое удаление хука происходит после `DetourTransactionCommit` - подтверждение транзакции
    if ((dwDetoursErr = DetourTransactionCommit()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionCommit завершилась ошибкой с кодом : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Основная функция</b><br />
<br />
Ранее показанные процедуры установки и удаления хука не включают в себя основную функцию. Основная функция представлена ниже, в ней просто вызываются подцепленные и не подцепленные версии MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    // Будет выполнено - не подцеплено
    MessageBoxA(NULL, &quot;Что вы думаете о разработке вредоносных программ?&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONQUESTION);

//------------------------------------------------------------------
    //  Установка хука
    if (!InstallHook())
        return -1;

//------------------------------------------------------------------
    // Не будет выполнено - будет запущена функция MyMessageBoxA вместо этого
    MessageBoxA(NULL, &quot;Разработка вредоносных программ - это плохо&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONWARNING);

//------------------------------------------------------------------
    //  Удаление хука
    if (!Unhook())
        return -1;

//------------------------------------------------------------------
    //  Будет выполнено - хук удален
    MessageBoxA(NULL, &quot;Снова обычное сообщение&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONINFORMATION);

      return 0;
}</code></pre>
	</div>
</div><br />
<b>Демо<br />
<br />
MessageBoxA (Unhooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785204088.png"
		data-src="https://osint42.org/attachments/1746785204088-png.194/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785204088-png.194/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785204088.png"
			title="1746785204088.png"
			width="1409" height="855" loading="lazy" />
	</div><br />
<br />
<b>MessageBoxA (Hooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785211187.png"
		data-src="https://osint42.org/attachments/1746785211187-png.195/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785211187-png.195/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785211187.png"
			title="1746785211187.png"
			width="1449" height="708" loading="lazy" />
	</div><br />
<br />
<b>MessageBoxA (Unhooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785217820.png"
		data-src="https://osint42.org/attachments/1746785217820-png.196/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746785217820-png.196/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785217820.png"
			title="1746785217820.png"
			width="1370" height="828" loading="lazy" />
	</div><br />
<br />
<b>Библиотека Minhook</b><br />
<br />
<a href="https://github.com/TsudaKageyu/minhook" target="_blank" class="link link--external" rel="noopener">Minhook</a> - это библиотека для хукинга, написанная на C, которая может быть использована для достижения API-хукинга. Она совместима как с 32-битными, так и с 64-битными приложениями на Windows и использует ассемблер x86/x64 для внутреннего хукинга, аналогично библиотеке Detours. По сравнению с другими библиотеками хукинга, MinHook проще и предлагает легковесные API, что делает работу с ней проще.<br />
<br />
<b>Использование библиотеки Minhook</b><br />
<br />
Как и библиотека Detours, библиотека Minhook требует статический .lib файл и заголовочный файл MinHook.h, которые должны быть включены в проект Visual Studio.<br />
<br />
<b>Функции API Minhook</b><br />
<br />
Библиотека Minhook работает, инициализируя структуру, которая содержит необходимую информацию, необходимую для установки или удаления хука.<br />
Это делается через API MH_Initialize, который инициализирует структуру HOOK_ENTRY в библиотеке. Затем используется функция MH_CreateHook для создания хуков, и MH_EnableHook используется для их активации. MH_DisableHook используется для удаления хуков, и, наконец, MH_Uninitialize используется для очистки инициализированной структуры.<br />
<br />
Функции перечислены ниже для удобства:<br />
<br />
MH_Initialize - Инициализация структуры HOOK_ENTRY.<br />
<br />
MH_CreateHook - Создание хуков.<br />
<br />
MH_EnableHook - Активация созданных хуков.<br />
<br />
MH_DisableHook - Удаление хуков.<br />
<br />
MH_Uninitialize - Очистка инициализированной структуры.<br />
<br />
API Minhook возвращает значение MH_STATUS, которое является пользовательским перечислением, расположенным в Minhook.h. Возвращаемый тип данных MH_STATUS указывает код ошибки указанной функции. Значение MH_OK, которое равно 0, возвращается, если функция выполняется успешно, и ненулевое значение возвращается в случае ошибки.<br />
<br />
<b>Стоит отметить, что функции MH_Initialize и MH_Uninitialize следует вызывать только один раз, в начале и в конце программы соответственно.<br />
<br />
Функция подмены (которая будет вызываться вместо API)</b><br />
Здесь тот же пример API MessageBoxA из предыдущего модуля, который будет подменяться и изменяться для выполнения другого сообщения.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnMessageBoxA g_pMessageBoxA = NULL;

INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
printf(&quot;[+] Оригинальные параметры : \n&quot;);
printf(&quot;\t - lpText    : %s\n&quot;, lpText);
printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

return g_pMessageBoxA(hWnd, &quot;Разный lpText&quot;, &quot;Разный lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
Обратите внимание, что глобальная переменная g_pMessageBoxA используется для запуска окна сообщений, где g_pMessageBoxA - это указатель на оригинальный, не подмененный API MessageBoxA. Ей присваивается значение NULL, потому что вызов API Minhook MH_CreateHook инициализирует его для использования, в отличие от библиотеки Detours, где g_pMessageBoxA устанавливается вручную. Это делается для предотвращения возникновения проблемы цикла хукинга, о которой говорилось в предыдущем модуле.<br />
<br />
<b>Процедура хукинга Minhook</b><br />
<br />
Как упоминалось ранее, чтобы подменить конкретный API с помощью Minhook, сначала необходимо выполнить функцию MH_Initialize. Затем можно создать хуки с помощью MH_CreateHook и активировать их с помощью MH_EnableHook.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InstallHook() {

DWORD     dwMinHookErr = NULL;

if ((dwMinHookErr = MH_Initialize()) != MH_OK) {
    printf(&quot;[!] MH_Initialize завершился с ошибкой : %d \n&quot;, dwMinHookErr);
    return FALSE;
}

// Установка хука на MessageBoxA, чтобы запускать MyMessageBoxA вместо него
// g_pMessageBoxA будет указателем на оригинальную функцию MessageBoxA
if ((dwMinHookErr = MH_CreateHook(&amp;MessageBoxA, &amp;MyMessageBoxA, &amp;g_pMessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_CreateHook завершился с ошибкой : %d \n&quot;, dwMinHookErr);
    return FALSE;
}

// Активация хука на MessageBoxA
if ((dwMinHookErr = MH_EnableHook(&amp;MessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_EnableHook завершился с ошибкой : %d \n&quot;, dwMinHookErr);
    return -1;
}

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Процедура отмены хукинга Minhook</b><br />
<br />
В отличие от библиотеки Detours, библиотека Minhook не требует использования транзакций. Вместо этого, чтобы удалить хук, единственное требование - это запустить API MH_DisableHook с адресом подмененной функции. Вызов MH_Uninitialize необязателен, но он очищает структуру, инициализированную предыдущим вызовом MH_Initialize.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL Unhook() {

DWORD     dwMinHookErr = NULL;

if ((dwMinHookErr = MH_DisableHook(&amp;MessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_DisableHook завершился с ошибкой : %d \n&quot;, dwMinHookErr);
    return -1;
}

if ((dwMinHookErr = MH_Uninitialize()) != MH_OK) {
    printf(&quot;[!] MH_Uninitialize завершился с ошибкой : %d \n&quot;, dwMinHookErr);
    return -1;
}
}</code></pre>
	</div>
</div><br />
<b>Главная функция</b><br />
<br />
Ранее показанные процедуры хукинга и отмены хукинга не включают главную функцию. Главная функция представлена ниже, она просто вызывает подмененные и не подмененные версии MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

// будет выполняться
MessageBoxA(NULL, &quot;Что вы думаете о разработке вредоносных программ?&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONQUESTION);

// подмена
if (!InstallHook())
    return -1;

// не будет выполняться - подменено
MessageBoxA(NULL, &quot;Разработка вредоносных программ - это плохо&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONWARNING);

// отмена подмены
if (!Unhook())
    return -1;

// будет выполняться - хук отключен
MessageBoxA(NULL, &quot;Снова обычное сообщение&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONINFORMATION);

return 0;
}</code></pre>
	</div>
</div><br />
<b>API Hooking - Собственный код<br />
<br />
Введение</b><br />
<br />
До сих пор для реализации API-хукинга использовались открытые библиотеки. Однако основная проблема этого подхода заключается в том, что исходный код этих библиотек доступен публично, что позволяет исследователям в области безопасности и поставщикам продуктов безопасности создавать IoC(Indicators of compromise). По этой причине в этом модуле API-хукинг будет реализован вручную, хотя и не так изощренно, как в ранее продемонстрированных библиотеках, но достаточно для достижения желаемого результата без IoC.<br />
<br />
Собственный код для хукинга может быть лучшим решением, если задача - установить хук на одну функцию. Это позволяет избежать дополнительных усилий по связыванию других библиотек и уменьшает их влияние на размер бинарного файла.<br />
<br />
<b>Создание трамплинного шеллкода</b><br />
<br />
Один из способов установки хука на функцию - перезаписать её первые несколько инструкций новыми. Эти новые инструкции - это трамплин, который отвечает за изменение потока выполнения функции на заменяющую функцию. Типичным трамплином является небольшой jmp-шеллкод, который выполняет инструкцию jmp к адресу функции, которая должна быть выполнена. Чтобы выполнить инструкцию jmp, адрес, к которому нужно перейти, должен быть сохранен в регистре. В представленном примере регистром будет eax на 32-битном процессоре и r10 на 64-битном процессоре. Инструкция mov будет использоваться для сохранения адреса в этих регистрах.<br />
<br />
Этого достаточно для трамплина: инструкции mov и jmp. Глубокое погружение в то, как используются эти инструкции, не является целью этой статьи. Если вы хотите узнать больше, то можно посетить felixcloutier.com/x86/mov и felixcloutier.com/x86/jmp для получения дополнительной информации.<br />
<br />
<b>64-битный Jump Shellcode</b><br />
<br />
64-битный jump-шеллкод должен выглядеть следующим образом:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>mov r10, pAddress
jmp r10</code></pre>
	</div>
</div><br />
Где pAddress - это адрес функции, к которой нужно перейти (например, 0x0000FFFEC32A300). Чтобы использовать эти инструкции в коде, их сначала нужно преобразовать в опкоды.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pAddress
0x41, 0xFF, 0xE2                                            // jmp r10</code></pre>
	</div>
</div><br />
32-битный Jump Shellcode А версия для 32-бит:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>mov eax, pAddress
jmp eax</code></pre>
	</div>
</div><br />
Также нужно преобразовать инструкции в опкоды.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pAddress
0xFF, 0xE0                        // jmp eax</code></pre>
	</div>
</div><br />
Следует отметить, что pAddress представлено как NULL, что объясняет последовательность 0x00. Эти опкоды 0x00 являются заполнителями <b>и будут перезаписаны во время выполнения.<br />
<br />
Получение pAddress</b><br />
<br />
Поскольку хуки устанавливаются во время выполнения, значение pAddress должно быть получено и добавлено в шеллкод во время выполнения. Получение адреса можно выполнить с помощью GetProcAddress, и после этого использовать memcpy для копирования адреса в правильное место в шеллкоде.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>//64-битное пропатчивание
uint8_t        uTrampoline[] = {
            0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pFunctionToRun
            0x41, 0xFF, 0xE2                                            // jmp r10
};
uint64_t uPatch = (uint64_t)pAddress;
memcpy(&amp;uTrampoline[2], &amp;uPatch, sizeof(uPatch)); // копирование адреса в смещение &#039;2&#039; в uTrampoline</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>//32-битное пропатчивание
uint8_t        uTrampoline[] = {
       0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pFunctionToRun
       0xFF, 0xE0                        // jmp eax
};
uint32_t uPatch = (uint32_t)pAddress;
memcpy(&amp;uTrampoline[1], &amp;uPatch, sizeof(uPatch)); // копирование адреса в смещение &#039;1&#039; в uTrampoline</code></pre>
	</div>
</div><br />
Как упоминалось ранее, pAddress - это адрес функции, к которой нужно перейти. Типы данных uint32_t и uint64_t используются для обеспечения правильного количества байтов адреса, то есть 4 байта для 32-битных машин и 8 байтов для 64-битных машин. uint32_t имеет размер 4 байта, а uint64_t - 8 байтов. Затем memcpy поместит адрес в трамплин, перезаписывая байты-заполнители 0x00.<br />
<br />
<b>Запись трамплина</b><br />
<br />
Перед перезаписью первых нескольких инструкций целевой функции подготовленным шеллкодом важно пометить память, в которой будет записан трамплин, как доступную для записи. В большинстве случаев регион памяти не будет доступен для записи, что потребует использования WinAPI VirtualProtect для изменения разрешений памяти на PAGE_EXECUTE_READWRITE. Стоит отметить, что память должна быть доступна для записи и выполнения, потому что когда программа вызывает функцию, ей нужно выполнить инструкции, которые не будут разрешены в памяти, доступной только для записи.<br />
<br />
Исходя из этого, трамплин должен сначала изменить разрешения целевой функции, а затем скопировать над ним шеллкод.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Изменение разрешений памяти в &#039;pFunctionToHook&#039; на PAGE_EXECUTE_READWRITE
if (!VirtualProtect(pFunctionToHook, sizeof(uTrampoline), PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
    return FALSE;
}
// Копирование трамплинового шеллкода в &#039;pFunctionToHook&#039;
memcpy(pFunctionToHook, uTrampoline, sizeof(uTrampoline));</code></pre>
	</div>
</div><br />
Где pFunctionToHook - это адрес функции для установки хука, а uTrampoline - это jmp-шеллкод.<br />
<br />
<b>Отключение хука</b><br />
<br />
Когда вызывается захваченная функция, трамплиновый шеллкод должен работать как для 64-битных, так и для 32-битных архитектур. Однако отключение захваченной функции не обсуждалось. Для этого оригинальные байты, которые были перезаписаны трамплином, следует восстановить, используя буфер, содержащий эти байты, который был создан до установки трамплинового шеллкода. Затем этот буфер следует использовать как исходный буфер в функции memcpy при отключении функции.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>memcpy(pFunctionToHook, pOriginalBytes, sizeof(pOriginalBytes));</code></pre>
	</div>
</div><br />
Где pFunctionToHook - это адрес захваченной функции, а pOriginalBytes - это буфер, который содержит оригинальные байты функции, которые должны были быть сохранены до установки хука, и это можно сделать с помощью вызова memcpy. Размер буфера pOriginalBytes должен быть таким же, как размер трамплинового шеллкода, таким образом, будет перезаписан только шеллкод. Наконец, рекомендуется восстановить разрешения памяти, что можно сделать с помощью приведенного ниже кода.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!VirtualProtect(pFunctionToHook, sizeof(uTrampoline), dwOldProtection, &amp;dwOldProtection)) {
    return FALSE;
}</code></pre>
	</div>
</div><br />
Где dwOldProtection - это старое разрешение памяти, возвращаемое первым вызовом VirtualProtect.<br />
<br />
<b>Структура HookSt </b><br />
<br />
Чтобы упростить реализацию, была создана структура HookSt. Эта структура будет содержать необходимую информацию для установки и отключения хука на определенную функцию. Значение TRAMPOLINE_SIZE установлено на 13, если программа компилируется как 64-битное приложение, и установлено на 7, если программа компилируется в режиме 32-бит. Значения 13 и 7 - это размеры трамплинового шеллкода, указанные в переменной uTrampoline, представленной ранее, для 64-битных и 32-битных систем соответственно.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _HookSt{

    PVOID    pFunctionToHook;                  // адрес функции для установки хука
    PVOID    pFunctionToRun;                   // адрес функции для выполнения вместо
    BYTE    pOriginalBytes[TRAMPOLINE_SIZE];  // буфер для сохранения некоторых оригинальных байтов (необходим для очистки)
    DWORD    dwOldProtection;                  // сохраняет старое разрешение памяти по адресу &quot;функции для установки хука&quot; (необходимо для очистки)

}HookSt, *PHookSt;</code></pre>
	</div>
</div><br />
Установка значения TRAMPOLINE_SIZE выполняется с помощью следующего препроцессорного кода:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// если компиляция как 64-бит
#ifdef _M_X64
#define TRAMPOLINE_SIZE        13
#endif // _M_X64
// если компиляция как 32-бит
#ifdef _M_IX86
#define TRAMPOLINE_SIZE        7
#endif // _M_IX86</code></pre>
	</div>
</div><br />
<b>Установка хуков</b><br />
<br />
Следующая функция использует HookSt для установки хуков.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InstallHook (IN PHookSt Hook) {

#ifdef _M_X64
// 64-битный трамплин
    uint8_t    uTrampoline [] = {
            0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pFunctionToRun
            0x41, 0xFF, 0xE2                                            // jmp r10
    };

    // Пропатчивание шеллкода адресом для перехода (pFunctionToRun)
    uint64_t uPatch = (uint64_t)(Hook-&gt;pFunctionToRun);
    // Копирование адреса функции для перехода в смещение &#039;2&#039; в uTrampoline
    memcpy(&amp;uTrampoline[2], &amp;uPatch, sizeof(uPatch));
#endif // _M_X64

#ifdef _M_IX86
// 32-битный трамплин
    uint8_t    uTrampoline[] = {
       0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pFunctionToRun
       0xFF, 0xE0                        // jmp eax
    };

    // Пропатчивание шеллкода адресом для перехода (pFunctionToRun)
    uint32_t uPatch = (uint32_t)(Hook-&gt;pFunctionToRun);
    // Копирование адреса функции для перехода в смещение &#039;1&#039; в uTrampoline
    memcpy(&amp;uTrampoline[1], &amp;uPatch, sizeof(uPatch));
#endif // _M_IX86

    // Размещение трамплинной функции - установка хука
    memcpy(Hook-&gt;pFunctionToHook, uTrampoline, sizeof(uTrampoline));

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Снятие хуков</b><br />
<br />
Функция ниже использует HookSt для снятия хуков.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoveHook (IN PHookSt Hook) {

    DWORD    dwOldProtection        = NULL;

    // Копирование оригинальных байтов назад
    memcpy(Hook-&gt;pFunctionToHook, Hook-&gt;pOriginalBytes, TRAMPOLINE_SIZE);
    // Очистка нашего буфера
    memset(Hook-&gt;pOriginalBytes, &#039;\0&#039;, TRAMPOLINE_SIZE);
    // Установка старого разрешения памяти обратно в то, что было до установки хука
    if (!VirtualProtect(Hook-&gt;pFunctionToHook, TRAMPOLINE_SIZE, Hook-&gt;dwOldProtection, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Установка всех значений в null
    Hook-&gt;pFunctionToHook   = NULL;
    Hook-&gt;pFunctionToRun    = NULL;
    Hook-&gt;dwOldProtection   = NULL;

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Заполнение структуры HookSt</b><br />
<br />
Функция InitializeHookStruct используется для заполнения структуры HookSt необходимой информацией для установки хука.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitializeHookStruct(IN PVOID pFunctionToHook, IN PVOID pFunctionToRun, OUT PHookSt Hook) {

    // Заполнение структуры
    Hook-&gt;pFunctionToHook   = pFunctionToHook;
    Hook-&gt;pFunctionToRun    = pFunctionToRun;

    // Сохранение оригинальных байтов того же размера, который мы будем перезаписывать (то есть TRAMPOLINE_SIZE)
    // Это делается для возможности выполнения очистки при завершении
    memcpy(Hook-&gt;pOriginalBytes, pFunctionToHook, TRAMPOLINE_SIZE);

    // Изменение разрешения на RWX, чтобы можно было изменять байты
    // Мы сохраняем старое разрешение в структуре (для последующего восстановления)
    if (!VirtualProtect(pFunctionToHook, TRAMPOLINE_SIZE, PAGE_EXECUTE_READWRITE, &amp;Hook-&gt;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Основная функция</b><br />
<br />
Основная функция ниже вызывает ранее продемонстрированные функции и устанавливает хук на WinAPI MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    // Инициализация структуры (необходима до установки/снятия хука)
    HookSt st = { 0 };

    if (!InitializeHookStruct(&amp;MessageBoxA, &amp;MyMessageBoxA, &amp;st)) {
        return -1;
    }

    // будет запущено
    MessageBoxA(NULL, &quot;Что вы думаете о разработке вредоносного ПО?&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONQUESTION);

    // установка хука
    if (!InstallHook(&amp;st)) {
        return -1;
    }

    // не будет запущено - с хуком
    MessageBoxA(NULL, &quot;Разработка вредоносного ПО - это плохо&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONWARNING);

    // снятие хука
    if (!RemoveHook(&amp;st)) {
        return -1;
    }

    // будет запущено - хук отключен
    MessageBoxA(NULL, &quot;Обычное сообщение снова&quot;, &quot;Оригинальное сообщение&quot;, MB_OK | MB_ICONINFORMATION);

    return 0;
}</code></pre>
	</div>
</div><br />
<b>Перехват API - Использование API Windows</b><br />
<br />
Вызов WinAPI SetWindowsHookEx является альтернативным методом перехвата API. Он преимущественно используется для отслеживания определенных типов системных событий, что отличается от техник, используемых в предыдущих модулях, так как SetWindowsHookExW/A не изменяет функциональность функции, а вместо этого выполняет обратный вызов функции каждый раз, когда происходит определенное событие.<br />
<br />
Типы событий ограничены теми, что предоставляет Windows.<br />
<br />
<b>Использование SetWindowsHookEx</b><br />
<br />
WinAPI SetWindowsHookExW показан ниже.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		Код:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>HHOOK SetWindowsHookExW(
  [вход] int       idHook,      // Тип процедуры перехвата, который будет установлен
  [вход] HOOKPROC  lpfn,        // Указатель на процедуру перехвата (функцию для выполнения)
  [вход] HINSTANCE hmod,        // Дескриптор DLL, содержащей процедуру перехвата (это оставляют как NULL)
  [вход] DWORD     dwThreadId   // Id потока, с которым будет ассоциирована процедура перехвата (это оставляют как NULL)
);</code></pre>
	</div>
</div><br />
idHook - Событие, которое будет отслеживаться. Например, флаг WH_KEYBOARD_LL используется для отслеживания сообщений нажатия клавиш, которые могут действовать как кейлоггер.<br />
Обратите внимание, что использование SetWindowsHookEx для кейлоггинга - старый трюк. В этой статье будет использоваться флаг WH_MOUSE_LL для отслеживания кликов мыши.<br />
<br />
lpfn - Указатель на функцию обратного вызова, которая выполняется всякий раз, когда происходит указанное событие. В данном случае функция будет выполняться при каждом клике мыши.<br />
<br />
<b>Функция обратного вызова</b><br />
<br />
Функция обратного вызова должна быть типа HOOKPROC, который показан ниже.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef LRESULT (CALLBACK* HOOKPROC)(int nCode, WPARAM wParam, LPARAM lParam);</code></pre>
	</div>
</div><br />
Таким образом, функция обратного вызова должна быть определена, как функция ниже.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){
  // код функции
}</code></pre>
	</div>
</div><br />
Функция обратного вызова также должна использовать WinAPI CallNextHookEx и возвращать его результат. CallNextHookEx передает информацию о перехвате следующей процедуре перехвата в цепочке перехватов. Другими словами, он передаст информацию о перехвате функции обратного вызова в следующий раз, когда она будет выполнена.<br />
<br />
Функция обратного вызова обновлена, чтобы включать в себя CallNextHookEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){
  // Код функции

  return CallNextHookEx(NULL, nCode, wParam, lParam);
}</code></pre>
	</div>
</div><br />
На основании замечаний Microsoft вызов CallNextHookEx является необязательным, но настоятельно рекомендуется. В противном случае другие приложения, которые установили перехваты, не будут получать уведомления о перехватах и могут работать неправильно.<br />
<br />
И наконец, последняя часть - код функции обратного вызова. Код будет отслеживать действие, поэтому в этом примере функция проверяет, какая кнопка мыши была нажата с помощью следующего кода.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] Левый клик мыши \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] Правый клик мыши \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] Средний клик мыши \n&quot;);
    }

  return CallNextHookEx(NULL, nCode, wParam, lParam);
}</code></pre>
	</div>
</div><br />
<b>Обработка сообщений</b><br />
<br />
Получив код, необходимый для отслеживания кликов пользователя мышью, следующий шаг - убедиться, что процесс перехвата поддерживается. Это достигается путем выполнения кода мониторинга в течение определенного периода. Для этого SetWindowsHookExW вызывается внутри потока, который остается активным на желаемый промежуток времени с использованием WinAPI WaitForSingleObject.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Функция обратного вызова, которая будет выполняться каждый раз, когда пользователь кликает кнопкой мыши
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] Левый клик мыши \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] Правый клик мыши \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] Средний клик мыши \n&quot;);
    }

    // переход к следующему перехвату в цепочке перехватов
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    // Установка перехвата
    HHOOK hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW не удалось с ошибкой : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Поддержание работы потока
    while(1){

    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // Отслеживание кликов мыши в течение 10 секунд

    return 0;
}</code></pre>
	</div>
</div><br />
<b>Улучшение реализации</b><br />
<br />
Проблема с предыдущим кодом заключалась в том, что цикл while не обрабатывает сообщения перехваченной мыши, что приводило к задержке движения мыши на целевой машине. Чтобы решить эту проблему, необходимо обрабатывать все события сообщений с помощью DefWindowProc. Это обеспечит правильную обработку события системой и выполнение соответствующего поведения по умолчанию. DefWindowProcW вызывает стандартную процедуру окна для предоставления стандартной обработки любых сообщений окна, которые приложение не обрабатывает.<br />
<br />
Чтобы получить детали сообщения, сначала должен быть вызван GetMessageW, который извлекает сообщение из очереди сообщений вызывающего потока. Затем это сообщение передается DefWindowProcW, который обрабатывает его. GetMessageW возвращает информацию о сообщении в структуре MSG, которая включает все, что необходимо для следующего вызова DefWindowProcW.<br />
<br />
Все это должно выполняться в цикле, чтобы гарантировать ручную обработку каждого необработанного сообщения.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Функция обратного вызова, которая будет выполняться каждый раз, когда пользователь кликнет кнопкой мыши
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] Левый клик мыши \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] Правый клик мыши \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] Средний клик мыши \n&quot;);
    }

    // Переход к следующему перехвату в цепочке перехватов
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    MSG         Msg         = { 0 };

    // Установка перехвата
    HHOOK hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW не удалось с ошибкой : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Обработка необработанных событий
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // Отслеживание кликов мыши в течение 10 секунд

    return 0;
}</code></pre>
	</div>
</div><br />
<b>Удаление перехватов</b><br />
<br />
Чтобы удалить любой перехват, установленный функцией SetWindowsHookEx, должен быть вызван WinAPI UnhookWindowsHookEx.<br />
UnhookWindowsHookEx принимает только дескриптор перехвата для удаления.<br />
<br />
<b>Код перехвата SetWindowsHookEx </b><br />
<br />
Приведенный ниже фрагмент кода соединяет все, что обсуждалось в этом модуле, чтобы выполнить перехват событий клика мыши, а затем удаляет перехват.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Глобальная переменная дескриптора перехвата
HHOOK g_hMouseHook      = NULL;

// Функция обратного вызова, которая будет выполняться каждый раз, когда пользователь кликнет кнопкой мыши
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] Левый клик мыши \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] Правый клик мыши \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] Средний клик мыши \n&quot;);
    }

    // Переход к следующему перехвату в цепочке перехватов
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    MSG         Msg         = { 0 };

    // Установка перехвата
    g_hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!g_hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW не удалось с ошибкой : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Обработка необработанных событий
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // Отслеживание кликов мыши в течение 10 секунд

    // Отключение перехвата
    if (g_hMouseHook &amp;&amp; !UnhookWindowsHookEx(g_hMouseHook)) {
        printf(&quot;[!] UnhookWindowsHookEx не удалось с ошибкой : %d \n&quot;, GetLastError());
    }
    return 0;
}</code></pre>
	</div>
</div></div>
					
										

					
						<div style="padding-top: 10px;">
							
														
									<dl class="blockStatus blockStatus--info blockStatus--standalone">
										<dt></dt>
										<dd class="blockStatus-message amsNextPage">
											<span class="">Следующая страница цикла:</span>
											<a href="../predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="" title="Предельная техника. Разборка с сисколами">Предельная техника. Разборка с сисколами</a>
										</dd>
									</dl>
								

								

														
									<dl class="blockStatus blockStatus--info blockStatus--standalone">
										<dt></dt>
										<dd class="blockStatus-message amsPreviousPage">
											<span class="">Предыдущая статья цикла:</span>
											<a href="../izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="" title="Изучаем кунгфу-1. Скрытие таблицы импорта">Изучаем кунгфу-1. Скрытие таблицы импорта</a>
										</dd>
									</dl>
								
							

							
						</div>
					

					
						

						
					

					

					<div class="reactionsBar js-reactionsList ">
						
					</div>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</article>
			</div>
		</div>
	</div>
	
	
</div>










	<div class="columnContainer"
		data-xf-init="lightbox"
		data-lb-id="article-6"
		data-lb-universal="0">

		<span class="u-anchorTarget" id="comments"></span>

		<div class="columnContainer-comments">
			
	
	

	<div class="block block--messages"
		data-xf-init=""
		data-type="ams_comment"
		data-href="/inline-mod/">

		
	
	


		<div class="block-outer"></div>
		
		<div class="block-container"
			data-xf-init="select-to-quote"
			data-message-selector=".js-comment">
			
			<h3 class="block-header">Комментарии</h3>
			<div class="block-body js-replyNewCommentContainer">
				
					<span class="u-anchorTarget" id="comments"></span>
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="vivty"
		data-content="ams-comment-25"
		id="js-comment-25">

		<span class="u-anchorTarget" id="ams-comment-25"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/vivty.94/">

		
			<meta itemprop="name" content="vivty" />
			
				<meta itemprop="url" content="https://osint42.org/members/vivty.94/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--s avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--xxs avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/vivty.94/" class="username " dir="auto" data-user-id="94" data-xf-init="member-tooltip"><span class="username--style2">vivty</span></a></h4>
								</li>
								<li>
									<a href="../../../comments/25/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-12T18:12:34+0300" data-timestamp="1749741154" data-date="12.06.2025" data-time="18:12" data-short="12 Июн" title="12.06.2025 в 18:12">12.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-25"
							data-lb-caption-desc="vivty &middot; 12.06.2025 в 18:12">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">Отличные статьи.<br />
Спасибо!</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList ">
							
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="HMCoba"
		data-content="ams-comment-27"
		id="js-comment-27">

		<span class="u-anchorTarget" id="ams-comment-27"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/hmcoba.102/">

		
			<meta itemprop="name" content="HMCoba" />
			
				<meta itemprop="url" content="https://osint42.org/members/hmcoba.102/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--s" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1026af6.jpg?1756734897" srcset="/data/avatars/m/0/102.jpg?1756734897 2x" alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" itemprop="image" /> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--xxs" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1026af6.jpg?1756734897"  alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" /> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/hmcoba.102/" class="username " dir="auto" data-user-id="102" data-xf-init="member-tooltip"><span class="username--style2">HMCoba</span></a></h4>
								</li>
								<li>
									<a href="../../../comments/27/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-16T14:27:08+0300" data-timestamp="1750073228" data-date="16.06.2025" data-time="14:27" data-short="16 Июн" title="16.06.2025 в 14:27">16.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-27"
							data-lb-caption-desc="HMCoba &middot; 16.06.2025 в 14:27">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">Отличный заход в тему Red Team. <br />
Такие статьи важны для практического понимания атакующих техник. <br />
Акцент на MDLC и реальное применение - то, чего часто не хватает. <br />
Буду следить за серией.</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	
		
			<aside class="message-signature">
			
				<div class="bbWrapper">HMCoba</div>
			
			</aside>
		
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList is-active">
							
	
	
		<ul class="reactionSummary">
		
			<li><span class="reaction reaction--small reaction--1" data-reaction-id="1"><i aria-hidden="true"></i><img src="../../../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f44d.png" loading="lazy" width="64" height="64" class="reaction-image reaction-image--emoji js-reaction" alt="Like" title="Like" /></span></li>
		
		</ul>
	


<span class="u-srOnly">Реакции:</span>
<a class="reactionsBar-link" href="../../../comments/27/reactions.html" data-xf-click="overlay" data-cache="false" rel="nofollow"><bdi>Marat</bdi></a>
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
				
			</div>
		</div>

		<div class="block-outer block-outer--after">
			
			
		</div>

		
	
	

	</div>

	
	
	

	


		</div>
	</div>	



	



		







	



	




	
</div>
					
				</div>

				
					<div class="p-body-sidebar">
						
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-header">ОГЛАВЛЕНИЕ</h3>
				<div class="block-body">
					<a class="blockLink " href="../../index.html">
						
							Зачем изучать разработку вредоносных программ ?
						
					</a>

					
						<a href="../instrumenty.1/index.html" class="blockLink ">
							 Инструменты</a>
					
						<a href="../tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="blockLink ">
							 Так какой-же язык выбрать !?</a>
					
						<a href="../shpargalka-po-arkhitekture-vindy.3/index.html" class="blockLink ">
							 Шпаргалка по архитектуре винды</a>
					
						<a href="../chto-takoye-payload-i-shell-code.5/index.html" class="blockLink ">
							 Что такое payload и shell code</a>
					
						<a href="../izuchayem-dinamicheskiye-biblioteki.6/index.html" class="blockLink ">
							 Изучаем динамические библиотеки</a>
					
						<a href="../protsessy-windows.7/index.html" class="blockLink ">
							 Процессы Windows</a>
					
						<a href="../vidy-detektov.8/index.html" class="blockLink ">
							 Виды детектов</a>
					
						<a href="../kuda-klast-nagruzku.9/index.html" class="blockLink ">
							 Куда класть нагрузку ?</a>
					
						<a href="../shifruyem-payload.10/index.html" class="blockLink ">
							 Шифруем Payload</a>
					
						<a href="../obfuskatsiya-payload.11/index.html" class="blockLink ">
							 Обфускация Payload</a>
					
						<a href="../lokal-nyi-zapusk-payload.12/index.html" class="blockLink ">
							 Локальный запуск Payload</a>
					
						<a href="../in-yektsiya-v-protsess.13/index.html" class="blockLink ">
							 Иньекция в процесс</a>
					
						<a href="../in-yektsiya-shell-koda-v-protsess.14/index.html" class="blockLink ">
							 Инъекция шелл-кода в процесс</a>
					
						<a href="../razmeshchayem-payload-udalenno-na-servere.15/index.html" class="blockLink ">
							 Размещаем Payload удаленно на сервере</a>
					
						<a href="../pryachem-payload-v-reyestre.16/index.html" class="blockLink ">
							 Прячем Payload в реестре</a>
					
						<a href="../razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="blockLink ">
							 Разборка с цифровой подписью зверька</a>
					
						<a href="../izuchayem-tekhniku-thread-hijacking.18/index.html" class="blockLink ">
							 Изучаем технику Thread Hijacking</a>
					
						<a href="../opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="blockLink ">
							 Определение PID нужного процесса, или перечисления процессов</a>
					
						<a href="../izuchayem-tekhniku-apc-injection.20/index.html" class="blockLink ">
							 Изучаем технику APC Injection</a>
					
						<a href="../vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="blockLink ">
							 Вызов кода через функции обратного вызова</a>
					
						<a href="../in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="blockLink ">
							 Инъекция отображаемой памяти</a>
					
						<a href="../izuchayem-tekhniku-stomping-injection.23/index.html" class="blockLink ">
							 Изучаем технику Stomping Injection</a>
					
						<a href="../kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="blockLink ">
							 Контроль выполнения полезной нагрузки</a>
					
						<a href="../izuchayem-tekhniku-spoofing.25/index.html" class="blockLink ">
							 Изучаем технику Spoofing</a>
					
						<a href="../skrytiye-strok.26/index.html" class="blockLink ">
							 Скрытие строк</a>
					
						<a href="../izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="blockLink ">
							 Изучаем кунгфу-1. Скрытие таблицы импорта</a>
					
						<a href="index.html" class="blockLink is-selected">
							 Кунгфу-2.Изучаем API Hooking</a>
					
						<a href="../predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="blockLink ">
							 Предельная техника. Разборка с сисколами</a>
					
						<a href="../predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="blockLink ">
							 Предельная техника-2. Практика. Реализуем техники инъекции через сисколы</a>
					
						<a href="../cherpayem-sily-v-antiotladke.31/index.html" class="blockLink ">
							 Черпаем силы в антиотладке</a>
					
						<a href="../obkhod-virtual-nykh-mashin.32/index.html" class="blockLink ">
							 Обход виртуальных машин</a>
					
						<a href="../otkryvayem-vrata-ada.33/index.html" class="blockLink ">
							 Открываем врата ада</a>
					
						<a href="../umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="blockLink ">
							 Уменьшение вероятности детекта зверька</a>
					
						<a href="../obkhod-windows-defender.35/index.html" class="blockLink ">
							 Обход Windows defender</a>
					
						<a href="../pro-endpoint-detection-and-response-edr.36/index.html" class="blockLink ">
							 Про Endpoint Detection and Response (EDR)</a>
					
						<a href="../pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="blockLink ">
							 Про детект в памяти. Ничего не поделаешь и это неизбежно)</a>
					
						<a href="../ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="blockLink ">
							 Огромная база исходников современных вирусов для разных платформ</a>
					
						<a href="../kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="blockLink ">
							 Как RootKit загрузить или же как загрузить драйвер без подписи</a>
					
						<a href="../obkhod-amsi.40/index.html" class="blockLink ">
							 Обход AMSI</a>
					
						<a href="../obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="blockLink ">
							 Обход AMSI при помощи хардварных точек останова</a>
					
						<a href="../uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="blockLink ">
							 Уклоняемся от поведенческого детекта антивируса и EDR</a>
					
						<a href="../obkhodim-antivirusy-i-edr.43/index.html" class="blockLink ">
							 Обходим антивирусы и EDR</a>
					
						<a href="../mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="blockLink ">
							 MutationGate - Новый подход работы с сисколами</a>
					
						<a href="../razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="blockLink ">
							 Разработка настоящего вируса в 2024 году</a>
					

					
						<a href="../../index9401.html?full=1" class="blockLink ">Просмотреть всю статью</a>
					
				</div>
			</div>
		</div>
						
							<div class="block">
		<div class="block-container">
			<h3 class="block-minorHeader">Информация о статье</h3>
			<div class="block-body block-row block-row--minor">
				<dl class="pairs pairs--justified">
					<dt>Автор</dt>
					
						<dd><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></dd>
					
				</dl>
				
					<dl class="pairs pairs--justified">
						<dt>Просмотры</dt>
						<dd>9 577</dd>
					</dl>
				
				
					<dl class="pairs pairs--justified">
						<dt>Комментарии</dt>
						<dd>2</dd>
					</dl>
				
				
				
					<dl class="pairs pairs--justified">
						<dt>Последнее обновление</dt>
						<dd><time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 Май" title="09.05.2025 в 16:44">09.05.2025</time></dd>
					</dl>
				
				
				

				
			</div>
		</div>
	</div>
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-minorHeader"><a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html">Больше в Уроки разработки вредоносного софта</a></h3>
				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../obkhod-antivirusov-cherez-uyazvimyi-draiver.71/index.html">Обход антивирусов через уязвимый драйвер</a>

			
			
			<div class="contentRow-snippet">
				Пока хакер не прикрыли, из-за дурацких законов, решил скопировать приватную статью.

Вот...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../unichtozhayem-signaturnyye-antivirusy.57/index.html">Уничтожаем сигнатурные антивирусы</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно такие тулзы были популярны, возможно и сейчас будет находкой, кто занимается...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../skrytoye-upravleniye-komp-yuterom-na-windows-adovaya-stat-ya.56/index.html">Скрытое управление компьютером на Windows, адовая статья</a>

			
			
			<div class="contentRow-snippet">
				Статья не новая, нашел на старом форуме, но не плохо описано всё.

Возможно какие-то команды...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../memorymodule-zagruzka-dll-iz-ozu.22/index.html">MemoryModule - Загрузка DLL из ОЗУ</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно писал свой загрузчик DLL, но сейчас на гитхабе наткнулся на более взрослый...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../pro-botnet-i-kak-delat-nel-zya.16/index.html">Про ботнет и как делать нельзя</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно участвовал в конкурсе статей на xss.is, мы решили для конкурса сделать ботнет...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
			<div class="block-container">
				
					<h3 class="block-minorHeader"><a href="../../../authors/0x42.1/index.html">Больше от 0x42</a></h3>
				

				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../o-tom-kak-boryut-sya-s-tor-v-rf.75/index.html">О том как борются с TOR в РФ</a>

			
			
			<div class="contentRow-snippet">
				Недавно решил поддержать проект TOR, решил поднять middle relay.

Напомню, что для поддержки...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../bezumnyi-maks-skam.74/index.html">Безумный МАКС/СКАМ</a>

			
			
			<div class="contentRow-snippet">
				По телевизору передают, что мессенджер МАКС полюбили россияне, зарегистрировалось почти вся...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../pochemu-v-linux-vse-fail.73/index.html">Почему в Linux всё — файл?</a>

			
			
			<div class="contentRow-snippet">
				---

## 🔹 Оглавление

[1. Философия UNIX: «Everything is a file»]
[2. Как работает VFS — Virtual...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../zashchita-ot-roskomnadzora.70/index.html">Защита от Роскомнадзора</a>

			
			
			<div class="contentRow-snippet">
				В связи с тем-что РКН внедрили ботов для автоматического поиска неугодного контента и...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../uyazvimosti-v-bash-skriptakh.69/index.html">Уязвимости в bash скриптах</a>

			
			
			<div class="contentRow-snippet">
				Вот кто хоть раз интересовался безопасностью, наверное помнят всякие инъекции в php и не...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
				<div class="block-container">
					
						<h3 class="block-minorHeader">Поделиться этой страницей статьи</h3>
						
							<div class="block-body block-row block-row--separated">
								
									

	

	
		

		<div class="shareButtons shareButtons--iconic" data-xf-init="share-buttons" data-page-url="" data-page-title="" data-page-desc="" data-page-image="">
			<span class="u-anchorTarget" id="_xfUid-1-1758965535"></span>

			

			<div class="shareButtons-buttons">
				
					

					

					

					

					

					

					

					

					
						<a class="shareButtons-button shareButtons-button--email" href="#_xfUid-1-1758965535" data-href="mailto:?subject={title}&amp;body={url}">
							<i class="fa--xf far fa-envelope "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#envelope"></use></svg></i>
							<span>Электронная почта</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--share is-hidden" href="#_xfUid-1-1758965535"
							data-xf-init="web-share"
							data-title="" data-text="" data-url=""
							data-hide=".shareButtons-button:not(.shareButtons-button--share)">

							<i class="fa--xf far fa-share-alt "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#share-alt"></use></svg></i>
							<span>Поделиться</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--link is-hidden" href="#_xfUid-1-1758965535" data-clipboard="{url}">
							<i class="fa--xf far fa-link "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#link"></use></svg></i>
							<span>Ссылка</span>
						</a>
					
				
			</div>
		</div>
	

								
							</div>
						
						
							<div class="block-body block-row block-row--separated">
								
																		
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-2-1758965535">Копировать BB-код адреса статьи</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="Скопировать в буфер обмена">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[URL=&quot;https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/kungfu-2-izuchayem-api-hooking.28/&quot;]Кунгфу-2.Изучаем API Hooking[/URL]" id="_xfUid-2-1758965535" />
		</div>
	</div>

									
									
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-3-1758965535">Копировать BB-код статьи</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="Скопировать в буфер обмена">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[AMS=page, 28][/AMS]" id="_xfUid-3-1758965535" />
		</div>
	</div>

																		
								
							</div>
						
					
				</div>
			</div>
						
						
					</div>
				
			</div>

			
			
	
		<ul class="p-breadcrumbs p-breadcrumbs--bottom"
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">Уроки разработки вредоносного софта</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			
		</div>
	</div>

	<footer class="p-footer" id="footer">
		<div class="p-footer-inner">

			<div class="p-footer-row">
				
					<div class="p-footer-row-main">
						<ul class="p-footer-linkList">
							
								
								
									<li>
										
											
											
												<a href="https://osint42.org/misc/style-variation" rel="nofollow"
													class="js-styleVariationsLink"
													data-xf-init="tooltip" title=" Выбор стиля"
													data-xf-click="menu" data-z-index-ref=".u-bottomFixer" role="button" aria-expanded="false" aria-haspopup="true">

													<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Выбор стиля</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
												</a>

												<div class="menu" data-menu="menu" aria-hidden="true">
													<div class="menu-content js-styleVariationsMenu">
														

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			Системный
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			Светлый
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965535%2Ca67e2c2d807cebe310218c8b0b84df4c"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			Тёмный
		
	</a>

	

	
		
	

													</div>
												</div>
											
										
									</li>
								
								
									<li><a href="../../../../misc/language.html" data-xf-click="overlay"
										data-xf-init="tooltip" title="Выбор языка" rel="nofollow">
										<i class="fa--xf far fa-globe "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#globe"></use></svg></i> Русский (RU)</a></li>
								
							
						</ul>
					</div>
				
				<div class="p-footer-row-opposite">
					<ul class="p-footer-linkList">
						

						
							<li><a href="../../../../threads/pravila-resursa.56/index.html">Условия и правила</a></li>
						

						
							<li><a href="../../../../help/privacy-policy/index.html">Политика конфиденциальности</a></li>
						

						
							<li><a href="../../../../help/index.html">Помощь</a></li>
						

						
							<li><a href="../../../../forums/index.html">Главная</a></li>
						

						<li><a href="../../../../forums/-/index.rss" target="_blank" class="p-footer-rssLink" title="RSS"><span aria-hidden="true"><i class="fa--xf far fa-rss "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#rss"></use></svg></i><span class="u-srOnly">RSS</span></span></a></li>
					</ul>
				</div>
			</div>

			

			
		</div>
	</footer>
</div> <!-- closing p-pageWrapper -->

<div class="u-bottomFixer js-bottomFixTarget">
	
	
</div>

<div class="u-navButtons js-navButtons">
	<a href="javascript:" class="button button--scroll"><span class="button-text"><i class="fa--xf far fa-arrow-left "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-left"></use></svg></i><span class="u-srOnly">Назад</span></span></a>
</div>


	<div class="u-scrollButtons js-scrollButtons" data-trigger-type="both">
		<a href="#top" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-up "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-up"></use></svg></i><span class="u-srOnly">Верх</span></span></a>
		
			<a href="#footer" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-down "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-down"></use></svg></i><span class="u-srOnly">Низ</span></span></a>
		
	</div>



	<form style="display:none" hidden="hidden">
		<input type="text" name="_xfClientLoadTime" value="" id="_xfClientLoadTime" title="_xfClientLoadTime" tabindex="-1" />
	</form>

	





    
    
        
        
            <script type="application/ld+json">
                {
    "@context": "https://schema.org",
    "@type": "CreativeWorkSeries",
    "@id": "https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/kungfu-2-izuchayem-api-hooking.28/",
    "name": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041a\u0443\u043d\u0433\u0444\u0443-2.\u0418\u0437\u0443\u0447\u0430\u0435\u043c API Hooking",
    "headline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041a\u0443\u043d\u0433\u0444\u0443-2.\u0418\u0437\u0443\u0447\u0430\u0435\u043c API Hooking",
    "alternativeHeadline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041a\u0443\u043d\u0433\u0444\u0443-2.\u0418\u0437\u0443\u0447\u0430\u0435\u043c API Hooking",
    "description": "\u0412\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \n\nAPI Hooking \u2014 \u044d\u0442\u043e \u0442\u0435\u0445\u043d\u0438\u043a\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0430\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u0430 \u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u0438 API. \u041e\u043d\u0430 \u0447\u0430\u0441\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0438, \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0432\u0437\u043b\u043e\u043c\u0430 \u0438\u0433\u0440.\nAPI Hooking \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u0443\u044e \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u0438 API...",
    "dateCreated": "2025-05-09T10:07:26+00:00",
    "dateModified": "2025-05-09T10:08:16+00:00",
    "author": {
        "@type": "Person",
        "name": "0x42"
    },
    "thumbnailUrl": "https://osint42.org/data/attachments/0/191-1bdb4d1b5f19d43fe225ea0c53d0effb.jpg?hash=48q0DBKv2w",
    "interactionStatistic": {
        "@type": "InteractionCounter",
        "interactionType": "https://schema.org/LikeAction",
        "userInteractionCount": "0"
    }
}
            </script>
        
    



	
			
	

				
			
		
		
	

</body>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/kungfu-2-izuchayem-api-hooking.28/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:42:28 GMT -->
</html>









